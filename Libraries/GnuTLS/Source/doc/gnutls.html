<html lang="en">
<head>
<title>GNU TLS 2.6.4</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="GNU TLS 2.6.4">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="top" href="#Top">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<!--
This manual is last updated 6 February 2009 for version
2.6.4 of GNU TLS.

Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008 Free Software Foundation, Inc.

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.2 or any later version published by the Free Software
     Foundation; with no Invariant Sections, no Front-Cover Texts, and
     no Back-Cover Texts.  A copy of the license is included in the
     section entitled "GNU Free Documentation License".
-->
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
body { 
	margin: 2%;
	padding: 0 5%;
	background: #f2f2f9;
}
h1,h2,h3,h4,h5 {
    font-weight: bold;
    padding: 5px 5px 5px 5px;
    background-color: #c2e0ff;
    color: #336699;
}
h1 {
    padding: 2em 2em 2em 5%;
    color: white;
    background: #336699;
    text-align: center;
    letter-spacing: 3px;
}
h2 { text-decoration: underline; }
pre {
  margin: 0 5%;
  padding: 0.5em;
}
pre.example {
  border: solid 1px;
  background: #eeeeff;
  padding-bottom: 1em;
}
pre.verbatim {
  border: solid 1px gray;
  background: white;
  padding-bottom: 1em;
}
div.node {
  margin: 0 -5% 0 -2%;
  padding: 0.5em 0.5em;
  margin-top: 0.5em;
  margin-bottom: 0.5em;
  font-weight: bold;
}
dd, li {
  padding-top: 0.1em;
  padding-bottom: 0.1em;
}
--></style>
</head>
<body>
<h1 class="settitle">GNU TLS 2.6.4</h1>
<div class="contents">
<h2>Table of Contents</h2>
<ul>
<li><a name="toc_Top" href="#Top">GNU TLS</a>
<li><a name="toc_Preface" href="#Preface">1 Preface</a>
<ul>
<li><a href="#Getting-help">1.1 Getting Help</a>
<li><a href="#Commercial-Support">1.2 Commercial Support</a>
<li><a href="#Downloading-and-Installing">1.3 Downloading and Installing</a>
<li><a href="#Bug-Reports">1.4 Bug Reports</a>
<li><a href="#Contributing">1.5 Contributing</a>
</li></ul>
<li><a name="toc_The-Library" href="#The-Library">2 The Library</a>
<ul>
<li><a href="#General-Idea">2.1 General Idea</a>
<li><a href="#Error-handling">2.2 Error Handling</a>
<li><a href="#Memory-handling">2.3 Memory Handling</a>
<li><a href="#Callback-functions">2.4 Callback Functions</a>
</li></ul>
<li><a name="toc_Introduction-to-TLS" href="#Introduction-to-TLS">3 Introduction to <acronym>TLS</acronym></a>
<ul>
<li><a href="#TLS-layers">3.1 TLS Layers</a>
<li><a href="#The-transport-layer">3.2 The Transport Layer</a>
<li><a href="#The-TLS-record-protocol">3.3 The TLS Record Protocol</a>
<ul>
<li><a href="#Encryption-algorithms-used-in-the-record-layer">3.3.1 Encryption Algorithms Used in the Record Layer</a>
<li><a href="#Compression-algorithms-used-in-the-record-layer">3.3.2 Compression Algorithms Used in the Record Layer</a>
<li><a href="#Weaknesses-and-countermeasures">3.3.3 Weaknesses and Countermeasures</a>
</li></ul>
<li><a href="#The-TLS-Alert-Protocol">3.4 The TLS Alert Protocol</a>
<li><a href="#The-TLS-Handshake-Protocol">3.5 The TLS Handshake Protocol</a>
<ul>
<li><a href="#The-TLS-Handshake-Protocol">3.5.1 TLS Cipher Suites</a>
<li><a href="#The-TLS-Handshake-Protocol">3.5.2 Client Authentication</a>
<li><a href="#The-TLS-Handshake-Protocol">3.5.3 Resuming Sessions</a>
<li><a href="#The-TLS-Handshake-Protocol">3.5.4 Resuming Internals</a>
</li></ul>
<li><a href="#TLS-Extensions">3.6 TLS Extensions</a>
<ul>
<li><a href="#TLS-Extensions">3.6.1 Maximum Fragment Length Negotiation</a>
<li><a href="#TLS-Extensions">3.6.2 Server Name Indication</a>
</li></ul>
<li><a href="#Selecting-cryptographic-key-sizes">3.7 Selecting Cryptographic Key Sizes</a>
<li><a href="#On-SSL-2-and-older-protocols">3.8 On SSL 2 and Older Protocols</a>
<li><a href="#On-Record-Padding">3.9 On Record Padding</a>
</li></ul>
<li><a name="toc_Authentication-methods" href="#Authentication-methods">4 Authentication Methods</a>
<ul>
<li><a href="#Certificate-authentication">4.1 Certificate Authentication</a>
<ul>
<li><a href="#Certificate-authentication">4.1.1 Authentication Using <acronym>X.509</acronym> Certificates</a>
<li><a href="#Certificate-authentication">4.1.2 Authentication Using <acronym>OpenPGP</acronym> Keys</a>
<li><a href="#Certificate-authentication">4.1.3 Using Certificate Authentication</a>
</li></ul>
<li><a href="#Anonymous-authentication">4.2 Anonymous Authentication</a>
<li><a href="#Authentication-using-SRP">4.3 Authentication using <acronym>SRP</acronym></a>
<li><a href="#Authentication-using-PSK">4.4 Authentication using <acronym>PSK</acronym></a>
<li><a href="#Authentication-and-credentials">4.5 Authentication and Credentials</a>
<li><a href="#Parameters-stored-in-credentials">4.6 Parameters Stored in Credentials</a>
</li></ul>
<li><a name="toc_More-on-certificate-authentication" href="#More-on-certificate-authentication">5 More on Certificate Authentication</a>
<ul>
<li><a href="#The-X_002e509-trust-model">5.1 The <acronym>X.509</acronym> Trust Model</a>
<ul>
<li><a href="#X_002e509-certificates">5.1.1 <acronym>X.509</acronym> Certificates</a>
<li><a href="#Verifying-X_002e509-certificate-paths">5.1.2 Verifying <acronym>X.509</acronym> Certificate Paths</a>
<li><a href="#PKCS-_002310-certificate-requests">5.1.3 <acronym>PKCS</acronym> #10 Certificate Requests</a>
<li><a href="#PKCS-_002312-structures">5.1.4 <acronym>PKCS</acronym> #12 Structures</a>
</li></ul>
<li><a href="#The-OpenPGP-trust-model">5.2 The <acronym>OpenPGP</acronym> Trust Model</a>
<ul>
<li><a href="#The-OpenPGP-trust-model">5.2.1 <acronym>OpenPGP</acronym> Keys</a>
<li><a href="#The-OpenPGP-trust-model">5.2.2 Verifying an <acronym>OpenPGP</acronym> Key</a>
</li></ul>
<li><a href="#Digital-signatures">5.3 Digital Signatures</a>
<ul>
<li><a href="#Digital-signatures">5.3.1 Trading Security for Interoperability</a>
</li></ul>
</li></ul>
<li><a name="toc_How-to-use-TLS-in-application-protocols" href="#How-to-use-TLS-in-application-protocols">6 How To Use <acronym>TLS</acronym> in Application Protocols</a>
<ul>
<li><a href="#Separate-ports">6.1 Separate Ports</a>
<li><a href="#Upward-negotiation">6.2 Upward Negotiation</a>
</li></ul>
<li><a name="toc_How-to-use-GnuTLS-in-applications" href="#How-to-use-GnuTLS-in-applications">7 How To Use <acronym>GnuTLS</acronym> in Applications</a>
<ul>
<li><a href="#Preparation">7.1 Preparation</a>
<ul>
<li><a href="#Headers">7.1.1 Headers</a>
<li><a href="#Initialization">7.1.2 Initialization</a>
<li><a href="#Version-check">7.1.3 Version Check</a>
<li><a href="#Debugging">7.1.4 Debugging</a>
<li><a href="#Building-the-source">7.1.5 Building the Source</a>
</li></ul>
<li><a href="#Multi_002dthreaded-applications">7.2 Multi-Threaded Applications</a>
<li><a href="#Client-examples">7.3 Client Examples</a>
<ul>
<li><a href="#Simple-client-example-with-anonymous-authentication">7.3.1 Simple Client Example with Anonymous Authentication</a>
<li><a href="#Simple-client-example-with-X_002e509-certificate-support">7.3.2 Simple Client Example with <acronym>X.509</acronym> Certificate Support</a>
<li><a href="#Obtaining-session-information">7.3.3 Obtaining Session Information</a>
<li><a href="#Verifying-peer_0027s-certificate">7.3.4 Verifying Peer's Certificate</a>
<li><a href="#Using-a-callback-to-select-the-certificate-to-use">7.3.5 Using a Callback to Select the Certificate to Use</a>
<li><a href="#Client-with-Resume-capability-example">7.3.6 Client with Resume Capability Example</a>
<li><a href="#Simple-client-example-with-SRP-authentication">7.3.7 Simple Client Example with <acronym>SRP</acronym> Authentication</a>
<li><a href="#Simple-client-example-with-TLS_002fIA-support">7.3.8 Simple Client Example with <acronym>TLS/IA</acronym> Support</a>
<li><a href="#Simple-client-example-in-C_002b_002b">7.3.9 Simple Client Example using the C++ API</a>
<li><a href="#Helper-function-for-TCP-connections">7.3.10 Helper Function for TCP Connections</a>
</li></ul>
<li><a href="#Server-examples">7.4 Server Examples</a>
<ul>
<li><a href="#Echo-Server-with-X_002e509-authentication">7.4.1 Echo Server with <acronym>X.509</acronym> Authentication</a>
<li><a href="#Echo-Server-with-X_002e509-authentication-II">7.4.2 Echo Server with <acronym>X.509</acronym> Authentication II</a>
<li><a href="#Echo-Server-with-OpenPGP-authentication">7.4.3 Echo Server with <acronym>OpenPGP</acronym> Authentication</a>
<li><a href="#Echo-Server-with-SRP-authentication">7.4.4 Echo Server with <acronym>SRP</acronym> Authentication</a>
<li><a href="#Echo-Server-with-anonymous-authentication">7.4.5 Echo Server with Anonymous Authentication</a>
</li></ul>
<li><a href="#Miscellaneous-examples">7.5 Miscellaneous Examples</a>
<ul>
<li><a href="#Checking-for-an-alert">7.5.1 Checking for an Alert</a>
<li><a href="#X_002e509-certificate-parsing-example">7.5.2 <acronym>X.509</acronym> Certificate Parsing Example</a>
<li><a href="#Certificate-request-generation">7.5.3 Certificate Request Generation</a>
<li><a href="#PKCS-_002312-structure-generation">7.5.4 <acronym>PKCS</acronym> #12 Structure Generation</a>
</li></ul>
<li><a href="#Compatibility-with-the-OpenSSL-library">7.6 Compatibility with the OpenSSL Library</a>
<li><a href="#Opaque-PRF-Input-TLS-Extension">7.7 Opaque PRF Input TLS Extension</a>
</li></ul>
<li><a name="toc_Included-programs" href="#Included-programs">8 Included Programs</a>
<ul>
<li><a href="#Invoking-certtool">8.1 Invoking certtool</a>
<li><a href="#Invoking-gnutls_002dcli">8.2 Invoking gnutls-cli</a>
<ul>
<li><a href="#Example-client-PSK-connection">8.2.1 Example client PSK connection</a>
</li></ul>
<li><a href="#Invoking-gnutls_002dcli_002ddebug">8.3 Invoking gnutls-cli-debug</a>
<li><a href="#Invoking-gnutls_002dserv">8.4 Invoking gnutls-serv</a>
<ul>
<li><a href="#Invoking-gnutls_002dserv">8.4.1 Setting Up a Test HTTPS Server</a>
<li><a href="#Example-server-PSK-connection">8.4.2 Example server PSK connection</a>
</li></ul>
<li><a href="#Invoking-psktool">8.5 Invoking psktool</a>
<li><a href="#Invoking-srptool">8.6 Invoking srptool</a>
</li></ul>
<li><a name="toc_Function-reference" href="#Function-reference">9 Function Reference</a>
<ul>
<li><a href="#Core-functions">9.1 Core Functions</a>
<li><a href="#X_002e509-certificate-functions">9.2 <acronym>X.509</acronym> Certificate Functions</a>
<li><a href="#GnuTLS_002dextra-functions">9.3 <acronym>GnuTLS-extra</acronym> Functions</a>
<li><a href="#OpenPGP-functions">9.4 <acronym>OpenPGP</acronym> Functions</a>
<li><a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">9.5 <acronym>TLS</acronym> Inner Application (<acronym>TLS/IA</acronym>) Functions</a>
<li><a href="#Error-codes-and-descriptions">9.6 Error Codes and Descriptions</a>
</li></ul>
<li><a name="toc_All-the-supported-ciphersuites-in-GnuTLS" href="#All-the-supported-ciphersuites-in-GnuTLS">10 All the Supported Ciphersuites in <acronym>GnuTLS</acronym></a>
<li><a name="toc_Guile-Bindings" href="#Guile-Bindings">11 Guile Bindings</a>
<ul>
<li><a href="#Guile-Preparations">11.1 Guile Preparations</a>
<li><a href="#Guile-API-Conventions">11.2 Guile API Conventions</a>
<ul>
<li><a href="#Enumerates-and-Constants">11.2.1 Enumerates and Constants</a>
<li><a href="#Procedure-Names">11.2.2 Procedure Names</a>
<li><a href="#Representation-of-Binary-Data">11.2.3 Representation of Binary Data</a>
<li><a href="#Input-and-Output">11.2.4 Input and Output</a>
<li><a href="#Exception-Handling">11.2.5 Exception Handling</a>
</li></ul>
<li><a href="#Guile-Examples">11.3 Guile Examples</a>
<ul>
<li><a href="#Anonymous-Authentication-Guile-Example">11.3.1 Anonymous Authentication Guile Example</a>
<li><a href="#OpenPGP-Authentication-Guile-Example">11.3.2 OpenPGP Authentication Guile Example</a>
<li><a href="#Importing-OpenPGP-Keys-Guile-Example">11.3.3 Importing OpenPGP Keys Guile Example</a>
</li></ul>
<li><a href="#Guile-Reference">11.4 Guile Reference</a>
<ul>
<li><a href="#Core-Interface">11.4.1 Core Interface</a>
<li><a href="#Extra-Interface">11.4.2 Extra Interface</a>
</li></ul>
</li></ul>
<li><a name="toc_Internal-architecture-of-GnuTLS" href="#Internal-architecture-of-GnuTLS">12 Internal Architecture of GnuTLS</a>
<ul>
<li><a href="#The-TLS-Protocol">12.1 The TLS Protocol</a>
<li><a href="#TLS-Handshake-Protocol">12.2 TLS Handshake Protocol</a>
<li><a href="#TLS-Authentication-Methods">12.3 TLS Authentication Methods</a>
<li><a href="#TLS-Extension-Handling">12.4 TLS Extension Handling</a>
<ul>
<li><a href="#TLS-Extension-Handling">12.4.1 Adding a New TLS Extension</a>
</li></ul>
<li><a href="#TLS-Extension-Handling">12.5 Certificate Handling</a>
<li><a href="#Cryptographic-Backend">12.6 Cryptographic Backend</a>
<ul>
<li><a href="#Cryptographic-Backend">12.6.1 Override specific algorithms</a>
<li><a href="#Cryptographic-Backend">12.6.2 Override parts of the backend</a>
</li></ul>
</li></ul>
<li><a name="toc_Copying-Information" href="#Copying-Information">Appendix A Copying Information</a>
<ul>
<li><a href="#GNU-Free-Documentation-License">A.1 GNU Free Documentation License</a>
<li><a href="#GNU-LGPL">A.2 GNU Lesser General Public License</a>
<li><a href="#GNU-GPL">A.3 GNU General Public License</a>
</li></ul>
<li><a name="toc_Bibliography" href="#Bibliography">Bibliography</a>
<li><a name="toc_Function-and-Data-Index" href="#Function-and-Data-Index">Function and Data Index</a>
<li><a name="toc_Concept-Index" href="#Concept-Index">Concept Index</a>
</li></ul>
</div>



<div class="node">
<a name="Top"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Preface">Preface</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dir">(dir)</a>

</div>

<h2 class="unnumbered">GNU TLS</h2>

<p>This manual is last updated 6 February 2009 for version
2.6.4 of GNU TLS.

<p>Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008 Free Software Foundation, Inc.

<blockquote>
Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.2 or
any later version published by the Free Software Foundation; with no
Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A
copy of the license is included in the section entitled &ldquo;GNU Free
Documentation License&rdquo;. 
</blockquote>

<ul class="menu">
<li><a accesskey="1" href="#Preface">Preface</a>
<li><a accesskey="2" href="#The-Library">The Library</a>
<li><a accesskey="3" href="#Introduction-to-TLS">Introduction to TLS</a>
<li><a accesskey="4" href="#Authentication-methods">Authentication methods</a>
<li><a accesskey="5" href="#More-on-certificate-authentication">More on certificate authentication</a>
<li><a accesskey="6" href="#How-to-use-TLS-in-application-protocols">How to use TLS in application protocols</a>
<li><a accesskey="7" href="#How-to-use-GnuTLS-in-applications">How to use GnuTLS in applications</a>
<li><a accesskey="8" href="#Included-programs">Included programs</a>
<li><a accesskey="9" href="#Function-reference">Function reference</a>
<li><a href="#All-the-supported-ciphersuites-in-GnuTLS">All the supported ciphersuites in GnuTLS</a>
<li><a href="#Guile-Bindings">Guile Bindings</a>
<li><a href="#Internal-architecture-of-GnuTLS">Internal architecture of GnuTLS</a>
<li><a href="#Copying-Information">Copying Information</a>
<li><a href="#Concept-Index">Concept Index</a>
<li><a href="#Function-and-Data-Index">Function and Data Index</a>
<!-- * @mybibnode{}:: -->
<li><a href="#Bibliography">Bibliography</a>
</ul>

<div class="node">
<a name="Preface"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#The-Library">The Library</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">1 Preface</h2>

<p>This document tries to demonstrate and explain the <acronym>GnuTLS</acronym>
library API.  A brief introduction to the protocols and the technology
involved, is also included so that an application programmer can
better understand the <acronym>GnuTLS</acronym> purpose and actual offerings. 
Even if <acronym>GnuTLS</acronym> is a typical library software, it operates
over several security and cryptographic protocols, which require the
programmer to make careful and correct usage of them, otherwise he
risks to offer just a false sense of security. Security and the
network security terms are very general terms even for computer
software thus cannot be easily restricted to a single cryptographic
library.  For that reason, do not consider a program secure just
because it uses <acronym>GnuTLS</acronym>; there are several ways to compromise
a program or a communication line and <acronym>GnuTLS</acronym> only helps with
some of them.

<p>Although this document tries to be self contained, basic network
programming and PKI knowlegde is assumed in most of it. A good
introduction to networking can be found in [STEVENS] (see <a href="#Bibliography">Bibliography</a>) and for
Public Key Infrastructure in [GUTPKI] (see <a href="#Bibliography">Bibliography</a>).

<p><a name="Availability"></a>Updated versions of the <acronym>GnuTLS</acronym> software and this document
will be available from <a href="http://www.gnutls.org/">http://www.gnutls.org/</a> and
<a href="http://www.gnu.org/software/gnutls/">http://www.gnu.org/software/gnutls/</a>.

<ul class="menu">
<li><a accesskey="1" href="#Getting-help">Getting help</a>
<li><a accesskey="2" href="#Commercial-Support">Commercial Support</a>
<li><a accesskey="3" href="#Downloading-and-Installing">Downloading and Installing</a>
<li><a accesskey="4" href="#Bug-Reports">Bug Reports</a>
<li><a accesskey="5" href="#Contributing">Contributing</a>
</ul>

<div class="node">
<a name="Getting-help"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Commercial-Support">Commercial Support</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Preface">Preface</a>

</div>

<h3 class="section">1.1 Getting Help</h3>

<p>A mailing list where users may help each other exists, and you can
reach it by sending e-mail to <a href="mailto:help-gnutls@gnu.org">help-gnutls@gnu.org</a>.  Archives
of the mailing list discussions, and an interface to manage
subscriptions, is available through the World Wide Web at
<a href="http://lists.gnu.org/mailman/listinfo/help-gnutls">http://lists.gnu.org/mailman/listinfo/help-gnutls</a>.

<p>A mailing list for developers are also available, see
<a href="http://www.gnu.org/software/gnutls/lists.html">http://www.gnu.org/software/gnutls/lists.html</a>.

<p>Bug reports should be sent to <a href="mailto:bug-gnutls@gnu.org">bug-gnutls@gnu.org</a>, see
See <a href="#Bug-Reports">Bug Reports</a>.

<div class="node">
<a name="Commercial-Support"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Downloading-and-Installing">Downloading and Installing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Getting-help">Getting help</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Preface">Preface</a>

</div>

<h3 class="section">1.2 Commercial Support</h3>

<p>Commercial support is available for users of GnuTLS.  The kind of
support that can be purchased may include:

     <ul>
<li>Implement new features. 
Such as a new TLS extension.

     <li>Port GnuTLS to new platforms. 
This could include porting to an embedded platforms that may need
memory or size optimization.

     <li>Integrating TLS as a security environment in your existing project.

     <li>System design of components related to TLS.

</ul>

<p>If you are interested, please write to:

<pre class="verbatim">Simon Josefsson Datakonsult
Hagagatan 24
113 47 Stockholm
Sweden

E-mail: simon@josefsson.org
</pre>

<p>If your company provide support related to GnuTLS and would like to be
mentioned here, contact the author (see <a href="#Bug-Reports">Bug Reports</a>).

<div class="node">
<a name="Downloading-and-Installing"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Bug-Reports">Bug Reports</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Commercial-Support">Commercial Support</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Preface">Preface</a>

</div>

<h3 class="section">1.3 Downloading and Installing</h3>

<p><a name="index-Installation-1"></a><a name="index-Download-2"></a>
GnuTLS is available for download from the following URL:

<p><a href="http://www.gnutls.org/download.html">http://www.gnutls.org/download.html</a>

<p>The latest version is stored in a file, e.g.,
&lsquo;<samp><span class="samp">gnutls-2.6.4.tar.gz</span></samp>&rsquo; where the &lsquo;<samp><span class="samp">2.6.4</span></samp>&rsquo;
value is the highest version number in the directory.

<p>GnuTLS uses a Linux-like development cycle: even minor version numbers
indicate a stable release and a odd minor version number indicates a
development release.  For example, GnuTLS 1.6.3 denote a stable
release since 6 is even, and GnuTLS 1.7.11 denote a development
release since 7 is odd.

<p>GnuTLS depends on Libgcrypt,
and you will need to install Libgcrypt
before installing GnuTLS.  Libgcrypt is available from
<a href="ftp://ftp.gnupg.org/gcrypt/libgcrypt">ftp://ftp.gnupg.org/gcrypt/libgcrypt</a>.  Libgcrypt needs another
library, libgpg-error, and you need to install libgpg-error before
installing Libgcrypt.  Libgpg-error is available from
<a href="ftp://ftp.gnupg.org/gcrypt/libgpg-error">ftp://ftp.gnupg.org/gcrypt/libgpg-error</a>.

<p>Don't forget to verify the cryptographic signature after downloading
source code packages.

<p>The package is then extracted, configured and built like many other
packages that use Autoconf.  For detailed information on configuring
and building it, refer to the <samp><span class="file">INSTALL</span></samp> file that is part of the
distribution archive.  Typically you invoke <code>./configure</code> and
then <code>make check install</code>.  There are a number of compile-time
parameters, as discussed below.

<p>The compression libraries (libz and lzo) are optional dependencies. 
You can get libz from <a href="http://www.zlib.net/">http://www.zlib.net/</a>.  You can get lzo
from <a href="http://www.oberhumer.com/opensource/lzo/">http://www.oberhumer.com/opensource/lzo/</a>.

<p>The X.509 part of GnuTLS needs ASN.1 functionality, from a library
called libtasn1.  A copy of libtasn1 is included in GnuTLS.  If you
want to install it separately (e.g., to make it possibly to use
libtasn1 in other programs), you can get it from
<a href="http://www.gnu.org/software/gnutls/download.html">http://www.gnu.org/software/gnutls/download.html</a>.

<p>The OpenPGP part of GnuTLS uses a stripped down version of OpenCDK for
parsing OpenPGP packets.  It is included GnuTLS.  Use parameter
<code>--disable-openpgp-authentication</code> to disable the OpenPGP
functionality in GnuTLS.  Unfortunately, we didn't have resources to
maintain the code in a separate library.

<p>Regarding the Guile bindings, there are additional installation
considerations, see See <a href="#Guile-Preparations">Guile Preparations</a>.

<p>A few <code>configure</code> options may be relevant, summarized in the
table.

     <dl>
<dt><code>--disable-srp-authentication</code><dt><code>--disable-psk-authentication</code><dt><code>--disable-anon-authentication</code><dt><code>--disable-extra-pki</code><dt><code>--disable-openpgp-authentication</code><dt><code>--disable-openssl-compatibility</code><dd>Disable or enable particular features.  Generally not recommended.

</dl>

<p>For the complete list, refer to the output from <code>configure
--help</code>.

<div class="node">
<a name="Bug-Reports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Contributing">Contributing</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Downloading-and-Installing">Downloading and Installing</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Preface">Preface</a>

</div>

<h3 class="section">1.4 Bug Reports</h3>

<p><a name="index-Reporting-Bugs-3"></a>
If you think you have found a bug in GnuTLS, please investigate it and
report it.

     <ul>
<li>Please make sure that the bug is really in GnuTLS, and
preferably also check that it hasn't already been fixed in the latest
version.

     <li>You have to send us a test case that makes it possible for us to
reproduce the bug.

     <li>You also have to explain what is wrong; if you get a crash, or
if the results printed are not good and in that case, in what way. 
Make sure that the bug report includes all information you would need
to fix this kind of bug for someone else.

</ul>

<p>Please make an effort to produce a self-contained report, with
something definite that can be tested or debugged.  Vague queries or
piecemeal messages are difficult to act on and don't help the
development effort.

<p>If your bug report is good, we will do our best to help you to get a
corrected version of the software; if the bug report is poor, we won't
do anything about it (apart from asking you to send better bug
reports).

<p>If you think something in this manual is unclear, or downright
incorrect, or if the language needs to be improved, please also send a
note.

<p>Send your bug report to:

<div align="center">&lsquo;<samp><span class="samp">bug-gnutls@gnu.org</span></samp>&rsquo;</div>

<div class="node">
<a name="Contributing"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Bug-Reports">Bug Reports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Preface">Preface</a>

</div>

<h3 class="section">1.5 Contributing</h3>

<p><a name="index-Contributing-4"></a><a name="index-Hacking-5"></a>
If you want to submit a patch for inclusion &ndash; from solve a typo you
discovered, up to adding support for a new feature &ndash; you should
submit it as a bug report (see <a href="#Bug-Reports">Bug Reports</a>).  There are some
things that you can do to increase the chances for it to be included
in the official package.

<p>Unless your patch is very small (say, under 10 lines) we require that
you assign the copyright of your work to the Free Software Foundation. 
This is to protect the freedom of the project.  If you have not
already signed papers, we will send you the necessary information when
you submit your contribution.

<p>For contributions that doesn't consist of actual programming code, the
only guidelines are common sense.  Use it.

<p>For code contributions, a number of style guides will help you:

     <ul>
<li>Coding Style. 
Follow the GNU Standards document (see <a href="standards.html#Top">GNU Coding Standards</a>).

     <p>If you normally code using another coding standard, there is no
problem, but you should use &lsquo;<samp><span class="samp">indent</span></samp>&rsquo; to reformat the code
(see <a href="indent.html#Top">GNU Indent</a>) before submitting your work.

     <li>Use the unified diff format &lsquo;<samp><span class="samp">diff -u</span></samp>&rsquo;.

     <li>Return errors. 
No reason whatsoever should abort the execution of the library.  Even
memory allocation errors, e.g. when malloc return NULL, should work
although result in an error code.

     <li>Design with thread safety in mind. 
Don't use global variables.  Don't even write to per-handle global
variables unless the documented behaviour of the function you write is
to write to the per-handle global variable.

     <li>Avoid using the C math library. 
It causes problems for embedded implementations, and in most
situations it is very easy to avoid using it.

     <li>Document your functions. 
Use comments before each function headers, that, if properly
formatted, are extracted into Texinfo manuals and GTK-DOC web pages.

     <li>Supply a ChangeLog and NEWS entries, where appropriate.

</ul>
<div class="node">
<a name="The-Library"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Introduction-to-TLS">Introduction to TLS</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Preface">Preface</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">2 The Library</h2>

<p>In brief <acronym>GnuTLS</acronym> can be described as a library which offers an API
to access secure communication protocols. These protocols provide
privacy over insecure lines, and were designed to prevent
eavesdropping, tampering, or message forgery.

<p>Technically <acronym>GnuTLS</acronym> is a portable ANSI C based library which
implements the TLS 1.1 and SSL 3.0 protocols (See <a href="#Introduction-to-TLS">Introduction to TLS</a>, for a more detailed description of the protocols), accompanied
with the required framework for authentication and public key
infrastructure.  Important features of the <acronym>GnuTLS</acronym> library
include:

     <ul>
<li>Support for TLS 1.0, TLS 1.1, and SSL 3.0 protocols.

     <li>Support for both <acronym>X.509</acronym> and <acronym>OpenPGP</acronym> certificates.

     <li>Support for handling and verification of certificates.

     <li>Support for <acronym>SRP</acronym> for TLS authentication.

     <li>Support for <acronym>PSK</acronym> for TLS authentication.

     <li>Support for TLS Extension mechanism.

     <li>Support for TLS Compression Methods.

</ul>

<p>Additionally <acronym>GnuTLS</acronym> provides a limited emulation API for the
widely used OpenSSL<a rel="footnote" href="#fn-1" name="fnd-1"><sup>1</sup></a> library,
to ease integration with existing applications.

<p><acronym>GnuTLS</acronym> consists of three independent parts, namely the &ldquo;TLS
protocol part&rdquo;, the &ldquo;Certificate part&rdquo;, and the &ldquo;Cryptographic backend&rdquo;
part.  The `TLS protocol part' is the actual protocol implementation,
and is entirely implemented within the <acronym>GnuTLS</acronym> library.  The
`Certificate part' consists of the certificate parsing, and
verification functions which is partially implemented in the
<acronym>GnuTLS</acronym> library.  The
<acronym>Libtasn1</acronym><a rel="footnote" href="#fn-2" name="fnd-2"><sup>2</sup></a>,
a library which offers <acronym>ASN.1</acronym> parsing capabilities, is used
for the <acronym>X.509</acronym> certificate parsing functions.  A smaller
version of
<acronym>OpenCDK</acronym><a rel="footnote" href="#fn-3" name="fnd-3"><sup>3</sup></a>
is used for the <acronym>OpenPGP</acronym> key support in <acronym>GnuTLS</acronym>. 
The &ldquo;Cryptographic backend&rdquo; is provided by the
<acronym>Libgcrypt</acronym><a rel="footnote" href="#fn-4" name="fnd-4"><sup>4</sup></a>
library<a rel="footnote" href="#fn-5" name="fnd-5"><sup>5</sup></a>.

<p>In order to ease integration in embedded systems, parts of the
<acronym>GnuTLS</acronym> library can be disabled at compile time. That way a
small library, with the required features, can be generated.

<ul class="menu">
<li><a accesskey="1" href="#General-Idea">General Idea</a>
<li><a accesskey="2" href="#Error-handling">Error handling</a>
<li><a accesskey="3" href="#Memory-handling">Memory handling</a>
<li><a accesskey="4" href="#Callback-functions">Callback functions</a>
</ul>

<div class="node">
<a name="General-Idea"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Error-handling">Error handling</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-Library">The Library</a>

</div>

<h3 class="section">2.1 General Idea</h3>

<p>A brief description of how <acronym>GnuTLS</acronym> works internally is shown
at the figure below. This section may be easier to understand after
having seen the examples (see <a href="#examples">examples</a>).

<div class="block-image"><img src="gnutls-internals.png" alt="gnutls-internals.png"></div>

<p>As shown in the figure, there is a read-only global state that is
initialized once by the global initialization function.  This global
structure, among others, contains the memory allocation functions
used, and some structures needed for the <acronym>ASN.1</acronym> parser.  This structure
is never modified by any <acronym>GnuTLS</acronym> function, except for the
deinitialization function which frees all memory allocated in the
global structure and is called after the program has permanently
finished using <acronym>GnuTLS</acronym>.

<p>The credentials structure is used by some authentication methods, such
as certificate authentication (see <a href="#Certificate-Authentication">Certificate Authentication</a>).  A
credentials structure may contain certificates, private keys,
temporary parameters for diffie hellman or RSA key exchange, and other
stuff that may be shared between several TLS sessions.

<p>This structure should be initialized using the appropriate
initialization functions. For example an application which uses
certificate authentication would probably initialize the credentials,
using the appropriate functions, and put its trusted certificates in
this structure. The next step is to associate the credentials
structure with each <acronym>TLS</acronym> session.

<p>A <acronym>GnuTLS</acronym> session contains all the required stuff for a
session to handle one secure connection. This session calls directly
to the transport layer functions, in order to communicate with the
peer.  Every session has a unique session ID shared with the peer.

<p>Since TLS sessions can be resumed, servers would probably need a
database backend to hold the session's parameters.  Every
<acronym>GnuTLS</acronym> session after a successful handshake calls the
appropriate backend function (See <a href="#resume">resume</a>, for information on
initialization) to store the newly negotiated session. The session
database is examined by the server just after having received the
client hello<a rel="footnote" href="#fn-6" name="fnd-6"><sup>6</sup></a>,
and if the session ID sent by the client, matches a stored session,
the stored session will be retrieved, and the new session will be a
resumed one, and will share the same session ID with the previous one.

<div class="node">
<a name="Error-handling"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Memory-handling">Memory handling</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#General-Idea">General Idea</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-Library">The Library</a>

</div>

<h3 class="section">2.2 Error Handling</h3>

<p>In <acronym>GnuTLS</acronym> most functions return an integer type as a result.  In
almost all cases a zero or a positive number means success, and a
negative number indicates failure, or a situation that some action has
to be taken. Thus negative error codes may be fatal or not.

<p>Fatal errors terminate the connection immediately and further sends
and receives will be disallowed. An example of a fatal error code is
<code>GNUTLS_E_DECRYPTION_FAILED</code>. Non-fatal errors may warn about
something, i.e., a warning alert was received, or indicate the some
action has to be taken. This is the case with the error code
<code>GNUTLS_E_REHANDSHAKE</code> returned by <a href="#gnutls_005frecord_005frecv">gnutls_record_recv</a>. 
This error code indicates that the server requests a re-handshake. The
client may ignore this request, or may reply with an alert.  You can
test if an error code is a fatal one by using the
<a href="#gnutls_005ferror_005fis_005ffatal">gnutls_error_is_fatal</a>.

<p>If any non fatal errors, that require an action, are to be returned by
a function, these error codes will be documented in the function's
reference.  See <a href="#Error-Codes">Error Codes</a>, for all the error codes.

<div class="node">
<a name="Memory-handling"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Callback-functions">Callback functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Error-handling">Error handling</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-Library">The Library</a>

</div>

<h3 class="section">2.3 Memory Handling</h3>

<p><acronym>GnuTLS</acronym> internally handles heap allocated objects
differently, depending on the sensitivity of the data they
contain. However for performance reasons, the default memory functions
do not overwrite sensitive data from memory, nor protect such objects
from being written to the swap.  In order to change the default
behavior the <a href="#gnutls_005fglobal_005fset_005fmem_005ffunctions">gnutls_global_set_mem_functions</a> function is
available which can be used to set other memory handlers than the
defaults.

<p>The <acronym>Libgcrypt</acronym> library on which <acronym>GnuTLS</acronym> depends, has such
secure memory allocation functions available. These should be used in
cases where even the system's swap memory is not considered
secure. See the documentation of <acronym>Libgcrypt</acronym> for more
information.

<div class="node">
<a name="Callback-functions"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Memory-handling">Memory handling</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-Library">The Library</a>

</div>

<h3 class="section">2.4 Callback Functions</h3>

<p><a name="index-Callback-functions-6"></a>
There are several cases where <acronym>GnuTLS</acronym> may need some out of
band input from your program. This is now implemented using some
callback functions, which your program is expected to register.

<p>An example of this type of functions are the push and pull callbacks
which are used to specify the functions that will retrieve and send
data to the transport layer.

     <ul>
<li><a href="#gnutls_005ftransport_005fset_005fpush_005ffunction">gnutls_transport_set_push_function</a>

     <li><a href="#gnutls_005ftransport_005fset_005fpull_005ffunction">gnutls_transport_set_pull_function</a>

</ul>

<p>Other callback functions such as the one set by
<a href="#gnutls_005fsrp_005fset_005fserver_005fcredentials_005ffunction">gnutls_srp_set_server_credentials_function</a>, may require more
complicated input, including data to be allocated.  These callbacks
should allocate and free memory using the functions shown below.

     <ul>
<li><a href="#gnutls_005fmalloc">gnutls_malloc</a>

     <li><a href="#gnutls_005ffree">gnutls_free</a>

</ul>

<div class="node">
<a name="Introduction-to-TLS"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Authentication-methods">Authentication methods</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-Library">The Library</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">3 Introduction to <acronym>TLS</acronym></h2>

<p><acronym>TLS</acronym> stands for &ldquo;Transport Layer Security&rdquo; and is the
successor of SSL, the Secure Sockets Layer protocol [SSL3] (see <a href="#Bibliography">Bibliography</a>)
designed by Netscape.  <acronym>TLS</acronym> is an Internet protocol, defined
by <acronym>IETF</acronym><a rel="footnote" href="#fn-7" name="fnd-7"><sup>7</sup></a>, described in <acronym>RFC</acronym>
4346 and also in [RESCORLA] (see <a href="#Bibliography">Bibliography</a>).  The protocol provides
confidentiality, and authentication layers over any reliable transport
layer.  The description, below, refers to <acronym>TLS</acronym> 1.0 but also
applies to <acronym>TLS</acronym> 1.1 [RFC4346] (see <a href="#Bibliography">Bibliography</a>) and <acronym>SSL</acronym> 3.0,
since the differences of these protocols are minor.  Older protocols
such as <acronym>SSL</acronym> 2.0 are not discussed nor implemented in
<acronym>GnuTLS</acronym> since they are not considered secure today.  GnuTLS
also supports <acronym>X.509</acronym> and <acronym>OpenPGP</acronym> [RFC4880] (see <a href="#Bibliography">Bibliography</a>).

<ul class="menu">
<li><a accesskey="1" href="#TLS-layers">TLS layers</a>
<li><a accesskey="2" href="#The-transport-layer">The transport layer</a>
<li><a accesskey="3" href="#The-TLS-record-protocol">The TLS record protocol</a>
<li><a accesskey="4" href="#The-TLS-Alert-Protocol">The TLS Alert Protocol</a>
<li><a accesskey="5" href="#The-TLS-Handshake-Protocol">The TLS Handshake Protocol</a>
<li><a accesskey="6" href="#TLS-Extensions">TLS Extensions</a>
<li><a accesskey="7" href="#Selecting-cryptographic-key-sizes">Selecting cryptographic key sizes</a>
<li><a accesskey="8" href="#On-SSL-2-and-older-protocols">On SSL 2 and older protocols</a>
<li><a accesskey="9" href="#On-Record-Padding">On Record Padding</a>
</ul>

<div class="node">
<a name="TLS-layers"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#The-transport-layer">The transport layer</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction-to-TLS">Introduction to TLS</a>

</div>

<h3 class="section">3.1 TLS Layers</h3>

<p><a name="index-TLS-Layers-7"></a>
<acronym>TLS</acronym> is a layered protocol, and consists of the Record
Protocol, the Handshake Protocol and the Alert Protocol. The Record
Protocol is to serve all other protocols and is above the transport
layer.  The Record protocol offers symmetric encryption, data
authenticity, and optionally compression.

<p>The Alert protocol offers some signaling to the other protocols. It
can help informing the peer for the cause of failures and other error
conditions.  See <a href="#The-Alert-Protocol">The Alert Protocol</a>, for more information.  The
alert protocol is above the record protocol.

<p>The Handshake protocol is responsible for the security parameters'
negotiation, the initial key exchange and authentication.  See <a href="#The-Handshake-Protocol">The Handshake Protocol</a>, for more information about the handshake
protocol.  The protocol layering in TLS is shown in the figure below.

<div class="block-image"><img src="gnutls-layers.png" alt="gnutls-layers.png"></div>

<div class="node">
<a name="The-transport-layer"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#The-TLS-record-protocol">The TLS record protocol</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#TLS-layers">TLS layers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction-to-TLS">Introduction to TLS</a>

</div>

<h3 class="section">3.2 The Transport Layer</h3>

<p><a name="index-Transport-protocol-8"></a>
<acronym>TLS</acronym> is not limited to one transport layer, it can be used
above any transport layer, as long as it is a reliable one.  A set of
functions is provided and their purpose is to load to <acronym>GnuTLS</acronym> the
required callbacks to access the transport layer.

     <ul>
<li><a href="#gnutls_005ftransport_005fset_005fpush_005ffunction">gnutls_transport_set_push_function</a>
<li><a href="#gnutls_005ftransport_005fset_005fpull_005ffunction">gnutls_transport_set_pull_function</a>
<li><a href="#gnutls_005ftransport_005fset_005fptr">gnutls_transport_set_ptr</a>
<li><a href="#gnutls_005ftransport_005fset_005flowat">gnutls_transport_set_lowat</a>
<li><a href="#gnutls_005ftransport_005fset_005ferrno">gnutls_transport_set_errno</a>
</ul>

<p>These functions accept a callback function as a parameter.  The
callback functions should return the number of bytes written, or -1 on
error and should set <code>errno</code> appropriately.

<p>In some environments, setting <code>errno</code> is unreliable, for example
Windows have several errno variables in different CRTs, or it may be
that errno is not a thread-local variable.  If this is a concern to
you, call <code>gnutls_transport_set_errno</code> with the intended errno
value instead of setting <code>errno</code> directly.

<p><acronym>GnuTLS</acronym> currently only interprets the EINTR and EAGAIN errno
values and returns the corresponding <acronym>GnuTLS</acronym> error codes
<code>GNUTLS_E_INTERRUPTED</code> and <code>GNUTLS_E_AGAIN</code>.  These values
are usually returned by interrupted system calls, or when non blocking
IO is used.  All <acronym>GnuTLS</acronym> functions can be resumed (called
again), if any of these error codes is returned.  The error codes
above refer to the system call, not the <acronym>GnuTLS</acronym> function,
since signals do not interrupt <acronym>GnuTLS</acronym>' functions.

<p>For non blocking sockets or other custom made pull/push functions
the <a href="#gnutls_005ftransport_005fset_005flowat">gnutls_transport_set_lowat</a> must be called, with a zero
low water mark value.

<p>By default, if the transport functions are not set, <acronym>GnuTLS</acronym>
will use the Berkeley Sockets functions.  In this case
<acronym>GnuTLS</acronym> will use some hacks in order for <code>select</code> to
work, thus making it easy to add <acronym>TLS</acronym> support to existing
TCP/IP servers.

<div class="node">
<a name="The-TLS-record-protocol"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#The-TLS-Alert-Protocol">The TLS Alert Protocol</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-transport-layer">The transport layer</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction-to-TLS">Introduction to TLS</a>

</div>

<h3 class="section">3.3 The TLS Record Protocol</h3>

<p><a name="index-Record-protocol-9"></a>
The Record protocol is the secure communications provider. Its purpose
is to encrypt, authenticate and &mdash;optionally&mdash; compress packets. 
The following functions are available:

     <dl>
<dt><a href="#gnutls_005frecord_005fsend">gnutls_record_send</a>:<dd>To send a record packet (with application data).

     <br><dt><a href="#gnutls_005frecord_005frecv">gnutls_record_recv</a>:<dd>To receive a record packet (with application data).

     <br><dt><a href="#gnutls_005frecord_005fget_005fdirection">gnutls_record_get_direction</a>:<dd>To get the direction of the last interrupted function call. 
</dl>

<p>As you may have already noticed, the functions which access the Record
protocol, are quite limited, given the importance of this protocol in
<acronym>TLS</acronym>.  This is because the Record protocol's parameters are
all set by the Handshake protocol.

<p>The Record protocol initially starts with NULL parameters, which means
no encryption, and no MAC is used. Encryption and authentication begin
just after the handshake protocol has finished.

<ul class="menu">
<li><a accesskey="1" href="#Encryption-algorithms-used-in-the-record-layer">Encryption algorithms used in the record layer</a>
<li><a accesskey="2" href="#Compression-algorithms-used-in-the-record-layer">Compression algorithms used in the record layer</a>
<li><a accesskey="3" href="#Weaknesses-and-countermeasures">Weaknesses and countermeasures</a>
</ul>

<div class="node">
<a name="Encryption-algorithms-used-in-the-record-layer"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Compression-algorithms-used-in-the-record-layer">Compression algorithms used in the record layer</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-TLS-record-protocol">The TLS record protocol</a>

</div>

<h4 class="subsection">3.3.1 Encryption Algorithms Used in the Record Layer</h4>

<p><a name="index-Symmetric-encryption-algorithms-10"></a>
Confidentiality in the record layer is achieved by using symmetric
block encryption algorithms like <code>3DES</code>, <code>AES</code><a rel="footnote" href="#fn-8" name="fnd-8"><sup>8</sup></a>, or stream algorithms like
<code>ARCFOUR_128</code><a rel="footnote" href="#fn-9" name="fnd-9"><sup>9</sup></a>. Ciphers are encryption algorithms that use a single, secret,
key to encrypt and decrypt data. Block algorithms in TLS also provide
protection against statistical analysis of the data.  Thus, if you're
using the <acronym>TLS</acronym> protocol, a random number of blocks will be
appended to data, to prevent eavesdroppers from guessing the actual
data size.

<p>Supported cipher algorithms:

     <dl>
<dt><code>3DES_CBC</code><dd><code>3DES_CBC</code> is the DES block cipher algorithm used with triple
encryption (EDE). Has 64 bits block size and is used in CBC mode.

     <br><dt><code>ARCFOUR_128</code><dd>ARCFOUR is a fast stream cipher.

     <br><dt><code>ARCFOUR_40</code><dd>This is the ARCFOUR cipher that is fed with a 40 bit key,
which is considered weak.

     <br><dt><code>AES_CBC</code><dd>AES or RIJNDAEL is the block cipher algorithm that replaces the old
DES algorithm.  Has 128 bits block size and is used in CBC mode. This
is not officially supported in TLS. 
</dl>

<p>Supported MAC algorithms:

     <dl>
<dt><code>MAC_MD5</code><dd>MD5 is a cryptographic hash algorithm designed by Ron Rivest. Outputs
128 bits of data.

     <br><dt><code>MAC_SHA</code><dd>SHA is a cryptographic hash algorithm designed by NSA. Outputs 160
bits of data.

</dl>

<div class="node">
<a name="Compression-algorithms-used-in-the-record-layer"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Weaknesses-and-countermeasures">Weaknesses and countermeasures</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Encryption-algorithms-used-in-the-record-layer">Encryption algorithms used in the record layer</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-TLS-record-protocol">The TLS record protocol</a>

</div>

<h4 class="subsection">3.3.2 Compression Algorithms Used in the Record Layer</h4>

<p><a name="index-Compression-algorithms-11"></a>
The TLS record layer also supports compression.  The algorithms
implemented in <acronym>GnuTLS</acronym> can be found in the table below. 
All the algorithms except for DEFLATE which is
referenced in [RFC3749] (see <a href="#Bibliography">Bibliography</a>), should be considered as
<acronym>GnuTLS</acronym>' extensions<a rel="footnote" href="#fn-10" name="fnd-10"><sup>10</sup></a>, and should be advertised only when the peer is known to
have a compliant client, to avoid interoperability problems.

<p>The included algorithms perform really good when text, or other
compressible data are to be transfered, but offer nothing on already
compressed data, such as compressed images, zipped archives etc. 
These compression algorithms, may be useful in high bandwidth TLS
tunnels, and in cases where network usage has to be minimized. As a
drawback, compression increases latency.

<p>The record layer compression in <acronym>GnuTLS</acronym> is implemented based
on the proposal [RFC3749] (see <a href="#Bibliography">Bibliography</a>). 
The supported compression algorithms are:

     <dl>
<dt><code>DEFLATE</code><dd>Zlib compression, using the deflate algorithm.

     <br><dt><code>LZO</code><dd>LZO is a very fast compression algorithm.  This algorithm is only
available if the <acronym>GnuTLS-extra</acronym> library has been initialized
and the private extensions are enabled, and if GnuTLS was built with
LZO support.

</dl>

<div class="node">
<a name="Weaknesses-and-countermeasures"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Compression-algorithms-used-in-the-record-layer">Compression algorithms used in the record layer</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-TLS-record-protocol">The TLS record protocol</a>

</div>

<h4 class="subsection">3.3.3 Weaknesses and Countermeasures</h4>

<p>Some weaknesses that may affect the security of the Record layer have
been found in <acronym>TLS</acronym> 1.0 protocol. These weaknesses can be
exploited by active attackers, and exploit the facts that

     <ol type=1 start=1>

     <li><acronym>TLS</acronym> has separate alerts for &ldquo;decryption_failed&rdquo; and
&ldquo;bad_record_mac&rdquo;

     <li>The decryption failure reason can be detected by timing the response
time.

     <li>The IV for CBC encrypted packets is the last block of the previous
encrypted packet.

     </ol>

<p>Those weaknesses were solved in <acronym>TLS</acronym> 1.1 [RFC4346] (see <a href="#Bibliography">Bibliography</a>) which is implemented
in <acronym>GnuTLS</acronym>. For a detailed discussion see the archives of the
TLS Working Group mailing list and the paper [CBCATT] (see <a href="#Bibliography">Bibliography</a>).

<div class="node">
<a name="The-TLS-Alert-Protocol"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#The-TLS-Handshake-Protocol">The TLS Handshake Protocol</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-TLS-record-protocol">The TLS record protocol</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction-to-TLS">Introduction to TLS</a>

</div>

<h3 class="section">3.4 The TLS Alert Protocol</h3>

<p><a name="The-Alert-Protocol"></a><a name="index-Alert-protocol-12"></a>
The Alert protocol is there to allow signals to be sent between peers. 
These signals are mostly used to inform the peer about the cause of a
protocol failure. Some of these signals are used internally by the
protocol and the application protocol does not have to cope with them
(see <code>GNUTLS_A_CLOSE_NOTIFY</code>), and others refer to the
application protocol solely (see <code>GNUTLS_A_USER_CANCELLED</code>).  An
alert signal includes a level indication which may be either fatal or
warning. Fatal alerts always terminate the current connection, and
prevent future renegotiations using the current session ID.

<p>The alert messages are protected by the record protocol, thus the
information that is included does not leak. You must take extreme care
for the alert information not to leak to a possible attacker, via
public log files etc.

     <dl>
<dt><a href="#gnutls_005falert_005fsend">gnutls_alert_send</a>:<dd>To send an alert signal.

     <br><dt><a href="#gnutls_005ferror_005fto_005falert">gnutls_error_to_alert</a>:<dd>To map a gnutls error number to an alert signal.

     <br><dt><a href="#gnutls_005falert_005fget">gnutls_alert_get</a>:<dd>Returns the last received alert.

     <br><dt><a href="#gnutls_005falert_005fget_005fname">gnutls_alert_get_name</a>:<dd>Returns the name, in a character array, of the given alert.

</dl>

<div class="node">
<a name="The-TLS-Handshake-Protocol"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#TLS-Extensions">TLS Extensions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-TLS-Alert-Protocol">The TLS Alert Protocol</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction-to-TLS">Introduction to TLS</a>

</div>

<h3 class="section">3.5 The TLS Handshake Protocol</h3>

<p><a name="The-Handshake-Protocol"></a><a name="index-Handshake-protocol-13"></a>
The Handshake protocol is responsible for the ciphersuite negotiation,
the initial key exchange, and the authentication of the two peers. 
This is fully controlled by the application layer, thus your program
has to set up the required parameters. Available functions to control
the handshake protocol include:

     <dl>
<dt><a href="#gnutls_005fpriority_005finit">gnutls_priority_init</a>:<dd>To initialize a priority set of ciphers.

     <br><dt><a href="#gnutls_005fpriority_005fdeinit">gnutls_priority_deinit</a>:<dd>To deinitialize a priority set of ciphers.

     <br><dt><a href="#gnutls_005fpriority_005fset">gnutls_priority_set</a>:<dd>To associate a priority set with a <acronym>TLS</acronym> session.

     <br><dt><a href="#gnutls_005fpriority_005fset_005fdirect">gnutls_priority_set_direct</a>:<dd>To directly associate a session with a given priority string.

     <br><dt><a href="#gnutls_005fcredentials_005fset">gnutls_credentials_set</a>:<dd>To set the appropriate credentials structures.

     <br><dt><a href="#gnutls_005fcertificate_005fserver_005fset_005frequest">gnutls_certificate_server_set_request</a>:<dd>To set whether client certificate is required or not.

     <br><dt><a href="#gnutls_005fhandshake">gnutls_handshake</a>:<dd>To initiate the handshake. 
</dl>

<h4 class="subsection">3.5.1 TLS Cipher Suites</h4>

<p>The Handshake Protocol of <acronym>TLS</acronym> negotiates cipher suites of
the form <code>TLS_DHE_RSA_WITH_3DES_CBC_SHA</code>.  The usual cipher
suites contain these parameters:

     <ul>
<li>The key exchange algorithm. 
<code>DHE_RSA</code> in the example.

     <li>The Symmetric encryption algorithm and mode
<code>3DES_CBC</code> in this example.

     <li>The MAC<a rel="footnote" href="#fn-11" name="fnd-11"><sup>11</sup></a> algorithm used for authentication. 
<code>MAC_SHA</code> is used in the above example.

</ul>

<p>The cipher suite negotiated in the handshake protocol will affect the
Record Protocol, by enabling encryption and data authentication.  Note
that you should not over rely on <acronym>TLS</acronym> to negotiate the
strongest available cipher suite. Do not enable ciphers and algorithms
that you consider weak.

<p>The priority functions, dicussed above, allow the application layer to
enable and set priorities on the individual ciphers. It may imply that
all combinations of ciphersuites are allowed, but this is not
true. For several reasons, not discussed here, some combinations were
not defined in the <acronym>TLS</acronym> protocol.  The supported ciphersuites
are shown in <a href="#ciphersuites">ciphersuites</a>.

<h4 class="subsection">3.5.2 Client Authentication</h4>

<p><a name="index-Client-Certificate-authentication-14"></a>
In the case of ciphersuites that use certificate authentication, the
authentication of the client is optional in <acronym>TLS</acronym>.  A server
may request a certificate from the client &mdash; using the
<a href="#gnutls_005fcertificate_005fserver_005fset_005frequest">gnutls_certificate_server_set_request</a> function. If a
certificate is to be requested from the client during the handshake,
the server will send a certificate request message that contains a
list of acceptable certificate signers. In <acronym>GnuTLS</acronym> the certificate
signers list is constructed using the trusted Certificate Authorities by the
server. That is the ones set using
     <ul>
<li><a href="#gnutls_005fcertificate_005fset_005fx509_005ftrust_005ffile">gnutls_certificate_set_x509_trust_file</a>
<li><a href="#gnutls_005fcertificate_005fset_005fx509_005ftrust_005fmem">gnutls_certificate_set_x509_trust_mem</a>
</ul>

<p>Sending of the names of the CAs can be controlled using
<a href="#gnutls_005fcertificate_005fsend_005fx509_005frdn_005fsequence">gnutls_certificate_send_x509_rdn_sequence</a>. The client, then,
may send a certificate, signed by one of the server's acceptable
signers.

<h4 class="subsection">3.5.3 Resuming Sessions</h4>

<p><a name="resume"></a><a name="index-Resuming-sessions-15"></a>
The <a href="#gnutls_005fhandshake">gnutls_handshake</a> function, is expensive since a lot of
calculations are performed. In order to support many fast connections
to the same server a client may use session resuming. <strong>Session
resuming</strong> is a feature of the <acronym>TLS</acronym> protocol which allows a
client to connect to a server, after a successful handshake, without
the expensive calculations.  This is achieved by using the previously
established keys. <acronym>GnuTLS</acronym> supports this feature, and the
example (see <a href="#ex_003aresume_002dclient">ex:resume-client</a>) illustrates a typical use of it.

<p>Keep in mind that sessions are expired after some time, for security
reasons, thus it may be normal for a server not to resume a session
even if you requested that.  Also note that you must enable, using the
priority functions, at least the algorithms used in the last session.

<h4 class="subsection">3.5.4 Resuming Internals</h4>

<p>The resuming capability, mostly in the server side, is one of the
problems of a thread-safe TLS implementations. The problem is that all
threads must share information in order to be able to resume
sessions. The gnutls approach is, in case of a client, to leave all
the burden of resuming to the client. I.e., copy and keep the necessary
parameters. See the functions:

     <ul>
<li><a href="#gnutls_005fsession_005fget_005fdata">gnutls_session_get_data</a>

     <li><a href="#gnutls_005fsession_005fget_005fid">gnutls_session_get_id</a>

     <li><a href="#gnutls_005fsession_005fset_005fdata">gnutls_session_set_data</a>

</ul>

<p>The server side is different. A server has to specify some callback
functions which store, retrieve and delete session data. These can be
registered with:

     <ul>
<li><a href="#gnutls_005fdb_005fset_005fremove_005ffunction">gnutls_db_set_remove_function</a>

     <li><a href="#gnutls_005fdb_005fset_005fstore_005ffunction">gnutls_db_set_store_function</a>

     <li><a href="#gnutls_005fdb_005fset_005fretrieve_005ffunction">gnutls_db_set_retrieve_function</a>

     <li><a href="#gnutls_005fdb_005fset_005fptr">gnutls_db_set_ptr</a>

</ul>

<p>It might also be useful to be able to check for expired sessions in
order to remove them, and save space. The function
<a href="#gnutls_005fdb_005fcheck_005fentry">gnutls_db_check_entry</a> is provided for that reason.

<div class="node">
<a name="TLS-Extensions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Selecting-cryptographic-key-sizes">Selecting cryptographic key sizes</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-TLS-Handshake-Protocol">The TLS Handshake Protocol</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction-to-TLS">Introduction to TLS</a>

</div>

<h3 class="section">3.6 TLS Extensions</h3>

<p><a name="index-TLS-Extensions-16"></a>
A number of extensions to the <acronym>TLS</acronym> protocol have been
proposed mainly in [TLSEXT] (see <a href="#Bibliography">Bibliography</a>). The extensions supported
in <acronym>GnuTLS</acronym> are:

     <ul>
<li>Maximum fragment length negotiation
<li>Server name indication
</ul>

<p>and they will be discussed in the subsections that follow.

<h4 class="subsection">3.6.1 Maximum Fragment Length Negotiation</h4>

<p><a name="index-TLS-Extensions-17"></a><a name="index-Maximum-fragment-length-18"></a>
This extension allows a <acronym>TLS</acronym> implementation to negotiate a
smaller value for record packet maximum length. This extension may be
useful to clients with constrained capabilities. See the
<a href="#gnutls_005frecord_005fset_005fmax_005fsize">gnutls_record_set_max_size</a> and the
<a href="#gnutls_005frecord_005fget_005fmax_005fsize">gnutls_record_get_max_size</a> functions.

<h4 class="subsection">3.6.2 Server Name Indication</h4>

<p><a name="serverind"></a><a name="index-TLS-Extensions-19"></a><a name="index-Server-name-indication-20"></a>
A common problem in <acronym>HTTPS</acronym> servers is the fact that the
<acronym>TLS</acronym> protocol is not aware of the hostname that a client
connects to, when the handshake procedure begins. For that reason the
<acronym>TLS</acronym> server has no way to know which certificate to send.

<p>This extension solves that problem within the <acronym>TLS</acronym> protocol,
and allows a client to send the HTTP hostname before the handshake
begins within the first handshake packet.  The functions
<a href="#gnutls_005fserver_005fname_005fset">gnutls_server_name_set</a> and <a href="#gnutls_005fserver_005fname_005fget">gnutls_server_name_get</a> can be
used to enable this extension, or to retrieve the name sent by a
client.

<div class="node">
<a name="Selecting-cryptographic-key-sizes"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#On-SSL-2-and-older-protocols">On SSL 2 and older protocols</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#TLS-Extensions">TLS Extensions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction-to-TLS">Introduction to TLS</a>

</div>

<h3 class="section">3.7 Selecting Cryptographic Key Sizes</h3>

<p><a name="index-key-sizes-21"></a>
In TLS, since a lot of algorithms are involved, it is not easy to set a consistent security level. 
For this reason this section will present some correspondance between key sizes of symmetric algorithms
and public key algorithms based on the most conservative values of [SELKEY] (see <a href="#Bibliography">Bibliography</a>). 
Those can be used to generate certificates with appropriate key sizes as well
as parameters for Diffie Hellman and SRP authentication.

<p><table summary="">
<tr align="left"><td valign="top" width="15%">Year
</td><td valign="top" width="20%">Symmetric key size
</td><td valign="top" width="20%">RSA key size, DH and SRP prime size
</td><td valign="top" width="20%">ECC key size

<p><br></td></tr><tr align="left"><td valign="top" width="15%">1982
</td><td valign="top" width="20%">56
</td><td valign="top" width="20%">417
</td><td valign="top" width="20%">105

<p><br></td></tr><tr align="left"><td valign="top" width="15%">1988
</td><td valign="top" width="20%">61
</td><td valign="top" width="20%">566
</td><td valign="top" width="20%">114

<p><br></td></tr><tr align="left"><td valign="top" width="15%">2002
</td><td valign="top" width="20%">72
</td><td valign="top" width="20%">1028
</td><td valign="top" width="20%">139

<p><br></td></tr><tr align="left"><td valign="top" width="15%">2015
</td><td valign="top" width="20%">82
</td><td valign="top" width="20%">1613
</td><td valign="top" width="20%">173

<p><br></td></tr><tr align="left"><td valign="top" width="15%">2028
</td><td valign="top" width="20%">92
</td><td valign="top" width="20%">2362
</td><td valign="top" width="20%">210

<p><br></td></tr><tr align="left"><td valign="top" width="15%">2040
</td><td valign="top" width="20%">101
</td><td valign="top" width="20%">3214
</td><td valign="top" width="20%">244

<p><br></td></tr><tr align="left"><td valign="top" width="15%">2050
</td><td valign="top" width="20%">109
</td><td valign="top" width="20%">4047
</td><td valign="top" width="20%">272

<br></td></tr></table>

<p>The first column provides an estimation of the year until these parameters
are considered safe and the rest of the columns list the parameters for the
various algorithms.

<p>Note however that the values suggested here are nothing more than an educated
guess that is valid today. There are no guarrantees that an algorithm will remain unbreakable or that these values will remain constant in time. There could be scientific breakthroughs that cannot be predicted or total failure of the current public key systems by quantum computers. On the other hand though the cryptosystems
used in TLS are selected in a conservative way and such catastrophic breakthroughs or failures are believed to be unlikely.

<p>NIST publication SP 800-57 [NISTSP80057] (see <a href="#Bibliography">Bibliography</a>) contains a similar
table that extends beyond the key sizes given above.

<p><table summary="">
<tr align="left"><td valign="top" width="15%">Bits of security
</td><td valign="top" width="20%">Symmetric key algorithms
</td><td valign="top" width="20%">RSA key size, DSA, DH and SRP prime size
</td><td valign="top" width="20%">ECC key size

<p><br></td></tr><tr align="left"><td valign="top" width="15%">80
</td><td valign="top" width="20%">2TDEA
</td><td valign="top" width="20%">1024
</td><td valign="top" width="20%">160-223

<p><br></td></tr><tr align="left"><td valign="top" width="15%">112
</td><td valign="top" width="20%">3DES
</td><td valign="top" width="20%">2048
</td><td valign="top" width="20%">224-255

<p><br></td></tr><tr align="left"><td valign="top" width="15%">128
</td><td valign="top" width="20%">AES-128
</td><td valign="top" width="20%">3072
</td><td valign="top" width="20%">256-383

<p><br></td></tr><tr align="left"><td valign="top" width="15%">192
</td><td valign="top" width="20%">AES-192
</td><td valign="top" width="20%">7680
</td><td valign="top" width="20%">384-511

<p><br></td></tr><tr align="left"><td valign="top" width="15%">256
</td><td valign="top" width="20%">AES-256
</td><td valign="top" width="20%">15360
</td><td valign="top" width="20%">512+

<br></td></tr></table>

<p>The recommendations are fairly consistent.

<div class="node">
<a name="On-SSL-2-and-older-protocols"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#On-Record-Padding">On Record Padding</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Selecting-cryptographic-key-sizes">Selecting cryptographic key sizes</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction-to-TLS">Introduction to TLS</a>

</div>

<h3 class="section">3.8 On SSL 2 and Older Protocols</h3>

<p><a name="index-SSL-2-22"></a>
One of the initial decisions in the <acronym>GnuTLS</acronym> development was
to implement the known security protocols for the transport layer. 
Initially <acronym>TLS</acronym> 1.0 was implemented since it was the latest at
that time, and was considered to be the most advanced in security
properties.  Later the <acronym>SSL</acronym> 3.0 protocol was implemented
since it is still the only protocol supported by several servers and
there are no serious security vulnerabilities known.

<p>One question that may arise is why we didn't implement <acronym>SSL</acronym>
2.0 in the library.  There are several reasons, most important being
that it has serious security flaws, unacceptable for a modern security
library.  Other than that, this protocol is barely used by anyone
these days since it has been deprecated since 1996.  The security
problems in <acronym>SSL</acronym> 2.0 include:

     <ul>
<li>Message integrity compromised. 
The <acronym>SSLv2</acronym> message authentication uses the MD5 function, and
is insecure.

     <li>Man-in-the-middle attack. 
There is no protection of the handshake in <acronym>SSLv2</acronym>, which
permits a man-in-the-middle attack.

     <li>Truncation attack. 
<acronym>SSLv2</acronym> relies on TCP FIN to close the session, so the
attacker can forge a TCP FIN, and the peer cannot tell if it was a
legitimate end of data or not.

     <li>Weak message integrity for export ciphers. 
The cryptographic keys in <acronym>SSLv2</acronym> are used for both message
authentication and encryption, so if weak encryption schemes are
negotiated (say 40-bit keys) the message authentication code use the
same weak key, which isn't necessary.

</ul>

<p><a name="index-PCT-23"></a>Other protocols such as Microsoft's <acronym>PCT</acronym> 1 and <acronym>PCT</acronym>
2 were not implemented because they were also abandoned and deprecated
by <acronym>SSL</acronym> 3.0 and later <acronym>TLS</acronym> 1.0.

<div class="node">
<a name="On-Record-Padding"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#On-SSL-2-and-older-protocols">On SSL 2 and older protocols</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction-to-TLS">Introduction to TLS</a>

</div>

<h3 class="section">3.9 On Record Padding</h3>

<p><a name="index-Record-padding-24"></a><a name="index-Bad-record-MAC-25"></a>
The TLS protocol allows for random padding of records, to make it more
difficult to perform analysis on the length of exchanged messages. 
(In RFC 4346 this is specified in section 6.2.3.2.)  GnuTLS appears to
be one of few implementation that take advantage of this text, and pad
records by a random length.

<p>The TLS implementation in the Symbian operating system, frequently
used by Nokia and Sony-Ericsson mobile phones, cannot handle
non-minimal record padding.  What happens when one of these clients
handshake with a GnuTLS server is that the client will fail to compute
the correct MAC for the record.  The client sends a TLS alert
(<code>bad_record_mac</code>) and disconnects.  Typically this will result
in error messages such as 'A TLS fatal alert has been received', 'Bad
record MAC', or both, on the GnuTLS server side.

<p>GnuTLS implements a work around for this problem.  However, it has to
be enabled specifically.  It can be enabled by using
<a href="#gnutls_005frecord_005fdisable_005fpadding">gnutls_record_disable_padding</a>, or <a href="#gnutls_005fpriority_005fset">gnutls_priority_set</a> with
the <code>%COMPAT</code> priority string.

<p>If you implement an application that have a configuration file, we
recommend that you make it possible for users or administrators to
specify a GnuTLS protocol priority string, which is used by your
application via <a href="#gnutls_005fpriority_005fset">gnutls_priority_set</a>.  To allow the best
flexibility, make it possible to have a different priority string for
different incoming IP addresses.

<p>To enable the workaround in the <code>gnutls-cli</code> client or the
<code>gnutls-serv</code> server, for testing of other implementations, use
the following parameter: <code>--priority "%COMPAT"</code>.

<p>This problem has been discussed on mailing lists and in bug reports. 
This section tries to collect all pieces of information that we know
about the problem.  If you wish to go back to the old discussions,
here are some links:

<p><a href="http://bugs.debian.org/390712">http://bugs.debian.org/390712</a>

<p><a href="http://bugs.debian.org/402861">http://bugs.debian.org/402861</a>

<p><a href="http://bugs.debian.org/438137">http://bugs.debian.org/438137</a>

<p><a href="http://thread.gmane.org/gmane.ietf.tls/3079">http://thread.gmane.org/gmane.ietf.tls/3079</a>

<div class="node">
<a name="Authentication-methods"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#More-on-certificate-authentication">More on certificate authentication</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Introduction-to-TLS">Introduction to TLS</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">4 Authentication Methods</h2>

<p>The <acronym>TLS</acronym> protocol provides confidentiality and encryption,
but also offers authentication, which is a prerequisite for a secure
connection. The available authentication methods in <acronym>GnuTLS</acronym>
are:

     <ul>
<li>Certificate authentication

     <li>Anonymous authentication

     <li><acronym>SRP</acronym> authentication

     <li><acronym>PSK</acronym> authentication

</ul>

<ul class="menu">
<li><a accesskey="1" href="#Certificate-authentication">Certificate authentication</a>
<li><a accesskey="2" href="#Anonymous-authentication">Anonymous authentication</a>
<li><a accesskey="3" href="#Authentication-using-SRP">Authentication using SRP</a>
<li><a accesskey="4" href="#Authentication-using-PSK">Authentication using PSK</a>
<li><a accesskey="5" href="#Authentication-and-credentials">Authentication and credentials</a>
<li><a accesskey="6" href="#Parameters-stored-in-credentials">Parameters stored in credentials</a>
</ul>

<div class="node">
<a name="Certificate-authentication"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Anonymous-authentication">Anonymous authentication</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Authentication-methods">Authentication methods</a>

</div>

<h3 class="section">4.1 Certificate Authentication</h3>

<h4 class="subsection">4.1.1 Authentication Using <acronym>X.509</acronym> Certificates</h4>

<p><a name="index-g_t_0040acronym_007bX_002e509_007d-certificates-26"></a>
<acronym>X.509</acronym> certificates contain the public parameters, of a
public key algorithm, and an authority's signature, which proves the
authenticity of the parameters.  See <a href="#The-X_002e509-trust-model">The X.509 trust model</a>, for
more information on <acronym>X.509</acronym> protocols.

<h4 class="subsection">4.1.2 Authentication Using <acronym>OpenPGP</acronym> Keys</h4>

<p><a name="index-g_t_0040acronym_007bOpenPGP_007d-Keys-27"></a>
<acronym>OpenPGP</acronym> keys also contain public parameters of a public key
algorithm, and signatures from several other parties. Depending on
whether a signer is trusted the key is considered trusted or not. 
<acronym>GnuTLS</acronym>'s <acronym>OpenPGP</acronym> authentication implementation is
based on the [TLSPGP] (see <a href="#Bibliography">Bibliography</a>) proposal.

<p>See <a href="#The-OpenPGP-trust-model">The OpenPGP trust model</a>, for more information about the
<acronym>OpenPGP</acronym> trust model.  For a more detailed introduction to
<acronym>OpenPGP</acronym> and <acronym>GnuPG</acronym> see [GPGH] (see <a href="#Bibliography">Bibliography</a>).

<h4 class="subsection">4.1.3 Using Certificate Authentication</h4>

<p>In <acronym>GnuTLS</acronym> both the <acronym>OpenPGP</acronym> and <acronym>X.509</acronym>
certificates are part of the certificate authentication and thus are
handled using a common API.

<p>When using certificates the server is required to have at least one
certificate and private key pair. A client may or may not have such a
pair. The certificate and key pair should be loaded, before any
<acronym>TLS</acronym> session is initialized, in a certificate credentials
structure. This should be done by using
<a href="#gnutls_005fcertificate_005fset_005fx509_005fkey_005ffile">gnutls_certificate_set_x509_key_file</a> or
<a href="#gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005ffile">gnutls_certificate_set_openpgp_key_file</a> depending on the
certificate type.  In the <acronym>X.509</acronym> case, the functions will
also accept and use a certificate list that leads to a trusted
authority. The certificate list must be ordered in such way that every
certificate certifies the one before it. The trusted authority's
certificate need not to be included, since the peer should possess it
already.

<p>As an alternative, a callback may be used so the server or the client
specify the certificate and the key at the handshake time.  That
callback can be set using the functions:

     <ul>
<li><a href="#gnutls_005fcertificate_005fserver_005fset_005fretrieve_005ffunction">gnutls_certificate_server_set_retrieve_function</a>

     <li><a href="#gnutls_005fcertificate_005fclient_005fset_005fretrieve_005ffunction">gnutls_certificate_client_set_retrieve_function</a>

</ul>

<p>Certificate verification is possible by loading the trusted
authorities into the credentials structure by using
<a href="#gnutls_005fcertificate_005fset_005fx509_005ftrust_005ffile">gnutls_certificate_set_x509_trust_file</a> or
<a href="#gnutls_005fcertificate_005fset_005fopenpgp_005fkeyring_005ffile">gnutls_certificate_set_openpgp_keyring_file</a> for openpgp
keys. Note however that the peer's certificate is not automatically
verified, you should call <a href="#gnutls_005fcertificate_005fverify_005fpeers2">gnutls_certificate_verify_peers2</a>,
after a successful handshake, to verify the signatures of the
certificate.  An alternative way, which reports a more detailed
verification output, is to use <a href="#gnutls_005fcertificate_005fget_005fpeers">gnutls_certificate_get_peers</a> to
obtain the raw certificate of the peer and verify it using the
functions discussed in <a href="#The-X_002e509-trust-model">The X.509 trust model</a>.

<p>In a handshake, the negotiated cipher suite depends on the
certificate's parameters, so not all key exchange methods will be
available with some certificates. <acronym>GnuTLS</acronym> will disable
ciphersuites that are not compatible with the key, or the enabled
authentication methods.  For example keys marked as sign-only, will
not be able to access the plain RSA ciphersuites, but only the
<code>DHE_RSA</code> ones. It is recommended not to use RSA keys for both
signing and encryption. If possible use the same key for the
<code>DHE_RSA</code> and <code>RSA_EXPORT</code> ciphersuites, which use signing,
and a different key for the plain RSA ciphersuites, which use
encryption.  All the key exchange methods shown below are available in
certificate authentication.

<p>Note that the DHE key exchange methods are generally
slower<a rel="footnote" href="#fn-12" name="fnd-12"><sup>12</sup></a> than plain RSA and require Diffie
Hellman parameters to be generated and associated with a credentials
structure, by the server.  The <code>RSA-EXPORT</code> method also requires 512 bit RSA
parameters, that should also be generated and associated with the
credentials structure.  See the functions:

     <ul>
<li><a href="#gnutls_005fdh_005fparams_005fgenerate2">gnutls_dh_params_generate2</a>

     <li><a href="#gnutls_005fcertificate_005fset_005fdh_005fparams">gnutls_certificate_set_dh_params</a>

     <li><a href="#gnutls_005frsa_005fparams_005fgenerate2">gnutls_rsa_params_generate2</a>

     <li><a href="#gnutls_005fcertificate_005fset_005frsa_005fexport_005fparams">gnutls_certificate_set_rsa_export_params</a>

</ul>

<p>Sometimes in order to avoid bottlenecks in programs it is usefull to store
and read parameters from formats that can be generated by external programs such
as <code>certtool</code>. This is possible with <acronym>GnuTLS</acronym> by using the following
functions:

     <ul>
<li><a href="#gnutls_005fdh_005fparams_005fimport_005fpkcs3">gnutls_dh_params_import_pkcs3</a>

     <li><a href="#gnutls_005frsa_005fparams_005fimport_005fpkcs1">gnutls_rsa_params_import_pkcs1</a>

     <li><a href="#gnutls_005fdh_005fparams_005fexport_005fpkcs3">gnutls_dh_params_export_pkcs3</a>

     <li><a href="#gnutls_005frsa_005fparams_005fexport_005fpkcs1">gnutls_rsa_params_export_pkcs1</a>

</ul>

<p>Key exchange algorithms for <acronym>OpenPGP</acronym> and <acronym>X.509</acronym>
certificates:

     <dl>
<dt><code>RSA:</code><dd>The RSA algorithm is used to encrypt a key and send it to the peer. 
The certificate must allow the key to be used for encryption.

     <br><dt><code>RSA_EXPORT:</code><dd>The RSA algorithm is used to encrypt a key and send it to the peer. 
In the EXPORT algorithm, the server signs temporary RSA parameters of
512 bits &mdash; which are considered weak &mdash; and sends them to the client.

     <br><dt><code>DHE_RSA:</code><dd>The RSA algorithm is used to sign Ephemeral Diffie Hellman parameters
which are sent to the peer. The key in the certificate must allow the
key to be used for signing. Note that key exchange algorithms which
use Ephemeral Diffie Hellman parameters, offer perfect forward
secrecy. That means that even if the private key used for signing is
compromised, it cannot be used to reveal past session data.

     <br><dt><code>DHE_DSS:</code><dd>The DSS algorithm is used to sign Ephemeral Diffie Hellman parameters
which are sent to the peer. The certificate must contain DSA
parameters to use this key exchange algorithm. DSS stands for Digital
Signature Standard.

</dl>

<div class="node">
<a name="Anonymous-authentication"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Authentication-using-SRP">Authentication using SRP</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Certificate-authentication">Certificate authentication</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Authentication-methods">Authentication methods</a>

</div>

<h3 class="section">4.2 Anonymous Authentication</h3>

<p><a name="index-Anonymous-authentication-28"></a>
The anonymous key exchange performs encryption but there is no
indication of the identity of the peer.  This kind of authentication
is vulnerable to a man in the middle attack, but this protocol can be
used even if there is no prior communication and trusted parties with
the peer, or when full anonymity is required.  Unless really required,
do not use anonymous authentication.  Available key exchange methods
are shown below.

<p>Note that the key exchange methods for anonymous authentication
require Diffie Hellman parameters to be generated by the server and associated with
an anonymous credentials structure.

<p>Supported anonymous key exchange algorithms:

     <dl>
<dt><code>ANON_DH:</code><dd>This algorithm exchanges Diffie Hellman parameters.

</dl>

<div class="node">
<a name="Authentication-using-SRP"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Authentication-using-PSK">Authentication using PSK</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Anonymous-authentication">Anonymous authentication</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Authentication-methods">Authentication methods</a>

</div>

<h3 class="section">4.3 Authentication using <acronym>SRP</acronym></h3>

<p><a name="index-g_t_0040acronym_007bSRP_007d-authentication-29"></a>
Authentication via the Secure Remote Password protocol,
<acronym>SRP</acronym><a rel="footnote" href="#fn-13" name="fnd-13"><sup>13</sup></a>,
is supported.  The <acronym>SRP</acronym> key exchange is an extension to the
<acronym>TLS</acronym> protocol, and it is a password based authentication
(unlike <acronym>X.509</acronym> or <acronym>OpenPGP</acronym> that use certificates). 
The two peers can be identified using a single password, or there can
be combinations where the client is authenticated using <acronym>SRP</acronym>
and the server using a certificate.

<p>The advantage of <acronym>SRP</acronym> authentication, over other proposed
secure password authentication schemes, is that <acronym>SRP</acronym> does not
require the server to hold the user's password.  This kind of
protection is similar to the one used traditionally in the <em>UNIX</em>
<samp><span class="file">/etc/passwd</span></samp> file, where the contents of this file did not cause
harm to the system security if they were revealed.  The <acronym>SRP</acronym>
needs instead of the plain password something called a verifier, which
is calculated using the user's password, and if stolen cannot be used
to impersonate the user. Check [TOMSRP] (see <a href="#Bibliography">Bibliography</a>) for a detailed description
of the <acronym>SRP</acronym> protocol and the Stanford <acronym>SRP</acronym>
libraries, which includes a PAM module that synchronizes the system's
users passwords with the <acronym>SRP</acronym> password files. That way
<acronym>SRP</acronym> authentication could be used for all the system's users.

<p>The implementation in <acronym>GnuTLS</acronym> is based on paper
[TLSSRP] (see <a href="#Bibliography">Bibliography</a>).  The supported <acronym>SRP</acronym> key exchange methods are:

     <dl>
<dt><code>SRP:</code><dd>Authentication using the <acronym>SRP</acronym> protocol.

     <br><dt><code>SRP_DSS:</code><dd>Client authentication using the <acronym>SRP</acronym> protocol. Server is
authenticated using a certificate with DSA parameters.

     <br><dt><code>SRP_RSA:</code><dd>Client authentication using the <acronym>SRP</acronym> protocol. Server is
authenticated using a certificate with RSA parameters.

</dl>

<p>If clients supporting <acronym>SRP</acronym> know the username and password
before the connection, should initialize the client credentials and
call the function <a href="#gnutls_005fsrp_005fset_005fclient_005fcredentials">gnutls_srp_set_client_credentials</a>. 
Alternatively they could specify a callback function by using the
function <a href="#gnutls_005fsrp_005fset_005fclient_005fcredentials_005ffunction">gnutls_srp_set_client_credentials_function</a>.  This has
the advantage that allows probing the server for <acronym>SRP</acronym>
support.  In that case the callback function will be called twice per
handshake.  The first time is before the ciphersuite is negotiated,
and if the callback returns a negative error code, the callback will
be called again if <acronym>SRP</acronym> has been negotiated.  This uses a
special <acronym>TLS</acronym>-<acronym>SRP</acronym> handshake idiom in order to avoid,
in interactive applications, to ask the user for <acronym>SRP</acronym>
password and username if the server does not negotiate an
<acronym>SRP</acronym> ciphersuite.

<p>In server side the default behaviour of <acronym>GnuTLS</acronym> is to read
the usernames and <acronym>SRP</acronym> verifiers from password files. These
password files are the ones used by the <em>Stanford srp libraries</em>
and can be specified using the
<a href="#gnutls_005fsrp_005fset_005fserver_005fcredentials_005ffile">gnutls_srp_set_server_credentials_file</a>.  If a different
password file format is to be used, then the function
<a href="#gnutls_005fsrp_005fset_005fserver_005fcredentials_005ffunction">gnutls_srp_set_server_credentials_function</a>, should be called,
in order to set an appropriate callback.

<p>Some helper functions such as

     <ul>
<li><a href="#gnutls_005fsrp_005fverifier">gnutls_srp_verifier</a>

     <li><a href="#gnutls_005fsrp_005fbase64_005fencode">gnutls_srp_base64_encode</a>

     <li><a href="#gnutls_005fsrp_005fbase64_005fdecode">gnutls_srp_base64_decode</a>

</ul>

<p>are included in <acronym>GnuTLS</acronym>, and can be used to generate and
maintain <acronym>SRP</acronym> verifiers and password files.  A program to
manipulate the required parameters for <acronym>SRP</acronym> authentication is
also included.  See <a href="#srptool">srptool</a>, for more information.

<div class="node">
<a name="Authentication-using-PSK"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Authentication-and-credentials">Authentication and credentials</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Authentication-using-SRP">Authentication using SRP</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Authentication-methods">Authentication methods</a>

</div>

<h3 class="section">4.4 Authentication using <acronym>PSK</acronym></h3>

<p><a name="index-g_t_0040acronym_007bPSK_007d-authentication-30"></a>
Authentication using Pre-shared keys is a method to authenticate using
usernames and binary keys. This protocol avoids making use of public key infrastructure
and expensive calculations, thus it is suitable for constraint clients.

<p>The implementation in <acronym>GnuTLS</acronym> is based on paper
[TLSPSK] (see <a href="#Bibliography">Bibliography</a>).  The supported <acronym>PSK</acronym> key exchange methods are:

     <dl>
<dt><code>PSK:</code><dd>Authentication using the <acronym>PSK</acronym> protocol.

     <br><dt><code>DHE-PSK:</code><dd>Authentication using the <acronym>PSK</acronym> protocol and Diffie Hellman key exchange. 
This method offers perfect forward secrecy.

</dl>

<p>Clients supporting <acronym>PSK</acronym> should supply the username and key
before the connection to the client credentials by calling
the function <a href="#gnutls_005fpsk_005fset_005fclient_005fcredentials">gnutls_psk_set_client_credentials</a>. 
Alternatively they could specify a callback function by using the
function <a href="#gnutls_005fpsk_005fset_005fclient_005fcredentials_005ffunction">gnutls_psk_set_client_credentials_function</a>. 
This has the advantage that the callback will be called only if <acronym>PSK</acronym>
has been negotiated.

<p>In server side the default behaviour of <acronym>GnuTLS</acronym> is to read
the usernames and <acronym>PSK</acronym> keys from a password file. The password file
should contain usernames and keys in hexadecimal format. The name of the password
file can be stored to the credentials structure by calling
<a href="#gnutls_005fpsk_005fset_005fserver_005fcredentials_005ffile">gnutls_psk_set_server_credentials_file</a>.  If a different
password file format is to be used, then the function
<a href="#gnutls_005fpsk_005fset_005fserver_005fcredentials_005ffunction">gnutls_psk_set_server_credentials_function</a>, should be used instead.

<p>The server can help the client chose a suitable username and password,
by sending a hint.  In the server, specify the hint by calling
<a href="#gnutls_005fpsk_005fset_005fserver_005fcredentials_005fhint">gnutls_psk_set_server_credentials_hint</a>.  The client can retrieve
the hint, for example in the callback function, using
<a href="#gnutls_005fpsk_005fclient_005fget_005fhint">gnutls_psk_client_get_hint</a>.

<p>There is no standard mechanism to derive a PSK key from a password
specified by the TLS PSK document.  However, GnuTLS provides
<a href="#gnutls_005fpsk_005fnetconf_005fderive_005fkey">gnutls_psk_netconf_derive_key</a> which follows the algorithm
specified in <samp><span class="file">draft-ietf-netconf-tls-02.txt</span></samp>.

<p>Some helper functions such as:

     <ul>
<li><a href="#gnutls_005fhex_005fencode">gnutls_hex_encode</a>

     <li><a href="#gnutls_005fhex_005fdecode">gnutls_hex_decode</a>

</ul>

<p>are included in <acronym>GnuTLS</acronym>, and may be used to generate and
maintain <acronym>PSK</acronym> keys.

<div class="node">
<a name="Authentication-and-credentials"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Parameters-stored-in-credentials">Parameters stored in credentials</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Authentication-using-PSK">Authentication using PSK</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Authentication-methods">Authentication methods</a>

</div>

<h3 class="section">4.5 Authentication and Credentials</h3>

<p>In <acronym>GnuTLS</acronym> every key exchange method is associated with a
credentials type. So in order to enable to enable a specific method,
the corresponding credentials type should be initialized and set using
<a href="#gnutls_005fcredentials_005fset">gnutls_credentials_set</a>.  A mapping is shown below.

<p>Key exchange algorithms and the corresponding credential types:

<p><table summary="">
<tr align="left"><th valign="top" width="30%">Key exchange </th><th valign="top" width="30%">Client credentials </th><th valign="top" width="30%">Server credentials

<p><br></th></tr><tr align="left"><td valign="top" width="30%"><code>KX_RSA</code>
<br></td></tr><tr align="left"><td valign="top" width="30%"><code>KX_DHE_RSA</code>
<br></td></tr><tr align="left"><td valign="top" width="30%"><code>KX_DHE_DSS</code>
<br></td></tr><tr align="left"><td valign="top" width="30%"><code>KX_RSA_EXPORT</code>
</td><td valign="top" width="30%"><code>CRD_CERTIFICATE</code>
</td><td valign="top" width="30%"><code>CRD_CERTIFICATE</code>

<p><br></td></tr><tr align="left"><td valign="top" width="30%"><code>KX_SRP_RSA</code>
</td><td valign="top" width="30%"><code>CRD_SRP</code>
</td><td valign="top" width="30%"><code>CRD_SRP</code>
<br></td></tr><tr align="left"><td valign="top" width="30%"><code>KX_SRP_DSS</code>
</td><td valign="top" width="30%">
</td><td valign="top" width="30%"><code>CRD_CERTIFICATE</code>

<p><br></td></tr><tr align="left"><td valign="top" width="30%"><code>KX_SRP</code>
</td><td valign="top" width="30%"><code>CRD_SRP</code>
</td><td valign="top" width="30%"><code>CRD_SRP</code>

<p><br></td></tr><tr align="left"><td valign="top" width="30%"><code>KX_ANON_DH</code>
</td><td valign="top" width="30%"><code>CRD_ANON</code>
</td><td valign="top" width="30%"><code>CRD_ANON</code>

<p><br></td></tr><tr align="left"><td valign="top" width="30%"><code>KX_PSK</code>
</td><td valign="top" width="30%"><code>CRD_PSK</code>
</td><td valign="top" width="30%"><code>CRD_PSK</code>

<br></td></tr></table>

<div class="node">
<a name="Parameters-stored-in-credentials"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Authentication-and-credentials">Authentication and credentials</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Authentication-methods">Authentication methods</a>

</div>

<h3 class="section">4.6 Parameters Stored in Credentials</h3>

<p>Several parameters such as the ones used for Diffie-Hellman
authentication are stored within the credentials structures, so all
sessions can access them. Those parameters are stored in structures
such as <code>gnutls_dh_params_t</code> and <code>gnutls_rsa_params_t</code>, and
functions like <a href="#gnutls_005fcertificate_005fset_005fdh_005fparams">gnutls_certificate_set_dh_params</a> and
<a href="#gnutls_005fcertificate_005fset_005frsa_005fexport_005fparams">gnutls_certificate_set_rsa_export_params</a> can be used to
associate those parameters with the given credentials structure.

<p>Since those parameters need to be renewed from time to time and a
global structure such as the credentials, may not be easy to modify
since it is accessible by all sessions, an alternative interface is
available using a callback function.  This can be set using the
<a href="#gnutls_005fcertificate_005fset_005fparams_005ffunction">gnutls_certificate_set_params_function</a>.  An example is shown
below.

<pre class="example">     #include &lt;gnutls.h&gt;
     
     gnutls_rsa_params_t rsa_params;
     gnutls_dh_params_t dh_params;
     
     /* This function will be called once a session requests DH
      * or RSA parameters. The parameters returned (if any) will
      * be used for the first handshake only.
      */
     static int get_params( gnutls_session_t session,
             gnutls_params_type_t type,
             gnutls_params_st *st)
     {
        if (type == GNUTLS_PARAMS_RSA_EXPORT)
           st-&gt;params.rsa_export = rsa_params;
        else if (type == GNUTLS_PARAMS_DH)
           st-&gt;params.dh = dh_params;
        else return -1;
     
        st-&gt;type = type;
        /* do not deinitialize those parameters.
         */
        st-&gt;deinit = 0;
     
        return 0;
     }
     
     int main()
     {
        gnutls_certificate_credentials_t cert_cred;
     
        initialize_params();
     
        /* ...
         */
     
        gnutls_certificate_set_params_function( cert_cred, get_params);
     }
</pre>
<div class="node">
<a name="More-on-certificate-authentication"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#How-to-use-TLS-in-application-protocols">How to use TLS in application protocols</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Authentication-methods">Authentication methods</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">5 More on Certificate Authentication</h2>

<p><a name="Certificate-Authentication"></a><a name="index-Certificate-authentication-31"></a>

<ul class="menu">
<li><a accesskey="1" href="#The-X_002e509-trust-model">The X.509 trust model</a>
<li><a accesskey="2" href="#The-OpenPGP-trust-model">The OpenPGP trust model</a>
<li><a accesskey="3" href="#Digital-signatures">Digital signatures</a>
</ul>

<div class="node">
<a name="The-X.509-trust-model"></a>
<a name="The-X_002e509-trust-model"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#The-OpenPGP-trust-model">The OpenPGP trust model</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#More-on-certificate-authentication">More on certificate authentication</a>

</div>

<h3 class="section">5.1 The <acronym>X.509</acronym> Trust Model</h3>

<p><a name="index-g_t_0040acronym_007bX_002e509_007d-certificates-32"></a>
The <acronym>X.509</acronym> protocols rely on a hierarchical trust model. In
this trust model Certification Authorities (CAs) are used to certify
entities.  Usually more than one certification authorities exist, and
certification authorities may certify other authorities to issue
certificates as well, following a hierarchical model.

<div class="block-image"><img src="gnutls-x509.png" alt="gnutls-x509.png"></div>

<p>One needs to trust one or more CAs for his secure communications. In
that case only the certificates issued by the trusted authorities are
acceptable.  See the figure above for a typical example.  The API for
handling <acronym>X.509</acronym> certificates is described at section
<a href="#sec_003ax509api">sec:x509api</a>.  Some examples are listed below.

<ul class="menu">
<li><a accesskey="1" href="#X_002e509-certificates">X.509 certificates</a>
<li><a accesskey="2" href="#Verifying-X_002e509-certificate-paths">Verifying X.509 certificate paths</a>
<li><a accesskey="3" href="#PKCS-_002310-certificate-requests">PKCS #10 certificate requests</a>
<li><a accesskey="4" href="#PKCS-_002312-structures">PKCS #12 structures</a>
</ul>

<div class="node">
<a name="X.509-certificates"></a>
<a name="X_002e509-certificates"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Verifying-X_002e509-certificate-paths">Verifying X.509 certificate paths</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-X_002e509-trust-model">The X.509 trust model</a>

</div>

<h4 class="subsection">5.1.1 <acronym>X.509</acronym> Certificates</h4>

<p>An <acronym>X.509</acronym> certificate usually contains information about the
certificate holder, the signer, a unique serial number, expiration
dates and some other fields [RFC3280] (see <a href="#Bibliography">Bibliography</a>) as shown in the table
below.

     <dl>
<dt><code>version:</code><dd>The field that indicates the version of the certificate.

     <br><dt><code>serialNumber:</code><dd>This field holds a unique serial number per certificate.

     <br><dt><code>issuer:</code><dd>Holds the issuer's distinguished name.

     <br><dt><code>validity:</code><dd>The activation and expiration dates.

     <br><dt><code>subject:</code><dd>The subject's distinguished name of the certificate.

     <br><dt><code>extensions:</code><dd>The extensions are fields only present in version 3 certificates.

</dl>

<p>The certificate's <em>subject or issuer name</em> is not just a single
string.  It is a Distinguished name and in the <acronym>ASN.1</acronym>
notation is a sequence of several object IDs with their corresponding
values. Some of available OIDs to be used in an <acronym>X.509</acronym>
distinguished name are defined in <samp><span class="file">gnutls/x509.h</span></samp>.

<p>The <em>Version</em> field in a certificate has values either 1 or 3 for
version 3 certificates.  Version 1 certificates do not support the
extensions field so it is not possible to distinguish a CA from a
person, thus their usage should be avoided.

<p>The <em>validity</em> dates are there to indicate the date that the
specific certificate was activated and the date the certificate's key
would be considered invalid.

<p>Certificate <em>extensions</em> are there to include information about
the certificate's subject that did not fit in the typical certificate
fields. Those may be e-mail addresses, flags that indicate whether the
belongs to a CA etc.  All the supported <acronym>X.509</acronym> version 3
extensions are shown in the table below.

     <dl>
<dt><code>subject key id (2.5.29.14):</code><dd>An identifier of the key of the subject.

     <br><dt><code>authority key id (2.5.29.35):</code><dd>An identifier of the authority's key used to sign the certificate.

     <br><dt><code>subject alternative name (2.5.29.17):</code><dd>Alternative names to subject's distinguished name.

     <br><dt><code>key usage (2.5.29.15):</code><dd>Constraints the key's usage of the certificate.

     <br><dt><code>extended key usage (2.5.29.37):</code><dd>Constraints the purpose of the certificate.

     <br><dt><code>basic constraints (2.5.29.19):</code><dd>Indicates whether this is a CA certificate or not, and specify the
maximum path lengths of certificate chains.

     <br><dt><code>CRL distribution points (2.5.29.31):</code><dd>This extension is set by the CA, in order to inform about the issued CRLs.

     <br><dt><code>Proxy Certification Information (1.3.6.1.5.5.7.1.14):</code><dd>Proxy Certificates includes this extension that contains the OID of
the proxy policy language used, and can specify limits on the maximum
lengths of proxy chains.  Proxy Certificates are specified in
[RFC3820] (see <a href="#Bibliography">Bibliography</a>).

</dl>

<p>In <acronym>GnuTLS</acronym> the <acronym>X.509</acronym> certificate structures are handled using
the <code>gnutls_x509_crt_t</code> type and the corresponding private keys
with the <code>gnutls_x509_privkey_t</code> type.  All the available
functions for <acronym>X.509</acronym> certificate handling have their prototypes in
<samp><span class="file">gnutls/x509.h</span></samp>. An example program to demonstrate the <acronym>X.509</acronym>
parsing capabilities can be found at section <a href="#ex_003ax509_002dinfo">ex:x509-info</a>.

<div class="node">
<a name="Verifying-X.509-certificate-paths"></a>
<a name="Verifying-X_002e509-certificate-paths"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#PKCS-_002310-certificate-requests">PKCS #10 certificate requests</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#X_002e509-certificates">X.509 certificates</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-X_002e509-trust-model">The X.509 trust model</a>

</div>

<h4 class="subsection">5.1.2 Verifying <acronym>X.509</acronym> Certificate Paths</h4>

<p><a name="index-Verifying-certificate-paths-33"></a>
Verifying certificate paths is important in <acronym>X.509</acronym> authentication. For
this purpose the function <a href="#gnutls_005fx509_005fcrt_005fverify">gnutls_x509_crt_verify</a> is
provided. The output of this function is the bitwise OR of the
elements of the <code>gnutls_certificate_status_t</code> enumeration.  A
detailed description of these elements can be found in figure below. 
The function <a href="#gnutls_005fcertificate_005fverify_005fpeers2">gnutls_certificate_verify_peers2</a> is equivalent to
the previous one, and will verify the peer's certificate in a TLS
session.

     <dl>
<dt><code>CERT_INVALID:</code><dd>The certificate is not signed by one of the known authorities, or
the signature is invalid.

     <br><dt><code>CERT_REVOKED:</code><dd>The certificate has been revoked by its CA.

     <br><dt><code>CERT_SIGNER_NOT_FOUND:</code><dd>The certificate's issuer is not known. This is the case when the
issuer is not in the trusted certificates list.

     <br><dt><code>GNUTLS_CERT_SIGNER_NOT_CA:</code><dd>The certificate's signer was not a CA. This may happen if
this was a version 1 certificate, which is common with some CAs, or
a version 3 certificate without the basic constrains extension.

     <p><a name="GNUTLS_005fCERT_005fINSECURE_005fALGORITHM"></a><br><dt><code>GNUTLS_CERT_INSECURE_ALGORITHM:</code><dd>The certificate was signed using an insecure algorithm such as MD2 or
MD5.  These algorithms have been broken and should not be trusted.

</dl>

<p>There is also to possibility to pass some input to the verification
functions in the form of flags. For <a href="#gnutls_005fx509_005fcrt_005fverify">gnutls_x509_crt_verify</a> the
flags are passed straightforward, but
<a href="#gnutls_005fcertificate_005fverify_005fpeers2">gnutls_certificate_verify_peers2</a> depends on the flags set by
calling <a href="#gnutls_005fcertificate_005fset_005fverify_005fflags">gnutls_certificate_set_verify_flags</a>.  All the available
flags are part of the enumeration
<a href="#gnutls_005fcertificate_005fverify_005fflags">gnutls_certificate_verify_flags</a> and are explained in the table
below.

<p><a name="gnutls_005fcertificate_005fverify_005fflags"></a><a name="index-gnutls_005fcertificate_005fverify_005fflags-34"></a>
     <dl>
<dt><code>GNUTLS_VERIFY_DISABLE_CA_SIGN:</code><dd>If set a signer does not have to be a certificate authority. This
flag should normaly be disabled, unless you know what this means.

     <br><dt><code>GNUTLS_VERIFY_ALLOW_X509_V1_CA_CRT:</code><dd>Allow only trusted CA certificates that have version 1.  This is
safer than GNUTLS_VERIFY_ALLOW_ANY_X509_V1_CA_CRT, and should be
used instead. That way only signers in your trusted list will be
allowed to have certificates of version 1.

     <br><dt><code>GNUTLS_VERIFY_ALLOW_ANY_X509_V1_CA_CRT:</code><dd>Allow CA certificates that have version 1 (both root and
intermediate). This is dangerous since those haven't the
basicConstraints extension. Must be used in combination with
GNUTLS_VERIFY_ALLOW_X509_V1_CA_CRT.

     <br><dt><code>GNUTLS_VERIFY_DO_NOT_ALLOW_SAME:</code><dd>If a certificate is not signed by anyone trusted but exists in
the trusted CA list do not treat it as trusted.

     <br><dt><code>GNUTLS_VERIFY_ALLOW_SIGN_RSA_MD2:</code><dd>Allow certificates to be signed using the old MD2 algorithm.

     <br><dt><code>GNUTLS_VERIFY_ALLOW_SIGN_RSA_MD5:</code><dd>Allow certificates to be signed using the broken MD5 algorithm. 
</dl>

<p>Although the verification of a certificate path indicates that the
certificate is signed by trusted authority, does not reveal anything
about the peer's identity. It is required to verify if the
certificate's owner is the one you expect. For more information consult [RFC2818] (see <a href="#Bibliography">Bibliography</a>)
and section <a href="#ex_003averify">ex:verify</a> for an example.

<div class="node">
<a name="PKCS-%2310-certificate-requests"></a>
<a name="PKCS-_002310-certificate-requests"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#PKCS-_002312-structures">PKCS #12 structures</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Verifying-X_002e509-certificate-paths">Verifying X.509 certificate paths</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-X_002e509-trust-model">The X.509 trust model</a>

</div>

<h4 class="subsection">5.1.3 <acronym>PKCS</acronym> #10 Certificate Requests</h4>

<p><a name="index-Certificate-requests-35"></a><a name="index-g_t_0040acronym_007bPKCS_007d-_002310-36"></a>
A certificate request is a structure, which contain information about
an applicant of a certificate service.  It usually contains a private
key, a distinguished name and secondary data such as a challenge
password. <acronym>GnuTLS</acronym> supports the requests defined in
<acronym>PKCS</acronym> #10 [RFC2986] (see <a href="#Bibliography">Bibliography</a>). Other certificate request's format
such as PKIX's [RFC4211] (see <a href="#Bibliography">Bibliography</a>) are not currently supported.

<p>In <acronym>GnuTLS</acronym> the <acronym>PKCS</acronym> #10 structures are handled
using the <code>gnutls_x509_crq_t</code> type.  An example of a certificate
request generation can be found at section <a href="#ex_003acrq">ex:crq</a>.

<div class="node">
<a name="PKCS-%2312-structures"></a>
<a name="PKCS-_002312-structures"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#PKCS-_002310-certificate-requests">PKCS #10 certificate requests</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#The-X_002e509-trust-model">The X.509 trust model</a>

</div>

<h4 class="subsection">5.1.4 <acronym>PKCS</acronym> #12 Structures</h4>

<p><a name="index-g_t_0040acronym_007bPKCS_007d-_002312-37"></a>
A <acronym>PKCS</acronym> #12 structure [PKCS12] (see <a href="#Bibliography">Bibliography</a>) usually contains a user's
private keys and certificates. It is commonly used in browsers to
export and import the user's identities.

<p>In <acronym>GnuTLS</acronym> the <acronym>PKCS</acronym> #12 structures are handled
using the <code>gnutls_pkcs12_t</code> type. This is an abstract type that
may hold several <code>gnutls_pkcs12_bag_t</code> types.  The Bag types are
the holders of the actual data, which may be certificates, private
keys or encrypted data.  An Bag of type encrypted should be decrypted
in order for its data to be accessed.

<p>An example of a <acronym>PKCS</acronym> #12 structure generation can be found
at section <a href="#ex_003apkcs12">ex:pkcs12</a>.

<div class="node">
<a name="The-OpenPGP-trust-model"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Digital-signatures">Digital signatures</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-X_002e509-trust-model">The X.509 trust model</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#More-on-certificate-authentication">More on certificate authentication</a>

</div>

<h3 class="section">5.2 The <acronym>OpenPGP</acronym> Trust Model</h3>

<p><a name="index-g_t_0040acronym_007bOpenPGP_007d-Keys-38"></a>
The <acronym>OpenPGP</acronym> key authentication relies on a distributed trust
model, called the &ldquo;web of trust&rdquo;. The &ldquo;web of trust&rdquo; uses a
decentralized system of trusted introducers, which are the same as a
CA. <acronym>OpenPGP</acronym> allows anyone to sign anyone's else public
key. When Alice signs Bob's key, she is introducing Bob's key to
anyone who trusts Alice. If someone trusts Alice to introduce keys,
then Alice is a trusted introducer in the mind of that observer.

<div class="block-image"><img src="gnutls-pgp.png" alt="gnutls-pgp.png"></div>

<p>For example: If David trusts Alice to be an introducer, and Alice
signed Bob's key, Dave also trusts Bob's key to be the real one.

<p>There are some key points that are important in that model. In the
example Alice has to sign Bob's key, only if she is sure that the key
belongs to Bob. Otherwise she may also make Dave falsely believe that
this is Bob's key. Dave has also the responsibility to know who to
trust.  This model is similar to real life relations.

<p>Just see how Charlie behaves in the previous example. Although he has
signed Bob's key - because he knows, somehow, that it belongs to Bob -
he does not trust Bob to be an introducer. Charlie decided to trust
only Kevin, for some reason. A reason could be that Bob is lazy
enough, and signs other people's keys without being sure that they
belong to the actual owner.

<h4 class="subsection">5.2.1 <acronym>OpenPGP</acronym> Keys</h4>

<p>In <acronym>GnuTLS</acronym> the <acronym>OpenPGP</acronym> key structures
[RFC2440] (see <a href="#Bibliography">Bibliography</a>) are handled using the <code>gnutls_openpgp_crt_t</code> type
and the corresponding private keys with the
<code>gnutls_openpgp_privkey_t</code> type. All the prototypes for the key
handling functions can be found at <samp><span class="file">gnutls/openpgp.h</span></samp>.

<h4 class="subsection">5.2.2 Verifying an <acronym>OpenPGP</acronym> Key</h4>

<p>The verification functions of <acronym>OpenPGP</acronym> keys, included in
<acronym>GnuTLS</acronym>, are simple ones, and do not use the features of the
&ldquo;web of trust&rdquo;.  For that reason, if the verification needs are
complex, the assistance of external tools like <acronym>GnuPG</acronym> and
GPGME (<a href="http://www.gnupg.org/related_software/gpgme/">http://www.gnupg.org/related_software/gpgme/</a>) is
recommended.

<p>There is one verification function in <acronym>GnuTLS</acronym>, the
<a href="#gnutls_005fopenpgp_005fcrt_005fverify_005fring">gnutls_openpgp_crt_verify_ring</a>. 
This checks an <acronym>OpenPGP</acronym> key against a given set of public keys (keyring) and
returns the key status. The key verification status is the same as in
<acronym>X.509</acronym> certificates, although the meaning and interpretation are
different. For example an <acronym>OpenPGP</acronym> key may be valid, if the
self signature is ok, even if no signers were found.  The meaning of
verification status is shown in the figure below.

     <dl>
<dt><code>CERT_INVALID:</code><dd>A signature on the key is invalid. That means that the key was
modified by somebody, or corrupted during transport.

     <br><dt><code>CERT_REVOKED:</code><dd>The key has been revoked by its owner.

     <br><dt><code>CERT_SIGNER_NOT_FOUND:</code><dd>The key was not signed by a known signer.

     <br><dt><code>GNUTLS_CERT_INSECURE_ALGORITHM:</code><dd>The certificate was signed using an insecure algorithm such as MD2 or MD5. 
These algorithms have been broken and should not be trusted.

</dl>

<div class="node">
<a name="Digital-signatures"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-OpenPGP-trust-model">The OpenPGP trust model</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#More-on-certificate-authentication">More on certificate authentication</a>

</div>

<h3 class="section">5.3 Digital Signatures</h3>

<p><a name="index-Digital-signatures-39"></a>
In this section we will provide some information about digital
signatures, how they work, and give the rationale for disabling some
of the algorithms used.

<p>Digital signatures work by using somebody's secret key to sign some
arbitrary data.  Then anybody else could use the public key of that
person to verify the signature.  Since the data may be arbitrary it is
not suitable input to a cryptographic digital signature algorithm. For
this reason and also for performance cryptographic hash algorithms are
used to preprocess the input to the signature algorithm. This works as
long as it is difficult enough to generate two different messages with
the same hash algorithm output. In that case the same signature could
be used as a proof for both messages. Nobody wants to sign an innocent
message of donating 1 &euro; to Greenpeace and find out that he
donated 1.000.000 &euro; to Bad Inc.

<p>For a hash algorithm to be called cryptographic the following three
requirements must hold:

     <ol type=1 start=1>
<li>Preimage resistance. 
That means the algorithm must be one way and given the output of the
hash function H(x), it is impossible to calculate x.

     <li>2nd preimage resistance. 
That means that given a pair x,y with y=H(x) it is
impossible to calculate an x' such that y=H(x').

     <li>Collision resistance. 
That means that it is impossible to calculate random x and
x' such H(x')=H(x).
     </ol>

<p>The last two requirements in the list are the most important in
digital signatures. These protect against somebody who would like to
generate two messages with the same hash output. When an algorithm is
considered broken usually it means that the Collision resistance of
the algorithm is less than brute force. Using the birthday paradox the
brute force attack takes
2^((hash size) / 2)
operations. Today colliding certificates using the MD5 hash algorithm
have been generated as shown in [WEGER] (see <a href="#Bibliography">Bibliography</a>).

<p>There has been cryptographic results for the SHA-1 hash algorithms as
well, although they are not yet critical.  Before 2004, MD5 had a
presumed collision strength of 2^64, but it has been showed
to have a collision strength well under 2^50.  As of November
2005, it is believed that SHA-1's collision strength is around
2^63.  We consider this sufficiently hard so that we still
support SHA-1.  We anticipate that SHA-256/386/512 will be used in
publicly-distributed certificates in the future.  When 2^63
can be considered too weak compared to the computer power available
sometime in the future, SHA-1 will be disabled as well.  The collision
attacks on SHA-1 may also get better, given the new interest in tools
for creating them.

<h4 class="subsection">5.3.1 Trading Security for Interoperability</h4>

<p>If you connect to a server and use GnuTLS' functions to verify the
certificate chain, and get a <a href="#GNUTLS_005fCERT_005fINSECURE_005fALGORITHM">GNUTLS_CERT_INSECURE_ALGORITHM</a>
validation error (see <a href="#Verifying-X_002e509-certificate-paths">Verifying X.509 certificate paths</a>), it means
that somewhere in the certificate chain there is a certificate signed
using <code>RSA-MD2</code> or <code>RSA-MD5</code>.  These two digital signature
algorithms are considered broken, so GnuTLS fail when attempting to
verify the certificate.  In some situations, it may be useful to be
able to verify the certificate chain anyway, assuming an attacker did
not utilize the fact that these signatures algorithms are broken. 
This section will give help on how to achieve that.

<p>First, it is important to know that you do not have to enable any of
the flags discussed here to be able to use trusted root CA
certificates signed using <code>RSA-MD2</code> or <code>RSA-MD5</code>.  The only
attack today is that it is possible to generate certificates with
colliding signatures (collision resistance); you cannot generate a
certificate that has the same signature as an already existing
signature (2nd preimage resistance).

<p>If you are using <a href="#gnutls_005fcertificate_005fverify_005fpeers2">gnutls_certificate_verify_peers2</a> to verify the
certificate chain, you can call
<a href="#gnutls_005fcertificate_005fset_005fverify_005fflags">gnutls_certificate_set_verify_flags</a> with the
<code>GNUTLS_VERIFY_ALLOW_SIGN_RSA_MD2</code> or
<code>GNUTLS_VERIFY_ALLOW_SIGN_RSA_MD5</code> flag, as in:

<pre class="example">       gnutls_certificate_set_verify_flags (x509cred,
                                            GNUTLS_VERIFY_ALLOW_SIGN_RSA_MD5);
</pre>
<p>This will tell the verifier algorithm to enable <code>RSA-MD5</code> when
verifying the certificates.

<p>If you are using <a href="#gnutls_005fx509_005fcrt_005fverify">gnutls_x509_crt_verify</a> or
<a href="#gnutls_005fx509_005fcrt_005flist_005fverify">gnutls_x509_crt_list_verify</a>, you can pass the
<code>GNUTLS_VERIFY_ALLOW_SIGN_RSA_MD5</code> parameter directly in the
<code>flags</code> parameter.

<p>If you are using these flags, it may also be a good idea to warn the
user when verification failure occur for this reason.  The simplest is
to not use the flags by default, and only fall back to using them
after warning the user.  If you wish to inspect the certificate chain
yourself, you can use <a href="#gnutls_005fcertificate_005fget_005fpeers">gnutls_certificate_get_peers</a> to extract
the raw server's certificate chain, then use
<a href="#gnutls_005fx509_005fcrt_005fimport">gnutls_x509_crt_import</a> to parse each of the certificates, and
then use <a href="#gnutls_005fx509_005fcrt_005fget_005fsignature_005falgorithm">gnutls_x509_crt_get_signature_algorithm</a> to find out the
signing algorithm used for each certificate.  If any of the
intermediary certificates are using <code>GNUTLS_SIGN_RSA_MD2</code> or
<code>GNUTLS_SIGN_RSA_MD5</code>, you could present a warning.

<div class="node">
<a name="How-to-use-TLS-in-application-protocols"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#How-to-use-GnuTLS-in-applications">How to use GnuTLS in applications</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#More-on-certificate-authentication">More on certificate authentication</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">6 How To Use <acronym>TLS</acronym> in Application Protocols</h2>

<p>This chapter is intended to provide some hints on how to use the
<acronym>TLS</acronym> over simple custom made application protocols.  The
discussion below mainly refers to the <em>TCP/IP</em> transport layer
but may be extended to other ones too.

<ul class="menu">
<li><a accesskey="1" href="#Separate-ports">Separate ports</a>
<li><a accesskey="2" href="#Upward-negotiation">Upward negotiation</a>
</ul>

<div class="node">
<a name="Separate-ports"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Upward-negotiation">Upward negotiation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#How-to-use-TLS-in-application-protocols">How to use TLS in application protocols</a>

</div>

<h3 class="section">6.1 Separate Ports</h3>

<p>Traditionally <acronym>SSL</acronym> was used in application protocols by
assigning a new port number for the secure services. That way two
separate ports were assigned, one for the non secure sessions, and one
for the secured ones. This has the benefit that if a user requests a
secure session then the client will try to connect to the secure port
and fail otherwise. The only possible attack with this method is a
denial of service one. The most famous example of this method is the
famous &ldquo;HTTP over TLS&rdquo; or <acronym>HTTPS</acronym> protocol [RFC2818] (see <a href="#Bibliography">Bibliography</a>).

<p>Despite its wide use, this method is not as good as it seems.  This
approach starts the <acronym>TLS</acronym> Handshake procedure just after the
client connects on the &mdash;so called&mdash; secure port.  That way the
<acronym>TLS</acronym> protocol does not know anything about the client, and
popular methods like the host advertising in HTTP do not
work<a rel="footnote" href="#fn-14" name="fnd-14"><sup>14</sup></a>.  There is no way for the client to say &ldquo;I
connected to YYY server&rdquo; before the Handshake starts, so the server
cannot possibly know which certificate to use.

<p>Other than that it requires two separate ports to run a single
service, which is unnecessary complication. Due to the fact that there
is a limitation on the available privileged ports, this approach was
soon obsoleted.

<div class="node">
<a name="Upward-negotiation"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Separate-ports">Separate ports</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#How-to-use-TLS-in-application-protocols">How to use TLS in application protocols</a>

</div>

<h3 class="section">6.2 Upward Negotiation</h3>

<p>Other application protocols<a rel="footnote" href="#fn-15" name="fnd-15"><sup>15</sup></a>  use a
different approach to enable the secure layer.  They use something
called the &ldquo;TLS upgrade&rdquo; method. This method is quite tricky but it
is more flexible. The idea is to extend the application protocol to
have a &ldquo;STARTTLS&rdquo; request, whose purpose it to start the TLS
protocols just after the client requests it.  This is a really neat
idea and does not require an extra port.

<p>This method is used by almost all modern protocols and there is even
the [RFC2817] (see <a href="#Bibliography">Bibliography</a>) paper which proposes extensions to HTTP to support
it.

<p>The tricky part, in this method, is that the &ldquo;STARTTLS&rdquo; request is
sent in the clear, thus is vulnerable to modifications.  A typical
attack is to modify the messages in a way that the client is fooled
and thinks that the server does not have the &ldquo;STARTTLS&rdquo; capability. 
See a typical conversation of a hypothetical protocol:

<blockquote>
(client connects to the server)

<p>CLIENT: HELLO I'M MR. XXX

<p>SERVER: NICE TO MEET YOU XXX

<p>CLIENT: PLEASE START TLS

<p>SERVER: OK

<p>*** TLS STARTS

<p>CLIENT: HERE ARE SOME CONFIDENTIAL DATA
</blockquote>

<p>And see an example of a conversation where someone is acting
in between:

<blockquote>
(client connects to the server)

<p>CLIENT: HELLO I'M MR. XXX

<p>SERVER: NICE TO MEET YOU XXX

<p>CLIENT: PLEASE START TLS

<p>(here someone inserts this message)

<p>SERVER: SORRY I DON'T HAVE THIS CAPABILITY

<p>CLIENT: HERE ARE SOME CONFIDENTIAL DATA
</blockquote>

<p>As you can see above the client was fooled, and was dummy enough to
send the confidential data in the clear.

<p>How to avoid the above attack? As you may have already thought this
one is easy to avoid. The client has to ask the user before it
connects whether the user requests <acronym>TLS</acronym> or not. If the user
answered that he certainly wants the secure layer the last
conversation should be:

<blockquote>
(client connects to the server)

<p>CLIENT: HELLO I'M MR. XXX

<p>SERVER: NICE TO MEET YOU XXX

<p>CLIENT: PLEASE START TLS

<p>(here someone inserts this message)

<p>SERVER: SORRY I DON'T HAVE THIS CAPABILITY

<p>CLIENT: BYE

<p>(the client notifies the user that the secure connection was not possible)
</blockquote>

<p>This method, if implemented properly, is far better than the
traditional method, and the security properties remain the same, since
only denial of service is possible. The benefit is that the server may
request additional data before the <acronym>TLS</acronym> Handshake protocol
starts, in order to send the correct certificate, use the correct
password file<a rel="footnote" href="#fn-16" name="fnd-16"><sup>16</sup></a>, or anything
else!

<div class="node">
<a name="How-to-use-GnuTLS-in-applications"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Included-programs">Included programs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#How-to-use-TLS-in-application-protocols">How to use TLS in application protocols</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">7 How To Use <acronym>GnuTLS</acronym> in Applications</h2>

<p><a name="examples"></a><a name="index-Example-programs-40"></a>

<ul class="menu">
<li><a accesskey="1" href="#Preparation">Preparation</a>
<li><a accesskey="2" href="#Multi_002dthreaded-applications">Multi-threaded applications</a>
<li><a accesskey="3" href="#Client-examples">Client examples</a>
<li><a accesskey="4" href="#Server-examples">Server examples</a>
<li><a accesskey="5" href="#Miscellaneous-examples">Miscellaneous examples</a>
<li><a accesskey="6" href="#Compatibility-with-the-OpenSSL-library">Compatibility with the OpenSSL library</a>
<li><a accesskey="7" href="#Opaque-PRF-Input-TLS-Extension">Opaque PRF Input TLS Extension</a>
</ul>

<div class="node">
<a name="Preparation"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Multi_002dthreaded-applications">Multi-threaded applications</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#How-to-use-GnuTLS-in-applications">How to use GnuTLS in applications</a>

</div>

<h3 class="section">7.1 Preparation</h3>

<p>To use <acronym>GnuTLS</acronym>, you have to perform some changes to your
sources and your build system. The necessary changes are explained in
the following subsections.

<ul class="menu">
<li><a accesskey="1" href="#Headers">Headers</a>
<li><a accesskey="2" href="#Initialization">Initialization</a>
<li><a accesskey="3" href="#Version-check">Version check</a>
<li><a accesskey="4" href="#Debugging">Debugging</a>
<li><a accesskey="5" href="#Building-the-source">Building the source</a>
</ul>

<div class="node">
<a name="Headers"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Initialization">Initialization</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Preparation">Preparation</a>

</div>

<h4 class="subsection">7.1.1 Headers</h4>

<p>All the data types and functions of the <acronym>GnuTLS</acronym> library are
defined in the header file <samp><span class="file">gnutls/gnutls.h</span></samp>.  This must be
included in all programs that make use of the <acronym>GnuTLS</acronym>
library.

<p>The extra functionality of the <acronym>GnuTLS-extra</acronym> library is
available by including the header file <samp><span class="file">gnutls/extra.h</span></samp> in your
programs.

<div class="node">
<a name="Initialization"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Version-check">Version check</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Headers">Headers</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Preparation">Preparation</a>

</div>

<h4 class="subsection">7.1.2 Initialization</h4>

<p>GnuTLS must be initialized before it can be used.  The library is
initialized by calling <a href="#gnutls_005fglobal_005finit">gnutls_global_init</a>.  The resources
allocated by the initialization process can be released if the
application no longer has a need to call GnuTLS functions, this is
done by calling <a href="#gnutls_005fglobal_005fdeinit">gnutls_global_deinit</a>.

<p>The extra functionality of the <acronym>GnuTLS-extra</acronym> library is
available after calling <a href="#gnutls_005fglobal_005finit_005fextra">gnutls_global_init_extra</a>.

<p>In order to take advantage of the internationalisation features in
GnuTLS, such as translated error messages, the application must set
the current locale using <code>setlocale</code> before initializing GnuTLS.

<div class="node">
<a name="Version-check"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Debugging">Debugging</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Initialization">Initialization</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Preparation">Preparation</a>

</div>

<h4 class="subsection">7.1.3 Version Check</h4>

<p>It is often desirable to check that the version of `gnutls' used is
indeed one which fits all requirements.  Even with binary
compatibility new features may have been introduced but due to problem
with the dynamic linker an old version is actually used.  So you may
want to check that the version is okay right after program startup. 
See the function <a href="#gnutls_005fcheck_005fversion">gnutls_check_version</a>.

<div class="node">
<a name="Debugging"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Building-the-source">Building the source</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Version-check">Version check</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Preparation">Preparation</a>

</div>

<h4 class="subsection">7.1.4 Debugging</h4>

<p>In many cases things may not go as expected and further information,
to assist debugging, from <acronym>GnuTLS</acronym> is desired. Those are the
case where the <a href="#gnutls_005fglobal_005fset_005flog_005flevel">gnutls_global_set_log_level</a> and
<a href="#gnutls_005fglobal_005fset_005flog_005ffunction">gnutls_global_set_log_function</a> are to be used. Those will print
verbose information on the <acronym>GnuTLS</acronym> functions internal flow.

<div class="node">
<a name="Building-the-source"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Debugging">Debugging</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Preparation">Preparation</a>

</div>

<h4 class="subsection">7.1.5 Building the Source</h4>

<p>If you want to compile a source file including the `gnutls/gnutls.h'
header file, you must make sure that the compiler can find it in the
directory hierarchy.  This is accomplished by adding the path to the
directory in which the header file is located to the compilers include
file search path (via the -I option).

<p>However, the path to the include file is determined at the time the
source is configured.  To solve this problem, <acronym>GnuTLS</acronym> ships
with two small helper programs <samp><span class="command">libgnutls-config</span></samp> and
<samp><span class="command">libgnutls-extra-config</span></samp> that knows about the path to the
include file and other configuration options.  The options that need
to be added to the compiler invocation at compile time are output by
the <code>--cflags</code> option to <samp><span class="command">libgnutls-config</span></samp>.  The
following example shows how it can be used at the command line:

<pre class="example">     gcc -c foo.c `libgnutls-config --cflags`
</pre>
<p>Adding the output of <samp><span class="command">libgnutls-config --cflags</span></samp> to the
compilers command line will ensure that the compiler can find the
<acronym>GnuTLS</acronym> header file.

<p>A similar problem occurs when linking the program with the library. 
Again, the compiler has to find the library files.  For this to work,
the path to the library files has to be added to the library search
path (via the -L option).  For this, the option <code>--libs</code> to
<samp><span class="command">libgnutls-config</span></samp> can be used.  For convenience, this option
also outputs all other options that are required to link the program
with the <acronym>GnuTLS</acronym> libararies.  The example shows how to link
`foo.o' with the <acronym>GnuTLS</acronym> libraries to a program <em>foo</em>.

<pre class="example">     gcc -o foo foo.o `libgnutls-config --libs`
</pre>
<p>Of course you can also combine both examples to a single command by
specifying both options to `libgnutls-config':

<pre class="example">     gcc -o foo foo.c `libgnutls-config --cflags --libs`
</pre>
<div class="node">
<a name="Multi-threaded-applications"></a>
<a name="Multi_002dthreaded-applications"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Client-examples">Client examples</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Preparation">Preparation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#How-to-use-GnuTLS-in-applications">How to use GnuTLS in applications</a>

</div>

<h3 class="section">7.2 Multi-Threaded Applications</h3>

<p>Although the <acronym>GnuTLS</acronym> library is thread safe by design, some
parts of Libgcrypt, such as the random generator, are not. 
Applications have to register callback functions to ensure proper
locking in the sensitive parts of <em>libgcrypt</em>.

<p>There are helper macros to help you properly initialize the libraries. 
Examples are shown below.

     <ul>
<li>POSIX threads
     <pre class="example">          #include &lt;gnutls.h&gt;
          #include &lt;gcrypt.h&gt;
          #include &lt;errno.h&gt;
          #include &lt;pthread.h&gt;
          GCRY_THREAD_OPTION_PTHREAD_IMPL;
          
          int main()
          {
             /* The order matters.
              */
             gcry_control (GCRYCTL_SET_THREAD_CBS, &amp;gcry_threads_pthread);
             gnutls_global_init();
          }
</pre>
     <li>GNU PTH threads
     <pre class="example">          #include &lt;gnutls.h&gt;
          #include &lt;gcrypt.h&gt;
          #include &lt;errno.h&gt;
          #include &lt;pth.h&gt;
          GCRY_THREAD_OPTION_PTH_IMPL;
          
          int main()
          {
             gcry_control (GCRYCTL_SET_THREAD_CBS, &amp;gcry_threads_pth);
             gnutls_global_init();
          }
</pre>
     <li>Other thread packages
     <pre class="example">          /* The gcry_thread_cbs structure must have been
           * initialized.
           */
          static struct gcry_thread_cbs gcry_threads_other = { ... };
          
          int main()
          {
             gcry_control (GCRYCTL_SET_THREAD_CBS, &amp;gcry_threads_other);
          }
</pre>
     </ul>

<div class="node">
<a name="Client-examples"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Server-examples">Server examples</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Multi_002dthreaded-applications">Multi-threaded applications</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#How-to-use-GnuTLS-in-applications">How to use GnuTLS in applications</a>

</div>

<h3 class="section">7.3 Client Examples</h3>

<p>This section contains examples of <acronym>TLS</acronym> and <acronym>SSL</acronym>
clients, using <acronym>GnuTLS</acronym>.  Note that these examples contain
little or no error checking.  Some of the examples require functions
implemented by another example.

<ul class="menu">
<li><a accesskey="1" href="#Simple-client-example-with-anonymous-authentication">Simple client example with anonymous authentication</a>
<li><a accesskey="2" href="#Simple-client-example-with-X_002e509-certificate-support">Simple client example with X.509 certificate support</a>
<li><a accesskey="3" href="#Obtaining-session-information">Obtaining session information</a>
<li><a accesskey="4" href="#Verifying-peer_0027s-certificate">Verifying peer's certificate</a>
<li><a accesskey="5" href="#Using-a-callback-to-select-the-certificate-to-use">Using a callback to select the certificate to use</a>
<li><a accesskey="6" href="#Client-with-Resume-capability-example">Client with Resume capability example</a>
<li><a accesskey="7" href="#Simple-client-example-with-SRP-authentication">Simple client example with SRP authentication</a>
<li><a accesskey="8" href="#Simple-client-example-with-TLS_002fIA-support">Simple client example with TLS/IA support</a>
<li><a accesskey="9" href="#Simple-client-example-in-C_002b_002b">Simple client example in C++</a>
<li><a href="#Helper-function-for-TCP-connections">Helper function for TCP connections</a>
</ul>

<div class="node">
<a name="Simple-client-example-with-anonymous-authentication"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Simple-client-example-with-X_002e509-certificate-support">Simple client example with X.509 certificate support</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Client-examples">Client examples</a>

</div>

<h4 class="subsection">7.3.1 Simple Client Example with Anonymous Authentication</h4>

<p>The simplest client using TLS is the one that doesn't do any
authentication.  This means no external certificates or passwords are
needed to set up the connection.  As could be expected, the connection
is vulnerable to man-in-the-middle (active or redirection) attacks. 
However, the data is integrity and privacy protected.

<pre class="verbatim">/* Copyright 2007 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;string.h>
#include &lt;sys/types.h>
#include &lt;sys/socket.h>
#include &lt;arpa/inet.h>
#include &lt;unistd.h>
#include &lt;gnutls/gnutls.h>

/* A very basic TLS client, with anonymous authentication.
 */

#define MAX_BUF 1024
#define SA struct sockaddr
#define MSG "GET / HTTP/1.0\r\n\r\n"

extern int tcp_connect (void);
extern void tcp_close (int sd);

int
main (void)
{
  int ret, sd, ii;
  gnutls_session_t session;
  char buffer[MAX_BUF + 1];
  gnutls_anon_client_credentials_t anoncred;
  /* Need to enable anonymous KX specifically. */

  gnutls_global_init ();

  gnutls_anon_allocate_client_credentials (&amp;anoncred);

  /* Initialize TLS session 
   */
  gnutls_init (&amp;session, GNUTLS_CLIENT);

  /* Use default priorities */
  gnutls_priority_set_direct (session, "PERFORMANCE:+ANON-DH:!ARCFOUR-128",
			      NULL);

  /* put the anonymous credentials to the current session
   */
  gnutls_credentials_set (session, GNUTLS_CRD_ANON, anoncred);

  /* connect to the peer
   */
  sd = tcp_connect ();

  gnutls_transport_set_ptr (session, (gnutls_transport_ptr_t) sd);

  /* Perform the TLS handshake
   */
  ret = gnutls_handshake (session);

  if (ret &lt; 0)
    {
      fprintf (stderr, "*** Handshake failed\n");
      gnutls_perror (ret);
      goto end;
    }
  else
    {
      printf ("- Handshake was completed\n");
    }

  gnutls_record_send (session, MSG, strlen (MSG));

  ret = gnutls_record_recv (session, buffer, MAX_BUF);
  if (ret == 0)
    {
      printf ("- Peer has closed the TLS connection\n");
      goto end;
    }
  else if (ret &lt; 0)
    {
      fprintf (stderr, "*** Error: %s\n", gnutls_strerror (ret));
      goto end;
    }

  printf ("- Received %d bytes: ", ret);
  for (ii = 0; ii &lt; ret; ii++)
    {
      fputc (buffer[ii], stdout);
    }
  fputs ("\n", stdout);

  gnutls_bye (session, GNUTLS_SHUT_RDWR);

end:

  tcp_close (sd);

  gnutls_deinit (session);

  gnutls_anon_free_client_credentials (anoncred);

  gnutls_global_deinit ();

  return 0;
}
</pre>
<div class="node">
<a name="Simple-client-example-with-X.509-certificate-support"></a>
<a name="Simple-client-example-with-X_002e509-certificate-support"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Obtaining-session-information">Obtaining session information</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Simple-client-example-with-anonymous-authentication">Simple client example with anonymous authentication</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Client-examples">Client examples</a>

</div>

<h4 class="subsection">7.3.2 Simple Client Example with <acronym>X.509</acronym> Certificate Support</h4>

<p>Let's assume now that we want to create a TCP client which
communicates with servers that use <acronym>X.509</acronym> or
<acronym>OpenPGP</acronym> certificate authentication. The following client is
a very simple <acronym>TLS</acronym> client, it does not support session
resuming, not even certificate verification. The TCP functions defined
in this example are used in most of the other examples below, without
redefining them.

<pre class="verbatim">/* Copyright 2007 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;string.h>
#include &lt;sys/types.h>
#include &lt;sys/socket.h>
#include &lt;arpa/inet.h>
#include &lt;unistd.h>
#include &lt;gnutls/gnutls.h>

/* A very basic TLS client, with X.509 authentication.
 */

#define MAX_BUF 1024
#define CAFILE "ca.pem"
#define MSG "GET / HTTP/1.0\r\n\r\n"

extern int tcp_connect (void);
extern void tcp_close (int sd);

int
main (void)
{
  int ret, sd, ii;
  gnutls_session_t session;
  char buffer[MAX_BUF + 1];
  const char *err;
  gnutls_certificate_credentials_t xcred;

  gnutls_global_init ();

  /* X509 stuff */
  gnutls_certificate_allocate_credentials (&amp;xcred);

  /* sets the trusted cas file
   */
  gnutls_certificate_set_x509_trust_file (xcred, CAFILE, GNUTLS_X509_FMT_PEM);

  /* Initialize TLS session 
   */
  gnutls_init (&amp;session, GNUTLS_CLIENT);

  /* Use default priorities */
  ret = gnutls_priority_set_direct (session, "PERFORMANCE", &amp;err);
  if (ret &lt; 0)
    {
      if (ret == GNUTLS_E_INVALID_REQUEST)
	{
	  fprintf (stderr, "Syntax error at: %s\n", err);
	}
      exit (1);
    }

  /* put the x509 credentials to the current session
   */
  gnutls_credentials_set (session, GNUTLS_CRD_CERTIFICATE, xcred);

  /* connect to the peer
   */
  sd = tcp_connect ();

  gnutls_transport_set_ptr (session, (gnutls_transport_ptr_t) sd);

  /* Perform the TLS handshake
   */
  ret = gnutls_handshake (session);

  if (ret &lt; 0)
    {
      fprintf (stderr, "*** Handshake failed\n");
      gnutls_perror (ret);
      goto end;
    }
  else
    {
      printf ("- Handshake was completed\n");
    }

  gnutls_record_send (session, MSG, strlen (MSG));

  ret = gnutls_record_recv (session, buffer, MAX_BUF);
  if (ret == 0)
    {
      printf ("- Peer has closed the TLS connection\n");
      goto end;
    }
  else if (ret &lt; 0)
    {
      fprintf (stderr, "*** Error: %s\n", gnutls_strerror (ret));
      goto end;
    }

  printf ("- Received %d bytes: ", ret);
  for (ii = 0; ii &lt; ret; ii++)
    {
      fputc (buffer[ii], stdout);
    }
  fputs ("\n", stdout);

  gnutls_bye (session, GNUTLS_SHUT_RDWR);

end:

  tcp_close (sd);

  gnutls_deinit (session);

  gnutls_certificate_free_credentials (xcred);

  gnutls_global_deinit ();

  return 0;
}
</pre>
<div class="node">
<a name="Obtaining-session-information"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Verifying-peer_0027s-certificate">Verifying peer's certificate</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Simple-client-example-with-X_002e509-certificate-support">Simple client example with X.509 certificate support</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Client-examples">Client examples</a>

</div>

<h4 class="subsection">7.3.3 Obtaining Session Information</h4>

<p>Most of the times it is desirable to know the security properties of
the current established session.  This includes the underlying ciphers
and the protocols involved.  That is the purpose of the following
function.  Note that this function will print meaningful values only
if called after a successful <a href="#gnutls_005fhandshake">gnutls_handshake</a>.

<pre class="verbatim">/* Copyright 2007, 2008 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;gnutls/gnutls.h>
#include &lt;gnutls/x509.h>

extern void print_x509_certificate_info (gnutls_session_t);

/* This function will print some details of the
 * given session.
 */
int
print_info (gnutls_session_t session)
{
  const char *tmp;
  gnutls_credentials_type_t cred;
  gnutls_kx_algorithm_t kx;

  /* print the key exchange's algorithm name
   */
  kx = gnutls_kx_get (session);
  tmp = gnutls_kx_get_name (kx);
  printf ("- Key Exchange: %s\n", tmp);

  /* Check the authentication type used and switch
   * to the appropriate.
   */
  cred = gnutls_auth_get_type (session);
  switch (cred)
    {
    case GNUTLS_CRD_IA:
      printf ("- TLS/IA session\n");
      break;


#ifdef ENABLE_SRP
    case GNUTLS_CRD_SRP:
      printf ("- SRP session with username %s\n",
	      gnutls_srp_server_get_username (session));
      break;
#endif

    case GNUTLS_CRD_PSK:
      /* This returns NULL in server side.
       */
      if (gnutls_psk_client_get_hint (session) != NULL)
	printf ("- PSK authentication. PSK hint '%s'\n",
		gnutls_psk_client_get_hint (session));
      /* This returns NULL in client side.
       */
      if (gnutls_psk_server_get_username (session) != NULL)
	printf ("- PSK authentication. Connected as '%s'\n",
		gnutls_psk_server_get_username (session));
      break;

    case GNUTLS_CRD_ANON:	/* anonymous authentication */

      printf ("- Anonymous DH using prime of %d bits\n",
	      gnutls_dh_get_prime_bits (session));
      break;

    case GNUTLS_CRD_CERTIFICATE:	/* certificate authentication */

      /* Check if we have been using ephemeral Diffie Hellman.
       */
      if (kx == GNUTLS_KX_DHE_RSA || kx == GNUTLS_KX_DHE_DSS)
	{
	  printf ("\n- Ephemeral DH using prime of %d bits\n",
		  gnutls_dh_get_prime_bits (session));
	}

      /* if the certificate list is available, then
       * print some information about it.
       */
      print_x509_certificate_info (session);

    }				/* switch */

  /* print the protocol's name (ie TLS 1.0) 
   */
  tmp = gnutls_protocol_get_name (gnutls_protocol_get_version (session));
  printf ("- Protocol: %s\n", tmp);

  /* print the certificate type of the peer.
   * ie X.509
   */
  tmp =
    gnutls_certificate_type_get_name (gnutls_certificate_type_get (session));

  printf ("- Certificate Type: %s\n", tmp);

  /* print the compression algorithm (if any)
   */
  tmp = gnutls_compression_get_name (gnutls_compression_get (session));
  printf ("- Compression: %s\n", tmp);

  /* print the name of the cipher used.
   * ie 3DES.
   */
  tmp = gnutls_cipher_get_name (gnutls_cipher_get (session));
  printf ("- Cipher: %s\n", tmp);

  /* Print the MAC algorithms name.
   * ie SHA1
   */
  tmp = gnutls_mac_get_name (gnutls_mac_get (session));
  printf ("- MAC: %s\n", tmp);

  return 0;
}
</pre>
<div class="node">
<a name="Verifying-peer's-certificate"></a>
<a name="Verifying-peer_0027s-certificate"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Using-a-callback-to-select-the-certificate-to-use">Using a callback to select the certificate to use</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Obtaining-session-information">Obtaining session information</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Client-examples">Client examples</a>

</div>

<h4 class="subsection">7.3.4 Verifying Peer's Certificate</h4>

<p><a name="ex_003averify"></a>A <acronym>TLS</acronym> session is not secure just after the handshake
procedure has finished.  It must be considered secure, only after the
peer's certificate and identity have been verified. That is, you have
to verify the signature in peer's certificate, the hostname in the
certificate, and expiration dates.  Just after this step you should
treat the connection as being a secure one.

<pre class="verbatim">/* Copyright 2007 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;gnutls/gnutls.h>
#include &lt;gnutls/x509.h>

/* This function will try to verify the peer's certificate, and
 * also check if the hostname matches, and the activation, expiration dates.
 */
void
verify_certificate (gnutls_session_t session, const char *hostname)
{
  unsigned int status;
  const gnutls_datum_t *cert_list;
  unsigned int cert_list_size;
  int ret;
  gnutls_x509_crt_t cert;


  /* This verification function uses the trusted CAs in the credentials
   * structure. So you must have installed one or more CA certificates.
   */
  ret = gnutls_certificate_verify_peers2 (session, &amp;status);

  if (ret &lt; 0)
    {
      printf ("Error\n");
      return;
    }

  if (status &amp; GNUTLS_CERT_INVALID)
    printf ("The certificate is not trusted.\n");

  if (status &amp; GNUTLS_CERT_SIGNER_NOT_FOUND)
    printf ("The certificate hasn't got a known issuer.\n");

  if (status &amp; GNUTLS_CERT_REVOKED)
    printf ("The certificate has been revoked.\n");


  /* Up to here the process is the same for X.509 certificates and
   * OpenPGP keys. From now on X.509 certificates are assumed. This can
   * be easily extended to work with openpgp keys as well.
   */
  if (gnutls_certificate_type_get (session) != GNUTLS_CRT_X509)
    return;

  if (gnutls_x509_crt_init (&amp;cert) &lt; 0)
    {
      printf ("error in initialization\n");
      return;
    }

  cert_list = gnutls_certificate_get_peers (session, &amp;cert_list_size);
  if (cert_list == NULL)
    {
      printf ("No certificate was found!\n");
      return;
    }

  /* This is not a real world example, since we only check the first 
   * certificate in the given chain.
   */
  if (gnutls_x509_crt_import (cert, &amp;cert_list[0], GNUTLS_X509_FMT_DER) &lt; 0)
    {
      printf ("error parsing certificate\n");
      return;
    }

  /* Beware here we do not check for errors.
   */
  if (gnutls_x509_crt_get_expiration_time (cert) &lt; time (0))
    {
      printf ("The certificate has expired\n");
      return;
    }

  if (gnutls_x509_crt_get_activation_time (cert) > time (0))
    {
      printf ("The certificate is not yet activated\n");
      return;
    }

  if (!gnutls_x509_crt_check_hostname (cert, hostname))
    {
      printf ("The certificate's owner does not match hostname '%s'\n",
	      hostname);
      return;
    }

  gnutls_x509_crt_deinit (cert);

  return;
}
</pre>
An other example is listed below which provides a more detailed
verification output.

<pre class="verbatim">/* Copyright 2007 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;gnutls/gnutls.h>
#include &lt;gnutls/x509.h>

/* All the available CRLs
 */
gnutls_x509_crl_t *crl_list;
int crl_list_size;

/* All the available trusted CAs
 */
gnutls_x509_crt_t *ca_list;
int ca_list_size;

static void verify_cert2 (gnutls_x509_crt_t crt,
			  gnutls_x509_crt_t issuer,
			  gnutls_x509_crl_t * crl_list, int crl_list_size);
static void verify_last_cert (gnutls_x509_crt_t crt,
			      gnutls_x509_crt_t * ca_list, int ca_list_size,
			      gnutls_x509_crl_t * crl_list,
			      int crl_list_size);


/* This function will try to verify the peer's certificate chain, and
 * also check if the hostname matches, and the activation, expiration dates.
 */
void
verify_certificate_chain (gnutls_session_t session,
			  const char *hostname,
			  const gnutls_datum_t * cert_chain,
			  int cert_chain_length)
{
  int i;
  gnutls_x509_crt_t *cert;

  cert = malloc (sizeof (*cert) * cert_chain_length);

  /* Import all the certificates in the chain to
   * native certificate format.
   */
  for (i = 0; i &lt; cert_chain_length; i++)
    {
      gnutls_x509_crt_init (&amp;cert[i]);
      gnutls_x509_crt_import (cert[i], &amp;cert_chain[i], GNUTLS_X509_FMT_DER);
    }

  /* If the last certificate in the chain is self signed ignore it.
   * That is because we want to check against our trusted certificate
   * list.
   */
  if (gnutls_x509_crt_check_issuer (cert[cert_chain_length - 1],
				    cert[cert_chain_length - 1]) > 0
      &amp;&amp; cert_chain_length > 0)
    {
      cert_chain_length--;
    }

  /* Now verify the certificates against their issuers
   * in the chain.
   */
  for (i = 1; i &lt; cert_chain_length; i++)
    {
      verify_cert2 (cert[i - 1], cert[i], crl_list, crl_list_size);
    }

  /* Here we must verify the last certificate in the chain against
   * our trusted CA list.
   */
  verify_last_cert (cert[cert_chain_length - 1],
		    ca_list, ca_list_size, crl_list, crl_list_size);

  /* Check if the name in the first certificate matches our destination!
   */
  if (!gnutls_x509_crt_check_hostname (cert[0], hostname))
    {
      printf ("The certificate's owner does not match hostname '%s'\n",
	      hostname);
    }

  for (i = 0; i &lt; cert_chain_length; i++)
    gnutls_x509_crt_deinit (cert[i]);

  return;
}


/* Verifies a certificate against an other certificate
 * which is supposed to be it's issuer. Also checks the
 * crl_list if the certificate is revoked.
 */
static void
verify_cert2 (gnutls_x509_crt_t crt, gnutls_x509_crt_t issuer,
	      gnutls_x509_crl_t * crl_list, int crl_list_size)
{
  unsigned int output;
  int ret;
  time_t now = time (0);
  size_t name_size;
  char name[64];

  /* Print information about the certificates to
   * be checked.
   */
  name_size = sizeof (name);
  gnutls_x509_crt_get_dn (crt, name, &amp;name_size);

  fprintf (stderr, "\nCertificate: %s\n", name);

  name_size = sizeof (name);
  gnutls_x509_crt_get_issuer_dn (crt, name, &amp;name_size);

  fprintf (stderr, "Issued by: %s\n", name);

  /* Get the DN of the issuer cert.
   */
  name_size = sizeof (name);
  gnutls_x509_crt_get_dn (issuer, name, &amp;name_size);

  fprintf (stderr, "Checking against: %s\n", name);

  /* Do the actual verification.
   */
  gnutls_x509_crt_verify (crt, &amp;issuer, 1, 0, &amp;output);

  if (output &amp; GNUTLS_CERT_INVALID)
    {
      fprintf (stderr, "Not trusted");

      if (output &amp; GNUTLS_CERT_SIGNER_NOT_FOUND)
	fprintf (stderr, ": no issuer was found");
      if (output &amp; GNUTLS_CERT_SIGNER_NOT_CA)
	fprintf (stderr, ": issuer is not a CA");

      fprintf (stderr, "\n");
    }
  else
    fprintf (stderr, "Trusted\n");


  /* Now check the expiration dates.
   */
  if (gnutls_x509_crt_get_activation_time (crt) > now)
    fprintf (stderr, "Not yet activated\n");

  if (gnutls_x509_crt_get_expiration_time (crt) &lt; now)
    fprintf (stderr, "Expired\n");

  /* Check if the certificate is revoked.
   */
  ret = gnutls_x509_crt_check_revocation (crt, crl_list, crl_list_size);
  if (ret == 1)
    {				/* revoked */
      fprintf (stderr, "Revoked\n");
    }
}


/* Verifies a certificate against our trusted CA list.
 * Also checks the crl_list if the certificate is revoked.
 */
static void
verify_last_cert (gnutls_x509_crt_t crt,
		  gnutls_x509_crt_t * ca_list, int ca_list_size,
		  gnutls_x509_crl_t * crl_list, int crl_list_size)
{
  unsigned int output;
  int ret;
  time_t now = time (0);
  size_t name_size;
  char name[64];

  /* Print information about the certificates to
   * be checked.
   */
  name_size = sizeof (name);
  gnutls_x509_crt_get_dn (crt, name, &amp;name_size);

  fprintf (stderr, "\nCertificate: %s\n", name);

  name_size = sizeof (name);
  gnutls_x509_crt_get_issuer_dn (crt, name, &amp;name_size);

  fprintf (stderr, "Issued by: %s\n", name);

  /* Do the actual verification.
   */
  gnutls_x509_crt_verify (crt, ca_list, ca_list_size,
			  GNUTLS_VERIFY_ALLOW_X509_V1_CA_CRT, &amp;output);

  if (output &amp; GNUTLS_CERT_INVALID)
    {
      fprintf (stderr, "Not trusted");

      if (output &amp; GNUTLS_CERT_SIGNER_NOT_CA)
	fprintf (stderr, ": Issuer is not a CA\n");
      else
	fprintf (stderr, "\n");
    }
  else
    fprintf (stderr, "Trusted\n");


  /* Now check the expiration dates.
   */
  if (gnutls_x509_crt_get_activation_time (crt) > now)
    fprintf (stderr, "Not yet activated\n");

  if (gnutls_x509_crt_get_expiration_time (crt) &lt; now)
    fprintf (stderr, "Expired\n");

  /* Check if the certificate is revoked.
   */
  ret = gnutls_x509_crt_check_revocation (crt, crl_list, crl_list_size);
  if (ret == 1)
    {				/* revoked */
      fprintf (stderr, "Revoked\n");
    }
}
</pre>
<div class="node">
<a name="Using-a-callback-to-select-the-certificate-to-use"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Client-with-Resume-capability-example">Client with Resume capability example</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Verifying-peer_0027s-certificate">Verifying peer's certificate</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Client-examples">Client examples</a>

</div>

<h4 class="subsection">7.3.5 Using a Callback to Select the Certificate to Use</h4>

<p>There are cases where a client holds several certificate and key
pairs, and may not want to load all of them in the credentials
structure.  The following example demonstrates the use of the
certificate selection callback.

<pre class="verbatim">/* Copyright 2007 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;string.h>
#include &lt;sys/types.h>
#include &lt;sys/socket.h>
#include &lt;arpa/inet.h>
#include &lt;unistd.h>
#include &lt;gnutls/gnutls.h>
#include &lt;gnutls/x509.h>
#include &lt;sys/types.h>
#include &lt;sys/stat.h>
#include &lt;fcntl.h>

/* A TLS client that loads the certificate and key.
 */

#define MAX_BUF 1024
#define MSG "GET / HTTP/1.0\r\n\r\n"

#define CERT_FILE "cert.pem"
#define KEY_FILE "key.pem"
#define CAFILE "ca.pem"

extern int tcp_connect (void);
extern void tcp_close (int sd);

static int cert_callback (gnutls_session_t session,
			  const gnutls_datum_t * req_ca_rdn, int nreqs,
			  const gnutls_pk_algorithm_t * sign_algos,
			  int sign_algos_length, gnutls_retr_st * st);

gnutls_x509_crt_t crt;
gnutls_x509_privkey_t key;

/* Helper functions to load a certificate and key
 * files into memory.
 */
static gnutls_datum_t
load_file (const char *file)
{
  FILE *f;
  gnutls_datum_t loaded_file = { NULL, 0 };
  long filelen;
  void *ptr;

  if (!(f = fopen (file, "r"))
      || fseek (f, 0, SEEK_END) != 0
      || (filelen = ftell (f)) &lt; 0
      || fseek (f, 0, SEEK_SET) != 0
      || !(ptr = malloc ((size_t) filelen))
      || fread (ptr, 1, (size_t) filelen, f) &lt; (size_t) filelen)
    {
      return loaded_file;
    }

  loaded_file.data = ptr;
  loaded_file.size = (unsigned int) filelen;
  return loaded_file;
}

static void
unload_file (gnutls_datum_t data)
{
  free (data.data);
}

/* Load the certificate and the private key.
 */
static void
load_keys (void)
{
  int ret;
  gnutls_datum_t data;

  data = load_file (CERT_FILE);
  if (data.data == NULL)
    {
      fprintf (stderr, "*** Error loading cert file.\n");
      exit (1);
    }
  gnutls_x509_crt_init (&amp;crt);

  ret = gnutls_x509_crt_import (crt, &amp;data, GNUTLS_X509_FMT_PEM);
  if (ret &lt; 0)
    {
      fprintf (stderr, "*** Error loading key file: %s\n",
	       gnutls_strerror (ret));
      exit (1);
    }

  unload_file (data);

  data = load_file (KEY_FILE);
  if (data.data == NULL)
    {
      fprintf (stderr, "*** Error loading key file.\n");
      exit (1);
    }

  gnutls_x509_privkey_init (&amp;key);

  ret = gnutls_x509_privkey_import (key, &amp;data, GNUTLS_X509_FMT_PEM);
  if (ret &lt; 0)
    {
      fprintf (stderr, "*** Error loading key file: %s\n",
	       gnutls_strerror (ret));
      exit (1);
    }

  unload_file (data);

}

int
main (void)
{
  int ret, sd, ii;
  gnutls_session_t session;
  gnutls_priority_t priorities_cache;
  char buffer[MAX_BUF + 1];
  gnutls_certificate_credentials_t xcred;
  /* Allow connections to servers that have OpenPGP keys as well.
   */

  gnutls_global_init ();

  load_keys ();

  /* X509 stuff */
  gnutls_certificate_allocate_credentials (&amp;xcred);

  /* priorities */
  gnutls_priority_init (&amp;priorities_cache, "NORMAL", NULL);


  /* sets the trusted cas file
   */
  gnutls_certificate_set_x509_trust_file (xcred, CAFILE, GNUTLS_X509_FMT_PEM);

  gnutls_certificate_client_set_retrieve_function (xcred, cert_callback);

  /* Initialize TLS session 
   */
  gnutls_init (&amp;session, GNUTLS_CLIENT);

  /* Use default priorities */
  gnutls_priority_set (session, priorities_cache);

  /* put the x509 credentials to the current session
   */
  gnutls_credentials_set (session, GNUTLS_CRD_CERTIFICATE, xcred);

  /* connect to the peer
   */
  sd = tcp_connect ();

  gnutls_transport_set_ptr (session, (gnutls_transport_ptr_t) sd);

  /* Perform the TLS handshake
   */
  ret = gnutls_handshake (session);

  if (ret &lt; 0)
    {
      fprintf (stderr, "*** Handshake failed\n");
      gnutls_perror (ret);
      goto end;
    }
  else
    {
      printf ("- Handshake was completed\n");
    }

  gnutls_record_send (session, MSG, strlen (MSG));

  ret = gnutls_record_recv (session, buffer, MAX_BUF);
  if (ret == 0)
    {
      printf ("- Peer has closed the TLS connection\n");
      goto end;
    }
  else if (ret &lt; 0)
    {
      fprintf (stderr, "*** Error: %s\n", gnutls_strerror (ret));
      goto end;
    }

  printf ("- Received %d bytes: ", ret);
  for (ii = 0; ii &lt; ret; ii++)
    {
      fputc (buffer[ii], stdout);
    }
  fputs ("\n", stdout);

  gnutls_bye (session, GNUTLS_SHUT_RDWR);

end:

  tcp_close (sd);

  gnutls_deinit (session);

  gnutls_certificate_free_credentials (xcred);
  gnutls_priority_deinit (priorities_cache);

  gnutls_global_deinit ();

  return 0;
}



/* This callback should be associated with a session by calling
 * gnutls_certificate_client_set_retrieve_function( session, cert_callback),
 * before a handshake.
 */

static int
cert_callback (gnutls_session_t session,
	       const gnutls_datum_t * req_ca_rdn, int nreqs,
	       const gnutls_pk_algorithm_t * sign_algos,
	       int sign_algos_length, gnutls_retr_st * st)
{
  char issuer_dn[256];
  int i, ret;
  size_t len;
  gnutls_certificate_type_t type;

  /* Print the server's trusted CAs
   */
  if (nreqs > 0)
    printf ("- Server's trusted authorities:\n");
  else
    printf ("- Server did not send us any trusted authorities names.\n");

  /* print the names (if any) */
  for (i = 0; i &lt; nreqs; i++)
    {
      len = sizeof (issuer_dn);
      ret = gnutls_x509_rdn_get (&amp;req_ca_rdn[i], issuer_dn, &amp;len);
      if (ret >= 0)
	{
	  printf ("   [%d]: ", i);
	  printf ("%s\n", issuer_dn);
	}
    }

  /* Select a certificate and return it.
   * The certificate must be of any of the "sign algorithms"
   * supported by the server.
   */

  type = gnutls_certificate_type_get (session);
  if (type == GNUTLS_CRT_X509)
    {
      st->type = type;
      st->ncerts = 1;

      st->cert.x509 = &amp;crt;
      st->key.x509 = key;

      st->deinit_all = 0;
    }
  else
    {
      return -1;
    }

  return 0;

}
</pre>
<div class="node">
<a name="Client-with-Resume-capability-example"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Simple-client-example-with-SRP-authentication">Simple client example with SRP authentication</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Using-a-callback-to-select-the-certificate-to-use">Using a callback to select the certificate to use</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Client-examples">Client examples</a>

</div>

<h4 class="subsection">7.3.6 Client with Resume Capability Example</h4>

<p><a name="ex_003aresume_002dclient"></a>This is a modification of the simple client example. Here we
demonstrate the use of session resumption. The client tries to connect
once using <acronym>TLS</acronym>, close the connection and then try to
establish a new connection using the previously negotiated data.

<pre class="verbatim">/* Copyright 2007, 2008 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;string.h>
#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;gnutls/gnutls.h>

/* Those functions are defined in other examples.
 */
extern void check_alert (gnutls_session_t session, int ret);
extern int tcp_connect (void);
extern void tcp_close (int sd);

#define MAX_BUF 1024
#define CRLFILE "crl.pem"
#define CAFILE "ca.pem"
#define MSG "GET / HTTP/1.0\r\n\r\n"

int
main (void)
{
  int ret;
  int sd, ii;
  gnutls_session_t session;
  char buffer[MAX_BUF + 1];
  gnutls_certificate_credentials_t xcred;

  /* variables used in session resuming 
   */
  int t;
  char *session_data = NULL;
  size_t session_data_size = 0;

  gnutls_global_init ();

  /* X509 stuff */
  gnutls_certificate_allocate_credentials (&amp;xcred);

  gnutls_certificate_set_x509_trust_file (xcred, CAFILE, GNUTLS_X509_FMT_PEM);

  for (t = 0; t &lt; 2; t++)
    {				/* connect 2 times to the server */

      sd = tcp_connect ();

      gnutls_init (&amp;session, GNUTLS_CLIENT);

      gnutls_priority_set_direct (session, "PERFORMANCE:!ARCFOUR-128", NULL);

      gnutls_credentials_set (session, GNUTLS_CRD_CERTIFICATE, xcred);

      if (t > 0)
	{
	  /* if this is not the first time we connect */
	  gnutls_session_set_data (session, session_data, session_data_size);
	  free (session_data);
	}

      gnutls_transport_set_ptr (session, (gnutls_transport_ptr_t) sd);

      /* Perform the TLS handshake
       */
      ret = gnutls_handshake (session);

      if (ret &lt; 0)
	{
	  fprintf (stderr, "*** Handshake failed\n");
	  gnutls_perror (ret);
	  goto end;
	}
      else
	{
	  printf ("- Handshake was completed\n");
	}

      if (t == 0)
	{			/* the first time we connect */
	  /* get the session data size */
	  gnutls_session_get_data (session, NULL, &amp;session_data_size);
	  session_data = malloc (session_data_size);

	  /* put session data to the session variable */
	  gnutls_session_get_data (session, session_data, &amp;session_data_size);

	}
      else
	{			/* the second time we connect */

	  /* check if we actually resumed the previous session */
	  if (gnutls_session_is_resumed (session) != 0)
	    {
	      printf ("- Previous session was resumed\n");
	    }
	  else
	    {
	      fprintf (stderr, "*** Previous session was NOT resumed\n");
	    }
	}

      /* This function was defined in a previous example
       */
      /* print_info(session); */

      gnutls_record_send (session, MSG, strlen (MSG));

      ret = gnutls_record_recv (session, buffer, MAX_BUF);
      if (ret == 0)
	{
	  printf ("- Peer has closed the TLS connection\n");
	  goto end;
	}
      else if (ret &lt; 0)
	{
	  fprintf (stderr, "*** Error: %s\n", gnutls_strerror (ret));
	  goto end;
	}

      printf ("- Received %d bytes: ", ret);
      for (ii = 0; ii &lt; ret; ii++)
	{
	  fputc (buffer[ii], stdout);
	}
      fputs ("\n", stdout);

      gnutls_bye (session, GNUTLS_SHUT_RDWR);

    end:

      tcp_close (sd);

      gnutls_deinit (session);

    }				/* for() */

  gnutls_certificate_free_credentials (xcred);

  gnutls_global_deinit ();

  return 0;
}
</pre>
<div class="node">
<a name="Simple-client-example-with-SRP-authentication"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Simple-client-example-with-TLS_002fIA-support">Simple client example with TLS/IA support</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Client-with-Resume-capability-example">Client with Resume capability example</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Client-examples">Client examples</a>

</div>

<h4 class="subsection">7.3.7 Simple Client Example with <acronym>SRP</acronym> Authentication</h4>

<p>The following client is a very simple <acronym>SRP</acronym> <acronym>TLS</acronym>
client which connects to a server and authenticates using a
<em>username</em> and a <em>password</em>. The server may authenticate
itself using a certificate, and in that case it has to be verified.

<pre class="verbatim">/* Copyright 2007 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;string.h>
#include &lt;gnutls/gnutls.h>
#include &lt;gnutls/extra.h>

/* Those functions are defined in other examples.
 */
extern void check_alert (gnutls_session_t session, int ret);
extern int tcp_connect (void);
extern void tcp_close (int sd);

#define MAX_BUF 1024
#define USERNAME "user"
#define PASSWORD "pass"
#define CAFILE "ca.pem"
#define SA struct sockaddr
#define MSG "GET / HTTP/1.0\r\n\r\n"

#define MAX_PRIORITIES 3

int
main (void)
{
  int ret;
  int sd, ii;
  gnutls_session_t session;
  char buffer[MAX_BUF + 1];
  gnutls_srp_client_credentials_t srp_cred;
  gnutls_certificate_credentials_t cert_cred;

  gnutls_global_init ();

  /* now enable the gnutls-extra library which contains the
   * SRP stuff. 
   */
  gnutls_global_init_extra ();

  gnutls_srp_allocate_client_credentials (&amp;srp_cred);
  gnutls_certificate_allocate_credentials (&amp;cert_cred);

  gnutls_certificate_set_x509_trust_file (cert_cred, CAFILE,
					  GNUTLS_X509_FMT_PEM);
  gnutls_srp_set_client_credentials (srp_cred, USERNAME, PASSWORD);

  /* connects to server 
   */
  sd = tcp_connect ();

  /* Initialize TLS session 
   */
  gnutls_init (&amp;session, GNUTLS_CLIENT);


  /* Set the priorities.
   */
  gnutls_priority_set_direct (session, "NORMAL:+SRP:+SRP-RSA:+SRP-DSS", NULL);

  /* put the SRP credentials to the current session
   */
  gnutls_credentials_set (session, GNUTLS_CRD_SRP, srp_cred);
  gnutls_credentials_set (session, GNUTLS_CRD_CERTIFICATE, cert_cred);

  gnutls_transport_set_ptr (session, (gnutls_transport_ptr_t) sd);

  /* Perform the TLS handshake
   */
  ret = gnutls_handshake (session);

  if (ret &lt; 0)
    {
      fprintf (stderr, "*** Handshake failed\n");
      gnutls_perror (ret);
      goto end;
    }
  else
    {
      printf ("- Handshake was completed\n");
    }

  gnutls_record_send (session, MSG, strlen (MSG));

  ret = gnutls_record_recv (session, buffer, MAX_BUF);
  if (gnutls_error_is_fatal (ret) == 1 || ret == 0)
    {
      if (ret == 0)
	{
	  printf ("- Peer has closed the GNUTLS connection\n");
	  goto end;
	}
      else
	{
	  fprintf (stderr, "*** Error: %s\n", gnutls_strerror (ret));
	  goto end;
	}
    }
  else
    check_alert (session, ret);

  if (ret > 0)
    {
      printf ("- Received %d bytes: ", ret);
      for (ii = 0; ii &lt; ret; ii++)
	{
	  fputc (buffer[ii], stdout);
	}
      fputs ("\n", stdout);
    }
  gnutls_bye (session, GNUTLS_SHUT_RDWR);

end:

  tcp_close (sd);

  gnutls_deinit (session);

  gnutls_srp_free_client_credentials (srp_cred);
  gnutls_certificate_free_credentials (cert_cred);

  gnutls_global_deinit ();

  return 0;
}
</pre>
<div class="node">
<a name="Simple-client-example-with-TLS%2fIA-support"></a>
<a name="Simple-client-example-with-TLS_002fIA-support"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Simple-client-example-in-C_002b_002b">Simple client example in C++</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Simple-client-example-with-SRP-authentication">Simple client example with SRP authentication</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Client-examples">Client examples</a>

</div>

<h4 class="subsection">7.3.8 Simple Client Example with <acronym>TLS/IA</acronym> Support</h4>

<p>The following client is a simple client which uses the
<acronym>TLS/IA</acronym> extension to authenticate with the server.

<pre class="verbatim">/* Copyright 2007, 2008 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;string.h>
#include &lt;sys/types.h>
#include &lt;sys/socket.h>
#include &lt;arpa/inet.h>
#include &lt;unistd.h>
#include &lt;gnutls/gnutls.h>
#include &lt;gnutls/extra.h>

/* A basic TLS client, with anonymous authentication and TLS/IA handshake.
 */

#define MAX_BUF 1024
#define SA struct sockaddr
#define MSG "GET / HTTP/1.0\r\n\r\n"

extern int tcp_connect (void);
extern void tcp_close (int sd);

static int
client_avp (gnutls_session_t session, void *ptr,
	    const char *last, size_t lastlen, char **new, size_t * newlen)
{

  if (last)
    printf ("- received %d bytes AVP: `%.*s'\n", lastlen, lastlen, last);
  else
    printf ("- new application phase\n");

  *new = gnutls_strdup ("client avp");
  if (!*new)
    return -1;
  *newlen = strlen (*new);

  printf ("- sending %d bytes AVP: `%s'\n", *newlen, *new);

  gnutls_ia_permute_inner_secret (session, 3, "foo");

  return 0;

}

int
main (void)
{
  int ret, sd, ii;
  gnutls_session_t session;
  char buffer[MAX_BUF + 1];
  gnutls_anon_client_credentials_t anoncred;
  gnutls_ia_client_credentials_t iacred;
  /* Need to enable anonymous KX specifically. */

  gnutls_global_init ();

  gnutls_anon_allocate_client_credentials (&amp;anoncred);
  gnutls_ia_allocate_client_credentials (&amp;iacred);

  /* Set TLS/IA stuff
   */
  gnutls_ia_set_client_avp_function (iacred, client_avp);

  /* Initialize TLS session 
   */
  gnutls_init (&amp;session, GNUTLS_CLIENT);

  /* Use default priorities */
  gnutls_priority_set_direct (session, "NORMAL:+ANON-DH", NULL);

  /* put the anonymous and TLS/IA credentials to the current session
   */
  gnutls_credentials_set (session, GNUTLS_CRD_ANON, anoncred);
  gnutls_credentials_set (session, GNUTLS_CRD_IA, iacred);

  /* connect to the peer
   */
  sd = tcp_connect ();

  gnutls_transport_set_ptr (session, (gnutls_transport_ptr_t) sd);

  /* Perform the TLS handshake
   */
  ret = gnutls_handshake (session);

  if (ret &lt; 0)
    {
      fprintf (stderr, "*** Handshake failed\n");
      gnutls_perror (ret);
      goto end;
    }
  else
    {
      printf ("- Handshake was completed\n");
    }

  if (!gnutls_ia_handshake_p (session))
    {
      fprintf (stderr, "*** TLS/IA not negotiated...\n");
      goto end;
    }
  else
    {
      printf ("- Starting TLS/IA handshake...\n");

      ret = gnutls_ia_handshake (session);

      if (ret &lt; 0)
	{
	  fprintf (stderr, "*** TLS/IA handshake failed\n");
	  gnutls_perror (ret);
	  goto end;
	}
      else
	{
	  printf ("- TLS/IA Handshake was completed\n");
	}
    }


  gnutls_record_send (session, MSG, strlen (MSG));

  ret = gnutls_record_recv (session, buffer, MAX_BUF);
  if (ret == 0)
    {
      printf ("- Peer has closed the TLS connection\n");
      goto end;
    }
  else if (ret &lt; 0)
    {
      fprintf (stderr, "*** Error: %s\n", gnutls_strerror (ret));
      goto end;
    }

  printf ("- Received %d bytes: ", ret);
  for (ii = 0; ii &lt; ret; ii++)
    {
      fputc (buffer[ii], stdout);
    }
  fputs ("\n", stdout);

  gnutls_bye (session, GNUTLS_SHUT_RDWR);

end:

  tcp_close (sd);

  gnutls_deinit (session);

  gnutls_ia_free_client_credentials (iacred);
  gnutls_anon_free_client_credentials (anoncred);

  gnutls_global_deinit ();

  return 0;
}
</pre>
<div class="node">
<a name="Simple-client-example-in-C++"></a>
<a name="Simple-client-example-in-C_002b_002b"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Helper-function-for-TCP-connections">Helper function for TCP connections</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Simple-client-example-with-TLS_002fIA-support">Simple client example with TLS/IA support</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Client-examples">Client examples</a>

</div>

<h4 class="subsection">7.3.9 Simple Client Example using the C++ API</h4>

<p>The following client is a simple example of a client client utilizing
the GnuTLS C++ API.

<pre class="verbatim">#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#else
#endif
#include &lt;iostream>
#include &lt;stdexcept>
#include &lt;gnutls/gnutls.h>
#include &lt;gnutls/gnutlsxx.h>
#include &lt;cstring> /* for strlen */

/* A very basic TLS client, with anonymous authentication.
 * written by Eduardo Villanueva Che.
 */

#define MAX_BUF 1024
#define SA struct sockaddr

#define CAFILE "ca.pem"
#define MSG "GET / HTTP/1.0\r\n\r\n"

extern "C"
{
    int tcp_connect(void);
    void tcp_close(int sd);
}


int main(void)
{
    int sd = -1;
    gnutls_global_init();

    try
    {

        /* Allow connections to servers that have OpenPGP keys as well.
         */
        gnutls::client_session session;

        /* X509 stuff */
        gnutls::certificate_credentials credentials;


        /* sets the trusted cas file
         */
        credentials.set_x509_trust_file(CAFILE, GNUTLS_X509_FMT_PEM);
        /* put the x509 credentials to the current session
         */
        session.set_credentials(credentials);

        /* Use default priorities */
        session.set_priority ("NORMAL", NULL);

        /* connect to the peer
         */
        sd = tcp_connect();
        session.set_transport_ptr((gnutls_transport_ptr_t) sd);

        /* Perform the TLS handshake
         */
        int ret = session.handshake();
        if (ret &lt; 0)
        {
//             gnutls_perror(ret);
            throw std::runtime_error("Handshake failed");
        }
        else
        {
            std::cout &lt;&lt; "- Handshake was completed" &lt;&lt; std::endl;
        }

        session.send(MSG, strlen(MSG));
        char buffer[MAX_BUF + 1];
        ret = session.recv(buffer, MAX_BUF);
        if (ret == 0)
        {
            throw std::runtime_error("Peer has closed the TLS connection");
        }
        else if (ret &lt; 0)
        {
            throw std::runtime_error(gnutls_strerror(ret));
        }

        std::cout &lt;&lt; "- Received " &lt;&lt; ret &lt;&lt; " bytes:" &lt;&lt; std::endl;
        std::cout.write(buffer, ret);
        std::cout &lt;&lt; std::endl;

        session.bye(GNUTLS_SHUT_RDWR);
    }
    catch (std::exception &amp;ex)
    {
        std::cerr &lt;&lt; "Exception caught: " &lt;&lt; ex.what() &lt;&lt; std::endl;
    }

    if (sd != -1)
        tcp_close(sd);

    gnutls_global_deinit();

    return 0;
}
</pre>
<div class="node">
<a name="Helper-function-for-TCP-connections"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Simple-client-example-in-C_002b_002b">Simple client example in C++</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Client-examples">Client examples</a>

</div>

<h4 class="subsection">7.3.10 Helper Function for TCP Connections</h4>

<p>This helper function abstracts away TCP connection handling from the
other examples.  It is required to build some examples.

<pre class="verbatim">/* Copyright 2007 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;string.h>
#include &lt;sys/types.h>
#include &lt;sys/socket.h>
#include &lt;arpa/inet.h>
#include &lt;netinet/in.h>
#include &lt;unistd.h>

#define SA struct sockaddr

/* Connects to the peer and returns a socket
 * descriptor.
 */
extern int
tcp_connect (void)
{
  const char *PORT = "5556";
  const char *SERVER = "127.0.0.1";
  int err, sd;
  struct sockaddr_in sa;

  /* connects to server
   */
  sd = socket (AF_INET, SOCK_STREAM, 0);

  memset (&amp;sa, '\0', sizeof (sa));
  sa.sin_family = AF_INET;
  sa.sin_port = htons (atoi (PORT));
  inet_pton (AF_INET, SERVER, &amp;sa.sin_addr);

  err = connect (sd, (SA *) &amp; sa, sizeof (sa));
  if (err &lt; 0)
    {
      fprintf (stderr, "Connect error\n");
      exit (1);
    }

  return sd;
}

/* closes the given socket descriptor.
 */
extern void
tcp_close (int sd)
{
  shutdown (sd, SHUT_RDWR);	/* no more receptions */
  close (sd);
}
</pre>
<div class="node">
<a name="Server-examples"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Miscellaneous-examples">Miscellaneous examples</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Client-examples">Client examples</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#How-to-use-GnuTLS-in-applications">How to use GnuTLS in applications</a>

</div>

<h3 class="section">7.4 Server Examples</h3>

<p>This section contains examples of <acronym>TLS</acronym> and <acronym>SSL</acronym>
servers, using <acronym>GnuTLS</acronym>.

<ul class="menu">
<li><a accesskey="1" href="#Echo-Server-with-X_002e509-authentication">Echo Server with X.509 authentication</a>
<li><a accesskey="2" href="#Echo-Server-with-X_002e509-authentication-II">Echo Server with X.509 authentication II</a>
<li><a accesskey="3" href="#Echo-Server-with-OpenPGP-authentication">Echo Server with OpenPGP authentication</a>
<li><a accesskey="4" href="#Echo-Server-with-SRP-authentication">Echo Server with SRP authentication</a>
<li><a accesskey="5" href="#Echo-Server-with-anonymous-authentication">Echo Server with anonymous authentication</a>
</ul>

<div class="node">
<a name="Echo-Server-with-X.509-authentication"></a>
<a name="Echo-Server-with-X_002e509-authentication"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Echo-Server-with-X_002e509-authentication-II">Echo Server with X.509 authentication II</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Server-examples">Server examples</a>

</div>

<h4 class="subsection">7.4.1 Echo Server with <acronym>X.509</acronym> Authentication</h4>

<p>This example is a very simple echo server which supports
<acronym>X.509</acronym> authentication, using the RSA ciphersuites.

<pre class="verbatim">/* Copyright 2007, 2008 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;errno.h>
#include &lt;sys/types.h>
#include &lt;sys/socket.h>
#include &lt;arpa/inet.h>
#include &lt;netinet/in.h>
#include &lt;string.h>
#include &lt;unistd.h>
#include &lt;gnutls/gnutls.h>
#include &lt;gcrypt.h>		/* for gcry_control */

#define KEYFILE "key.pem"
#define CERTFILE "cert.pem"
#define CAFILE "ca.pem"
#define CRLFILE "crl.pem"

/* This is a sample TLS 1.0 echo server, using X.509 authentication.
 */


#define SA struct sockaddr
#define SOCKET_ERR(err,s) if(err==-1) {perror(s);return(1);}
#define MAX_BUF 1024
#define PORT 5556		/* listen to 5556 port */
#define DH_BITS 1024

/* These are global */
gnutls_certificate_credentials_t x509_cred;
gnutls_priority_t priority_cache;

static gnutls_session_t
initialize_tls_session (void)
{
  gnutls_session_t session;

  gnutls_init (&amp;session, GNUTLS_SERVER);

  gnutls_priority_set (session, priority_cache);

  gnutls_credentials_set (session, GNUTLS_CRD_CERTIFICATE, x509_cred);

  /* request client certificate if any.
   */
  gnutls_certificate_server_set_request (session, GNUTLS_CERT_REQUEST);

  /* Set maximum compatibility mode. This is only suggested on public webservers
   * that need to trade security for compatibility
   */
  gnutls_session_enable_compatibility_mode (session);

  return session;
}

static gnutls_dh_params_t dh_params;

static int
generate_dh_params (void)
{

  /* Generate Diffie Hellman parameters - for use with DHE
   * kx algorithms. When short bit length is used, it might
   * be wise to regenerate parameters.
   *
   * Check the ex-serv-export.c example for using static
   * parameters.
   */
  gnutls_dh_params_init (&amp;dh_params);
  gnutls_dh_params_generate2 (dh_params, DH_BITS);

  return 0;
}

int
main (void)
{
  int err, listen_sd, i;
  int sd, ret;
  struct sockaddr_in sa_serv;
  struct sockaddr_in sa_cli;
  int client_len;
  char topbuf[512];
  gnutls_session_t session;
  char buffer[MAX_BUF + 1];
  int optval = 1;

  /* to disallow usage of the blocking /dev/random 
   */
  gcry_control (GCRYCTL_ENABLE_QUICK_RANDOM, 0);

  /* this must be called once in the program
   */
  gnutls_global_init ();

  gnutls_certificate_allocate_credentials (&amp;x509_cred);
  gnutls_certificate_set_x509_trust_file (x509_cred, CAFILE,
					  GNUTLS_X509_FMT_PEM);

  gnutls_certificate_set_x509_crl_file (x509_cred, CRLFILE,
					GNUTLS_X509_FMT_PEM);

  gnutls_certificate_set_x509_key_file (x509_cred, CERTFILE, KEYFILE,
					GNUTLS_X509_FMT_PEM);

  generate_dh_params ();

  gnutls_priority_init (&amp;priority_cache, "NORMAL", NULL);


  gnutls_certificate_set_dh_params (x509_cred, dh_params);

  /* Socket operations
   */
  listen_sd = socket (AF_INET, SOCK_STREAM, 0);
  SOCKET_ERR (listen_sd, "socket");

  memset (&amp;sa_serv, '\0', sizeof (sa_serv));
  sa_serv.sin_family = AF_INET;
  sa_serv.sin_addr.s_addr = INADDR_ANY;
  sa_serv.sin_port = htons (PORT);	/* Server Port number */

  setsockopt (listen_sd, SOL_SOCKET, SO_REUSEADDR, &amp;optval, sizeof (int));

  err = bind (listen_sd, (SA *) &amp; sa_serv, sizeof (sa_serv));
  SOCKET_ERR (err, "bind");
  err = listen (listen_sd, 1024);
  SOCKET_ERR (err, "listen");

  printf ("Server ready. Listening to port '%d'.\n\n", PORT);

  client_len = sizeof (sa_cli);
  for (;;)
    {
      session = initialize_tls_session ();

      sd = accept (listen_sd, (SA *) &amp; sa_cli, &amp;client_len);

      printf ("- connection from %s, port %d\n",
	      inet_ntop (AF_INET, &amp;sa_cli.sin_addr, topbuf,
			 sizeof (topbuf)), ntohs (sa_cli.sin_port));

      gnutls_transport_set_ptr (session, (gnutls_transport_ptr_t) sd);
      ret = gnutls_handshake (session);
      if (ret &lt; 0)
	{
	  close (sd);
	  gnutls_deinit (session);
	  fprintf (stderr, "*** Handshake has failed (%s)\n\n",
		   gnutls_strerror (ret));
	  continue;
	}
      printf ("- Handshake was completed\n");

      /* see the Getting peer's information example */
      /* print_info(session); */

      i = 0;
      for (;;)
	{
	  memset (buffer, 0, MAX_BUF + 1);
	  ret = gnutls_record_recv (session, buffer, MAX_BUF);

	  if (ret == 0)
	    {
	      printf ("\n- Peer has closed the GNUTLS connection\n");
	      break;
	    }
	  else if (ret &lt; 0)
	    {
	      fprintf (stderr, "\n*** Received corrupted "
		       "data(%d). Closing the connection.\n\n", ret);
	      break;
	    }
	  else if (ret > 0)
	    {
	      /* echo data back to the client
	       */
	      gnutls_record_send (session, buffer, strlen (buffer));
	    }
	}
      printf ("\n");
      /* do not wait for the peer to close the connection.
       */
      gnutls_bye (session, GNUTLS_SHUT_WR);

      close (sd);
      gnutls_deinit (session);

    }
  close (listen_sd);

  gnutls_certificate_free_credentials (x509_cred);
  gnutls_priority_deinit (priority_cache);

  gnutls_global_deinit ();

  return 0;

}
</pre>
<div class="node">
<a name="Echo-Server-with-X.509-authentication-II"></a>
<a name="Echo-Server-with-X_002e509-authentication-II"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Echo-Server-with-OpenPGP-authentication">Echo Server with OpenPGP authentication</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Echo-Server-with-X_002e509-authentication">Echo Server with X.509 authentication</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Server-examples">Server examples</a>

</div>

<h4 class="subsection">7.4.2 Echo Server with <acronym>X.509</acronym> Authentication II</h4>

<p>The following example is a server which supports <acronym>X.509</acronym>
authentication.  This server supports the export-grade cipher suites,
the DHE ciphersuites and session resuming.

<pre class="verbatim">/* Copyright 2007, 2008 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;errno.h>
#include &lt;sys/types.h>
#include &lt;sys/socket.h>
#include &lt;arpa/inet.h>
#include &lt;netinet/in.h>
#include &lt;string.h>
#include &lt;unistd.h>
#include &lt;gnutls/gnutls.h>
#include &lt;gcrypt.h>		/* for gcry_control */

#define KEYFILE "key.pem"
#define CERTFILE "cert.pem"
#define CAFILE "ca.pem"
#define CRLFILE "crl.pem"

/* This is a sample TLS 1.0 echo server.
 * Export-grade ciphersuites and session resuming are supported.
 */

#define SA struct sockaddr
#define SOCKET_ERR(err,s) if(err==-1) {perror(s);return(1);}
#define MAX_BUF 1024
#define PORT 5556		/* listen to 5556 port */
#define DH_BITS 1024

/* These are global */
gnutls_certificate_credentials_t cert_cred;

static void wrap_db_init (void);
static void wrap_db_deinit (void);
static int wrap_db_store (void *dbf, gnutls_datum_t key, gnutls_datum_t data);
static gnutls_datum_t wrap_db_fetch (void *dbf, gnutls_datum_t key);
static int wrap_db_delete (void *dbf, gnutls_datum_t key);

#define TLS_SESSION_CACHE 50

static gnutls_session_t
initialize_tls_session (void)
{
  gnutls_session_t session;

  gnutls_init (&amp;session, GNUTLS_SERVER);

  /* Use the default priorities, plus, export cipher suites.
   */
  gnutls_priority_set_direct (session, "EXPORT", NULL);

  gnutls_credentials_set (session, GNUTLS_CRD_CERTIFICATE, cert_cred);

  /* request client certificate if any.
   */
  gnutls_certificate_server_set_request (session, GNUTLS_CERT_REQUEST);

  gnutls_dh_set_prime_bits (session, DH_BITS);

  if (TLS_SESSION_CACHE != 0)
    {
      gnutls_db_set_retrieve_function (session, wrap_db_fetch);
      gnutls_db_set_remove_function (session, wrap_db_delete);
      gnutls_db_set_store_function (session, wrap_db_store);
      gnutls_db_set_ptr (session, NULL);
    }

  return session;
}

gnutls_dh_params_t dh_params;
/* Export-grade cipher suites require temporary RSA
 * keys.
 */
gnutls_rsa_params_t rsa_params;

static char srp_dh_group2048[] =
  "-----BEGIN DH PARAMETERS-----\n"
  "MIIBBwKCAQCsa9tBMkqam/Fm3l4TiVgvr3K2ZRmH7gf8MZKUPbVgUKNzKcu0oJnt\n"
  "gZPgdXdnoT3VIxKrSwMxDc1/SKnaBP1Q6Ag5ae23Z7DPYJUXmhY6s2YaBfvV+qro\n"
  "KRipli8Lk7hV+XmT7Jde6qgNdArb9P90c1nQQdXDPqcdKB5EaxR3O8qXtDoj+4AW\n"
  "dr0gekNsZIHx0rkHhxdGGludMuaI+HdIVEUjtSSw1X1ep3onddLs+gMs+9v1L7N4\n"
  "YWAnkATleuavh05zA85TKZzMBBx7wwjYKlaY86jQw4JxrjX46dv7tpS1yAPYn3rk\n"
  "Nd4jbVJfVHWbZeNy/NaO8g+nER+eSv9zAgEC\n" "-----END DH PARAMETERS-----\n";

static int
generate_dh_params (void)
{
  gnutls_datum_t dparams = { srp_dh_group2048, sizeof (srp_dh_group2048) };
  /* Here instead of generating Diffie Hellman parameters (for use with DHE
   * kx algorithms) we import them.
   */
  gnutls_dh_params_init (&amp;dh_params);
  gnutls_dh_params_import_pkcs3 (dh_params, &amp;dparams, GNUTLS_X509_FMT_PEM);

  return 0;
}

static int
generate_rsa_params (void)
{
  gnutls_rsa_params_init (&amp;rsa_params);

  /* Generate RSA parameters - for use with RSA-export
   * cipher suites. This is an RSA private key and should be 
   * discarded and regenerated once a day, once every 500 
   * transactions etc. Depends on the security requirements.
   */

  gnutls_rsa_params_generate2 (rsa_params, 512);

  return 0;
}

int
main (void)
{
  int err, listen_sd, i;
  int sd, ret;
  struct sockaddr_in sa_serv;
  struct sockaddr_in sa_cli;
  int client_len;
  char topbuf[512];
  gnutls_session_t session;
  char buffer[MAX_BUF + 1];
  int optval = 1;
  char name[256];

  strcpy (name, "Echo Server");

  /* to disallow usage of the blocking /dev/random 
   */
  gcry_control (GCRYCTL_ENABLE_QUICK_RANDOM, 0);

  /* this must be called once in the program
   */
  gnutls_global_init ();


  gnutls_certificate_allocate_credentials (&amp;cert_cred);

  gnutls_certificate_set_x509_trust_file (cert_cred, CAFILE,
					  GNUTLS_X509_FMT_PEM);

  gnutls_certificate_set_x509_crl_file (cert_cred, CRLFILE,
					GNUTLS_X509_FMT_PEM);

  gnutls_certificate_set_x509_key_file (cert_cred, CERTFILE, KEYFILE,
					GNUTLS_X509_FMT_PEM);

  generate_dh_params ();
  generate_rsa_params ();

  if (TLS_SESSION_CACHE != 0)
    {
      wrap_db_init ();
    }

  gnutls_certificate_set_dh_params (cert_cred, dh_params);
  gnutls_certificate_set_rsa_export_params (cert_cred, rsa_params);

  /* Socket operations
   */
  listen_sd = socket (AF_INET, SOCK_STREAM, 0);
  SOCKET_ERR (listen_sd, "socket");

  memset (&amp;sa_serv, '\0', sizeof (sa_serv));
  sa_serv.sin_family = AF_INET;
  sa_serv.sin_addr.s_addr = INADDR_ANY;
  sa_serv.sin_port = htons (PORT);	/* Server Port number */

  setsockopt (listen_sd, SOL_SOCKET, SO_REUSEADDR, &amp;optval, sizeof (int));

  err = bind (listen_sd, (SA *) &amp; sa_serv, sizeof (sa_serv));
  SOCKET_ERR (err, "bind");
  err = listen (listen_sd, 1024);
  SOCKET_ERR (err, "listen");

  printf ("%s ready. Listening to port '%d'.\n\n", name, PORT);

  client_len = sizeof (sa_cli);
  for (;;)
    {
      session = initialize_tls_session ();

      sd = accept (listen_sd, (SA *) &amp; sa_cli, &amp;client_len);

      printf ("- connection from %s, port %d\n",
	      inet_ntop (AF_INET, &amp;sa_cli.sin_addr, topbuf,
			 sizeof (topbuf)), ntohs (sa_cli.sin_port));

      gnutls_transport_set_ptr (session, (gnutls_transport_ptr_t) sd);
      ret = gnutls_handshake (session);
      if (ret &lt; 0)
	{
	  close (sd);
	  gnutls_deinit (session);
	  fprintf (stderr, "*** Handshake has failed (%s)\n\n",
		   gnutls_strerror (ret));
	  continue;
	}
      printf ("- Handshake was completed\n");

      /* print_info(session); */

      i = 0;
      for (;;)
	{
	  memset (buffer, 0, MAX_BUF + 1);
	  ret = gnutls_record_recv (session, buffer, MAX_BUF);

	  if (ret == 0)
	    {
	      printf ("\n- Peer has closed the TLS connection\n");
	      break;
	    }
	  else if (ret &lt; 0)
	    {
	      fprintf (stderr, "\n*** Received corrupted "
		       "data(%d). Closing the connection.\n\n", ret);
	      break;
	    }
	  else if (ret > 0)
	    {
	      /* echo data back to the client
	       */
	      gnutls_record_send (session, buffer, strlen (buffer));
	    }
	}
      printf ("\n");
      /* do not wait for the peer to close the connection.
       */
      gnutls_bye (session, GNUTLS_SHUT_WR);

      close (sd);
      gnutls_deinit (session);

    }
  close (listen_sd);

  if (TLS_SESSION_CACHE != 0)
    {
      wrap_db_deinit ();
    }

  gnutls_certificate_free_credentials (cert_cred);

  gnutls_global_deinit ();

  return 0;

}


/* Functions and other stuff needed for session resuming.
 * This is done using a very simple list which holds session ids
 * and session data.
 */

#define MAX_SESSION_ID_SIZE 32
#define MAX_SESSION_DATA_SIZE 512

typedef struct
{
  char session_id[MAX_SESSION_ID_SIZE];
  int session_id_size;

  char session_data[MAX_SESSION_DATA_SIZE];
  int session_data_size;
} CACHE;

static CACHE *cache_db;
static int cache_db_ptr = 0;

static void
wrap_db_init (void)
{

  /* allocate cache_db */
  cache_db = calloc (1, TLS_SESSION_CACHE * sizeof (CACHE));
}

static void
wrap_db_deinit (void)
{
  if (cache_db)
    free (cache_db);
  cache_db = NULL;
  return;
}

static int
wrap_db_store (void *dbf, gnutls_datum_t key, gnutls_datum_t data)
{

  if (cache_db == NULL)
    return -1;

  if (key.size > MAX_SESSION_ID_SIZE)
    return -1;
  if (data.size > MAX_SESSION_DATA_SIZE)
    return -1;

  memcpy (cache_db[cache_db_ptr].session_id, key.data, key.size);
  cache_db[cache_db_ptr].session_id_size = key.size;

  memcpy (cache_db[cache_db_ptr].session_data, data.data, data.size);
  cache_db[cache_db_ptr].session_data_size = data.size;

  cache_db_ptr++;
  cache_db_ptr %= TLS_SESSION_CACHE;

  return 0;
}

static gnutls_datum_t
wrap_db_fetch (void *dbf, gnutls_datum_t key)
{
  gnutls_datum_t res = { NULL, 0 };
  int i;

  if (cache_db == NULL)
    return res;

  for (i = 0; i &lt; TLS_SESSION_CACHE; i++)
    {
      if (key.size == cache_db[i].session_id_size &amp;&amp;
	  memcmp (key.data, cache_db[i].session_id, key.size) == 0)
	{


	  res.size = cache_db[i].session_data_size;

	  res.data = gnutls_malloc (res.size);
	  if (res.data == NULL)
	    return res;

	  memcpy (res.data, cache_db[i].session_data, res.size);

	  return res;
	}
    }
  return res;
}

static int
wrap_db_delete (void *dbf, gnutls_datum_t key)
{
  int i;

  if (cache_db == NULL)
    return -1;

  for (i = 0; i &lt; TLS_SESSION_CACHE; i++)
    {
      if (key.size == cache_db[i].session_id_size &amp;&amp;
	  memcmp (key.data, cache_db[i].session_id, key.size) == 0)
	{

	  cache_db[i].session_id_size = 0;
	  cache_db[i].session_data_size = 0;

	  return 0;
	}
    }

  return -1;

}
</pre>
<div class="node">
<a name="Echo-Server-with-OpenPGP-authentication"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Echo-Server-with-SRP-authentication">Echo Server with SRP authentication</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Echo-Server-with-X_002e509-authentication-II">Echo Server with X.509 authentication II</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Server-examples">Server examples</a>

</div>

<h4 class="subsection">7.4.3 Echo Server with <acronym>OpenPGP</acronym> Authentication</h4>

<p><a name="index-g_t_0040acronym_007bOpenPGP_007d-Server-41"></a>
The following example is an echo server which supports
<acronym><acronym>OpenPGP</acronym></acronym> key authentication. You can easily combine
this functionality &mdash;that is have a server that supports both
<acronym>X.509</acronym> and <acronym>OpenPGP</acronym> certificates&mdash; but we separated
them to keep these examples as simple as possible.

<pre class="verbatim">/* Copyright 2007, 2008 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;errno.h>
#include &lt;sys/types.h>
#include &lt;sys/socket.h>
#include &lt;arpa/inet.h>
#include &lt;netinet/in.h>
#include &lt;string.h>
#include &lt;unistd.h>
#include &lt;gnutls/gnutls.h>
#include &lt;gnutls/openpgp.h>

#define KEYFILE "secret.asc"
#define CERTFILE "public.asc"
#define RINGFILE "ring.gpg"

/* This is a sample TLS 1.0-OpenPGP echo server.
 */


#define SA struct sockaddr
#define SOCKET_ERR(err,s) if(err==-1) {perror(s);return(1);}
#define MAX_BUF 1024
#define PORT 5556		/* listen to 5556 port */
#define DH_BITS 1024

/* These are global */
gnutls_certificate_credentials_t cred;
gnutls_dh_params_t dh_params;

static int
generate_dh_params (void)
{

  /* Generate Diffie Hellman parameters - for use with DHE
   * kx algorithms. These should be discarded and regenerated
   * once a day, once a week or once a month. Depending on the
   * security requirements.
   */
  gnutls_dh_params_init (&amp;dh_params);
  gnutls_dh_params_generate2 (dh_params, DH_BITS);

  return 0;
}

static gnutls_session_t
initialize_tls_session (void)
{
  gnutls_session_t session;

  gnutls_init (&amp;session, GNUTLS_SERVER);

  gnutls_priority_set_direct (session, "NORMAL", NULL);

  /* request client certificate if any.
   */
  gnutls_certificate_server_set_request (session, GNUTLS_CERT_REQUEST);

  gnutls_dh_set_prime_bits (session, DH_BITS);

  return session;
}

int
main (void)
{
  int err, listen_sd, i;
  int sd, ret;
  struct sockaddr_in sa_serv;
  struct sockaddr_in sa_cli;
  int client_len;
  char topbuf[512];
  gnutls_session_t session;
  char buffer[MAX_BUF + 1];
  int optval = 1;
  char name[256];

  strcpy (name, "Echo Server");

  /* this must be called once in the program
   */
  gnutls_global_init ();

  gnutls_certificate_allocate_credentials (&amp;cred);
  gnutls_certificate_set_openpgp_keyring_file (cred, RINGFILE,
					       GNUTLS_OPENPGP_FMT_BASE64);

  gnutls_certificate_set_openpgp_key_file (cred, CERTFILE, KEYFILE,
					   GNUTLS_OPENPGP_FMT_BASE64);

  generate_dh_params ();

  gnutls_certificate_set_dh_params (cred, dh_params);

  /* Socket operations
   */
  listen_sd = socket (AF_INET, SOCK_STREAM, 0);
  SOCKET_ERR (listen_sd, "socket");

  memset (&amp;sa_serv, '\0', sizeof (sa_serv));
  sa_serv.sin_family = AF_INET;
  sa_serv.sin_addr.s_addr = INADDR_ANY;
  sa_serv.sin_port = htons (PORT);	/* Server Port number */

  setsockopt (listen_sd, SOL_SOCKET, SO_REUSEADDR, &amp;optval, sizeof (int));

  err = bind (listen_sd, (SA *) &amp; sa_serv, sizeof (sa_serv));
  SOCKET_ERR (err, "bind");
  err = listen (listen_sd, 1024);
  SOCKET_ERR (err, "listen");

  printf ("%s ready. Listening to port '%d'.\n\n", name, PORT);

  client_len = sizeof (sa_cli);
  for (;;)
    {
      session = initialize_tls_session ();

      sd = accept (listen_sd, (SA *) &amp; sa_cli, &amp;client_len);

      printf ("- connection from %s, port %d\n",
	      inet_ntop (AF_INET, &amp;sa_cli.sin_addr, topbuf,
			 sizeof (topbuf)), ntohs (sa_cli.sin_port));

      gnutls_transport_set_ptr (session, (gnutls_transport_ptr_t) sd);
      ret = gnutls_handshake (session);
      if (ret &lt; 0)
	{
	  close (sd);
	  gnutls_deinit (session);
	  fprintf (stderr, "*** Handshake has failed (%s)\n\n",
		   gnutls_strerror (ret));
	  continue;
	}
      printf ("- Handshake was completed\n");

      /* see the Getting peer's information example */
      /* print_info(session); */

      i = 0;
      for (;;)
	{
	  memset (buffer, 0, MAX_BUF + 1);
	  ret = gnutls_record_recv (session, buffer, MAX_BUF);

	  if (ret == 0)
	    {
	      printf ("\n- Peer has closed the GNUTLS connection\n");
	      break;
	    }
	  else if (ret &lt; 0)
	    {
	      fprintf (stderr, "\n*** Received corrupted "
		       "data(%d). Closing the connection.\n\n", ret);
	      break;
	    }
	  else if (ret > 0)
	    {
	      /* echo data back to the client
	       */
	      gnutls_record_send (session, buffer, strlen (buffer));
	    }
	}
      printf ("\n");
      /* do not wait for the peer to close the connection.
       */
      gnutls_bye (session, GNUTLS_SHUT_WR);

      close (sd);
      gnutls_deinit (session);

    }
  close (listen_sd);

  gnutls_certificate_free_credentials (cred);

  gnutls_global_deinit ();

  return 0;

}
</pre>
<div class="node">
<a name="Echo-Server-with-SRP-authentication"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Echo-Server-with-anonymous-authentication">Echo Server with anonymous authentication</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Echo-Server-with-OpenPGP-authentication">Echo Server with OpenPGP authentication</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Server-examples">Server examples</a>

</div>

<h4 class="subsection">7.4.4 Echo Server with <acronym>SRP</acronym> Authentication</h4>

<p>This is a server which supports <acronym>SRP</acronym> authentication. It is
also possible to combine this functionality with a certificate
server. Here it is separate for simplicity.

<pre class="verbatim">/* Copyright 2007, 2008 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;errno.h>
#include &lt;sys/types.h>
#include &lt;sys/socket.h>
#include &lt;arpa/inet.h>
#include &lt;netinet/in.h>
#include &lt;string.h>
#include &lt;unistd.h>
#include &lt;gnutls/gnutls.h>
#include &lt;gnutls/extra.h>

#define SRP_PASSWD "tpasswd"
#define SRP_PASSWD_CONF "tpasswd.conf"

#define KEYFILE "key.pem"
#define CERTFILE "cert.pem"
#define CAFILE "ca.pem"

/* This is a sample TLS-SRP echo server.
 */

#define SA struct sockaddr
#define SOCKET_ERR(err,s) if(err==-1) {perror(s);return(1);}
#define MAX_BUF 1024
#define PORT 5556		/* listen to 5556 port */

/* These are global */
gnutls_srp_server_credentials_t srp_cred;
gnutls_certificate_credentials_t cert_cred;

static gnutls_session_t
initialize_tls_session (void)
{
  gnutls_session_t session;

  gnutls_init (&amp;session, GNUTLS_SERVER);

  gnutls_priority_set_direct (session, "NORMAL:+SRP:+SRP-DSS:+SRP-RSA", NULL);

  gnutls_credentials_set (session, GNUTLS_CRD_SRP, srp_cred);
  /* for the certificate authenticated ciphersuites.
   */
  gnutls_credentials_set (session, GNUTLS_CRD_CERTIFICATE, cert_cred);

  /* request client certificate if any.
   */
  gnutls_certificate_server_set_request (session, GNUTLS_CERT_IGNORE);

  return session;
}

int
main (void)
{
  int err, listen_sd, i;
  int sd, ret;
  struct sockaddr_in sa_serv;
  struct sockaddr_in sa_cli;
  int client_len;
  char topbuf[512];
  gnutls_session_t session;
  char buffer[MAX_BUF + 1];
  int optval = 1;
  char name[256];

  strcpy (name, "Echo Server");

  /* these must be called once in the program
   */
  gnutls_global_init ();
  gnutls_global_init_extra ();	/* for SRP */

  /* SRP_PASSWD a password file (created with the included srptool utility) 
   */
  gnutls_srp_allocate_server_credentials (&amp;srp_cred);
  gnutls_srp_set_server_credentials_file (srp_cred, SRP_PASSWD,
					  SRP_PASSWD_CONF);

  gnutls_certificate_allocate_credentials (&amp;cert_cred);
  gnutls_certificate_set_x509_trust_file (cert_cred, CAFILE,
					  GNUTLS_X509_FMT_PEM);
  gnutls_certificate_set_x509_key_file (cert_cred, CERTFILE, KEYFILE,
					GNUTLS_X509_FMT_PEM);

  /* TCP socket operations
   */
  listen_sd = socket (AF_INET, SOCK_STREAM, 0);
  SOCKET_ERR (listen_sd, "socket");

  memset (&amp;sa_serv, '\0', sizeof (sa_serv));
  sa_serv.sin_family = AF_INET;
  sa_serv.sin_addr.s_addr = INADDR_ANY;
  sa_serv.sin_port = htons (PORT);	/* Server Port number */

  setsockopt (listen_sd, SOL_SOCKET, SO_REUSEADDR, &amp;optval, sizeof (int));

  err = bind (listen_sd, (SA *) &amp; sa_serv, sizeof (sa_serv));
  SOCKET_ERR (err, "bind");
  err = listen (listen_sd, 1024);
  SOCKET_ERR (err, "listen");

  printf ("%s ready. Listening to port '%d'.\n\n", name, PORT);

  client_len = sizeof (sa_cli);
  for (;;)
    {
      session = initialize_tls_session ();

      sd = accept (listen_sd, (SA *) &amp; sa_cli, &amp;client_len);

      printf ("- connection from %s, port %d\n",
	      inet_ntop (AF_INET, &amp;sa_cli.sin_addr, topbuf,
			 sizeof (topbuf)), ntohs (sa_cli.sin_port));

      gnutls_transport_set_ptr (session, (gnutls_transport_ptr_t) sd);
      ret = gnutls_handshake (session);
      if (ret &lt; 0)
	{
	  close (sd);
	  gnutls_deinit (session);
	  fprintf (stderr, "*** Handshake has failed (%s)\n\n",
		   gnutls_strerror (ret));
	  continue;
	}
      printf ("- Handshake was completed\n");

      /* print_info(session); */

      i = 0;
      for (;;)
	{
	  memset (buffer, 0, MAX_BUF + 1);
	  ret = gnutls_record_recv (session, buffer, MAX_BUF);

	  if (ret == 0)
	    {
	      printf ("\n- Peer has closed the GNUTLS connection\n");
	      break;
	    }
	  else if (ret &lt; 0)
	    {
	      fprintf (stderr, "\n*** Received corrupted "
		       "data(%d). Closing the connection.\n\n", ret);
	      break;
	    }
	  else if (ret > 0)
	    {
	      /* echo data back to the client
	       */
	      gnutls_record_send (session, buffer, strlen (buffer));
	    }
	}
      printf ("\n");
      /* do not wait for the peer to close the connection. */
      gnutls_bye (session, GNUTLS_SHUT_WR);

      close (sd);
      gnutls_deinit (session);

    }
  close (listen_sd);

  gnutls_srp_free_server_credentials (srp_cred);
  gnutls_certificate_free_credentials (cert_cred);

  gnutls_global_deinit ();

  return 0;

}
</pre>
<div class="node">
<a name="Echo-Server-with-anonymous-authentication"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Echo-Server-with-SRP-authentication">Echo Server with SRP authentication</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Server-examples">Server examples</a>

</div>

<h4 class="subsection">7.4.5 Echo Server with Anonymous Authentication</h4>

<p>This example server support anonymous authentication, and could be
used to serve the example client for anonymous authentication.

<pre class="verbatim">/* Copyright 2007, 2008 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;errno.h>
#include &lt;sys/types.h>
#include &lt;sys/socket.h>
#include &lt;arpa/inet.h>
#include &lt;netinet/in.h>
#include &lt;string.h>
#include &lt;unistd.h>
#include &lt;gnutls/gnutls.h>

/* This is a sample TLS 1.0 echo server, for anonymous authentication only.
 */


#define SA struct sockaddr
#define SOCKET_ERR(err,s) if(err==-1) {perror(s);return(1);}
#define MAX_BUF 1024
#define PORT 5556		/* listen to 5556 port */
#define DH_BITS 1024

/* These are global */
gnutls_anon_server_credentials_t anoncred;

static gnutls_session_t
initialize_tls_session (void)
{
  gnutls_session_t session;

  gnutls_init (&amp;session, GNUTLS_SERVER);

  gnutls_priority_set_direct (session, "NORMAL:+ANON-DH", NULL);

  gnutls_credentials_set (session, GNUTLS_CRD_ANON, anoncred);

  gnutls_dh_set_prime_bits (session, DH_BITS);

  return session;
}

static gnutls_dh_params_t dh_params;

static int
generate_dh_params (void)
{

  /* Generate Diffie Hellman parameters - for use with DHE
   * kx algorithms. These should be discarded and regenerated
   * once a day, once a week or once a month. Depending on the
   * security requirements.
   */
  gnutls_dh_params_init (&amp;dh_params);
  gnutls_dh_params_generate2 (dh_params, DH_BITS);

  return 0;
}

int
main (void)
{
  int err, listen_sd, i;
  int sd, ret;
  struct sockaddr_in sa_serv;
  struct sockaddr_in sa_cli;
  int client_len;
  char topbuf[512];
  gnutls_session_t session;
  char buffer[MAX_BUF + 1];
  int optval = 1;

  /* this must be called once in the program
   */
  gnutls_global_init ();

  gnutls_anon_allocate_server_credentials (&amp;anoncred);

  generate_dh_params ();

  gnutls_anon_set_server_dh_params (anoncred, dh_params);

  /* Socket operations
   */
  listen_sd = socket (AF_INET, SOCK_STREAM, 0);
  SOCKET_ERR (listen_sd, "socket");

  memset (&amp;sa_serv, '\0', sizeof (sa_serv));
  sa_serv.sin_family = AF_INET;
  sa_serv.sin_addr.s_addr = INADDR_ANY;
  sa_serv.sin_port = htons (PORT);	/* Server Port number */

  setsockopt (listen_sd, SOL_SOCKET, SO_REUSEADDR, &amp;optval, sizeof (int));

  err = bind (listen_sd, (SA *) &amp; sa_serv, sizeof (sa_serv));
  SOCKET_ERR (err, "bind");
  err = listen (listen_sd, 1024);
  SOCKET_ERR (err, "listen");

  printf ("Server ready. Listening to port '%d'.\n\n", PORT);

  client_len = sizeof (sa_cli);
  for (;;)
    {
      session = initialize_tls_session ();

      sd = accept (listen_sd, (SA *) &amp; sa_cli, &amp;client_len);

      printf ("- connection from %s, port %d\n",
	      inet_ntop (AF_INET, &amp;sa_cli.sin_addr, topbuf,
			 sizeof (topbuf)), ntohs (sa_cli.sin_port));

      gnutls_transport_set_ptr (session, (gnutls_transport_ptr_t) sd);
      ret = gnutls_handshake (session);
      if (ret &lt; 0)
	{
	  close (sd);
	  gnutls_deinit (session);
	  fprintf (stderr, "*** Handshake has failed (%s)\n\n",
		   gnutls_strerror (ret));
	  continue;
	}
      printf ("- Handshake was completed\n");

      /* see the Getting peer's information example */
      /* print_info(session); */

      i = 0;
      for (;;)
	{
	  memset (buffer, 0, MAX_BUF + 1);
	  ret = gnutls_record_recv (session, buffer, MAX_BUF);

	  if (ret == 0)
	    {
	      printf ("\n- Peer has closed the GNUTLS connection\n");
	      break;
	    }
	  else if (ret &lt; 0)
	    {
	      fprintf (stderr, "\n*** Received corrupted "
		       "data(%d). Closing the connection.\n\n", ret);
	      break;
	    }
	  else if (ret > 0)
	    {
	      /* echo data back to the client
	       */
	      gnutls_record_send (session, buffer, strlen (buffer));
	    }
	}
      printf ("\n");
      /* do not wait for the peer to close the connection.
       */
      gnutls_bye (session, GNUTLS_SHUT_WR);

      close (sd);
      gnutls_deinit (session);

    }
  close (listen_sd);

  gnutls_anon_free_server_credentials (anoncred);

  gnutls_global_deinit ();

  return 0;

}
</pre>
<div class="node">
<a name="Miscellaneous-examples"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Compatibility-with-the-OpenSSL-library">Compatibility with the OpenSSL library</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Server-examples">Server examples</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#How-to-use-GnuTLS-in-applications">How to use GnuTLS in applications</a>

</div>

<h3 class="section">7.5 Miscellaneous Examples</h3>

<ul class="menu">
<li><a accesskey="1" href="#Checking-for-an-alert">Checking for an alert</a>
<li><a accesskey="2" href="#X_002e509-certificate-parsing-example">X.509 certificate parsing example</a>
<li><a accesskey="3" href="#Certificate-request-generation">Certificate request generation</a>
<li><a accesskey="4" href="#PKCS-_002312-structure-generation">PKCS #12 structure generation</a>
</ul>

<div class="node">
<a name="Checking-for-an-alert"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#X_002e509-certificate-parsing-example">X.509 certificate parsing example</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Miscellaneous-examples">Miscellaneous examples</a>

</div>

<h4 class="subsection">7.5.1 Checking for an Alert</h4>

<p>This is a function that checks if an alert has been received in the
current session.

<pre class="verbatim">/* Copyright 2007 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;gnutls/gnutls.h>

/* This function will check whether the given return code from
 * a gnutls function (recv/send), is an alert, and will print
 * that alert.
 */
void
check_alert (gnutls_session_t session, int ret)
{
  int last_alert;

  if (ret == GNUTLS_E_WARNING_ALERT_RECEIVED
      || ret == GNUTLS_E_FATAL_ALERT_RECEIVED)
    {
      last_alert = gnutls_alert_get (session);

      /* The check for renegotiation is only useful if we are 
       * a server, and we had requested a rehandshake.
       */
      if (last_alert == GNUTLS_A_NO_RENEGOTIATION &amp;&amp;
	  ret == GNUTLS_E_WARNING_ALERT_RECEIVED)
	printf ("* Received NO_RENEGOTIATION alert. "
		"Client Does not support renegotiation.\n");
      else
	printf ("* Received alert '%d': %s.\n", last_alert,
		gnutls_alert_get_name (last_alert));
    }
}
</pre>
<div class="node">
<a name="X.509-certificate-parsing-example"></a>
<a name="X_002e509-certificate-parsing-example"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Certificate-request-generation">Certificate request generation</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Checking-for-an-alert">Checking for an alert</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Miscellaneous-examples">Miscellaneous examples</a>

</div>

<h4 class="subsection">7.5.2 <acronym>X.509</acronym> Certificate Parsing Example</h4>

<p><a name="ex_003ax509_002dinfo"></a>To demonstrate the <acronym>X.509</acronym> parsing capabilities an example program is
listed below.  That program reads the peer's certificate, and prints
information about it.

<pre class="verbatim">/* Copyright 2007, 2008 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;gnutls/gnutls.h>
#include &lt;gnutls/x509.h>

static const char *
bin2hex (const void *bin, size_t bin_size)
{
  static char printable[110];
  const unsigned char *_bin = bin;
  char *print;
  size_t i;

  if (bin_size > 50)
    bin_size = 50;

  print = printable;
  for (i = 0; i &lt; bin_size; i++)
    {
      sprintf (print, "%.2x ", _bin[i]);
      print += 2;
    }

  return printable;
}

/* This function will print information about this session's peer
 * certificate.
 */
void
print_x509_certificate_info (gnutls_session_t session)
{
  char serial[40];
  char dn[128];
  size_t size;
  unsigned int algo, bits;
  time_t expiration_time, activation_time;
  const gnutls_datum_t *cert_list;
  unsigned int cert_list_size = 0;
  gnutls_x509_crt_t cert;

  /* This function only works for X.509 certificates.
   */
  if (gnutls_certificate_type_get (session) != GNUTLS_CRT_X509)
    return;

  cert_list = gnutls_certificate_get_peers (session, &amp;cert_list_size);

  printf ("Peer provided %d certificates.\n", cert_list_size);

  if (cert_list_size > 0)
    {

      /* we only print information about the first certificate.
       */
      gnutls_x509_crt_init (&amp;cert);

      gnutls_x509_crt_import (cert, &amp;cert_list[0], GNUTLS_X509_FMT_DER);

      printf ("Certificate info:\n");

      expiration_time = gnutls_x509_crt_get_expiration_time (cert);
      activation_time = gnutls_x509_crt_get_activation_time (cert);

      printf ("\tCertificate is valid since: %s", ctime (&amp;activation_time));
      printf ("\tCertificate expires: %s", ctime (&amp;expiration_time));

      /* Print the serial number of the certificate.
       */
      size = sizeof (serial);
      gnutls_x509_crt_get_serial (cert, serial, &amp;size);

      printf ("\tCertificate serial number: %s\n", bin2hex (serial, size));

      /* Extract some of the public key algorithm's parameters
       */
      algo = gnutls_x509_crt_get_pk_algorithm (cert, &amp;bits);

      printf ("Certificate public key: %s",
	      gnutls_pk_algorithm_get_name (algo));

      /* Print the version of the X.509 
       * certificate.
       */
      printf ("\tCertificate version: #%d\n",
	      gnutls_x509_crt_get_version (cert));

      size = sizeof (dn);
      gnutls_x509_crt_get_dn (cert, dn, &amp;size);
      printf ("\tDN: %s\n", dn);

      size = sizeof (dn);
      gnutls_x509_crt_get_issuer_dn (cert, dn, &amp;size);
      printf ("\tIssuer's DN: %s\n", dn);

      gnutls_x509_crt_deinit (cert);

    }
}
</pre>
<div class="node">
<a name="Certificate-request-generation"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#PKCS-_002312-structure-generation">PKCS #12 structure generation</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#X_002e509-certificate-parsing-example">X.509 certificate parsing example</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Miscellaneous-examples">Miscellaneous examples</a>

</div>

<h4 class="subsection">7.5.3 Certificate Request Generation</h4>

<p><a name="ex_003acrq"></a>The following example is about generating a certificate request, and a
private key. A certificate request can be later be processed by a CA,
which should return a signed certificate.

<pre class="verbatim">/* Copyright 2007 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;string.h>
#include &lt;gnutls/gnutls.h>
#include &lt;gnutls/x509.h>
#include &lt;time.h>

/* This example will generate a private key and a certificate
 * request.
 */

int
main (void)
{
  gnutls_x509_crq_t crq;
  gnutls_x509_privkey_t key;
  unsigned char buffer[10 * 1024];
  size_t buffer_size = sizeof (buffer);

  gnutls_global_init ();

  /* Initialize an empty certificate request, and
   * an empty private key.
   */
  gnutls_x509_crq_init (&amp;crq);

  gnutls_x509_privkey_init (&amp;key);

  /* Generate a 1024 bit RSA private key.
   */
  gnutls_x509_privkey_generate (key, GNUTLS_PK_RSA, 1024, 0);

  /* Add stuff to the distinguished name
   */
  gnutls_x509_crq_set_dn_by_oid (crq, GNUTLS_OID_X520_COUNTRY_NAME,
				 0, "GR", 2);

  gnutls_x509_crq_set_dn_by_oid (crq, GNUTLS_OID_X520_COMMON_NAME,
				 0, "Nikos", strlen ("Nikos"));

  /* Set the request version.
   */
  gnutls_x509_crq_set_version (crq, 1);

  /* Set a challenge password.
   */
  gnutls_x509_crq_set_challenge_password (crq, "something to remember here");

  /* Associate the request with the private key
   */
  gnutls_x509_crq_set_key (crq, key);

  /* Self sign the certificate request.
   */
  gnutls_x509_crq_sign (crq, key);

  /* Export the PEM encoded certificate request, and
   * display it.
   */
  gnutls_x509_crq_export (crq, GNUTLS_X509_FMT_PEM, buffer, &amp;buffer_size);

  printf ("Certificate Request: \n%s", buffer);


  /* Export the PEM encoded private key, and
   * display it.
   */
  buffer_size = sizeof (buffer);
  gnutls_x509_privkey_export (key, GNUTLS_X509_FMT_PEM, buffer, &amp;buffer_size);

  printf ("\n\nPrivate key: \n%s", buffer);

  gnutls_x509_crq_deinit (crq);
  gnutls_x509_privkey_deinit (key);

  return 0;

}
</pre>
<div class="node">
<a name="PKCS-%2312-structure-generation"></a>
<a name="PKCS-_002312-structure-generation"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Certificate-request-generation">Certificate request generation</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Miscellaneous-examples">Miscellaneous examples</a>

</div>

<h4 class="subsection">7.5.4 <acronym>PKCS</acronym> #12 Structure Generation</h4>

<p><a name="ex_003apkcs12"></a>The following example is about generating a <acronym>PKCS</acronym> #12
structure.

<pre class="verbatim">/* Copyright 2007 Free Software Foundation
 *
 * Copying and distribution of this file, with or without modification,
 * are permitted in any medium without royalty provided the copyright
 * notice and this notice are preserved.
 */

#ifdef HAVE_CONFIG_H
# include &lt;config.h>
#endif

#include &lt;stdio.h>
#include &lt;stdlib.h>
#include &lt;gnutls/gnutls.h>
#include &lt;gnutls/pkcs12.h>

#define OUTFILE "out.p12"

/* This function will write a pkcs12 structure into a file.
 * cert: is a DER encoded certificate
 * pkcs8_key: is a PKCS #8 encrypted key (note that this must be
 *  encrypted using a PKCS #12 cipher, or some browsers will crash)
 * password: is the password used to encrypt the PKCS #12 packet.
 */
int
write_pkcs12 (const gnutls_datum_t * cert,
	      const gnutls_datum_t * pkcs8_key, const char *password)
{
  gnutls_pkcs12_t pkcs12;
  int ret, bag_index;
  gnutls_pkcs12_bag_t bag, key_bag;
  char pkcs12_struct[10 * 1024];
  size_t pkcs12_struct_size;
  FILE *fd;

  /* A good idea might be to use gnutls_x509_privkey_get_key_id()
   * to obtain a unique ID.
   */
  gnutls_datum_t key_id = { "\x00\x00\x07", 3 };

  gnutls_global_init ();

  /* Firstly we create two helper bags, which hold the certificate,
   * and the (encrypted) key.
   */

  gnutls_pkcs12_bag_init (&amp;bag);
  gnutls_pkcs12_bag_init (&amp;key_bag);

  ret = gnutls_pkcs12_bag_set_data (bag, GNUTLS_BAG_CERTIFICATE, cert);
  if (ret &lt; 0)
    {
      fprintf (stderr, "ret: %s\n", gnutls_strerror (ret));
      return 1;
    }

  /* ret now holds the bag's index.
   */
  bag_index = ret;

  /* Associate a friendly name with the given certificate. Used
   * by browsers.
   */
  gnutls_pkcs12_bag_set_friendly_name (bag, bag_index, "My name");

  /* Associate the certificate with the key using a unique key
   * ID.
   */
  gnutls_pkcs12_bag_set_key_id (bag, bag_index, &amp;key_id);

  /* use weak encryption for the certificate. 
   */
  gnutls_pkcs12_bag_encrypt (bag, password, GNUTLS_PKCS_USE_PKCS12_RC2_40);

  /* Now the key.
   */

  ret = gnutls_pkcs12_bag_set_data (key_bag,
				    GNUTLS_BAG_PKCS8_ENCRYPTED_KEY,
				    pkcs8_key);
  if (ret &lt; 0)
    {
      fprintf (stderr, "ret: %s\n", gnutls_strerror (ret));
      return 1;
    }

  /* Note that since the PKCS #8 key is already encrypted we don't
   * bother encrypting that bag.
   */
  bag_index = ret;

  gnutls_pkcs12_bag_set_friendly_name (key_bag, bag_index, "My name");

  gnutls_pkcs12_bag_set_key_id (key_bag, bag_index, &amp;key_id);


  /* The bags were filled. Now create the PKCS #12 structure.
   */
  gnutls_pkcs12_init (&amp;pkcs12);

  /* Insert the two bags in the PKCS #12 structure.
   */

  gnutls_pkcs12_set_bag (pkcs12, bag);
  gnutls_pkcs12_set_bag (pkcs12, key_bag);


  /* Generate a message authentication code for the PKCS #12
   * structure.
   */
  gnutls_pkcs12_generate_mac (pkcs12, password);

  pkcs12_struct_size = sizeof (pkcs12_struct);
  ret =
    gnutls_pkcs12_export (pkcs12, GNUTLS_X509_FMT_DER, pkcs12_struct,
			  &amp;pkcs12_struct_size);
  if (ret &lt; 0)
    {
      fprintf (stderr, "ret: %s\n", gnutls_strerror (ret));
      return 1;
    }

  fd = fopen (OUTFILE, "w");
  if (fd == NULL)
    {
      fprintf (stderr, "cannot open file\n");
      return 1;
    }
  fwrite (pkcs12_struct, 1, pkcs12_struct_size, fd);
  fclose (fd);

  gnutls_pkcs12_bag_deinit (bag);
  gnutls_pkcs12_bag_deinit (key_bag);
  gnutls_pkcs12_deinit (pkcs12);

  return 0;
}
</pre>
<div class="node">
<a name="Compatibility-with-the-OpenSSL-library"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Opaque-PRF-Input-TLS-Extension">Opaque PRF Input TLS Extension</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Miscellaneous-examples">Miscellaneous examples</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#How-to-use-GnuTLS-in-applications">How to use GnuTLS in applications</a>

</div>

<h3 class="section">7.6 Compatibility with the OpenSSL Library</h3>

<p><a name="index-OpenSSL-42"></a>
To ease <acronym>GnuTLS</acronym>' integration with existing applications, a
compatibility layer with the widely used OpenSSL library is included
in the <code>gnutls-openssl</code> library. This compatibility layer is not
complete and it is not intended to completely reimplement the OpenSSL
API with <acronym>GnuTLS</acronym>.  It only provides source-level
compatibility. There is currently no attempt to make it
binary-compatible with OpenSSL.

<p>The prototypes for the compatibility functions are in the
<samp><span class="file">gnutls/openssl.h</span></samp> header file.

<p>Current limitations imposed by the compatibility layer include:

     <ul>
<li>Error handling is not thread safe.

</ul>

<div class="node">
<a name="Opaque-PRF-Input-TLS-Extension"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Compatibility-with-the-OpenSSL-library">Compatibility with the OpenSSL library</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#How-to-use-GnuTLS-in-applications">How to use GnuTLS in applications</a>

</div>

<h3 class="section">7.7 Opaque PRF Input TLS Extension</h3>

<p><a name="index-Opaque-PRF-Input-43"></a>
GnuTLS supports the Opaque PRF Input TLS extension
(<code>draft-rescorla-tls-opaque-prf-input-00.txt</code>).  The API consists
of one API for use in the client, <a href="#gnutls_005foprfi_005fenable_005fclient">gnutls_oprfi_enable_client</a>,
and one API for use in the server, <a href="#gnutls_005foprfi_005fenable_005fserver">gnutls_oprfi_enable_server</a>. 
You must invoke both functions before calling <a href="#gnutls_005fhandshake">gnutls_handshake</a>. 
The server utilizes a callback function into the application.  The
callback can look at the random string provided by the client, and
also set the server string.  The string lengths must be equal
according to the protocol.

<div class="node">
<a name="Included-programs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-reference">Function reference</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#How-to-use-GnuTLS-in-applications">How to use GnuTLS in applications</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">8 Included Programs</h2>

<p>Included with <acronym>GnuTLS</acronym> are also a few command line tools that
let you use the library for common tasks without writing an
application.  The applications are discussed in this chapter.

<ul class="menu">
<li><a accesskey="1" href="#Invoking-certtool">Invoking certtool</a>
<li><a accesskey="2" href="#Invoking-gnutls_002dcli">Invoking gnutls-cli</a>
<li><a accesskey="3" href="#Invoking-gnutls_002dcli_002ddebug">Invoking gnutls-cli-debug</a>
<li><a accesskey="4" href="#Invoking-gnutls_002dserv">Invoking gnutls-serv</a>
<li><a accesskey="5" href="#Invoking-psktool">Invoking psktool</a>
<li><a accesskey="6" href="#Invoking-srptool">Invoking srptool</a>
</ul>

<div class="node">
<a name="Invoking-certtool"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Invoking-gnutls_002dcli">Invoking gnutls-cli</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Included-programs">Included programs</a>

</div>

<h3 class="section">8.1 Invoking certtool</h3>

<p><a name="index-certtool-44"></a>
This is a program to generate <acronym>X.509</acronym> certificates, certificate
requests, CRLs and private keys.

<pre class="verbatim">Certtool help
Usage: certtool [options]
     -s, --generate-self-signed
                              Generate a self-signed certificate.
     -c, --generate-certificate
                              Generate a signed certificate.
     --generate-proxy         Generate a proxy certificate.
     --generate-crl           Generate a CRL.
     -u, --update-certificate
                              Update a signed certificate.
     -p, --generate-privkey   Generate a private key.
     -q, --generate-request   Generate a PKCS #10 certificate
                              request.
     -e, --verify-chain       Verify a PEM encoded certificate chain.
                              The last certificate in the chain must
                              be a self signed one.
     --verify-crl             Verify a CRL.
     --generate-dh-params     Generate PKCS #3 encoded Diffie Hellman
                              parameters.
     --get-dh-params          Get the included PKCS #3 encoded Diffie
                              Hellman parameters.
     --load-privkey FILE      Private key file to use.
     --load-request FILE      Certificate request file to use.
     --load-certificate FILE
                              Certificate file to use.
     --load-ca-privkey FILE   Certificate authority's private key
                              file to use.
     --load-ca-certificate FILE
                              Certificate authority's certificate
                              file to use.
     --password PASSWORD      Password to use.
     -i, --certificate-info   Print information on a certificate.
     -l, --crl-info           Print information on a CRL.
     --p12-info               Print information on a PKCS #12
                              structure.
     --p7-info                Print information on a PKCS #7
                              structure.
     --smime-to-p7            Convert S/MIME to PKCS #7 structure.
     -k, --key-info           Print information on a private key.
     --fix-key                Regenerate the parameters in a private
                              key.
     --to-p12                 Generate a PKCS #12 structure.
     -8, --pkcs8              Use PKCS #8 format for private keys.
     --dsa                    Use DSA keys.
     --hash STR               Hash algorithm to use for signing
                              (MD5,SHA1,RMD160).
     --export-ciphers         Use weak encryption algorithms.
     --inder                  Use DER format for input certificates
                              and private keys.
     --outder                 Use DER format for output certificates
                              and private keys.
     --bits BITS              specify the number of bits for key
                              generation.
     --outfile FILE           Output file.
     --infile FILE            Input file.
     --template FILE          Template file to use for non
                              interactive operation.
     -d, --debug LEVEL        specify the debug level. Default is 1.
     -h, --help               shows this help text
     -v, --version            shows the program's version
</pre>

<p>The program can be used interactively or non interactively by
specifying the <code>--template</code> command line option. See below for an
example of a template file.

<p>How to use certtool interactively:

     <ul>
<li>To generate parameters for Diffie Hellman key exchange, use the command:
     <pre class="example">          $ certtool --generate-dh-params --outfile dh.pem
</pre>
     <li>To generate parameters for the RSA-EXPORT key exchange, use the command:
     <pre class="example">          $ certtool --generate-privkey --bits 512 --outfile rsa.pem
</pre>
     </ul>

     <ul>
<li>To create a self signed certificate, use the command:
     <pre class="example">          $ certtool --generate-privkey --outfile ca-key.pem
          $ certtool --generate-self-signed --load-privkey ca-key.pem \
             --outfile ca-cert.pem
</pre>
     <p>Note that a self-signed certificate usually belongs to a certificate
authority, that signs other certificates.

     <li>To create a private key, run:

     <pre class="example">          $ certtool --generate-privkey --outfile key.pem
</pre>
     <li>To generate a certificate using the private key, use the command:

     <pre class="example">          $ certtool --generate-certificate --load-privkey key.pem \
             --outfile cert.pem --load-ca-certificate ca-cert.pem \
             --load-ca-privkey ca-key.pem
</pre>
     <li>To create a certificate request (needed when the certificate is issued by
another party), run:

     <pre class="example">          $ certtool --generate-request --load-privkey key.pem \
            --outfile request.pem
</pre>
     <li>To generate a certificate using the previous request, use the command:

     <pre class="example">          $ certtool --generate-certificate --load-request request.pem \
             --outfile cert.pem \
             --load-ca-certificate ca-cert.pem --load-ca-privkey ca-key.pem
</pre>
     <li>To view the certificate information, use:

     <pre class="example">          $ certtool --certificate-info --infile cert.pem
</pre>
     <li>To generate a <acronym>PKCS</acronym> #12 structure using the previous key and
certificate, use the command:

     <pre class="example">          $ certtool --load-certificate cert.pem --load-privkey key.pem \
            --to-p12 --outder --outfile key.p12
</pre>
     <li>Proxy certificate can be used to delegate your credential to a
temporary, typically short-lived, certificate.  To create one from the
previously created certificate, first create a temporary key and then
generate a proxy certificate for it, using the commands:

     <pre class="example">          $ certtool --generate-privkey &gt; proxy-key.pem
          $ certtool --generate-proxy --load-ca-privkey key.pem \
            --load-privkey proxy-key.pem --load-certificate cert.pem \
            --outfile proxy-cert.pem
</pre>
     <li>To create an empty Certificate Revocation List (CRL) do:

     <pre class="example">          $ certtool --generate-crl --load-ca-privkey x509-ca-key.pem --load-ca-certificate x509-ca.pem
</pre>
     <p>To create a CRL that contains some revoked certificates, place the
certificates in a file and use <code>--load-certificate</code> as follows:

     <pre class="example">          $ certtool --generate-crl --load-ca-privkey x509-ca-key.pem --load-ca-certificate x509-ca.pem --load-certificate revoked-certs.pem
</pre>
     <li>To verify a Certificate Revocation List (CRL) do:

     <pre class="example">          $ certtool --verify-crl --load-ca-certificate x509-ca.pem &lt; crl.pem
</pre>
     </ul>

<p>Certtool's template file format:

     <ul>
<li>Firstly create a file named 'cert.cfg' that contains the information
about the certificate. An example file is listed below.

     <li>Then execute:

     <pre class="example">          $ certtool --generate-certificate cert.pem --load-privkey key.pem  \
             --template cert.cfg \
             --load-ca-certificate ca-cert.pem --load-ca-privkey ca-key.pem
</pre>
     </ul>

<p>An example certtool template file:

<pre class="example">     # X.509 Certificate options
     #
     # DN options
     
     # The organization of the subject.
     organization = "Koko inc."
     
     # The organizational unit of the subject.
     unit = "sleeping dept."
     
     # The locality of the subject.
     # locality =
     
     # The state of the certificate owner.
     state = "Attiki"
     
     # The country of the subject. Two letter code.
     country = GR
     
     # The common name of the certificate owner.
     cn = "Cindy Lauper"
     
     # A user id of the certificate owner.
     #uid = "clauper"
     
     # If the supported DN OIDs are not adequate you can set
     # any OID here.
     # For example set the X.520 Title and the X.520 Pseudonym
     # by using OID and string pairs.
     #dn_oid = "2.5.4.12" "Dr." "2.5.4.65" "jackal"
     
     # This is deprecated and should not be used in new
     # certificates.
     # pkcs9_email = "none@none.org"
     
     # The serial number of the certificate
     serial = 007
     
     # In how many days, counting from today, this certificate will expire.
     expiration_days = 700
     
     # X.509 v3 extensions
     
     # A dnsname in case of a WWW server.
     #dns_name = "www.none.org"
     #dns_name = "www.morethanone.org"
     
     # An IP address in case of a server.
     #ip_address = "192.168.1.1"
     
     # An email in case of a person
     email = "none@none.org"
     
     # An URL that has CRLs (certificate revocation lists)
     # available. Needed in CA certificates.
     #crl_dist_points = "http://www.getcrl.crl/getcrl/"
     
     # Whether this is a CA certificate or not
     #ca
     
     # Whether this certificate will be used for a TLS client
     #tls_www_client
     
     # Whether this certificate will be used for a TLS server
     #tls_www_server
     
     # Whether this certificate will be used to sign data (needed
     # in TLS DHE ciphersuites).
     signing_key
     
     # Whether this certificate will be used to encrypt data (needed
     # in TLS RSA ciphersuites). Note that it is prefered to use different
     # keys for encryption and signing.
     #encryption_key
     
     # Whether this key will be used to sign other certificates.
     #cert_signing_key
     
     # Whether this key will be used to sign CRLs.
     #crl_signing_key
     
     # Whether this key will be used to sign code.
     #code_signing_key
     
     # Whether this key will be used to sign OCSP data.
     #ocsp_signing_key
     
     # Whether this key will be used for time stamping.
     #time_stamping_key
</pre>
<div class="node">
<a name="Invoking-gnutls-cli"></a>
<a name="Invoking-gnutls_002dcli"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Invoking-gnutls_002dcli_002ddebug">Invoking gnutls-cli-debug</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Invoking-certtool">Invoking certtool</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Included-programs">Included programs</a>

</div>

<h3 class="section">8.2 Invoking gnutls-cli</h3>

<p><a name="index-gnutls_002dcli-45"></a>
Simple client program to set up a TLS connection to some other
computer.  It sets up a TLS connection and forwards data from the
standard input to the secured socket and vice versa.

<pre class="verbatim">GNU TLS test client
Usage:  gnutls-cli [options] hostname

     -d, --debug integer      Enable debugging
     -r, --resume             Connect, establish a session. Connect
                              again and resume this session.
     -s, --starttls           Connect, establish a plain session and
                              start TLS when EOF or a SIGALRM is
                              received.
     --crlf                   Send CR LF instead of LF.
     --x509fmtder             Use DER format for certificates to read
                              from.
     -f, --fingerprint        Send the openpgp fingerprint, instead
                              of the key.
     --disable-extensions     Disable all the TLS extensions.
     --print-cert             Print the certificate in PEM format.
     -p, --port integer       The port to connect to.
     --recordsize integer     The maximum record size to advertize.
     -V, --verbose            More verbose output.
     --ciphers cipher1 cipher2...
                              Ciphers to enable.
     --protocols protocol1 protocol2...
                              Protocols to enable.
     --comp comp1 comp2...    Compression methods to enable.
     --macs mac1 mac2...      MACs to enable.
     --kx kx1 kx2...          Key exchange methods to enable.
     --ctypes certType1 certType2...
                              Certificate types to enable.
     --x509cafile FILE        Certificate file to use.
     --x509crlfile FILE       CRL file to use.
     --pgpkeyfile FILE        PGP Key file to use.
     --pgpkeyring FILE        PGP Key ring file to use.
     --pgptrustdb FILE        PGP trustdb file to use.
     --pgpcertfile FILE       PGP Public Key (certificate) file to
                              use.
     --x509keyfile FILE       X.509 key file to use.
     --x509certfile FILE      X.509 Certificate file to use.
     --srpusername NAME       SRP username to use.
     --srppasswd PASSWD       SRP password to use.
     --insecure               Don't abort program if server
                              certificate can't be validated.
     -l, --list               Print a list of the supported
                              algorithms  and modes.
     -h, --help               prints this help
     -v, --version            prints the program's version number
</pre>

<p>To connect to a server using PSK authentication, you may use something
like:

<pre class="smallexample">     $ gnutls-cli -p 5556 test.gnutls.org --pskusername jas --pskkey 9e32cf7786321a828ef7668f09fb35db --priority NORMAL:+PSK:-RSA:-DHE-RSA -d 4711
</pre>
<ul class="menu">
<li><a accesskey="1" href="#Example-client-PSK-connection">Example client PSK connection</a>
</ul>

<div class="node">
<a name="Example-client-PSK-connection"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#Invoking-gnutls_002dcli">Invoking gnutls-cli</a>

</div>

<h4 class="subsection">8.2.1 Example client PSK connection</h4>

<p><a name="index-PSK-client-46"></a>
If your server only supports the PSK ciphersuite, connecting to it
should be as simple as connecting to the server:

<pre class="smallexample">     $ ./gnutls-cli -p 5556 localhost
     Resolving 'localhost'...
     Connecting to '127.0.0.1:5556'...
     - PSK client callback. PSK hint 'psk_identity_hint'
     Enter PSK identity: psk_identity
     Enter password:
     - PSK authentication. PSK hint 'psk_identity_hint'
     - Version: TLS1.1
     - Key Exchange: PSK
     - Cipher: AES-128-CBC
     - MAC: SHA1
     - Compression: NULL
     - Handshake was completed
     
     - Simple Client Mode:
</pre>
<p>If the server supports several cipher suites, you may need to force it
to chose PSK by using a cipher priority parameter such as
<code>--priority NORMAL:+PSK:-RSA:-DHE-RSA:-DHE-PSK</code>.

<p><a name="index-Netconf-47"></a>Instead of using the Netconf-way to derive the PSK key from a
password, you can also give the PSK username and key directly on the
command line:

<pre class="smallexample">     $ ./gnutls-cli -p 5556 localhost --pskusername psk_identity --pskkey 88f3824b3e5659f52d00e959bacab954b6540344
     Resolving 'localhost'...
     Connecting to '127.0.0.1:5556'...
     - PSK authentication. PSK hint 'psk_identity_hint'
     - Version: TLS1.1
     - Key Exchange: PSK
     - Cipher: AES-128-CBC
     - MAC: SHA1
     - Compression: NULL
     - Handshake was completed
     
     - Simple Client Mode:
</pre>
<p>By keeping the <code>--pskusername</code> parameter and removing the
<code>--pskkey</code> parameter, it will query only for the password during
the handshake.

<div class="node">
<a name="Invoking-gnutls-cli-debug"></a>
<a name="Invoking-gnutls_002dcli_002ddebug"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Invoking-gnutls_002dserv">Invoking gnutls-serv</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Invoking-gnutls_002dcli">Invoking gnutls-cli</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Included-programs">Included programs</a>

</div>

<h3 class="section">8.3 Invoking gnutls-cli-debug</h3>

<p><a name="index-gnutls_002dcli_002ddebug-48"></a>
This program was created to assist in debugging <acronym>GnuTLS</acronym>, but
it might be useful to extract a <acronym>TLS</acronym> server's capabilities. 
It's purpose is to connect onto a <acronym>TLS</acronym> server, perform some
tests and print the server's capabilities. If called with the `-v'
parameter a more checks will be performed. An example output is:

<pre class="smallexample">     crystal:/cvs/gnutls/src$ ./gnutls-cli-debug localhost -p 5556
     Resolving 'localhost'...
     Connecting to '127.0.0.1:5556'...
     Checking for TLS 1.1 support... yes
     Checking fallback from TLS 1.1 to... N/A
     Checking for TLS 1.0 support... yes
     Checking for SSL 3.0 support... yes
     Checking for version rollback bug in RSA PMS... no
     Checking for version rollback bug in Client Hello... no
     Checking whether we need to disable TLS 1.0... N/A
     Checking whether the server ignores the RSA PMS version... no
     Checking whether the server can accept Hello Extensions... yes
     Checking whether the server can accept cipher suites not in SSL 3.0 spec... yes
     Checking whether the server can accept a bogus TLS record version in the client hello... yes
     Checking for certificate information... N/A
     Checking for trusted CAs... N/A
     Checking whether the server understands TLS closure alerts... yes
     Checking whether the server supports session resumption... yes
     Checking for export-grade ciphersuite support... no
     Checking RSA-export ciphersuite info... N/A
     Checking for anonymous authentication support... no
     Checking anonymous Diffie Hellman group info... N/A
     Checking for ephemeral Diffie Hellman support... no
     Checking ephemeral Diffie Hellman group info... N/A
     Checking for AES cipher support (TLS extension)... yes
     Checking for 3DES cipher support... yes
     Checking for ARCFOUR 128 cipher support... yes
     Checking for ARCFOUR 40 cipher support... no
     Checking for MD5 MAC support... yes
     Checking for SHA1 MAC support... yes
     Checking for ZLIB compression support (TLS extension)... yes
     Checking for LZO compression support (GnuTLS extension)... yes
     Checking for max record size (TLS extension)... yes
     Checking for SRP authentication support (TLS extension)... yes
     Checking for OpenPGP authentication support (TLS extension)... no
</pre>
<div class="node">
<a name="Invoking-gnutls-serv"></a>
<a name="Invoking-gnutls_002dserv"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Invoking-psktool">Invoking psktool</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Invoking-gnutls_002dcli_002ddebug">Invoking gnutls-cli-debug</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Included-programs">Included programs</a>

</div>

<h3 class="section">8.4 Invoking gnutls-serv</h3>

<p><a name="index-gnutls_002dserv-49"></a>
Simple server program that listens to incoming TLS connections.

<pre class="verbatim">GNU TLS test server
Usage: gnutls-serv [options]

     -d, --debug integer      Enable debugging
     -g, --generate           Generate Diffie Hellman Parameters.
     -p, --port integer       The port to connect to.
     -q, --quiet              Suppress some messages.
     --nodb                   Does not use the resume database.
     --http                   Act as an HTTP Server.
     --echo                   Act as an Echo Server.
     --dhparams FILE          DH params file to use.
     --x509fmtder             Use DER format for certificates
     --x509cafile FILE        Certificate file to use.
     --x509crlfile FILE       CRL file to use.
     --pgpkeyring FILE        PGP Key ring file to use.
     --pgptrustdb FILE        PGP trustdb file to use.
     --pgpkeyfile FILE        PGP Key file to use.
     --pgpcertfile FILE       PGP Public Key (certificate) file to
                              use.
     --x509keyfile FILE       X.509 key file to use.
     --x509certfile FILE      X.509 Certificate file to use.
     --x509dsakeyfile FILE    Alternative X.509 key file to use.
     --x509dsacertfile FILE   Alternative X.509 certificate file to
                              use.
     --srppasswd FILE         SRP password file to use.
     --srppasswdconf FILE     SRP password conf file to use.
     --ciphers cipher1 cipher2...
                              Ciphers to enable.
     --protocols protocol1 protocol2...
                              Protocols to enable.
     --comp comp1 comp2...    Compression methods to enable.
     --macs mac1 mac2...      MACs to enable.
     --kx kx1 kx2...          Key exchange methods to enable.
     --ctypes certType1 certType2...
                              Certificate types to enable.
     -l, --list               Print a list of the supported
                              algorithms  and modes.
     -h, --help               prints this help
     -v, --version            prints the program's version number
</pre>

<h4 class="subsection">8.4.1 Setting Up a Test HTTPS Server</h4>

<p><a name="index-HTTPS-server-50"></a><a name="index-debug-server-51"></a>
Running your own TLS server based on GnuTLS can be useful when
debugging clients and/or GnuTLS itself.  This section describes how to
use <code>gnutls-serv</code> as a simple HTTPS server.

<p>The most basic server can be started as:

<pre class="example">     gnutls-serv --http
</pre>
<p>It will only support anonymous ciphersuites, which many TLS clients
refuse to use.

<p>The next step is to add support for X.509.  First we generate a CA:

<pre class="example">     certtool --generate-privkey &gt; x509-ca-key.pem
     echo 'cn = GnuTLS test CA' &gt; ca.tmpl
     echo 'ca' &gt;&gt; ca.tmpl
     echo 'cert_signing_key' &gt;&gt; ca.tmpl
     certtool --generate-self-signed --load-privkey x509-ca-key.pem \
       --template ca.tmpl --outfile x509-ca.pem
     ...
</pre>
<p>Then generate a server certificate.  Remember to change the dns_name
value to the name of your server host, or skip that command to avoid
the field.

<pre class="example">     certtool --generate-privkey &gt; x509-server-key.pem
     echo 'organization = GnuTLS test server' &gt; server.tmpl
     echo 'cn = test.gnutls.org' &gt;&gt; server.tmpl
     echo 'tls_www_server' &gt;&gt; server.tmpl
     echo 'encryption_key' &gt;&gt; server.tmpl
     echo 'signing_key' &gt;&gt; server.tmpl
     echo 'dns_name = test.gnutls.org' &gt;&gt; server.tmpl
     certtool --generate-certificate --load-privkey x509-server-key.pem \
       --load-ca-certificate x509-ca.pem --load-ca-privkey x509-ca-key.pem \
       --template server.tmpl --outfile x509-server.pem
     ...
</pre>
<p>For use in the client, you may want to generate a client certificate
as well.

<pre class="example">     certtool --generate-privkey &gt; x509-client-key.pem
     echo 'cn = GnuTLS test client' &gt; client.tmpl
     echo 'tls_www_client' &gt;&gt; client.tmpl
     echo 'encryption_key' &gt;&gt; client.tmpl
     echo 'signing_key' &gt;&gt; client.tmpl
     certtool --generate-certificate --load-privkey x509-client-key.pem \
       --load-ca-certificate x509-ca.pem --load-ca-privkey x509-ca-key.pem \
       --template client.tmpl --outfile x509-client.pem
     ...
</pre>
<p>To be able to import the client key/certificate into some
applications, you will need to convert them into a PKCS#12 structure. 
This also encrypts the security sensitive key with a password.

<pre class="example">     certtool --to-p12 --load-privkey x509-client-key.pem --load-certificate x509-client.pem --outder --outfile x509-client.p12
</pre>
<p>For icing, we'll create a proxy certificate for the client too.

<pre class="example">     certtool --generate-privkey &gt; x509-proxy-key.pem
     echo 'cn = GnuTLS test client proxy' &gt; proxy.tmpl
     certtool --generate-proxy --load-privkey x509-proxy-key.pem \
       --load-ca-certificate x509-client.pem --load-ca-privkey x509-client-key.pem \
       --load-certificate x509-client.pem --template proxy.tmpl \
       --outfile x509-proxy.pem
     ...
</pre>
<p>Then start the server again:

<pre class="example">     gnutls-serv --http \
                 --x509cafile x509-ca.pem \
                 --x509keyfile x509-server-key.pem \
                 --x509certfile x509-server.pem
</pre>
<p>Try connecting to the server using your web browser.  Note that the
server listens to port 5556 by default.

<p>While you are at it, to allow connections using DSA, you can also
create a DSA key and certificate for the server.  These credentials
will be used in the final example below.

<pre class="example">     certtool --generate-privkey --dsa &gt; x509-server-key-dsa.pem
     certtool --generate-certificate --load-privkey x509-server-key-dsa.pem \
       --load-ca-certificate x509-ca.pem --load-ca-privkey x509-ca-key.pem \
       --template server.tmpl --outfile x509-server-dsa.pem
     ...
</pre>
<p>The next step is to create OpenPGP credentials for the server.

<pre class="example">     gpg --gen-key
     ...enter whatever details you want, use 'test.gnutls.org' as name...
</pre>
<p>Make a note of the OpenPGP key identifier of the newly generated key,
here it was <code>5D1D14D8</code>.  You will need to export the key for
GnuTLS to be able to use it.

<pre class="example">     gpg -a --export 5D1D14D8 &gt; openpgp-server.txt
     gpg --export 5D1D14D8 &gt; openpgp-server.bin
     gpg --export-secret-keys 5D1D14D8 &gt; openpgp-server-key.bin
     gpg -a --export-secret-keys 5D1D14D8 &gt; openpgp-server-key.txt
</pre>
<p>Let's start the server with support for OpenPGP credentials:

<pre class="example">     gnutls-serv --http \
                 --pgpkeyfile openpgp-server-key.txt \
                 --pgpcertfile openpgp-server.txt
</pre>
<p>The next step is to add support for SRP authentication.

<pre class="example">     srptool --create-conf srp-tpasswd.conf
     srptool --passwd-conf srp-tpasswd.conf --username jas --passwd srp-passwd.txt
     Enter password: [TYPE "foo"]
</pre>
<p>Start the server with SRP support:

<pre class="example">     gnutls-serv --http \
                 --srppasswdconf srp-tpasswd.conf \
                 --srppasswd srp-passwd.txt
</pre>
<p>Let's also add support for PSK.

<pre class="example">     $ psktool --passwd psk-passwd.txt
</pre>
<p>Start the server with PSK support:

<pre class="example">     gnutls-serv --http \
                 --pskpasswd psk-passwd.txt
</pre>
<p>Finally, we start the server with all the earlier parameters and you
get this command:

<pre class="example">     gnutls-serv --http \
                 --x509cafile x509-ca.pem \
                 --x509keyfile x509-server-key.pem \
                 --x509certfile x509-server.pem \
                 --x509dsakeyfile x509-server-key-dsa.pem \
                 --x509dsacertfile x509-server-dsa.pem \
                 --pgpkeyfile openpgp-server-key.txt \
                 --pgpcertfile openpgp-server.txt \
                 --srppasswdconf srp-tpasswd.conf \
                 --srppasswd srp-passwd.txt \
                 --pskpasswd psk-passwd.txt
</pre>
<ul class="menu">
<li><a accesskey="1" href="#Example-server-PSK-connection">Example server PSK connection</a>
</ul>

<div class="node">
<a name="Example-server-PSK-connection"></a>
<p><hr>
Up:&nbsp;<a rel="up" accesskey="u" href="#Invoking-gnutls_002dserv">Invoking gnutls-serv</a>

</div>

<h4 class="subsection">8.4.2 Example server PSK connection</h4>

<p><a name="index-PSK-server-52"></a>
To set up a PSK server with <code>gnutls-serv</code> you need to create PSK
password file (see <a href="#Invoking-psktool">Invoking psktool</a>).  In the example below, I
type <code>password</code> at the prompt.

<pre class="smallexample">     $ ./psktool -u psk_identity -p psks.txt -n psk_identity_hint
     Enter password:
     Key stored to psks.txt
     $ cat psks.txt
     psk_identity:88f3824b3e5659f52d00e959bacab954b6540344
     $
</pre>
<p>After this, start the server pointing to the password file.  We
disable DHE-PSK.

<pre class="smallexample">     $ ./gnutls-serv --pskpasswd psks.txt  --pskhint psk_identity_hint --priority NORMAL:-DHE-PSK
     Set static Diffie Hellman parameters, consider --dhparams.
     Echo Server ready. Listening to port '5556'.
</pre>
<p>You can now connect to the server using a PSK client (see <a href="#Example-client-PSK-connection">Example client PSK connection</a>).

<div class="node">
<a name="Invoking-psktool"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Invoking-srptool">Invoking srptool</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Invoking-gnutls_002dserv">Invoking gnutls-serv</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Included-programs">Included programs</a>

</div>

<h3 class="section">8.5 Invoking psktool</h3>

<p><a name="index-psktool-53"></a>
This is a program to manage <acronym>PSK</acronym> username and keys.

<pre class="verbatim">PSKtool help
Usage : psktool [options]
     -u, --username username
                              specify username.
     -p, --passwd FILE        specify a password file.
     -n, --netconf-hint HINT
                              derive key from Netconf password, using 
                              HINT as the psk_identity_hint.
     -s, --keysize SIZE       specify the key size in bytes.
     -v, --version            prints the program's version number
     -h, --help               shows this help text
</pre>

<p>Normally the file will generate random keys for the indicate username. 
You may also derive PSK keys from passwords, using the algorithm
specified in <samp><span class="file">draft-ietf-netconf-tls-02.txt</span></samp>.  The algorithm
needs a PSK identity hint, which you specify using
<code>--netconf-hint</code>.  To derive a PSK key from a password with an
empty PSK identity hint, using <code>--netconf-hint ""</code>.

<div class="node">
<a name="Invoking-srptool"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Invoking-psktool">Invoking psktool</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Included-programs">Included programs</a>

</div>

<h3 class="section">8.6 Invoking srptool</h3>

<p><a name="srptool"></a><a name="index-srptool-54"></a>
The <samp><span class="file">srptool</span></samp> is a very simple program that emulates the programs
in the <em>Stanford SRP libraries</em>.  It is intended for use in
places where you don't expect <acronym>SRP</acronym> authentication to be the
used for system users.  Traditionally <em>libsrp</em> used two
files. One called 'tpasswd' which holds usernames and verifiers, and
'tpasswd.conf' which holds generators and primes.

<p>How to use srptool:

     <ul>
<li>To create tpasswd.conf which holds the g and n values for
<acronym>SRP</acronym> protocol (generator and a large prime), run:

     <pre class="example">          $ srptool --create-conf /etc/tpasswd.conf
</pre>
     <li>This command will create /etc/tpasswd and will add user 'test' (you
will also be prompted for a password). Verifiers are stored by default
in the way libsrp expects.

     <pre class="example">          $ srptool --passwd /etc/tpasswd \
              --passwd-conf /etc/tpasswd.conf -u test
</pre>
     <li>This command will check against a password. If the password matches
the one in /etc/tpasswd you will get an ok.

     <pre class="example">          $ srptool --passwd /etc/tpasswd \
              --passwd-conf /etc/tpasswd.conf --verify -u test
</pre>
     </ul>

<div class="node">
<a name="Function-reference"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#All-the-supported-ciphersuites-in-GnuTLS">All the supported ciphersuites in GnuTLS</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Included-programs">Included programs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">9 Function Reference</h2>

<p><a name="index-Function-reference-55"></a>

<ul class="menu">
<li><a accesskey="1" href="#Core-functions">Core functions</a>
<li><a accesskey="2" href="#X_002e509-certificate-functions">X.509 certificate functions</a>
<li><a accesskey="3" href="#GnuTLS_002dextra-functions">GnuTLS-extra functions</a>
<li><a accesskey="4" href="#OpenPGP-functions">OpenPGP functions</a>
<li><a accesskey="5" href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a>
<li><a accesskey="6" href="#Error-codes-and-descriptions">Error codes and descriptions</a>
</ul>

<div class="node">
<a name="Core-functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#X_002e509-certificate-functions">X.509 certificate functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Function-reference">Function reference</a>

</div>

<h3 class="section">9.1 Core Functions</h3>

<p>The prototypes for the following functions lie in
<samp><span class="file">gnutls/gnutls.h</span></samp>.

<h4 class="subheading">gnutls_alert_get_name</h4>

<p><a name="gnutls_005falert_005fget_005fname"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_alert_get_name</b> (<var>gnutls_alert_description_t alert</var>)<var><a name="index-gnutls_005falert_005fget_005fname-56"></a></var><br>
<blockquote><p><var>alert</var>: is an alert number <code>gnutls_session_t</code> structure.

     <p>This function will return a string that describes the given alert
number, or <code>NULL</code>.  See <code>gnutls_alert_get()</code>.

     <p><strong>Returns:</strong> string corresponding to <code>gnutls_alert_description_t</code> value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_alert_get</h4>

<p><a name="gnutls_005falert_005fget"></a>

<div class="defun">
&mdash; Function: gnutls_alert_description_t <b>gnutls_alert_get</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005falert_005fget-57"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>This function will return the last alert number received.  This
function should be called if <code>GNUTLS_E_WARNING_ALERT_RECEIVED</code> or
<code>GNUTLS_E_FATAL_ALERT_RECEIVED</code> has been returned by a gnutls
function.  The peer may send alerts if he thinks some things were
not right. Check gnutls.h for the available alert descriptions.

     <p>If no alert has been received the returned value is undefined.

     <p><strong>Returns:</strong> returns the last alert received, a
<code>gnutls_alert_description_t</code> value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_alert_send_appropriate</h4>

<p><a name="gnutls_005falert_005fsend_005fappropriate"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_alert_send_appropriate</b> (<var>gnutls_session_t session, int err</var>)<var><a name="index-gnutls_005falert_005fsend_005fappropriate-58"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>err</var>: is an integer

     <p>Sends an alert to the peer depending on the error code returned by
a gnutls function. This function will call <code>gnutls_error_to_alert()</code>
to determine the appropriate alert to send.

     <p>This function may also return <code>GNUTLS_E_AGAIN</code>, or
<code>GNUTLS_E_INTERRUPTED</code>.

     <p>If the return value is <code>GNUTLS_E_INVALID_REQUEST</code>, then no alert has
been sent to the peer.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, otherwise
an error code is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_alert_send</h4>

<p><a name="gnutls_005falert_005fsend"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_alert_send</b> (<var>gnutls_session_t session, gnutls_alert_level_t level, gnutls_alert_description_t desc</var>)<var><a name="index-gnutls_005falert_005fsend-59"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>level</var>: is the level of the alert

     <p><var>desc</var>: is the alert description

     <p>This function will send an alert to the peer in order to inform
him of something important (eg. his Certificate could not be verified). 
If the alert level is Fatal then the peer is expected to close the
connection, otherwise he may ignore the alert and continue.

     <p>The error code of the underlying record send function will be
returned, so you may also receive <code>GNUTLS_E_INTERRUPTED</code> or
<code>GNUTLS_E_AGAIN</code> as well.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, otherwise
an error code is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_anon_allocate_client_credentials</h4>

<p><a name="gnutls_005fanon_005fallocate_005fclient_005fcredentials"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_anon_allocate_client_credentials</b> (<var>gnutls_anon_client_credentials_t * sc</var>)<var><a name="index-gnutls_005fanon_005fallocate_005fclient_005fcredentials-60"></a></var><br>
<blockquote><p><var>sc</var>: is a pointer to an <code>gnutls_anon_client_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus
this helper function is provided in order to allocate it.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_anon_allocate_server_credentials</h4>

<p><a name="gnutls_005fanon_005fallocate_005fserver_005fcredentials"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_anon_allocate_server_credentials</b> (<var>gnutls_anon_server_credentials_t * sc</var>)<var><a name="index-gnutls_005fanon_005fallocate_005fserver_005fcredentials-61"></a></var><br>
<blockquote><p><var>sc</var>: is a pointer to an <code>gnutls_anon_server_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus this
helper function is provided in order to allocate it.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_anon_free_client_credentials</h4>

<p><a name="gnutls_005fanon_005ffree_005fclient_005fcredentials"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_anon_free_client_credentials</b> (<var>gnutls_anon_client_credentials_t sc</var>)<var><a name="index-gnutls_005fanon_005ffree_005fclient_005fcredentials-62"></a></var><br>
<blockquote><p><var>sc</var>: is an <code>gnutls_anon_client_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus this
helper function is provided in order to free (deallocate) it. 
</p></blockquote></div>

<h4 class="subheading">gnutls_anon_free_server_credentials</h4>

<p><a name="gnutls_005fanon_005ffree_005fserver_005fcredentials"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_anon_free_server_credentials</b> (<var>gnutls_anon_server_credentials_t sc</var>)<var><a name="index-gnutls_005fanon_005ffree_005fserver_005fcredentials-63"></a></var><br>
<blockquote><p><var>sc</var>: is an <code>gnutls_anon_server_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus this
helper function is provided in order to free (deallocate) it. 
</p></blockquote></div>

<h4 class="subheading">gnutls_anon_set_params_function</h4>

<p><a name="gnutls_005fanon_005fset_005fparams_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_anon_set_params_function</b> (<var>gnutls_anon_server_credentials_t res, gnutls_params_function * func</var>)<var><a name="index-gnutls_005fanon_005fset_005fparams_005ffunction-64"></a></var><br>
<blockquote><p><var>res</var>: is a gnutls_anon_server_credentials_t structure

     <p><var>func</var>: is the function to be called

     <p>This function will set a callback in order for the server to get
the diffie hellman or RSA parameters for anonymous authentication. 
The callback should return zero on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_anon_set_server_dh_params</h4>

<p><a name="gnutls_005fanon_005fset_005fserver_005fdh_005fparams"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_anon_set_server_dh_params</b> (<var>gnutls_anon_server_credentials_t res, gnutls_dh_params_t dh_params</var>)<var><a name="index-gnutls_005fanon_005fset_005fserver_005fdh_005fparams-65"></a></var><br>
<blockquote><p><var>res</var>: is a gnutls_anon_server_credentials_t structure

     <p><var>dh_params</var>: is a structure that holds diffie hellman parameters.

     <p>This function will set the diffie hellman parameters for an
anonymous server to use.  These parameters will be used in
Anonymous Diffie Hellman cipher suites. 
</p></blockquote></div>

<h4 class="subheading">gnutls_anon_set_server_params_function</h4>

<p><a name="gnutls_005fanon_005fset_005fserver_005fparams_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_anon_set_server_params_function</b> (<var>gnutls_anon_server_credentials_t res, gnutls_params_function * func</var>)<var><a name="index-gnutls_005fanon_005fset_005fserver_005fparams_005ffunction-66"></a></var><br>
<blockquote><p><var>res</var>: is a gnutls_certificate_credentials_t structure

     <p><var>func</var>: is the function to be called

     <p>This function will set a callback in order for the server to get
the diffie hellman parameters for anonymous authentication.  The
callback should return zero on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_auth_client_get_type</h4>

<p><a name="gnutls_005fauth_005fclient_005fget_005ftype"></a>

<div class="defun">
&mdash; Function: gnutls_credentials_type_t <b>gnutls_auth_client_get_type</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fauth_005fclient_005fget_005ftype-67"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Returns the type of credentials that were used for client authentication. 
The returned information is to be used to distinguish the function used
to access authentication data.

     <p><strong>Returns:</strong> The type of credentials for the client authentication
schema, an <code>gnutls_credentials_type_t</code> type. 
</p></blockquote></div>

<h4 class="subheading">gnutls_auth_get_type</h4>

<p><a name="gnutls_005fauth_005fget_005ftype"></a>

<div class="defun">
&mdash; Function: gnutls_credentials_type_t <b>gnutls_auth_get_type</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fauth_005fget_005ftype-68"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Returns type of credentials for the current authentication schema. 
The returned information is to be used to distinguish the function used
to access authentication data.

     <p>Eg. for CERTIFICATE ciphersuites (key exchange algorithms: KX_RSA,
KX_DHE_RSA), the same function are to be used to access the
authentication data.

     <p><strong>Returns:</strong> The type of credentials for the current authentication
schema, an <code>gnutls_credentials_type_t</code> type. 
</p></blockquote></div>

<h4 class="subheading">gnutls_auth_server_get_type</h4>

<p><a name="gnutls_005fauth_005fserver_005fget_005ftype"></a>

<div class="defun">
&mdash; Function: gnutls_credentials_type_t <b>gnutls_auth_server_get_type</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fauth_005fserver_005fget_005ftype-69"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Returns the type of credentials that were used for server authentication. 
The returned information is to be used to distinguish the function used
to access authentication data.

     <p><strong>Returns:</strong> The type of credentials for the server authentication
schema, an <code>gnutls_credentials_type_t</code> type. 
</p></blockquote></div>

<h4 class="subheading">gnutls_bye</h4>

<p><a name="gnutls_005fbye"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_bye</b> (<var>gnutls_session_t session, gnutls_close_request_t how</var>)<var><a name="index-gnutls_005fbye-70"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>how</var>: is an integer

     <p>Terminates the current TLS/SSL connection. The connection should
have been initiated using <code>gnutls_handshake()</code>.  <code>how</code> should be one
of <code>GNUTLS_SHUT_RDWR</code>, <code>GNUTLS_SHUT_WR</code>.

     <p>In case of <code>GNUTLS_SHUT_RDWR</code> then the TLS connection gets
terminated and further receives and sends will be disallowed.  If
the return value is zero you may continue using the connection. 
<code>GNUTLS_SHUT_RDWR</code> actually sends an alert containing a close
request and waits for the peer to reply with the same message.

     <p>In case of <code>GNUTLS_SHUT_WR</code> then the TLS connection gets terminated
and further sends will be disallowed. In order to reuse the
connection you should wait for an EOF from the peer. 
<code>GNUTLS_SHUT_WR</code> sends an alert containing a close request.

     <p>Note that not all implementations will properly terminate a TLS
connection.  Some of them, usually for performance reasons, will
terminate only the underlying transport layer, thus causing a
transmission error to the peer.  This error cannot be
distinguished from a malicious party prematurely terminating the
session, thus this behavior is not recommended.

     <p>This function may also return <code>GNUTLS_E_AGAIN</code> or
<code>GNUTLS_E_INTERRUPTED</code>; cf.  <code>gnutls_record_get_direction()</code>.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code, see
function documentation for entire semantics. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_activation_time_peers</h4>

<p><a name="gnutls_005fcertificate_005factivation_005ftime_005fpeers"></a>

<div class="defun">
&mdash; Function: time_t <b>gnutls_certificate_activation_time_peers</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fcertificate_005factivation_005ftime_005fpeers-71"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p>This function will return the peer's certificate activation time. 
This is the creation time for openpgp keys.

     <p><strong>Returns:</strong> (time_t)-1 on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_allocate_credentials</h4>

<p><a name="gnutls_005fcertificate_005fallocate_005fcredentials"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_allocate_credentials</b> (<var>gnutls_certificate_credentials_t * res</var>)<var><a name="index-gnutls_005fcertificate_005fallocate_005fcredentials-72"></a></var><br>
<blockquote><p><var>res</var>: is a pointer to an <code>gnutls_certificate_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus this
helper function is provided in order to allocate it.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_client_get_request_status</h4>

<p><a name="gnutls_005fcertificate_005fclient_005fget_005frequest_005fstatus"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_client_get_request_status</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fcertificate_005fclient_005fget_005frequest_005fstatus-73"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p>Get whether client certificate is requested or not.

     <p><strong>Returns:</strong> 0 if the peer (server) did not request client
authentication or 1 otherwise, or a negative value in case of
error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_client_set_retrieve_function</h4>

<p><a name="gnutls_005fcertificate_005fclient_005fset_005fretrieve_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_certificate_client_set_retrieve_function</b> (<var>gnutls_certificate_credentials_t cred, gnutls_certificate_client_retrieve_function * func</var>)<var><a name="index-gnutls_005fcertificate_005fclient_005fset_005fretrieve_005ffunction-74"></a></var><br>
<blockquote><p><var>cred</var>: is a <code>gnutls_certificate_credentials_t</code> structure.

     <p><var>func</var>: is the callback function

     <p>This function sets a callback to be called in order to retrieve the certificate
to be used in the handshake. 
The callback's function prototype is:
int (*callback)(gnutls_session_t, const gnutls_datum_t* req_ca_dn, int nreqs,
const gnutls_pk_algorithm_t* pk_algos, int pk_algos_length, gnutls_retr_st* st);

     <p><code>req_ca_cert</code> is only used in X.509 certificates. 
Contains a list with the CA names that the server considers trusted. 
Normally we should send a certificate that is signed
by one of these CAs. These names are DER encoded. To get a more
meaningful value use the function <code>gnutls_x509_rdn_get()</code>.

     <p><code>pk_algos</code> contains a list with server's acceptable signature algorithms. 
The certificate returned should support the server's given algorithms.

     <p><code>st</code> should contain the certificates and private keys.

     <p>If the callback function is provided then gnutls will call it, in the
handshake, after the certificate request message has been received.

     <p>The callback function should set the certificate list to be sent, and
return 0 on success. If no certificate was selected then the number of certificates
should be set to zero. The value (-1) indicates error and the handshake
will be terminated. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_expiration_time_peers</h4>

<p><a name="gnutls_005fcertificate_005fexpiration_005ftime_005fpeers"></a>

<div class="defun">
&mdash; Function: time_t <b>gnutls_certificate_expiration_time_peers</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fcertificate_005fexpiration_005ftime_005fpeers-75"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p>This function will return the peer's certificate expiration time.

     <p><strong>Returns:</strong> (time_t)-1 on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_free_ca_names</h4>

<p><a name="gnutls_005fcertificate_005ffree_005fca_005fnames"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_certificate_free_ca_names</b> (<var>gnutls_certificate_credentials_t sc</var>)<var><a name="index-gnutls_005fcertificate_005ffree_005fca_005fnames-76"></a></var><br>
<blockquote><p><var>sc</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p>This function will delete all the CA name in the
given credentials. Clients may call this to save some memory
since in client side the CA names are not used.

     <p>CA names are used by servers to advertize the CAs they
support to clients. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_free_cas</h4>

<p><a name="gnutls_005fcertificate_005ffree_005fcas"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_certificate_free_cas</b> (<var>gnutls_certificate_credentials_t sc</var>)<var><a name="index-gnutls_005fcertificate_005ffree_005fcas-77"></a></var><br>
<blockquote><p><var>sc</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p>This function will delete all the CAs associated
with the given credentials. Servers that do not use
<code>gnutls_certificate_verify_peers2()</code> may call this to
save some memory. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_free_credentials</h4>

<p><a name="gnutls_005fcertificate_005ffree_005fcredentials"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_certificate_free_credentials</b> (<var>gnutls_certificate_credentials_t sc</var>)<var><a name="index-gnutls_005fcertificate_005ffree_005fcredentials-78"></a></var><br>
<blockquote><p><var>sc</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus
this helper function is provided in order to free (deallocate) it.

     <p>This function does not free any temporary parameters associated
with this structure (ie RSA and DH parameters are not freed by
this function). 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_free_crls</h4>

<p><a name="gnutls_005fcertificate_005ffree_005fcrls"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_certificate_free_crls</b> (<var>gnutls_certificate_credentials_t sc</var>)<var><a name="index-gnutls_005fcertificate_005ffree_005fcrls-79"></a></var><br>
<blockquote><p><var>sc</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p>This function will delete all the CRLs associated
with the given credentials. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_free_keys</h4>

<p><a name="gnutls_005fcertificate_005ffree_005fkeys"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_certificate_free_keys</b> (<var>gnutls_certificate_credentials_t sc</var>)<var><a name="index-gnutls_005fcertificate_005ffree_005fkeys-80"></a></var><br>
<blockquote><p><var>sc</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p>This function will delete all the keys and the certificates associated
with the given credentials. This function must not be called when a
TLS negotiation that uses the credentials is in progress. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_get_openpgp_keyring</h4>

<p><a name="gnutls_005fcertificate_005fget_005fopenpgp_005fkeyring"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_certificate_get_openpgp_keyring</b> (<var>gnutls_certificate_credentials_t sc, gnutls_openpgp_keyring_t * keyring</var>)<var><a name="index-gnutls_005fcertificate_005fget_005fopenpgp_005fkeyring-81"></a></var><br>
<blockquote><p><var>sc</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p>This function will export the OpenPGP keyring associated with the
given credentials.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_get_ours</h4>

<p><a name="gnutls_005fcertificate_005fget_005fours"></a>

<div class="defun">
&mdash; Function: const gnutls_datum_t * <b>gnutls_certificate_get_ours</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fcertificate_005fget_005fours-82"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p>Get the certificate as sent to the peer, in the last handshake. 
These certificates are in raw format.  In X.509 this is a
certificate list. In OpenPGP this is a single certificate.

     <p><strong>Returns:</strong> return a pointer to a <code>gnutls_datum_t</code> containing our
certificates, or <code>NULL</code> in case of an error or if no certificate
was used. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_get_peers</h4>

<p><a name="gnutls_005fcertificate_005fget_005fpeers"></a>

<div class="defun">
&mdash; Function: const gnutls_datum_t * <b>gnutls_certificate_get_peers</b> (<var>gnutls_session_t session, unsigned int * list_size</var>)<var><a name="index-gnutls_005fcertificate_005fget_005fpeers-83"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p><var>list_size</var>: is the length of the certificate list

     <p>Get the peer's raw certificate (chain) as sent by the peer.  These
certificates are in raw format (DER encoded for X.509).  In case of
a X.509 then a certificate list may be present.  The first
certificate in the list is the peer's certificate, following the
issuer's certificate, then the issuer's issuer etc.

     <p>In case of OpenPGP keys a single key will be returned in raw
format.

     <p><strong>Returns:</strong> return a pointer to a <code>gnutls_datum_t</code> containing our
certificates, or <code>NULL</code> in case of an error or if no certificate
was used. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_get_x509_cas</h4>

<p><a name="gnutls_005fcertificate_005fget_005fx509_005fcas"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_certificate_get_x509_cas</b> (<var>gnutls_certificate_credentials_t sc, gnutls_x509_crt_t ** x509_ca_list, unsigned int * ncas</var>)<var><a name="index-gnutls_005fcertificate_005fget_005fx509_005fcas-84"></a></var><br>
<blockquote><p><var>sc</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p><var>x509_ca_list</var>: will point to the CA list. Should be treated as constant

     <p><var>ncas</var>: the number of CAs

     <p>This function will export all the CAs associated
with the given credentials.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_get_x509_crls</h4>

<p><a name="gnutls_005fcertificate_005fget_005fx509_005fcrls"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_certificate_get_x509_crls</b> (<var>gnutls_certificate_credentials_t sc, gnutls_x509_crl_t ** x509_crl_list, unsigned int * ncrls</var>)<var><a name="index-gnutls_005fcertificate_005fget_005fx509_005fcrls-85"></a></var><br>
<blockquote><p><var>sc</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p><var>x509_crl_list</var>: the exported CRL list. Should be treated as constant

     <p><var>ncrls</var>: the number of exported CRLs

     <p>This function will export all the CRLs associated with the given
credentials.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_send_x509_rdn_sequence</h4>

<p><a name="gnutls_005fcertificate_005fsend_005fx509_005frdn_005fsequence"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_certificate_send_x509_rdn_sequence</b> (<var>gnutls_session_t session, int status</var>)<var><a name="index-gnutls_005fcertificate_005fsend_005fx509_005frdn_005fsequence-86"></a></var><br>
<blockquote><p><var>session</var>: is a pointer to a <code>gnutls_session_t</code> structure.

     <p><var>status</var>: is 0 or 1

     <p>If status is non zero, this function will order gnutls not to send
the rdnSequence in the certificate request message. That is the
server will not advertize it's trusted CAs to the peer. If status
is zero then the default behaviour will take effect, which is to
advertize the server's trusted CAs.

     <p>This function has no effect in clients, and in authentication
methods other than certificate with X.509 certificates. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_server_set_request</h4>

<p><a name="gnutls_005fcertificate_005fserver_005fset_005frequest"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_certificate_server_set_request</b> (<var>gnutls_session_t session, gnutls_certificate_request_t req</var>)<var><a name="index-gnutls_005fcertificate_005fserver_005fset_005frequest-87"></a></var><br>
<blockquote><p><var>session</var>: is an <code>gnutls_session_t</code> structure.

     <p><var>req</var>: is one of GNUTLS_CERT_REQUEST, GNUTLS_CERT_REQUIRE

     <p>This function specifies if we (in case of a server) are going
to send a certificate request message to the client. If <code>req</code>
is GNUTLS_CERT_REQUIRE then the server will return an error if
the peer does not provide a certificate. If you do not
call this function then the client will not be asked to
send a certificate. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_server_set_retrieve_function</h4>

<p><a name="gnutls_005fcertificate_005fserver_005fset_005fretrieve_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_certificate_server_set_retrieve_function</b> (<var>gnutls_certificate_credentials_t cred, gnutls_certificate_server_retrieve_function * func</var>)<var><a name="index-gnutls_005fcertificate_005fserver_005fset_005fretrieve_005ffunction-88"></a></var><br>
<blockquote><p><var>cred</var>: is a <code>gnutls_certificate_credentials_t</code> structure.

     <p><var>func</var>: is the callback function

     <p>This function sets a callback to be called in order to retrieve the certificate
to be used in the handshake. 
The callback's function prototype is:
int (*callback)(gnutls_session_t, gnutls_retr_st* st);

     <p><code>st</code> should contain the certificates and private keys.

     <p>If the callback function is provided then gnutls will call it, in the
handshake, after the certificate request message has been received.

     <p>The callback function should set the certificate list to be sent, and
return 0 on success.  The value (-1) indicates error and the handshake
will be terminated. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_dh_params</h4>

<p><a name="gnutls_005fcertificate_005fset_005fdh_005fparams"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_certificate_set_dh_params</b> (<var>gnutls_certificate_credentials_t res, gnutls_dh_params_t dh_params</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fdh_005fparams-89"></a></var><br>
<blockquote><p><var>res</var>: is a gnutls_certificate_credentials_t structure

     <p><var>dh_params</var>: is a structure that holds diffie hellman parameters.

     <p>This function will set the diffie hellman parameters for a
certificate server to use. These parameters will be used in
Ephemeral Diffie Hellman cipher suites.  Note that only a pointer
to the parameters are stored in the certificate handle, so if you
deallocate the parameters before the certificate is deallocated,
you must change the parameters stored in the certificate first. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_params_function</h4>

<p><a name="gnutls_005fcertificate_005fset_005fparams_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_certificate_set_params_function</b> (<var>gnutls_certificate_credentials_t res, gnutls_params_function * func</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fparams_005ffunction-90"></a></var><br>
<blockquote><p><var>res</var>: is a gnutls_certificate_credentials_t structure

     <p><var>func</var>: is the function to be called

     <p>This function will set a callback in order for the server to get
the diffie hellman or RSA parameters for certificate
authentication.  The callback should return zero on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_rsa_export_params</h4>

<p><a name="gnutls_005fcertificate_005fset_005frsa_005fexport_005fparams"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_certificate_set_rsa_export_params</b> (<var>gnutls_certificate_credentials_t res, gnutls_rsa_params_t rsa_params</var>)<var><a name="index-gnutls_005fcertificate_005fset_005frsa_005fexport_005fparams-91"></a></var><br>
<blockquote><p><var>res</var>: is a gnutls_certificate_credentials_t structure

     <p><var>rsa_params</var>: is a structure that holds temporary RSA parameters.

     <p>This function will set the temporary RSA parameters for a
certificate server to use.  These parameters will be used in
RSA-EXPORT cipher suites. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_verify_flags</h4>

<p><a name="gnutls_005fcertificate_005fset_005fverify_005fflags"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_certificate_set_verify_flags</b> (<var>gnutls_certificate_credentials_t res, unsigned int flags</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fverify_005fflags-92"></a></var><br>
<blockquote><p><var>res</var>: is a gnutls_certificate_credentials_t structure

     <p><var>flags</var>: are the flags

     <p>This function will set the flags to be used at verification of the
certificates.  Flags must be OR of the
<code>gnutls_certificate_verify_flags</code> enumerations. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_verify_limits</h4>

<p><a name="gnutls_005fcertificate_005fset_005fverify_005flimits"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_certificate_set_verify_limits</b> (<var>gnutls_certificate_credentials_t res, unsigned int max_bits, unsigned int max_depth</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fverify_005flimits-93"></a></var><br>
<blockquote><p><var>res</var>: is a gnutls_certificate_credentials structure

     <p><var>max_bits</var>: is the number of bits of an acceptable certificate (default 8200)

     <p><var>max_depth</var>: is maximum depth of the verification of a certificate chain (default 5)

     <p>This function will set some upper limits for the default
verification function, <code>gnutls_certificate_verify_peers2()</code>, to avoid
denial of service attacks.  You can set them to zero to disable
limits. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_x509_crl_file</h4>

<p><a name="gnutls_005fcertificate_005fset_005fx509_005fcrl_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_set_x509_crl_file</b> (<var>gnutls_certificate_credentials_t res, const char * crlfile, gnutls_x509_crt_fmt_t type</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fx509_005fcrl_005ffile-94"></a></var><br>
<blockquote><p><var>res</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p><var>crlfile</var>: is a file containing the list of verified CRLs (DER or PEM list)

     <p><var>type</var>: is PEM or DER

     <p>This function adds the trusted CRLs in order to verify client or server
certificates.  In case of a client this is not required
to be called if the certificates are not verified using
<code>gnutls_certificate_verify_peers2()</code>. 
This function may be called multiple times.

     <p><strong>Returns:</strong> number of CRLs processed or a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_x509_crl_mem</h4>

<p><a name="gnutls_005fcertificate_005fset_005fx509_005fcrl_005fmem"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_set_x509_crl_mem</b> (<var>gnutls_certificate_credentials_t res, const gnutls_datum_t * CRL, gnutls_x509_crt_fmt_t type</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fx509_005fcrl_005fmem-95"></a></var><br>
<blockquote><p><var>res</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p><var>CRL</var>: is a list of trusted CRLs. They should have been verified before.

     <p><var>type</var>: is DER or PEM

     <p>This function adds the trusted CRLs in order to verify client or
server certificates.  In case of a client this is not required to
be called if the certificates are not verified using
<code>gnutls_certificate_verify_peers2()</code>.  This function may be called
multiple times.

     <p><strong>Returns:</strong> number of CRLs processed, or a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_x509_crl</h4>

<p><a name="gnutls_005fcertificate_005fset_005fx509_005fcrl"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_set_x509_crl</b> (<var>gnutls_certificate_credentials_t res, gnutls_x509_crl_t * crl_list, int crl_list_size</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fx509_005fcrl-96"></a></var><br>
<blockquote><p><var>res</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p><var>crl_list</var>: is a list of trusted CRLs. They should have been verified before.

     <p><var>crl_list_size</var>: holds the size of the crl_list

     <p>This function adds the trusted CRLs in order to verify client or
server certificates.  In case of a client this is not required to
be called if the certificates are not verified using
<code>gnutls_certificate_verify_peers2()</code>.  This function may be called
multiple times.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_x509_key_file</h4>

<p><a name="gnutls_005fcertificate_005fset_005fx509_005fkey_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_set_x509_key_file</b> (<var>gnutls_certificate_credentials_t res, const char * CERTFILE, const char * KEYFILE, gnutls_x509_crt_fmt_t type</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fx509_005fkey_005ffile-97"></a></var><br>
<blockquote><p><var>res</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p><var>CERTFILE</var>: is a file that containing the certificate list (path) for
the specified private key, in PKCS7 format, or a list of certificates

     <p><var>KEYFILE</var>: is a file that contains the private key

     <p><var>type</var>: is PEM or DER

     <p>This function sets a certificate/private key pair in the
gnutls_certificate_credentials_t structure.  This function may be
called more than once (in case multiple keys/certificates exist
for the server).

     <p>Currently only PKCS-1 encoded RSA and DSA private keys are accepted by
this function.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_x509_key_mem</h4>

<p><a name="gnutls_005fcertificate_005fset_005fx509_005fkey_005fmem"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_set_x509_key_mem</b> (<var>gnutls_certificate_credentials_t res, const gnutls_datum_t * cert, const gnutls_datum_t * key, gnutls_x509_crt_fmt_t type</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fx509_005fkey_005fmem-98"></a></var><br>
<blockquote><p><var>res</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p><var>cert</var>: contains a certificate list (path) for the specified private key

     <p><var>key</var>: is the private key, or <code>NULL</code>

     <p><var>type</var>: is PEM or DER

     <p>This function sets a certificate/private key pair in the
gnutls_certificate_credentials_t structure. This function may be called
more than once (in case multiple keys/certificates exist for the
server).

     <p><strong>Currently are supported:</strong> RSA PKCS-1 encoded private keys,
DSA private keys.

     <p>DSA private keys are encoded the OpenSSL way, which is an ASN.1
DER sequence of 6 INTEGERs - version, p, q, g, pub, priv.

     <p>Note that the keyUsage (2.5.29.15) PKIX extension in X.509 certificates
is supported. This means that certificates intended for signing cannot
be used for ciphersuites that require encryption.

     <p>If the certificate and the private key are given in PEM encoding
then the strings that hold their values must be null terminated.

     <p>The <code>key</code> may be <code>NULL</code> if you are using a sign callback, see
<code>gnutls_sign_callback_set()</code>.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_x509_key</h4>

<p><a name="gnutls_005fcertificate_005fset_005fx509_005fkey"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_set_x509_key</b> (<var>gnutls_certificate_credentials_t res, gnutls_x509_crt_t * cert_list, int cert_list_size, gnutls_x509_privkey_t key</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fx509_005fkey-99"></a></var><br>
<blockquote><p><var>res</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p><var>cert_list</var>: contains a certificate list (path) for the specified private key

     <p><var>cert_list_size</var>: holds the size of the certificate list

     <p><var>key</var>: is a gnutls_x509_privkey_t key

     <p>This function sets a certificate/private key pair in the
gnutls_certificate_credentials_t structure.  This function may be
called more than once (in case multiple keys/certificates exist
for the server).

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_x509_simple_pkcs12_file</h4>

<p><a name="gnutls_005fcertificate_005fset_005fx509_005fsimple_005fpkcs12_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_set_x509_simple_pkcs12_file</b> (<var>gnutls_certificate_credentials_t res, const char * pkcs12file, gnutls_x509_crt_fmt_t type, const char * password</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fx509_005fsimple_005fpkcs12_005ffile-100"></a></var><br>
<blockquote><p><var>res</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p><var>pkcs12file</var>: filename of file containing PKCS<code>12</code> blob.

     <p><var>type</var>: is PEM or DER of the <code>pkcs12file</code>.

     <p><var>password</var>: optional password used to decrypt PKCS<code>12</code> file, bags and keys.

     <p>This function sets a certificate/private key pair and/or a CRL in
the gnutls_certificate_credentials_t structure.  This function may
be called more than once (in case multiple keys/certificates exist
for the server).

     <p><strong>MAC:</strong> ed PKCS<code>12</code> files are supported.  Encrypted PKCS<code>12</code> bags are
supported.  Encrypted PKCS<code>8</code> private keys are supported.  However,
only password based security, and the same password for all
operations, are supported.

     <p>The private keys may be RSA PKCS<code>1</code> or DSA private keys encoded in
the OpenSSL way.

     <p>PKCS<code>12</code> file may contain many keys and/or certificates, and there
is no way to identify which key/certificate pair you want.  You
should make sure the PKCS<code>12</code> file only contain one key/certificate
pair and/or one CRL.

     <p>It is believed that the limitations of this function is acceptable
for most usage, and that any more flexibility would introduce
complexity that would make it harder to use this functionality at
all.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_x509_trust_file</h4>

<p><a name="gnutls_005fcertificate_005fset_005fx509_005ftrust_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_set_x509_trust_file</b> (<var>gnutls_certificate_credentials_t res, const char * cafile, gnutls_x509_crt_fmt_t type</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fx509_005ftrust_005ffile-101"></a></var><br>
<blockquote><p><var>res</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p><var>cafile</var>: is a file containing the list of trusted CAs (DER or PEM list)

     <p><var>type</var>: is PEM or DER

     <p>This function adds the trusted CAs in order to verify client or
server certificates. In case of a client this is not required to
be called if the certificates are not verified using
<code>gnutls_certificate_verify_peers2()</code>.  This function may be called
multiple times.

     <p>In case of a server the names of the CAs set here will be sent to
the client if a certificate request is sent. This can be disabled
using <code>gnutls_certificate_send_x509_rdn_sequence()</code>.

     <p><strong>Returns:</strong> number of certificates processed, or a negative value on
error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_x509_trust_mem</h4>

<p><a name="gnutls_005fcertificate_005fset_005fx509_005ftrust_005fmem"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_set_x509_trust_mem</b> (<var>gnutls_certificate_credentials_t res, const gnutls_datum_t * ca, gnutls_x509_crt_fmt_t type</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fx509_005ftrust_005fmem-102"></a></var><br>
<blockquote><p><var>res</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p><var>ca</var>: is a list of trusted CAs or a DER certificate

     <p><var>type</var>: is DER or PEM

     <p>This function adds the trusted CAs in order to verify client or
server certificates. In case of a client this is not required to
be called if the certificates are not verified using
<code>gnutls_certificate_verify_peers2()</code>.  This function may be called
multiple times.

     <p>In case of a server the CAs set here will be sent to the client if
a certificate request is sent. This can be disabled using
<code>gnutls_certificate_send_x509_rdn_sequence()</code>.

     <p><strong>Returns:</strong> the number of certificates processed or a negative value
on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_x509_trust</h4>

<p><a name="gnutls_005fcertificate_005fset_005fx509_005ftrust"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_set_x509_trust</b> (<var>gnutls_certificate_credentials_t res, gnutls_x509_crt_t * ca_list, int ca_list_size</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fx509_005ftrust-103"></a></var><br>
<blockquote><p><var>res</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p><var>ca_list</var>: is a list of trusted CAs

     <p><var>ca_list_size</var>: holds the size of the CA list

     <p>This function adds the trusted CAs in order to verify client
or server certificates. In case of a client this is not required
to be called if the certificates are not verified using
<code>gnutls_certificate_verify_peers2()</code>. 
This function may be called multiple times.

     <p>In case of a server the CAs set here will be sent to the client if
a certificate request is sent. This can be disabled using
<code>gnutls_certificate_send_x509_rdn_sequence()</code>.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_type_get_id</h4>

<p><a name="gnutls_005fcertificate_005ftype_005fget_005fid"></a>

<div class="defun">
&mdash; Function: gnutls_certificate_type_t <b>gnutls_certificate_type_get_id</b> (<var>const char * name</var>)<var><a name="index-gnutls_005fcertificate_005ftype_005fget_005fid-104"></a></var><br>
<blockquote><p><var>name</var>: is a certificate type name

     <p>The names are compared in a case insensitive way.

     <p><strong>Returns:</strong> an <code>gnutls_certificate_type_t</code> for the specified in a
string certificate type, or <code>GNUTLS_CRT_UNKNOWN</code> on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_type_get_name</h4>

<p><a name="gnutls_005fcertificate_005ftype_005fget_005fname"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_certificate_type_get_name</b> (<var>gnutls_certificate_type_t type</var>)<var><a name="index-gnutls_005fcertificate_005ftype_005fget_005fname-105"></a></var><br>
<blockquote><p><var>type</var>: is a certificate type

     <p>Convert a <code>gnutls_certificate_type_t</code> type to a string.

     <p><strong>Returns:</strong> a string that contains the name of the specified
certificate type, or <code>NULL</code> in case of unknown types. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_type_get</h4>

<p><a name="gnutls_005fcertificate_005ftype_005fget"></a>

<div class="defun">
&mdash; Function: gnutls_certificate_type_t <b>gnutls_certificate_type_get</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fcertificate_005ftype_005fget-106"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>The certificate type is by default X.509, unless it is negotiated
as a TLS extension.

     <p><strong>Returns:</strong> the currently used <code>gnutls_certificate_type_t</code> certificate
type. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_type_list</h4>

<p><a name="gnutls_005fcertificate_005ftype_005flist"></a>

<div class="defun">
&mdash; Function: const gnutls_certificate_type_t * <b>gnutls_certificate_type_list</b> (<var> void</var>)<var><a name="index-gnutls_005fcertificate_005ftype_005flist-107"></a></var><br>
<blockquote>
     <p>Get a list of certificate types.  Note that to be able to use
OpenPGP certificates, you must link to libgnutls-extra and call
<code>gnutls_global_init_extra()</code>.

     <p><strong>Returns:</strong> a zero-terminated list of <code>gnutls_certificate_type_t</code>
integers indicating the available certificate types. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_type_set_priority</h4>

<p><a name="gnutls_005fcertificate_005ftype_005fset_005fpriority"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_type_set_priority</b> (<var>gnutls_session_t session, const int * list</var>)<var><a name="index-gnutls_005fcertificate_005ftype_005fset_005fpriority-108"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>list</var>: is a 0 terminated list of gnutls_certificate_type_t elements.

     <p>Sets the priority on the certificate types supported by gnutls. 
Priority is higher for elements specified before others. 
After specifying the types you want, you must append a 0. 
Note that the certificate type priority is set on the client. 
The server does not use the cert type priority except for disabling
types that were not specified.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_verify_peers2</h4>

<p><a name="gnutls_005fcertificate_005fverify_005fpeers2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_verify_peers2</b> (<var>gnutls_session_t session, unsigned int * status</var>)<var><a name="index-gnutls_005fcertificate_005fverify_005fpeers2-109"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p><var>status</var>: is the output of the verification

     <p>This function will try to verify the peer's certificate and return
its status (trusted, invalid etc.).  The value of <code>status</code> should
be one or more of the gnutls_certificate_status_t enumerated
elements bitwise or'd. To avoid denial of service attacks some
default upper limits regarding the certificate key size and chain
size are set. To override them use
<code>gnutls_certificate_set_verify_limits()</code>.

     <p>Note that you must also check the peer's name in order to check if
the verified certificate belongs to the actual peer.

     <p>This is the same as <code>gnutls_x509_crt_list_verify()</code> and uses the
loaded CAs in the credentials as trusted CAs.

     <p>Note that some commonly used X.509 Certificate Authorities are
still using Version 1 certificates.  If you want to accept them,
you need to call <code>gnutls_certificate_set_verify_flags()</code> with, e.g.,
<code>GNUTLS_VERIFY_ALLOW_X509_V1_CA_CRT</code> parameter.

     <p><strong>Returns:</strong> a negative error code on error and zero on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_verify_peers</h4>

<p><a name="gnutls_005fcertificate_005fverify_005fpeers"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_verify_peers</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fcertificate_005fverify_005fpeers-110"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p>This function will try to verify the peer's certificate and return
its status (trusted, invalid etc.).  However you must also check
the peer's name in order to check if the verified certificate
belongs to the actual peer.

     <p>The return value should be one or more of the
gnutls_certificate_status_t enumerated elements bitwise or'd, or a
negative value on error.

     <p>This is the same as <code>gnutls_x509_crt_list_verify()</code>.

     <p><strong>Deprecated:</strong> Use <code>gnutls_certificate_verify_peers2()</code> instead. 
</p></blockquote></div>

<h4 class="subheading">gnutls_check_version</h4>

<p><a name="gnutls_005fcheck_005fversion"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_check_version</b> (<var>const char * req_version</var>)<var><a name="index-gnutls_005fcheck_005fversion-111"></a></var><br>
<blockquote><p><var>req_version</var>: the version to check

     <p>Check that the version of the library is at minimum the requested one
and return the version string; return NULL if the condition is not
satisfied.  If a NULL is passed to this function, no check is done,
but the version string is simply returned.

     <p>See <code>LIBGNUTLS_VERSION</code> for a suitable <code>req_version</code> string.

     <p><strong>Return value:</strong> Version string of run-time library, or NULL if the
run-time library does not meet the required version number.  If
<code>NULL</code> is passed to this function no check is done and only the
version string is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_cipher_get_id</h4>

<p><a name="gnutls_005fcipher_005fget_005fid"></a>

<div class="defun">
&mdash; Function: gnutls_cipher_algorithm_t <b>gnutls_cipher_get_id</b> (<var>const char * name</var>)<var><a name="index-gnutls_005fcipher_005fget_005fid-112"></a></var><br>
<blockquote><p><var>name</var>: is a MAC algorithm name

     <p>The names are compared in a case insensitive way.

     <p><strong>Returns:</strong> return a <code>gnutls_cipher_algorithm_t</code> value corresponding to
the specified cipher, or <code>GNUTLS_CIPHER_UNKNOWN</code> on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_cipher_get_key_size</h4>

<p><a name="gnutls_005fcipher_005fget_005fkey_005fsize"></a>

<div class="defun">
&mdash; Function: size_t <b>gnutls_cipher_get_key_size</b> (<var>gnutls_cipher_algorithm_t algorithm</var>)<var><a name="index-gnutls_005fcipher_005fget_005fkey_005fsize-113"></a></var><br>
<blockquote><p><var>algorithm</var>: is an encryption algorithm

     <p>Get key size for cipher.

     <p><strong>Returns:</strong> length (in bytes) of the given cipher's key size, or 0 if
the given cipher is invalid. 
</p></blockquote></div>

<h4 class="subheading">gnutls_cipher_get_name</h4>

<p><a name="gnutls_005fcipher_005fget_005fname"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_cipher_get_name</b> (<var>gnutls_cipher_algorithm_t algorithm</var>)<var><a name="index-gnutls_005fcipher_005fget_005fname-114"></a></var><br>
<blockquote><p><var>algorithm</var>: is an encryption algorithm

     <p>Convert a <code>gnutls_cipher_algorithm_t</code> type to a string.

     <p><strong>Returns:</strong> a pointer to a string that contains the name of the
specified cipher, or <code>NULL</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_cipher_get</h4>

<p><a name="gnutls_005fcipher_005fget"></a>

<div class="defun">
&mdash; Function: gnutls_cipher_algorithm_t <b>gnutls_cipher_get</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fcipher_005fget-115"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Get currently used cipher.

     <p><strong>Returns:</strong> the currently used cipher, an <code>gnutls_cipher_algorithm_t</code>
type. 
</p></blockquote></div>

<h4 class="subheading">gnutls_cipher_list</h4>

<p><a name="gnutls_005fcipher_005flist"></a>

<div class="defun">
&mdash; Function: const gnutls_cipher_algorithm_t * <b>gnutls_cipher_list</b> (<var> void</var>)<var><a name="index-gnutls_005fcipher_005flist-116"></a></var><br>
<blockquote>
     <p>Get a list of supported cipher algorithms.  Note that not
necessarily all ciphers are supported as TLS cipher suites.  For
example, DES is not supported as a cipher suite, but is supported
for other purposes (e.g., PKCS<code>8</code> or similar).

     <p><strong>Returns:</strong> a zero-terminated list of <code>gnutls_cipher_algorithm_t</code>
integers indicating the available ciphers. 
</p></blockquote></div>

<h4 class="subheading">gnutls_cipher_set_priority</h4>

<p><a name="gnutls_005fcipher_005fset_005fpriority"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_cipher_set_priority</b> (<var>gnutls_session_t session, const int * list</var>)<var><a name="index-gnutls_005fcipher_005fset_005fpriority-117"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>list</var>: is a 0 terminated list of gnutls_cipher_algorithm_t elements.

     <p>Sets the priority on the ciphers supported by gnutls. 
Priority is higher for elements specified before others. 
After specifying the ciphers you want, you must append a 0. 
Note that the priority is set on the client. The server does
not use the algorithm's priority except for disabling
algorithms that were not specified.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_cipher_suite_get_name</h4>

<p><a name="gnutls_005fcipher_005fsuite_005fget_005fname"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_cipher_suite_get_name</b> (<var>gnutls_kx_algorithm_t kx_algorithm, gnutls_cipher_algorithm_t cipher_algorithm, gnutls_mac_algorithm_t mac_algorithm</var>)<var><a name="index-gnutls_005fcipher_005fsuite_005fget_005fname-118"></a></var><br>
<blockquote><p><var>kx_algorithm</var>: is a Key exchange algorithm

     <p><var>cipher_algorithm</var>: is a cipher algorithm

     <p><var>mac_algorithm</var>: is a MAC algorithm

     <p>Note that the full cipher suite name must be prepended by TLS or
SSL depending of the protocol in use.

     <p><strong>Returns:</strong> a string that contains the name of a TLS cipher suite,
specified by the given algorithms, or <code>NULL</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_cipher_suite_info</h4>

<p><a name="gnutls_005fcipher_005fsuite_005finfo"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_cipher_suite_info</b> (<var>size_t idx, char * cs_id, gnutls_kx_algorithm_t * kx, gnutls_cipher_algorithm_t * cipher, gnutls_mac_algorithm_t * mac, gnutls_protocol_t * version</var>)<var><a name="index-gnutls_005fcipher_005fsuite_005finfo-119"></a></var><br>
<blockquote><p><var>idx</var>: index of cipher suite to get information about, starts on 0.

     <p><var>cs_id</var>: output buffer with room for 2 bytes, indicating cipher suite value

     <p><var>kx</var>: output variable indicating key exchange algorithm, or <code>NULL</code>.

     <p><var>cipher</var>: output variable indicating cipher, or <code>NULL</code>.

     <p><var>mac</var>: output variable indicating MAC algorithm, or <code>NULL</code>.

     <p><var>version</var>: output variable indicating TLS protocol version, or <code>NULL</code>.

     <p>Get information about supported cipher suites.  Use the function
iteratively to get information about all supported cipher suites. 
Call with idx=0 to get information about first cipher suite, then
idx=1 and so on until the function returns NULL.

     <p><strong>Returns:</strong> the name of <code>idx</code> cipher suite, and set the information
about the cipher suite in the output variables.  If <code>idx</code> is out of
bounds, <code>NULL</code> is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_compression_get_id</h4>

<p><a name="gnutls_005fcompression_005fget_005fid"></a>

<div class="defun">
&mdash; Function: gnutls_compression_method_t <b>gnutls_compression_get_id</b> (<var>const char * name</var>)<var><a name="index-gnutls_005fcompression_005fget_005fid-120"></a></var><br>
<blockquote><p><var>name</var>: is a compression method name

     <p>The names are compared in a case insensitive way.

     <p><strong>Returns:</strong> an id of the specified in a string compression method, or
<code>GNUTLS_COMP_UNKNOWN</code> on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_compression_get_name</h4>

<p><a name="gnutls_005fcompression_005fget_005fname"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_compression_get_name</b> (<var>gnutls_compression_method_t algorithm</var>)<var><a name="index-gnutls_005fcompression_005fget_005fname-121"></a></var><br>
<blockquote><p><var>algorithm</var>: is a Compression algorithm

     <p>Convert a <code>gnutls_compression_method_t</code> value to a string.

     <p><strong>Returns:</strong> a pointer to a string that contains the name of the
specified compression algorithm, or <code>NULL</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_compression_get</h4>

<p><a name="gnutls_005fcompression_005fget"></a>

<div class="defun">
&mdash; Function: gnutls_compression_method_t <b>gnutls_compression_get</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fcompression_005fget-122"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Get currently used compression algorithm.

     <p><strong>Returns:</strong> the currently used compression method, a
<code>gnutls_compression_method_t</code> value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_compression_list</h4>

<p><a name="gnutls_005fcompression_005flist"></a>

<div class="defun">
&mdash; Function: const gnutls_compression_method_t * <b>gnutls_compression_list</b> (<var> void</var>)<var><a name="index-gnutls_005fcompression_005flist-123"></a></var><br>
<blockquote>
     <p>Get a list of compression methods.  Note that to be able to use LZO
compression, you must link to libgnutls-extra and call
<code>gnutls_global_init_extra()</code>.

     <p><strong>Returns:</strong> a zero-terminated list of <code>gnutls_compression_method_t</code>
integers indicating the available compression methods. 
</p></blockquote></div>

<h4 class="subheading">gnutls_compression_set_priority</h4>

<p><a name="gnutls_005fcompression_005fset_005fpriority"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_compression_set_priority</b> (<var>gnutls_session_t session, const int * list</var>)<var><a name="index-gnutls_005fcompression_005fset_005fpriority-124"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>list</var>: is a 0 terminated list of gnutls_compression_method_t elements.

     <p>Sets the priority on the compression algorithms supported by gnutls. 
Priority is higher for elements specified before others. 
After specifying the algorithms you want, you must append a 0. 
Note that the priority is set on the client. The server does
not use the algorithm's priority except for disabling
algorithms that were not specified.

     <p>TLS 1.0 does not define any compression algorithms except
NULL. Other compression algorithms are to be considered
as gnutls extensions.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_credentials_clear</h4>

<p><a name="gnutls_005fcredentials_005fclear"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_credentials_clear</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fcredentials_005fclear-125"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Clears all the credentials previously set in this session. 
</p></blockquote></div>

<h4 class="subheading">gnutls_credentials_set</h4>

<p><a name="gnutls_005fcredentials_005fset"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_credentials_set</b> (<var>gnutls_session_t session, gnutls_credentials_type_t type, void * cred</var>)<var><a name="index-gnutls_005fcredentials_005fset-126"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>type</var>: is the type of the credentials

     <p><var>cred</var>: is a pointer to a structure.

     <p>Sets the needed credentials for the specified type. 
Eg username, password - or public and private keys etc. 
The (void* cred) parameter is a structure that depends on the
specified type and on the current session (client or server). 
[ In order to minimize memory usage, and share credentials between
several threads gnutls keeps a pointer to cred, and not the whole cred
structure. Thus you will have to keep the structure allocated until
you call <code>gnutls_deinit()</code>. ]

     <p>For GNUTLS_CRD_ANON cred should be gnutls_anon_client_credentials_t in case of a client. 
In case of a server it should be gnutls_anon_server_credentials_t.

     <p>For GNUTLS_CRD_SRP cred should be gnutls_srp_client_credentials_t
in case of a client, and gnutls_srp_server_credentials_t, in case
of a server.

     <p>For GNUTLS_CRD_CERTIFICATE cred should be gnutls_certificate_credentials_t. 
</p></blockquote></div>

<h4 class="subheading">gnutls_crypto_bigint_register2</h4>

<p><a name="gnutls_005fcrypto_005fbigint_005fregister2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_crypto_bigint_register2</b> (<var>int priority, int version, gnutls_crypto_bigint_st * s</var>)<var><a name="index-gnutls_005fcrypto_005fbigint_005fregister2-127"></a></var><br>
<blockquote><p><var>priority</var>: is the priority of the interface

     <p><var>version</var>: should be set to <code>GNUTLS_CRYPTO_API_VERSION</code>

     <p><var>s</var>: is a structure holding new interface's data

     <p>This function will register an interface for gnutls to operate
on big integers. Any interface registered will override
the included interface. The interface with the lowest
priority will be used by gnutls.

     <p>Note that the bigint interface must interoperate with the public
key interface. Thus if this interface is updated the
<code>gnutls_crypto_pk_register()</code> should also be used.

     <p>This function should be called before <code>gnutls_global_init()</code>.

     <p>For simplicity you can use the convenience <code>gnutls_crypto_bigint_register()</code>
macro.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_crypto_cipher_register2</h4>

<p><a name="gnutls_005fcrypto_005fcipher_005fregister2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_crypto_cipher_register2</b> (<var>int priority, int version, gnutls_crypto_cipher_st * s</var>)<var><a name="index-gnutls_005fcrypto_005fcipher_005fregister2-128"></a></var><br>
<blockquote><p><var>priority</var>: is the priority of the cipher interface

     <p><var>version</var>: should be set to <code>GNUTLS_CRYPTO_API_VERSION</code>

     <p><var>s</var>: is a structure holding new interface's data

     <p>This function will register a cipher interface to be used by
gnutls. Any interface registered will override the included engine
and by convention kernel implemented interfaces should have
priority of 90. The interface with the lowest priority will be used
by gnutls.

     <p>This function should be called before <code>gnutls_global_init()</code>.

     <p>For simplicity you can use the convenience
<code>gnutls_crypto_cipher_register()</code> macro.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_crypto_digest_register2</h4>

<p><a name="gnutls_005fcrypto_005fdigest_005fregister2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_crypto_digest_register2</b> (<var>int priority, int version, gnutls_crypto_digest_st * s</var>)<var><a name="index-gnutls_005fcrypto_005fdigest_005fregister2-129"></a></var><br>
<blockquote><p><var>priority</var>: is the priority of the digest interface

     <p><var>version</var>: should be set to <code>GNUTLS_CRYPTO_API_VERSION</code>

     <p><var>s</var>: is a structure holding new interface's data

     <p>This function will register a digest interface to be used by
gnutls. Any interface registered will override the included engine
and by convention kernel implemented interfaces should have
priority of 90. The interface with the lowest priority will be used
by gnutls.

     <p>This function should be called before <code>gnutls_global_init()</code>.

     <p>For simplicity you can use the convenience
<code>gnutls_crypto_digest_register()</code> macro.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_crypto_mac_register2</h4>

<p><a name="gnutls_005fcrypto_005fmac_005fregister2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_crypto_mac_register2</b> (<var>int priority, int version, gnutls_crypto_mac_st * s</var>)<var><a name="index-gnutls_005fcrypto_005fmac_005fregister2-130"></a></var><br>
<blockquote><p><var>priority</var>: is the priority of the mac interface

     <p><var>version</var>: should be set to <code>GNUTLS_CRYPTO_API_VERSION</code>

     <p><var>s</var>: is a structure holding new interface's data

     <p>This function will register a mac interface to be used by
gnutls. Any interface registered will override the included engine
and by convention kernel implemented interfaces should have
priority of 90. The interface with the lowest priority will be used
by gnutls.

     <p>This function should be called before <code>gnutls_global_init()</code>.

     <p>For simplicity you can use the convenience
<code>gnutls_crypto_mac_register()</code> macro.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_crypto_pk_register2</h4>

<p><a name="gnutls_005fcrypto_005fpk_005fregister2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_crypto_pk_register2</b> (<var>int priority, int version, gnutls_crypto_pk_st * s</var>)<var><a name="index-gnutls_005fcrypto_005fpk_005fregister2-131"></a></var><br>
<blockquote><p><var>priority</var>: is the priority of the interface

     <p><var>version</var>: should be set to <code>GNUTLS_CRYPTO_API_VERSION</code>

     <p><var>s</var>: is a structure holding new interface's data

     <p>This function will register an interface for gnutls to operate
on public key operations. Any interface registered will override
the included interface. The interface with the lowest
priority will be used by gnutls.

     <p>Note that the bigint interface must interoperate with the bigint
interface. Thus if this interface is updated the
<code>gnutls_crypto_bigint_register()</code> should also be used.

     <p>This function should be called before <code>gnutls_global_init()</code>.

     <p>For simplicity you can use the convenience <code>gnutls_crypto_pk_register()</code>
macro.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_crypto_rnd_register2</h4>

<p><a name="gnutls_005fcrypto_005frnd_005fregister2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_crypto_rnd_register2</b> (<var>int priority, int version, gnutls_crypto_rnd_st * s</var>)<var><a name="index-gnutls_005fcrypto_005frnd_005fregister2-132"></a></var><br>
<blockquote><p><var>priority</var>: is the priority of the generator

     <p><var>version</var>: should be set to <code>GNUTLS_CRYPTO_API_VERSION</code>

     <p><var>s</var>: is a structure holding new generator's data

     <p>This function will register a random generator to be used by
gnutls.  Any generator registered will override the included
generator and by convention kernel implemented generators have
priority of 90.  The generator with the lowest priority will be
used by gnutls.

     <p>This function should be called before <code>gnutls_global_init()</code>.

     <p>For simplicity you can use the convenience
<code>gnutls_crypto_rnd_register()</code> macro.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_crypto_single_cipher_register2</h4>

<p><a name="gnutls_005fcrypto_005fsingle_005fcipher_005fregister2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_crypto_single_cipher_register2</b> (<var>gnutls_cipher_algorithm_t algorithm, int priority, int version, gnutls_crypto_single_cipher_st * s</var>)<var><a name="index-gnutls_005fcrypto_005fsingle_005fcipher_005fregister2-133"></a></var><br>
<blockquote><p><var>algorithm</var>: is the gnutls algorithm identifier

     <p><var>priority</var>: is the priority of the algorithm

     <p><var>version</var>: should be set to <code>GNUTLS_CRYPTO_API_VERSION</code>

     <p><var>s</var>: is a structure holding new cipher's data

     <p>This function will register a cipher algorithm to be used by
gnutls.  Any algorithm registered will override the included
algorithms and by convention kernel implemented algorithms have
priority of 90.  The algorithm with the lowest priority will be
used by gnutls.

     <p>This function should be called before <code>gnutls_global_init()</code>.

     <p>For simplicity you can use the convenience
<code>gnutls_crypto_single_cipher_register()</code> macro.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_crypto_single_digest_register2</h4>

<p><a name="gnutls_005fcrypto_005fsingle_005fdigest_005fregister2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_crypto_single_digest_register2</b> (<var>gnutls_digest_algorithm_t algorithm, int priority, int version, gnutls_crypto_single_digest_st * s</var>)<var><a name="index-gnutls_005fcrypto_005fsingle_005fdigest_005fregister2-134"></a></var><br>
<blockquote><p><var>algorithm</var>: is the gnutls algorithm identifier

     <p><var>priority</var>: is the priority of the algorithm

     <p><var>version</var>: should be set to <code>GNUTLS_CRYPTO_API_VERSION</code>

     <p><var>s</var>: is a structure holding new algorithms's data

     <p>This function will register a digest (hash) algorithm to be used by
gnutls.  Any algorithm registered will override the included
algorithms and by convention kernel implemented algorithms have
priority of 90.  The algorithm with the lowest priority will be
used by gnutls.

     <p>This function should be called before <code>gnutls_global_init()</code>.

     <p>For simplicity you can use the convenience
<code>gnutls_crypto_single_digest_register()</code> macro.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_crypto_single_mac_register2</h4>

<p><a name="gnutls_005fcrypto_005fsingle_005fmac_005fregister2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_crypto_single_mac_register2</b> (<var>gnutls_mac_algorithm_t algorithm, int priority, int version, gnutls_crypto_single_mac_st * s</var>)<var><a name="index-gnutls_005fcrypto_005fsingle_005fmac_005fregister2-135"></a></var><br>
<blockquote><p><var>algorithm</var>: is the gnutls algorithm identifier

     <p><var>priority</var>: is the priority of the algorithm

     <p><var>version</var>: should be set to <code>GNUTLS_CRYPTO_API_VERSION</code>

     <p><var>s</var>: is a structure holding new algorithms's data

     <p>This function will register a MAC algorithm to be used by gnutls. 
Any algorithm registered will override the included algorithms and
by convention kernel implemented algorithms have priority of 90. 
The algorithm with the lowest priority will be used by gnutls.

     <p>This function should be called before <code>gnutls_global_init()</code>.

     <p>For simplicity you can use the convenience
<code>gnutls_crypto_single_mac_register()</code> macro.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_db_check_entry</h4>

<p><a name="gnutls_005fdb_005fcheck_005fentry"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_db_check_entry</b> (<var>gnutls_session_t session, gnutls_datum_t session_entry</var>)<var><a name="index-gnutls_005fdb_005fcheck_005fentry-136"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>session_entry</var>: is the session data (not key)

     <p>Check if database entry has expired.  This function is to be used
when you want to clear unnesessary session which occupy space in
your backend.

     <p><strong>Returns:</strong> Returns <code>GNUTLS_E_EXPIRED</code>, if the database entry has
expired or 0 otherwise. 
</p></blockquote></div>

<h4 class="subheading">gnutls_db_get_ptr</h4>

<p><a name="gnutls_005fdb_005fget_005fptr"></a>

<div class="defun">
&mdash; Function: void * <b>gnutls_db_get_ptr</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fdb_005fget_005fptr-137"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Get db function pointer.

     <p><strong>Returns:</strong> the pointer that will be sent to db store, retrieve and
delete functions, as the first argument. 
</p></blockquote></div>

<h4 class="subheading">gnutls_db_remove_session</h4>

<p><a name="gnutls_005fdb_005fremove_005fsession"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_db_remove_session</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fdb_005fremove_005fsession-138"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>This function will remove the current session data from the
session database.  This will prevent future handshakes reusing
these session data.  This function should be called if a session
was terminated abnormally, and before <code>gnutls_deinit()</code> is called.

     <p>Normally <code>gnutls_deinit()</code> will remove abnormally terminated
sessions. 
</p></blockquote></div>

<h4 class="subheading">gnutls_db_set_cache_expiration</h4>

<p><a name="gnutls_005fdb_005fset_005fcache_005fexpiration"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_db_set_cache_expiration</b> (<var>gnutls_session_t session, int seconds</var>)<var><a name="index-gnutls_005fdb_005fset_005fcache_005fexpiration-139"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>seconds</var>: is the number of seconds.

     <p>Set the expiration time for resumed sessions. The default is 3600
(one hour) at the time writing this. 
</p></blockquote></div>

<h4 class="subheading">gnutls_db_set_ptr</h4>

<p><a name="gnutls_005fdb_005fset_005fptr"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_db_set_ptr</b> (<var>gnutls_session_t session, void * ptr</var>)<var><a name="index-gnutls_005fdb_005fset_005fptr-140"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>ptr</var>: is the pointer

     <p>Sets the pointer that will be provided to db store, retrieve and
delete functions, as the first argument. 
</p></blockquote></div>

<h4 class="subheading">gnutls_db_set_remove_function</h4>

<p><a name="gnutls_005fdb_005fset_005fremove_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_db_set_remove_function</b> (<var>gnutls_session_t session, gnutls_db_remove_func rem_func</var>)<var><a name="index-gnutls_005fdb_005fset_005fremove_005ffunction-141"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>rem_func</var>: is the function.

     <p>Sets the function that will be used to remove data from the
resumed sessions database. This function must return 0 on success.

     <p>The first argument to <code>rem_func()</code> will be null unless
<code>gnutls_db_set_ptr()</code> has been called. 
</p></blockquote></div>

<h4 class="subheading">gnutls_db_set_retrieve_function</h4>

<p><a name="gnutls_005fdb_005fset_005fretrieve_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_db_set_retrieve_function</b> (<var>gnutls_session_t session, gnutls_db_retr_func retr_func</var>)<var><a name="index-gnutls_005fdb_005fset_005fretrieve_005ffunction-142"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>retr_func</var>: is the function.

     <p>Sets the function that will be used to retrieve data from the
resumed sessions database.  This function must return a
gnutls_datum_t containing the data on success, or a gnutls_datum_t
containing null and 0 on failure.

     <p>The datum's data must be allocated using the function
<code>gnutls_malloc()</code>.

     <p>The first argument to <code>retr_func()</code> will be null unless
<code>gnutls_db_set_ptr()</code> has been called. 
</p></blockquote></div>

<h4 class="subheading">gnutls_db_set_store_function</h4>

<p><a name="gnutls_005fdb_005fset_005fstore_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_db_set_store_function</b> (<var>gnutls_session_t session, gnutls_db_store_func store_func</var>)<var><a name="index-gnutls_005fdb_005fset_005fstore_005ffunction-143"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>store_func</var>: is the function

     <p>Sets the function that will be used to store data from the resumed
sessions database. This function must remove 0 on success.

     <p>The first argument to <code>store_func()</code> will be null unless
<code>gnutls_db_set_ptr()</code> has been called. 
</p></blockquote></div>

<h4 class="subheading">gnutls_deinit</h4>

<p><a name="gnutls_005fdeinit"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_deinit</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fdeinit-144"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>This function clears all buffers associated with the <code>session</code>. 
This function will also remove session data from the session
database if the session was terminated abnormally. 
</p></blockquote></div>

<h4 class="subheading">gnutls_dh_get_group</h4>

<p><a name="gnutls_005fdh_005fget_005fgroup"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_dh_get_group</b> (<var>gnutls_session_t session, gnutls_datum_t * raw_gen, gnutls_datum_t * raw_prime</var>)<var><a name="index-gnutls_005fdh_005fget_005fgroup-145"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p><var>raw_gen</var>: will hold the generator.

     <p><var>raw_prime</var>: will hold the prime.

     <p>This function will return the group parameters used in the last
Diffie Hellman authentication with the peer.  These are the prime
and the generator used.  This function should be used for both
anonymous and ephemeral diffie Hellman.  The output parameters must
be freed with <code>gnutls_free()</code>.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, otherwise
an error code is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_dh_get_peers_public_bits</h4>

<p><a name="gnutls_005fdh_005fget_005fpeers_005fpublic_005fbits"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_dh_get_peers_public_bits</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fdh_005fget_005fpeers_005fpublic_005fbits-146"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p>Get the Diffie-Hellman public key bit size.  Can be used for both
anonymous and ephemeral diffie Hellman.

     <p><strong>Returns:</strong> the public key bit size used in the last Diffie Hellman
authentication with the peer, or a negative value in case of
error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_dh_get_prime_bits</h4>

<p><a name="gnutls_005fdh_005fget_005fprime_005fbits"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_dh_get_prime_bits</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fdh_005fget_005fprime_005fbits-147"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p>This function will return the bits of the prime used in the last
Diffie Hellman authentication with the peer.  Should be used for
both anonymous and ephemeral diffie Hellman.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, otherwise
an error code is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_dh_get_pubkey</h4>

<p><a name="gnutls_005fdh_005fget_005fpubkey"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_dh_get_pubkey</b> (<var>gnutls_session_t session, gnutls_datum_t * raw_key</var>)<var><a name="index-gnutls_005fdh_005fget_005fpubkey-148"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p><var>raw_key</var>: will hold the public key.

     <p>This function will return the peer's public key used in the last
Diffie Hellman authentication.  This function should be used for
both anonymous and ephemeral diffie Hellman.  The output
parameters must be freed with <code>gnutls_free()</code>.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, otherwise
an error code is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_dh_get_secret_bits</h4>

<p><a name="gnutls_005fdh_005fget_005fsecret_005fbits"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_dh_get_secret_bits</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fdh_005fget_005fsecret_005fbits-149"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p>This function will return the bits used in the last Diffie Hellman
authentication with the peer.  Should be used for both anonymous
and ephemeral diffie Hellman.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, otherwise
an error code is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_dh_params_cpy</h4>

<p><a name="gnutls_005fdh_005fparams_005fcpy"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_dh_params_cpy</b> (<var>gnutls_dh_params_t dst, gnutls_dh_params_t src</var>)<var><a name="index-gnutls_005fdh_005fparams_005fcpy-150"></a></var><br>
<blockquote><p><var>dst</var>: Is the destination structure, which should be initialized.

     <p><var>src</var>: Is the source structure

     <p>This function will copy the DH parameters structure from source
to destination. 
</p></blockquote></div>

<h4 class="subheading">gnutls_dh_params_deinit</h4>

<p><a name="gnutls_005fdh_005fparams_005fdeinit"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_dh_params_deinit</b> (<var>gnutls_dh_params_t dh_params</var>)<var><a name="index-gnutls_005fdh_005fparams_005fdeinit-151"></a></var><br>
<blockquote><p><var>dh_params</var>: Is a structure that holds the prime numbers

     <p>This function will deinitialize the DH parameters structure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_dh_params_export_pkcs3</h4>

<p><a name="gnutls_005fdh_005fparams_005fexport_005fpkcs3"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_dh_params_export_pkcs3</b> (<var>gnutls_dh_params_t params, gnutls_x509_crt_fmt_t format, unsigned char * params_data, size_t * params_data_size</var>)<var><a name="index-gnutls_005fdh_005fparams_005fexport_005fpkcs3-152"></a></var><br>
<blockquote><p><var>params</var>: Holds the DH parameters

     <p><var>format</var>: the format of output params. One of PEM or DER.

     <p><var>params_data</var>: will contain a PKCS3 DHParams structure PEM or DER encoded

     <p><var>params_data_size</var>: holds the size of params_data (and will be replaced by the actual size of parameters)

     <p>This function will export the given dh parameters to a PKCS3
DHParams structure. This is the format generated by "openssl dhparam" tool. 
If the buffer provided is not long enough to hold the output, then
GNUTLS_E_SHORT_MEMORY_BUFFER will be returned.

     <p>If the structure is PEM encoded, it will have a header
of "BEGIN DH PARAMETERS".

     <p>In case of failure a negative value will be returned, and
0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_dh_params_export_raw</h4>

<p><a name="gnutls_005fdh_005fparams_005fexport_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_dh_params_export_raw</b> (<var>gnutls_dh_params_t params, gnutls_datum_t * prime, gnutls_datum_t * generator, unsigned int * bits</var>)<var><a name="index-gnutls_005fdh_005fparams_005fexport_005fraw-153"></a></var><br>
<blockquote><p><var>params</var>: Holds the DH parameters

     <p><var>prime</var>: will hold the new prime

     <p><var>generator</var>: will hold the new generator

     <p><var>bits</var>: if non null will hold is the prime's number of bits

     <p>This function will export the pair of prime and generator for use in
the Diffie-Hellman key exchange. The new parameters will be allocated using
<code>gnutls_malloc()</code> and will be stored in the appropriate datum. 
</p></blockquote></div>

<h4 class="subheading">gnutls_dh_params_generate2</h4>

<p><a name="gnutls_005fdh_005fparams_005fgenerate2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_dh_params_generate2</b> (<var>gnutls_dh_params_t params, unsigned int bits</var>)<var><a name="index-gnutls_005fdh_005fparams_005fgenerate2-154"></a></var><br>
<blockquote><p><var>params</var>: Is the structure that the DH parameters will be stored

     <p><var>bits</var>: is the prime's number of bits

     <p>This function will generate a new pair of prime and generator for use in
the Diffie-Hellman key exchange. The new parameters will be allocated using
<code>gnutls_malloc()</code> and will be stored in the appropriate datum. 
This function is normally slow.

     <p>Note that the bits value should be one of 768, 1024, 2048, 3072 or 4096. 
Also note that the DH parameters are only useful to servers. 
Since clients use the parameters sent by the server, it's of
no use to call this in client side. 
</p></blockquote></div>

<h4 class="subheading">gnutls_dh_params_import_pkcs3</h4>

<p><a name="gnutls_005fdh_005fparams_005fimport_005fpkcs3"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_dh_params_import_pkcs3</b> (<var>gnutls_dh_params_t params, const gnutls_datum_t * pkcs3_params, gnutls_x509_crt_fmt_t format</var>)<var><a name="index-gnutls_005fdh_005fparams_005fimport_005fpkcs3-155"></a></var><br>
<blockquote><p><var>params</var>: A structure where the parameters will be copied to

     <p><var>pkcs3_params</var>: should contain a PKCS3 DHParams structure PEM or DER encoded

     <p><var>format</var>: the format of params. PEM or DER.

     <p>This function will extract the DHParams found in a PKCS3 formatted
structure. This is the format generated by "openssl dhparam" tool.

     <p>If the structure is PEM encoded, it should have a header
of "BEGIN DH PARAMETERS".

     <p>In case of failure a negative value will be returned, and
0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_dh_params_import_raw</h4>

<p><a name="gnutls_005fdh_005fparams_005fimport_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_dh_params_import_raw</b> (<var>gnutls_dh_params_t dh_params, const gnutls_datum_t * prime, const gnutls_datum_t * generator</var>)<var><a name="index-gnutls_005fdh_005fparams_005fimport_005fraw-156"></a></var><br>
<blockquote><p><var>dh_params</var>: Is a structure that will hold the prime numbers

     <p><var>prime</var>: holds the new prime

     <p><var>generator</var>: holds the new generator

     <p>This function will replace the pair of prime and generator for use in
the Diffie-Hellman key exchange. The new parameters should be stored in the
appropriate gnutls_datum. 
</p></blockquote></div>

<h4 class="subheading">gnutls_dh_params_init</h4>

<p><a name="gnutls_005fdh_005fparams_005finit"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_dh_params_init</b> (<var>gnutls_dh_params_t * dh_params</var>)<var><a name="index-gnutls_005fdh_005fparams_005finit-157"></a></var><br>
<blockquote><p><var>dh_params</var>: Is a structure that will hold the prime numbers

     <p>This function will initialize the DH parameters structure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_dh_set_prime_bits</h4>

<p><a name="gnutls_005fdh_005fset_005fprime_005fbits"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_dh_set_prime_bits</b> (<var>gnutls_session_t session, unsigned int bits</var>)<var><a name="index-gnutls_005fdh_005fset_005fprime_005fbits-158"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>bits</var>: is the number of bits

     <p>This function sets the number of bits, for use in an Diffie Hellman
key exchange.  This is used both in DH ephemeral and DH anonymous
cipher suites.  This will set the minimum size of the prime that
will be used for the handshake.

     <p>In the client side it sets the minimum accepted number of bits.  If
a server sends a prime with less bits than that
<code>GNUTLS_E_DH_PRIME_UNACCEPTABLE</code> will be returned by the handshake. 
</p></blockquote></div>

<h4 class="subheading">gnutls_error_is_fatal</h4>

<p><a name="gnutls_005ferror_005fis_005ffatal"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_error_is_fatal</b> (<var>int error</var>)<var><a name="index-gnutls_005ferror_005fis_005ffatal-159"></a></var><br>
<blockquote><p><var>error</var>: is a GnuTLS error code, a negative value

     <p>If a GnuTLS function returns a negative value you may feed that
value to this function to see if the error condition is fatal.

     <p>Note that you may want to check the error code manually, since some
non-fatal errors to the protocol may be fatal for you program.

     <p>This function is only useful if you are dealing with errors from
the record layer or the handshake layer.

     <p><strong>Returns:</strong> 1 if the error code is fatal, for positive <code>error</code> values,
0 is returned.  For unknown <code>error</code> values, -1 is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_error_to_alert</h4>

<p><a name="gnutls_005ferror_005fto_005falert"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_error_to_alert</b> (<var>int err, int * level</var>)<var><a name="index-gnutls_005ferror_005fto_005falert-160"></a></var><br>
<blockquote><p><var>err</var>: is a negative integer

     <p><var>level</var>: the alert level will be stored there

     <p>Get an alert depending on the error code returned by a gnutls
function.  All alerts sent by this function should be considered
fatal.  The only exception is when <code>err</code> is <code>GNUTLS_E_REHANDSHAKE</code>,
where a warning alert should be sent to the peer indicating that no
renegotiation will be performed.

     <p>If there is no mapping to a valid alert the alert to indicate
internal error is returned.

     <p><strong>Returns:</strong> the alert code to use for a particular error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ext_register</h4>

<p><a name="gnutls_005fext_005fregister"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_ext_register</b> (<var>int type, const char * name, gnutls_ext_parse_type_t parse_type, gnutls_ext_recv_func recv_func, gnutls_ext_send_func send_func</var>)<var><a name="index-gnutls_005fext_005fregister-161"></a></var><br>
<blockquote><p><var>type</var>: the 16-bit integer referring to the extension type

     <p><var>name</var>: human printable name of the extension used for debugging

     <p><var>parse_type</var>: either <code>GNUTLS_EXT_TLS</code> or <code>GNUTLS_EXT_APPLICATION</code>.

     <p><var>recv_func</var>: a function to receive extension data

     <p><var>send_func</var>: a function to send extension data

     <p>This function is used to register a new TLS extension handler.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_fingerprint</h4>

<p><a name="gnutls_005ffingerprint"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_fingerprint</b> (<var>gnutls_digest_algorithm_t algo, const gnutls_datum_t * data, void * result, size_t * result_size</var>)<var><a name="index-gnutls_005ffingerprint-162"></a></var><br>
<blockquote><p><var>algo</var>: is a digest algorithm

     <p><var>data</var>: is the data

     <p><var>result</var>: is the place where the result will be copied (may be null).

     <p><var>result_size</var>: should hold the size of the result. The actual size
of the returned result will also be copied there.

     <p>This function will calculate a fingerprint (actually a hash), of
the given data.  The result is not printable data.  You should
convert it to hex, or to something else printable.

     <p>This is the usual way to calculate a fingerprint of an X.509 DER
encoded certificate.  Note however that the fingerprint of an
OpenPGP is not just a hash and cannot be calculated with this
function.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, otherwise
an error code is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_free</h4>

<p><a name="gnutls_005ffree"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_free</b> (<var>void * ptr</var>)<var><a name="index-gnutls_005ffree-163"></a></var><br>
<blockquote><p>This function will free data pointed by ptr.

     <p>The deallocation function used is the one set by <code>gnutls_global_set_mem_functions()</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_global_deinit</h4>

<p><a name="gnutls_005fglobal_005fdeinit"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_global_deinit</b> (<var> void</var>)<var><a name="index-gnutls_005fglobal_005fdeinit-164"></a></var><br>
<blockquote>
     <p>This function deinitializes the global data, that were initialized
using <code>gnutls_global_init()</code>.

     <p>Note!  This function is not thread safe.  See the discussion for
<code>gnutls_global_init()</code> for more information. 
</p></blockquote></div>

<h4 class="subheading">gnutls_global_init</h4>

<p><a name="gnutls_005fglobal_005finit"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_global_init</b> (<var> void</var>)<var><a name="index-gnutls_005fglobal_005finit-165"></a></var><br>
<blockquote>
     <p>This function initializes the global data to defaults.  Every
gnutls application has a global data which holds common parameters
shared by gnutls session structures.  You should call
<code>gnutls_global_deinit()</code> when gnutls usage is no longer needed

     <p>Note that this function will also initialize libgcrypt, if it has
not been initialized before.  Thus if you want to manually
initialize libgcrypt you must do it before calling this function. 
This is useful in cases you want to disable libgcrypt's internal
lockings etc.

     <p>This function increment a global counter, so that
<code>gnutls_global_deinit()</code> only releases resources when it has been
called as many times as <code>gnutls_global_init()</code>.  This is useful when
GnuTLS is used by more than one library in an application.  This
function can be called many times, but will only do something the
first time.

     <p>Note!  This function is not thread safe.  If two threads call this
function simultaneously, they can cause a race between checking
the global counter and incrementing it, causing both threads to
execute the library initialization code.  That would lead to a
memory leak.  To handle this, your application could invoke this
function after aquiring a thread mutex.  To ignore the potential
memory leak is also an option.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (zero) is returned,
otherwise an error code is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_global_set_log_function</h4>

<p><a name="gnutls_005fglobal_005fset_005flog_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_global_set_log_function</b> (<var>gnutls_log_func log_func</var>)<var><a name="index-gnutls_005fglobal_005fset_005flog_005ffunction-166"></a></var><br>
<blockquote><p><var>log_func</var>: it's a log function

     <p>This is the function where you set the logging function gnutls
is going to use. This function only accepts a character array. 
Normally you may not use this function since it is only used
for debugging purposes.

     <p>gnutls_log_func is of the form,
void (*gnutls_log_func)( int level, const char*);
</p></blockquote></div>

<h4 class="subheading">gnutls_global_set_log_level</h4>

<p><a name="gnutls_005fglobal_005fset_005flog_005flevel"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_global_set_log_level</b> (<var>int level</var>)<var><a name="index-gnutls_005fglobal_005fset_005flog_005flevel-167"></a></var><br>
<blockquote><p><var>level</var>: it's an integer from 0 to 9.

     <p>This is the function that allows you to set the log level. 
The level is an integer between 0 and 9. Higher values mean
more verbosity. The default value is 0. Larger values should
only be used with care, since they may reveal sensitive information.

     <p>Use a log level over 10 to enable all debugging options. 
</p></blockquote></div>

<h4 class="subheading">gnutls_global_set_mem_functions</h4>

<p><a name="gnutls_005fglobal_005fset_005fmem_005ffunctions"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_global_set_mem_functions</b> (<var>gnutls_alloc_function alloc_func, gnutls_alloc_function secure_alloc_func, gnutls_is_secure_function is_secure_func, gnutls_realloc_function realloc_func, gnutls_free_function free_func</var>)<var><a name="index-gnutls_005fglobal_005fset_005fmem_005ffunctions-168"></a></var><br>
<blockquote><p><var>alloc_func</var>: it's the default memory allocation function. Like <code>malloc()</code>.

     <p><var>secure_alloc_func</var>: This is the memory allocation function that will be used for sensitive data.

     <p><var>is_secure_func</var>: a function that returns 0 if the memory given is not secure. May be NULL.

     <p><var>realloc_func</var>: A realloc function

     <p><var>free_func</var>: The function that frees allocated data. Must accept a NULL pointer.

     <p>This is the function were you set the memory allocation functions gnutls
is going to use. By default the libc's allocation functions (<code>malloc()</code>, <code>free()</code>),
are used by gnutls, to allocate both sensitive and not sensitive data. 
This function is provided to set the memory allocation functions to
something other than the defaults (ie the gcrypt allocation functions).

     <p>This function must be called before <code>gnutls_global_init()</code> is called. 
</p></blockquote></div>

<h4 class="subheading">gnutls_handshake_get_last_in</h4>

<p><a name="gnutls_005fhandshake_005fget_005flast_005fin"></a>

<div class="defun">
&mdash; Function: gnutls_handshake_description_t <b>gnutls_handshake_get_last_in</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fhandshake_005fget_005flast_005fin-169"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>This function is only useful to check where the last performed
handshake failed.  If the previous handshake succeed or was not
performed at all then no meaningful value will be returned.

     <p>Check <code>gnutls_handshake_description_t</code> in gnutls.h for the
available handshake descriptions.

     <p><strong>Returns:</strong> the last handshake message type received, a
<code>gnutls_handshake_description_t</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_handshake_get_last_out</h4>

<p><a name="gnutls_005fhandshake_005fget_005flast_005fout"></a>

<div class="defun">
&mdash; Function: gnutls_handshake_description_t <b>gnutls_handshake_get_last_out</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fhandshake_005fget_005flast_005fout-170"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>This function is only useful to check where the last performed
handshake failed.  If the previous handshake succeed or was not
performed at all then no meaningful value will be returned.

     <p>Check <code>gnutls_handshake_description_t</code> in gnutls.h for the
available handshake descriptions.

     <p><strong>Returns:</strong> the last handshake message type sent, a
<code>gnutls_handshake_description_t</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_handshake_set_max_packet_length</h4>

<p><a name="gnutls_005fhandshake_005fset_005fmax_005fpacket_005flength"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_handshake_set_max_packet_length</b> (<var>gnutls_session_t session, size_t max</var>)<var><a name="index-gnutls_005fhandshake_005fset_005fmax_005fpacket_005flength-171"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>max</var>: is the maximum number.

     <p>This function will set the maximum size of all handshake messages. 
Handshakes over this size are rejected with
<code>GNUTLS_E_HANDSHAKE_TOO_LARGE</code> error code.  The default value is
48kb which is typically large enough.  Set this to 0 if you do not
want to set an upper limit.

     <p>The reason for restricting the handshake message sizes are to
limit Denial of Service attacks. 
</p></blockquote></div>

<h4 class="subheading">gnutls_handshake_set_post_client_hello_function</h4>

<p><a name="gnutls_005fhandshake_005fset_005fpost_005fclient_005fhello_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_handshake_set_post_client_hello_function</b> (<var>gnutls_session_t session, gnutls_handshake_post_client_hello_func func</var>)<var><a name="index-gnutls_005fhandshake_005fset_005fpost_005fclient_005fhello_005ffunction-172"></a></var><br>
<blockquote><p><var>func</var>: is the function to be called

     <p>This function will set a callback to be called after the client
hello has been received (callback valid in server side only). This
allows the server to adjust settings based on received extensions.

     <p>Those settings could be ciphersuites, requesting certificate, or
anything else except for version negotiation (this is done before
the hello message is parsed).

     <p>This callback must return 0 on success or a gnutls error code to
terminate the handshake.

     <p><strong>Warning:</strong> You should not use this function to terminate the
handshake based on client input unless you know what you are
doing. Before the handshake is finished there is no way to know if
there is a man-in-the-middle attack being performed. 
</p></blockquote></div>

<h4 class="subheading">gnutls_handshake_set_private_extensions</h4>

<p><a name="gnutls_005fhandshake_005fset_005fprivate_005fextensions"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_handshake_set_private_extensions</b> (<var>gnutls_session_t session, int allow</var>)<var><a name="index-gnutls_005fhandshake_005fset_005fprivate_005fextensions-173"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>allow</var>: is an integer (0 or 1)

     <p>This function will enable or disable the use of private cipher
suites (the ones that start with 0xFF).  By default or if <code>allow</code>
is 0 then these cipher suites will not be advertized nor used.

     <p>Unless this function is called with the option to allow (1), then
no compression algorithms, like LZO.  That is because these
algorithms are not yet defined in any RFC or even internet draft.

     <p>Enabling the private ciphersuites when talking to other than
gnutls servers and clients may cause interoperability problems. 
</p></blockquote></div>

<h4 class="subheading">gnutls_handshake</h4>

<p><a name="gnutls_005fhandshake"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_handshake</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fhandshake-174"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>This function does the handshake of the TLS/SSL protocol, and
initializes the TLS connection.

     <p>This function will fail if any problem is encountered, and will
return a negative error code. In case of a client, if the client
has asked to resume a session, but the server couldn't, then a
full handshake will be performed.

     <p>The non-fatal errors such as <code>GNUTLS_E_AGAIN</code> and
<code>GNUTLS_E_INTERRUPTED</code> interrupt the handshake procedure, which
should be later be resumed.  Call this function again, until it
returns 0; cf.  <code>gnutls_record_get_direction()</code> and
<code>gnutls_error_is_fatal()</code>.

     <p>If this function is called by a server after a rehandshake request
then <code>GNUTLS_E_GOT_APPLICATION_DATA</code> or
<code>GNUTLS_E_WARNING_ALERT_RECEIVED</code> may be returned.  Note that these
are non fatal errors, only in the specific case of a rehandshake. 
Their meaning is that the client rejected the rehandshake request.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_hex2bin</h4>

<p><a name="gnutls_005fhex2bin"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_hex2bin</b> (<var>const char * hex_data, size_t hex_size, char * bin_data, size_t * bin_size</var>)<var><a name="index-gnutls_005fhex2bin-175"></a></var><br>
<blockquote><p><var>hex_data</var>: string with data in hex format

     <p><var>hex_size</var>: size of hex data

     <p><var>bin_data</var>: output array with binary data

     <p><var>bin_size</var>: when calling *<code>bin_size</code> should hold size of <code>bin_data</code>,
on return will hold actual size of <code>bin_data</code>.

     <p>Convert a buffer with hex data to binary data.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_hex_decode</h4>

<p><a name="gnutls_005fhex_005fdecode"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_hex_decode</b> (<var>const gnutls_datum_t * hex_data, char * result, size_t * result_size</var>)<var><a name="index-gnutls_005fhex_005fdecode-176"></a></var><br>
<blockquote><p><var>hex_data</var>: contain the encoded data

     <p><var>result</var>: the place where decoded data will be copied

     <p><var>result_size</var>: holds the size of the result

     <p>This function will decode the given encoded data, using the hex encoding
used by PSK password files.

     <p>Note that hex_data should be null terminated.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> if the buffer given is not
long enough, or 0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_hex_encode</h4>

<p><a name="gnutls_005fhex_005fencode"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_hex_encode</b> (<var>const gnutls_datum_t * data, char * result, size_t * result_size</var>)<var><a name="index-gnutls_005fhex_005fencode-177"></a></var><br>
<blockquote><p><var>data</var>: contain the raw data

     <p><var>result</var>: the place where hex data will be copied

     <p><var>result_size</var>: holds the size of the result

     <p>This function will convert the given data to printable data, using
the hex encoding, as used in the PSK password files.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> if the buffer given is not
long enough, or 0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_init</h4>

<p><a name="gnutls_005finit"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_init</b> (<var>gnutls_session_t * session, gnutls_connection_end_t con_end</var>)<var><a name="index-gnutls_005finit-178"></a></var><br>
<blockquote><p><var>session</var>: is a pointer to a <code>gnutls_session_t</code> structure.

     <p><var>con_end</var>: indicate if this session is to be used for server or client.

     <p>This function initializes the current session to null. Every
session must be initialized before use, so internal structures can
be allocated.  This function allocates structures which can only
be free'd by calling <code>gnutls_deinit()</code>.  Returns zero on success.

     <p><code>con_end</code> can be one of <code>GNUTLS_CLIENT</code> and <code>GNUTLS_SERVER</code>.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_kx_get_id</h4>

<p><a name="gnutls_005fkx_005fget_005fid"></a>

<div class="defun">
&mdash; Function: gnutls_kx_algorithm_t <b>gnutls_kx_get_id</b> (<var>const char * name</var>)<var><a name="index-gnutls_005fkx_005fget_005fid-179"></a></var><br>
<blockquote><p><var>name</var>: is a KX name

     <p>Convert a string to a <code>gnutls_kx_algorithm_t</code> value.  The names are
compared in a case insensitive way.

     <p><strong>Returns:</strong> an id of the specified KX algorithm, or <code>GNUTLS_KX_UNKNOWN</code>
on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_kx_get_name</h4>

<p><a name="gnutls_005fkx_005fget_005fname"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_kx_get_name</b> (<var>gnutls_kx_algorithm_t algorithm</var>)<var><a name="index-gnutls_005fkx_005fget_005fname-180"></a></var><br>
<blockquote><p><var>algorithm</var>: is a key exchange algorithm

     <p>Convert a <code>gnutls_kx_algorithm_t</code> value to a string.

     <p><strong>Returns:</strong> a pointer to a string that contains the name of the
specified key exchange algorithm, or <code>NULL</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_kx_get</h4>

<p><a name="gnutls_005fkx_005fget"></a>

<div class="defun">
&mdash; Function: gnutls_kx_algorithm_t <b>gnutls_kx_get</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fkx_005fget-181"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Get currently used key exchange algorithm.

     <p><strong>Returns:</strong> the key exchange algorithm used in the last handshake, a
<code>gnutls_kx_algorithm_t</code> value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_kx_list</h4>

<p><a name="gnutls_005fkx_005flist"></a>

<div class="defun">
&mdash; Function: const gnutls_kx_algorithm_t * <b>gnutls_kx_list</b> (<var> void</var>)<var><a name="index-gnutls_005fkx_005flist-182"></a></var><br>
<blockquote>
     <p>Get a list of supported key exchange algorithms.

     <p><strong>Returns:</strong> a zero-terminated list of <code>gnutls_kx_algorithm_t</code> integers
indicating the available key exchange algorithms. 
</p></blockquote></div>

<h4 class="subheading">gnutls_kx_set_priority</h4>

<p><a name="gnutls_005fkx_005fset_005fpriority"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_kx_set_priority</b> (<var>gnutls_session_t session, const int * list</var>)<var><a name="index-gnutls_005fkx_005fset_005fpriority-183"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>list</var>: is a 0 terminated list of gnutls_kx_algorithm_t elements.

     <p>Sets the priority on the key exchange algorithms supported by gnutls. 
Priority is higher for elements specified before others. 
After specifying the algorithms you want, you must append a 0. 
Note that the priority is set on the client. The server does
not use the algorithm's priority except for disabling
algorithms that were not specified.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_mac_get_id</h4>

<p><a name="gnutls_005fmac_005fget_005fid"></a>

<div class="defun">
&mdash; Function: gnutls_mac_algorithm_t <b>gnutls_mac_get_id</b> (<var>const char * name</var>)<var><a name="index-gnutls_005fmac_005fget_005fid-184"></a></var><br>
<blockquote><p><var>name</var>: is a MAC algorithm name

     <p>Convert a string to a <code>gnutls_mac_algorithm_t</code> value.  The names are
compared in a case insensitive way.

     <p><strong>Returns:</strong> an <code>gnutls_mac_algorithm_tid</code> of the specified in a string
MAC algorithm, or <code>GNUTLS_MAC_UNKNOWN</code> on failures. 
</p></blockquote></div>

<h4 class="subheading">gnutls_mac_get_key_size</h4>

<p><a name="gnutls_005fmac_005fget_005fkey_005fsize"></a>

<div class="defun">
&mdash; Function: size_t <b>gnutls_mac_get_key_size</b> (<var>gnutls_mac_algorithm_t algorithm</var>)<var><a name="index-gnutls_005fmac_005fget_005fkey_005fsize-185"></a></var><br>
<blockquote><p><var>algorithm</var>: is an encryption algorithm

     <p>Get size of MAC key.

     <p><strong>Returns:</strong> length (in bytes) of the given MAC key size, or 0 if the
given MAC algorithm is invalid. 
</p></blockquote></div>

<h4 class="subheading">gnutls_mac_get_name</h4>

<p><a name="gnutls_005fmac_005fget_005fname"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_mac_get_name</b> (<var>gnutls_mac_algorithm_t algorithm</var>)<var><a name="index-gnutls_005fmac_005fget_005fname-186"></a></var><br>
<blockquote><p><var>algorithm</var>: is a MAC algorithm

     <p>Convert a <code>gnutls_mac_algorithm_t</code> value to a string.

     <p><strong>Returns:</strong> a string that contains the name of the specified MAC
algorithm, or <code>NULL</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_mac_get</h4>

<p><a name="gnutls_005fmac_005fget"></a>

<div class="defun">
&mdash; Function: gnutls_mac_algorithm_t <b>gnutls_mac_get</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fmac_005fget-187"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Get currently used MAC algorithm.

     <p><strong>Returns:</strong> the currently used mac algorithm, a
<code>gnutls_mac_algorithm_t</code> value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_mac_list</h4>

<p><a name="gnutls_005fmac_005flist"></a>

<div class="defun">
&mdash; Function: const gnutls_mac_algorithm_t * <b>gnutls_mac_list</b> (<var> void</var>)<var><a name="index-gnutls_005fmac_005flist-188"></a></var><br>
<blockquote>
     <p>Get a list of hash algorithms for use as MACs.  Note that not
necessarily all MACs are supported in TLS cipher suites.  For
example, MD2 is not supported as a cipher suite, but is supported
for other purposes (e.g., X.509 signature verification or similar).

     <p><strong>Returns:</strong> Return a zero-terminated list of <code>gnutls_mac_algorithm_t</code>
integers indicating the available MACs. 
</p></blockquote></div>

<h4 class="subheading">gnutls_mac_set_priority</h4>

<p><a name="gnutls_005fmac_005fset_005fpriority"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_mac_set_priority</b> (<var>gnutls_session_t session, const int * list</var>)<var><a name="index-gnutls_005fmac_005fset_005fpriority-189"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>list</var>: is a 0 terminated list of gnutls_mac_algorithm_t elements.

     <p>Sets the priority on the mac algorithms supported by gnutls. 
Priority is higher for elements specified before others. 
After specifying the algorithms you want, you must append a 0. 
Note that the priority is set on the client. The server does
not use the algorithm's priority except for disabling
algorithms that were not specified.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_malloc</h4>

<p><a name="gnutls_005fmalloc"></a>

<div class="defun">
&mdash; Function: void * <b>gnutls_malloc</b> (<var>size_t s</var>)<var><a name="index-gnutls_005fmalloc-190"></a></var><br>
<blockquote>
     <p>This function will allocate 's' bytes data, and
return a pointer to memory. This function is supposed
to be used by callbacks.

     <p>The allocation function used is the one set by <code>gnutls_global_set_mem_functions()</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_send_cert</h4>

<p><a name="gnutls_005fopenpgp_005fsend_005fcert"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_openpgp_send_cert</b> (<var>gnutls_session_t session, gnutls_openpgp_crt_status_t status</var>)<var><a name="index-gnutls_005fopenpgp_005fsend_005fcert-191"></a></var><br>
<blockquote><p><var>session</var>: is a pointer to a <code>gnutls_session_t</code> structure.

     <p><var>status</var>: is one of GNUTLS_OPENPGP_CERT, or GNUTLS_OPENPGP_CERT_FINGERPRINT

     <p>This function will order gnutls to send the key fingerprint
instead of the key in the initial handshake procedure. This should
be used with care and only when there is indication or knowledge
that the server can obtain the client's key. 
</p></blockquote></div>

<h4 class="subheading">gnutls_oprfi_enable_client</h4>

<p><a name="gnutls_005foprfi_005fenable_005fclient"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_oprfi_enable_client</b> (<var>gnutls_session_t session, size_t len, unsigned char * data</var>)<var><a name="index-gnutls_005foprfi_005fenable_005fclient-192"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>len</var>: length of Opaque PRF data to use in client.

     <p><var>data</var>: Opaque PRF data to use in client.

     <p>Request that the client should attempt to negotiate the Opaque PRF
Input TLS extension, using the given data as the client's Opaque
PRF input.

     <p>The data is copied into the session context after this call, so you
may de-allocate it immediately after calling this function. 
</p></blockquote></div>

<h4 class="subheading">gnutls_oprfi_enable_server</h4>

<p><a name="gnutls_005foprfi_005fenable_005fserver"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_oprfi_enable_server</b> (<var>gnutls_session_t session, gnutls_oprfi_callback_func cb, void * userdata</var>)<var><a name="index-gnutls_005foprfi_005fenable_005fserver-193"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>cb</var>: function pointer to Opaque PRF extension server callback.

     <p><var>userdata</var>: hook passed to callback function for passing application state.

     <p>Request that the server should attempt to accept the Opaque PRF
Input TLS extension.  If the client requests the extension, the
provided callback <code>cb</code> will be invoked.  The callback must have the
following prototype:

     <p>int callback (gnutls_session_t session, void *userdata,
size_t oprfi_len, const unsigned char *in_oprfi,
unsigned char *out_oprfi);

     <p>The callback can inspect the client-provided data in the input
parameters, and specify its own opaque prf input data in the output
variable.  The function must return 0 on success, otherwise the
handshake will be aborted. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pem_base64_decode_alloc</h4>

<p><a name="gnutls_005fpem_005fbase64_005fdecode_005falloc"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pem_base64_decode_alloc</b> (<var>const char * header, const gnutls_datum_t * b64_data, gnutls_datum_t * result</var>)<var><a name="index-gnutls_005fpem_005fbase64_005fdecode_005falloc-194"></a></var><br>
<blockquote><p><var>header</var>: The PEM header (eg. CERTIFICATE)

     <p><var>b64_data</var>: contains the encoded data

     <p><var>result</var>: the place where decoded data lie

     <p>This function will decode the given encoded data. The decoded data
will be allocated, and stored into result.  If the header given is
non null this function will search for "&mdash;&mdash;BEGIN header" and
decode only this part. Otherwise it will decode the first PEM
packet found.

     <p>You should use <code>gnutls_free()</code> to free the returned data.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, otherwise
an error code is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pem_base64_decode</h4>

<p><a name="gnutls_005fpem_005fbase64_005fdecode"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pem_base64_decode</b> (<var>const char * header, const gnutls_datum_t * b64_data, unsigned char * result, size_t * result_size</var>)<var><a name="index-gnutls_005fpem_005fbase64_005fdecode-195"></a></var><br>
<blockquote><p><var>header</var>: A null terminated string with the PEM header (eg. CERTIFICATE)

     <p><var>b64_data</var>: contain the encoded data

     <p><var>result</var>: the place where decoded data will be copied

     <p><var>result_size</var>: holds the size of the result

     <p>This function will decode the given encoded data.  If the header
given is non null this function will search for "&mdash;&mdash;BEGIN header"
and decode only this part.  Otherwise it will decode the first PEM
packet found.

     <p><strong>Returns:</strong> On success <code>GNUTLS_E_SUCCESS</code> (0) is returned,
<code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> is returned if the buffer given is
not long enough, or 0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pem_base64_encode_alloc</h4>

<p><a name="gnutls_005fpem_005fbase64_005fencode_005falloc"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pem_base64_encode_alloc</b> (<var>const char * msg, const gnutls_datum_t * data, gnutls_datum_t * result</var>)<var><a name="index-gnutls_005fpem_005fbase64_005fencode_005falloc-196"></a></var><br>
<blockquote><p><var>msg</var>: is a message to be put in the encoded header

     <p><var>data</var>: contains the raw data

     <p><var>result</var>: will hold the newly allocated encoded data

     <p>This function will convert the given data to printable data, using
the base64 encoding.  This is the encoding used in PEM messages. 
This function will allocate the required memory to hold the encoded
data.

     <p>You should use <code>gnutls_free()</code> to free the returned data.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, otherwise
an error code is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pem_base64_encode</h4>

<p><a name="gnutls_005fpem_005fbase64_005fencode"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pem_base64_encode</b> (<var>const char * msg, const gnutls_datum_t * data, char * result, size_t * result_size</var>)<var><a name="index-gnutls_005fpem_005fbase64_005fencode-197"></a></var><br>
<blockquote><p><var>msg</var>: is a message to be put in the header

     <p><var>data</var>: contain the raw data

     <p><var>result</var>: the place where base64 data will be copied

     <p><var>result_size</var>: holds the size of the result

     <p>This function will convert the given data to printable data, using
the base64 encoding. This is the encoding used in PEM messages.

     <p>The output string will be null terminated, although the size will
not include the terminating null.

     <p><strong>Returns:</strong> On success <code>GNUTLS_E_SUCCESS</code> (0) is returned,
<code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> is returned if the buffer given is
not long enough, or 0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_perror</h4>

<p><a name="gnutls_005fperror"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_perror</b> (<var>int error</var>)<var><a name="index-gnutls_005fperror-198"></a></var><br>
<blockquote><p><var>error</var>: is a GnuTLS error code, a negative value

     <p>This function is like <code>perror()</code>. The only difference is that it
accepts an error number returned by a gnutls function. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pk_algorithm_get_name</h4>

<p><a name="gnutls_005fpk_005falgorithm_005fget_005fname"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_pk_algorithm_get_name</b> (<var>gnutls_pk_algorithm_t algorithm</var>)<var><a name="index-gnutls_005fpk_005falgorithm_005fget_005fname-199"></a></var><br>
<blockquote><p><var>algorithm</var>: is a pk algorithm

     <p>Convert a <code>gnutls_pk_algorithm_t</code> value to a string.

     <p><strong>Returns:</strong> a string that contains the name of the specified public
key algorithm, or <code>NULL</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pk_get_id</h4>

<p><a name="gnutls_005fpk_005fget_005fid"></a>

<div class="defun">
&mdash; Function: gnutls_pk_algorithm_t <b>gnutls_pk_get_id</b> (<var>const char * name</var>)<var><a name="index-gnutls_005fpk_005fget_005fid-200"></a></var><br>
<blockquote><p><var>name</var>: is a string containing a public key algorithm name.

     <p>Convert a string to a <code>gnutls_pk_algorithm_t</code> value.  The names are
compared in a case insensitive way.  For example,
gnutls_pk_get_id("RSA") will return <code>GNUTLS_PK_RSA</code>.

     <p><strong>Returns:</strong> an <code>gnutls_pk_algorithm_tid</code> of the specified in a string
public key algorithm, or <code>GNUTLS_PK_UNKNOWN</code> on failures.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_pk_get_name</h4>

<p><a name="gnutls_005fpk_005fget_005fname"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_pk_get_name</b> (<var>gnutls_pk_algorithm_t algorithm</var>)<var><a name="index-gnutls_005fpk_005fget_005fname-201"></a></var><br>
<blockquote><p><var>algorithm</var>: is a public key algorithm

     <p>Convert a <code>gnutls_pk_algorithm_t</code> value to a string.

     <p><strong>Returns:</strong> a pointer to a string that contains the name of the
specified public key algorithm, or <code>NULL</code>.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_pk_list</h4>

<p><a name="gnutls_005fpk_005flist"></a>

<div class="defun">
&mdash; Function: const gnutls_pk_algorithm_t * <b>gnutls_pk_list</b> (<var> void</var>)<var><a name="index-gnutls_005fpk_005flist-202"></a></var><br>
<blockquote>
     <p>Get a list of supported public key algorithms.

     <p><strong>Returns:</strong> a zero-terminated list of <code>gnutls_pk_algorithm_t</code> integers
indicating the available ciphers.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_prf_raw</h4>

<p><a name="gnutls_005fprf_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_prf_raw</b> (<var>gnutls_session_t session, size_t label_size, const char * label, size_t seed_size, const char * seed, size_t outsize, char * out</var>)<var><a name="index-gnutls_005fprf_005fraw-203"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>label_size</var>: length of the <code>label</code> variable.

     <p><var>label</var>: label used in PRF computation, typically a short string.

     <p><var>seed_size</var>: length of the <code>seed</code> variable.

     <p><var>seed</var>: optional extra data to seed the PRF with.

     <p><var>outsize</var>: size of pre-allocated output buffer to hold the output.

     <p><var>out</var>: pre-allocate buffer to hold the generated data.

     <p>Apply the TLS Pseudo-Random-Function (PRF) using the master secret
on some data.

     <p>The <code>label</code> variable usually contain a string denoting the purpose
for the generated data.  The <code>seed</code> usually contain data such as the
client and server random, perhaps together with some additional
data that is added to guarantee uniqueness of the output for a
particular purpose.

     <p>Because the output is not guaranteed to be unique for a particular
session unless <code>seed</code> include the client random and server random
fields (the PRF would output the same data on another connection
resumed from the first one), it is not recommended to use this
function directly.  The <code>gnutls_prf()</code> function seed the PRF with the
client and server random fields directly, and is recommended if you
want to generate pseudo random data unique for each session.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_prf</h4>

<p><a name="gnutls_005fprf"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_prf</b> (<var>gnutls_session_t session, size_t label_size, const char * label, int server_random_first, size_t extra_size, const char * extra, size_t outsize, char * out</var>)<var><a name="index-gnutls_005fprf-204"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>label_size</var>: length of the <code>label</code> variable.

     <p><var>label</var>: label used in PRF computation, typically a short string.

     <p><var>server_random_first</var>: non-0 if server random field should be first in seed

     <p><var>extra_size</var>: length of the <code>extra</code> variable.

     <p><var>extra</var>: optional extra data to seed the PRF with.

     <p><var>outsize</var>: size of pre-allocated output buffer to hold the output.

     <p><var>out</var>: pre-allocate buffer to hold the generated data.

     <p>Apply the TLS Pseudo-Random-Function (PRF) using the master secret
on some data, seeded with the client and server random fields.

     <p>The <code>label</code> variable usually contain a string denoting the purpose
for the generated data.  The <code>server_random_first</code> indicate whether
the client random field or the server random field should be first
in the seed.  Non-0 indicate that the server random field is first,
0 that the client random field is first.

     <p>The <code>extra</code> variable can be used to add more data to the seed, after
the random variables.  It can be used to tie make sure the
generated output is strongly connected to some additional data
(e.g., a string used in user authentication).

     <p>The output is placed in *<code>OUT</code>, which must be pre-allocated.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_priority_deinit</h4>

<p><a name="gnutls_005fpriority_005fdeinit"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_priority_deinit</b> (<var>gnutls_priority_t priority_cache</var>)<var><a name="index-gnutls_005fpriority_005fdeinit-205"></a></var><br>
<blockquote><p><var>priority_cache</var>: is a <code>gnutls_prioritity_t</code> structure.

     <p>Deinitializes the priority cache. 
</p></blockquote></div>

<h4 class="subheading">gnutls_priority_init</h4>

<p><a name="gnutls_005fpriority_005finit"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_priority_init</b> (<var>gnutls_priority_t * priority_cache, const char * priorities, const char ** err_pos</var>)<var><a name="index-gnutls_005fpriority_005finit-206"></a></var><br>
<blockquote><p><var>priority_cache</var>: is a <code>gnutls_prioritity_t</code> structure.

     <p><var>priorities</var>: is a string describing priorities

     <p><var>err_pos</var>: In case of an error this will have the position in the string the error occured

     <p>Sets priorities for the ciphers, key exchange methods, macs and
compression methods. This is to avoid using the
gnutls_*<code>_priority()</code> functions.

     <p>The <code>priorities</code> option allows you to specify a semi-colon
separated list of the cipher priorities to enable.

     <p>Unless the first keyword is "NONE" the defaults are:

     <p><strong>Protocols:</strong> TLS1.1, TLS1.0, and SSL3.0.

     <p><strong>Compression:</strong> NULL.

     <p><strong>Certificate types:</strong> X.509, OpenPGP.

     <p><strong>You can also use predefined sets of ciphersuites:</strong> "PERFORMANCE"
all the "secure" ciphersuites are enabled, limited to 128 bit
ciphers and sorted by terms of speed performance.

     <p>"NORMAL" option enables all "secure" ciphersuites. The 256-bit ciphers
are included as a fallback only. The ciphers are sorted by security margin.

     <p>"SECURE128" flag enables all "secure" ciphersuites with ciphers up to
128 bits, sorted by security margin.

     <p>"SECURE256" flag enables all "secure" ciphersuites including the 256 bit
ciphers, sorted by security margin.

     <p>"EXPORT" all the ciphersuites are enabled, including the
low-security 40 bit ciphers.

     <p>"NONE" nothing is enabled. This disables even protocols and
compression methods.

     <p><strong>Special keywords:</strong> '!' or '-' appended with an algorithm will remove this algorithm. 
'+' appended with an algorithm will add this algorithm. 
'<code>COMPAT</code>' will enable compatibility features for a server.

     <p>To avoid collisions in order to specify a compression algorithm in
this string you have to prefix it with "COMP-", protocol versions
with "VERS-" and certificate types with "CTYPE-". All other
algorithms don't need a prefix.

     <p>For key exchange algorithms when in NORMAL or SECURE levels the
perfect forward secrecy algorithms take precendence of the other
protocols.  In all cases all the supported key exchange algorithms
are enabled (except for the RSA-EXPORT which is only enabled in
EXPORT level).

     <p>Note that although one can select very long key sizes (such as 256 bits)
for symmetric algorithms, to actually increase security the public key
algorithms have to use longer key sizes as well.

     <p><strong>Examples:</strong> "NORMAL:!AES-128-CBC",
"EXPORT:!VERS-TLS1.0:+COMP-DEFLATE:+CTYPE-OPENPGP",
"NONE:+VERS-TLS1.0:+AES-128-CBC:+RSA:+SHA1:+COMP-NULL", "NORMAL",
"NORMAL:<code>COMPAT</code>".

     <p>For all the current available algorithms and protocols use "gnutls-cli -l"
to get a listing.

     <p><strong>Returns:</strong> On syntax error <code>GNUTLS_E_INVALID_REQUEST</code> is returned,
<code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_priority_set_direct</h4>

<p><a name="gnutls_005fpriority_005fset_005fdirect"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_priority_set_direct</b> (<var>gnutls_session_t session, const char * priorities, const char ** err_pos</var>)<var><a name="index-gnutls_005fpriority_005fset_005fdirect-207"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>priorities</var>: is a string describing priorities

     <p><var>err_pos</var>: In case of an error this will have the position in the string the error occured

     <p>Sets the priorities to use on the ciphers, key exchange methods,
macs and compression methods. This function avoids keeping a
priority cache and is used to directly set string priorities to a
TLS session.  For documentation check the <code>gnutls_priority_init()</code>.

     <p><strong>Returns:</strong> On syntax error <code>GNUTLS_E_INVALID_REQUEST</code> is returned,
<code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_priority_set</h4>

<p><a name="gnutls_005fpriority_005fset"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_priority_set</b> (<var>gnutls_session_t session, gnutls_priority_t priority</var>)<var><a name="index-gnutls_005fpriority_005fset-208"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>priority</var>: is a <code>gnutls_priority_t</code> structure.

     <p>Sets the priorities to use on the ciphers, key exchange methods,
macs and compression methods.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_protocol_get_id</h4>

<p><a name="gnutls_005fprotocol_005fget_005fid"></a>

<div class="defun">
&mdash; Function: gnutls_protocol_t <b>gnutls_protocol_get_id</b> (<var>const char * name</var>)<var><a name="index-gnutls_005fprotocol_005fget_005fid-209"></a></var><br>
<blockquote><p><var>name</var>: is a protocol name

     <p>The names are compared in a case insensitive way.

     <p><strong>Returns:</strong> an id of the specified protocol, or
<code>GNUTLS_VERSION_UNKNOWN</code> on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_protocol_get_name</h4>

<p><a name="gnutls_005fprotocol_005fget_005fname"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_protocol_get_name</b> (<var>gnutls_protocol_t version</var>)<var><a name="index-gnutls_005fprotocol_005fget_005fname-210"></a></var><br>
<blockquote><p><var>version</var>: is a (gnutls) version number

     <p>Convert a <code>gnutls_protocol_t</code> value to a string.

     <p><strong>Returns:</strong> a string that contains the name of the specified TLS
version (e.g., "TLS1.0"), or <code>NULL</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_protocol_get_version</h4>

<p><a name="gnutls_005fprotocol_005fget_005fversion"></a>

<div class="defun">
&mdash; Function: gnutls_protocol_t <b>gnutls_protocol_get_version</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fprotocol_005fget_005fversion-211"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Get TLS version, a <code>gnutls_protocol_t</code> value.

     <p><strong>Returns:</strong> the version of the currently used protocol. 
</p></blockquote></div>

<h4 class="subheading">gnutls_protocol_list</h4>

<p><a name="gnutls_005fprotocol_005flist"></a>

<div class="defun">
&mdash; Function: const gnutls_protocol_t * <b>gnutls_protocol_list</b> (<var> void</var>)<var><a name="index-gnutls_005fprotocol_005flist-212"></a></var><br>
<blockquote>
     <p>Get a list of supported protocols, e.g. SSL 3.0, TLS 1.0 etc.

     <p><strong>Returns:</strong> a zero-terminated list of <code>gnutls_protocol_t</code> integers
indicating the available protocols. 
</p></blockquote></div>

<h4 class="subheading">gnutls_protocol_set_priority</h4>

<p><a name="gnutls_005fprotocol_005fset_005fpriority"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_protocol_set_priority</b> (<var>gnutls_session_t session, const int * list</var>)<var><a name="index-gnutls_005fprotocol_005fset_005fpriority-213"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>list</var>: is a 0 terminated list of gnutls_protocol_t elements.

     <p>Sets the priority on the protocol versions supported by gnutls. 
This function actually enables or disables protocols. Newer protocol
versions always have highest priority.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_psk_allocate_client_credentials</h4>

<p><a name="gnutls_005fpsk_005fallocate_005fclient_005fcredentials"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_psk_allocate_client_credentials</b> (<var>gnutls_psk_client_credentials_t * sc</var>)<var><a name="index-gnutls_005fpsk_005fallocate_005fclient_005fcredentials-214"></a></var><br>
<blockquote><p><var>sc</var>: is a pointer to an <code>gnutls_psk_server_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus this
helper function is provided in order to allocate it.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_psk_allocate_server_credentials</h4>

<p><a name="gnutls_005fpsk_005fallocate_005fserver_005fcredentials"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_psk_allocate_server_credentials</b> (<var>gnutls_psk_server_credentials_t * sc</var>)<var><a name="index-gnutls_005fpsk_005fallocate_005fserver_005fcredentials-215"></a></var><br>
<blockquote><p><var>sc</var>: is a pointer to an <code>gnutls_psk_server_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus this
helper function is provided in order to allocate it.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_psk_client_get_hint</h4>

<p><a name="gnutls_005fpsk_005fclient_005fget_005fhint"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_psk_client_get_hint</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fpsk_005fclient_005fget_005fhint-216"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p>The PSK identity hint may give the client help in deciding which
username to use.  This should only be called in case of PSK
authentication and in case of a client.

     <p><strong>Returns:</strong> the identity hint of the peer, or <code>NULL</code> in case of an error.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_psk_free_client_credentials</h4>

<p><a name="gnutls_005fpsk_005ffree_005fclient_005fcredentials"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_psk_free_client_credentials</b> (<var>gnutls_psk_client_credentials_t sc</var>)<var><a name="index-gnutls_005fpsk_005ffree_005fclient_005fcredentials-217"></a></var><br>
<blockquote><p><var>sc</var>: is an <code>gnutls_psk_client_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus this
helper function is provided in order to free (deallocate) it. 
</p></blockquote></div>

<h4 class="subheading">gnutls_psk_free_server_credentials</h4>

<p><a name="gnutls_005fpsk_005ffree_005fserver_005fcredentials"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_psk_free_server_credentials</b> (<var>gnutls_psk_server_credentials_t sc</var>)<var><a name="index-gnutls_005fpsk_005ffree_005fserver_005fcredentials-218"></a></var><br>
<blockquote><p><var>sc</var>: is an <code>gnutls_psk_server_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus this
helper function is provided in order to free (deallocate) it. 
</p></blockquote></div>

<h4 class="subheading">gnutls_psk_netconf_derive_key</h4>

<p><a name="gnutls_005fpsk_005fnetconf_005fderive_005fkey"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_psk_netconf_derive_key</b> (<var>const char * password, const char * psk_identity, const char * psk_identity_hint, gnutls_datum_t * output_key</var>)<var><a name="index-gnutls_005fpsk_005fnetconf_005fderive_005fkey-219"></a></var><br>
<blockquote><p><var>password</var>: zero terminated string containing password.

     <p><var>psk_identity</var>: zero terminated string with PSK identity.

     <p><var>psk_identity_hint</var>: zero terminated string with PSK identity hint.

     <p><var>output_key</var>: output variable, contains newly allocated *data pointer.

     <p>This function will derive a PSK key from a password, for use with
the Netconf protocol.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_psk_server_get_username</h4>

<p><a name="gnutls_005fpsk_005fserver_005fget_005fusername"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_psk_server_get_username</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fpsk_005fserver_005fget_005fusername-220"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p>This should only be called in case of PSK authentication and in
case of a server.

     <p><strong>Returns:</strong> the username of the peer, or <code>NULL</code> in case of an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_psk_set_client_credentials_function</h4>

<p><a name="gnutls_005fpsk_005fset_005fclient_005fcredentials_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_psk_set_client_credentials_function</b> (<var>gnutls_psk_client_credentials_t cred, gnutls_psk_client_credentials_function * func</var>)<var><a name="index-gnutls_005fpsk_005fset_005fclient_005fcredentials_005ffunction-221"></a></var><br>
<blockquote><p><var>cred</var>: is a <code>gnutls_psk_server_credentials_t</code> structure.

     <p><var>func</var>: is the callback function

     <p>This function can be used to set a callback to retrieve the username and
password for client PSK authentication. 
The callback's function form is:
int (*callback)(gnutls_session_t, char** username,
gnutls_datum_t* key);

     <p>The <code>username</code> and <code>key</code>-&gt;data must be allocated using <code>gnutls_malloc()</code>. 
<code>username</code> should be ASCII strings or UTF-8 strings prepared using
the "SASLprep" profile of "stringprep".

     <p>The callback function will be called once per handshake.

     <p>The callback function should return 0 on success. 
-1 indicates an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_psk_set_client_credentials</h4>

<p><a name="gnutls_005fpsk_005fset_005fclient_005fcredentials"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_psk_set_client_credentials</b> (<var>gnutls_psk_client_credentials_t res, const char * username, const gnutls_datum_t * key, gnutls_psk_key_flags flags</var>)<var><a name="index-gnutls_005fpsk_005fset_005fclient_005fcredentials-222"></a></var><br>
<blockquote><p><var>res</var>: is an <code>gnutls_psk_client_credentials_t</code> structure.

     <p><var>username</var>: is the user's zero-terminated userid

     <p><var>key</var>: is the user's key

     <p>This function sets the username and password, in a
gnutls_psk_client_credentials_t structure.  Those will be used in
PSK authentication. <code>username</code> should be an ASCII string or UTF-8
strings prepared using the "SASLprep" profile of "stringprep". 
The key can be either in raw byte format or in Hex (not with the
'0x' prefix).

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_psk_set_params_function</h4>

<p><a name="gnutls_005fpsk_005fset_005fparams_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_psk_set_params_function</b> (<var>gnutls_psk_server_credentials_t res, gnutls_params_function * func</var>)<var><a name="index-gnutls_005fpsk_005fset_005fparams_005ffunction-223"></a></var><br>
<blockquote><p><var>res</var>: is a gnutls_psk_server_credentials_t structure

     <p><var>func</var>: is the function to be called

     <p>This function will set a callback in order for the server to get
the diffie hellman or RSA parameters for psk authentication.  The
callback should return zero on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_psk_set_server_credentials_file</h4>

<p><a name="gnutls_005fpsk_005fset_005fserver_005fcredentials_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_psk_set_server_credentials_file</b> (<var>gnutls_psk_server_credentials_t res, const char * password_file</var>)<var><a name="index-gnutls_005fpsk_005fset_005fserver_005fcredentials_005ffile-224"></a></var><br>
<blockquote><p><var>res</var>: is an <code>gnutls_psk_server_credentials_t</code> structure.

     <p><var>password_file</var>: is the PSK password file (passwd.psk)

     <p>This function sets the password file, in a
<code>gnutls_psk_server_credentials_t</code> structure.  This password file
holds usernames and keys and will be used for PSK authentication.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_psk_set_server_credentials_function</h4>

<p><a name="gnutls_005fpsk_005fset_005fserver_005fcredentials_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_psk_set_server_credentials_function</b> (<var>gnutls_psk_server_credentials_t cred, gnutls_psk_server_credentials_function * func</var>)<var><a name="index-gnutls_005fpsk_005fset_005fserver_005fcredentials_005ffunction-225"></a></var><br>
<blockquote><p><var>cred</var>: is a <code>gnutls_psk_server_credentials_t</code> structure.

     <p><var>func</var>: is the callback function

     <p>This function can be used to set a callback to retrieve the user's PSK credentials. 
The callback's function form is:
int (*callback)(gnutls_session_t, const char* username,
gnutls_datum_t* key);

     <p><code>username</code> contains the actual username. 
The <code>key</code> must be filled in using the <code>gnutls_malloc()</code>.

     <p>In case the callback returned a negative number then gnutls will
assume that the username does not exist.

     <p>The callback function will only be called once per handshake.  The
callback function should return 0 on success, while -1 indicates
an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_psk_set_server_credentials_hint</h4>

<p><a name="gnutls_005fpsk_005fset_005fserver_005fcredentials_005fhint"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_psk_set_server_credentials_hint</b> (<var>gnutls_psk_server_credentials_t res, const char * hint</var>)<var><a name="index-gnutls_005fpsk_005fset_005fserver_005fcredentials_005fhint-226"></a></var><br>
<blockquote><p><var>res</var>: is an <code>gnutls_psk_server_credentials_t</code> structure.

     <p><var>hint</var>: is the PSK identity hint string

     <p>This function sets the identity hint, in a
<code>gnutls_psk_server_credentials_t</code> structure.  This hint is sent to
the client to help it chose a good PSK credential (i.e., username
and password).

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_psk_set_server_dh_params</h4>

<p><a name="gnutls_005fpsk_005fset_005fserver_005fdh_005fparams"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_psk_set_server_dh_params</b> (<var>gnutls_psk_server_credentials_t res, gnutls_dh_params_t dh_params</var>)<var><a name="index-gnutls_005fpsk_005fset_005fserver_005fdh_005fparams-227"></a></var><br>
<blockquote><p><var>res</var>: is a gnutls_psk_server_credentials_t structure

     <p><var>dh_params</var>: is a structure that holds diffie hellman parameters.

     <p>This function will set the diffie hellman parameters for an
anonymous server to use. These parameters will be used in Diffie
Hellman with PSK cipher suites. 
</p></blockquote></div>

<h4 class="subheading">gnutls_psk_set_server_params_function</h4>

<p><a name="gnutls_005fpsk_005fset_005fserver_005fparams_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_psk_set_server_params_function</b> (<var>gnutls_psk_server_credentials_t res, gnutls_params_function * func</var>)<var><a name="index-gnutls_005fpsk_005fset_005fserver_005fparams_005ffunction-228"></a></var><br>
<blockquote><p><var>res</var>: is a gnutls_certificate_credentials_t structure

     <p><var>func</var>: is the function to be called

     <p>This function will set a callback in order for the server to get
the diffie hellman parameters for PSK authentication. The callback
should return zero on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_record_check_pending</h4>

<p><a name="gnutls_005frecord_005fcheck_005fpending"></a>

<div class="defun">
&mdash; Function: size_t <b>gnutls_record_check_pending</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005frecord_005fcheck_005fpending-229"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>This function checks if there are any data to receive
in the gnutls buffers. Returns the size of that data or 0. 
Notice that you may also use <code>select()</code> to check for data in
a TCP connection, instead of this function. 
(gnutls leaves some data in the tcp buffer in order for select
to work). 
</p></blockquote></div>

<h4 class="subheading">gnutls_record_disable_padding</h4>

<p><a name="gnutls_005frecord_005fdisable_005fpadding"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_record_disable_padding</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005frecord_005fdisable_005fpadding-230"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Used to disabled padding in TLS 1.0 and above.  Normally you do
not need to use this function, but there are buggy clients that
complain if a server pads the encrypted data.  This of course will
disable protection against statistical attacks on the data.

     <p>Normally only servers that require maximum compatibility with everything
out there, need to call this function. 
</p></blockquote></div>

<h4 class="subheading">gnutls_record_get_direction</h4>

<p><a name="gnutls_005frecord_005fget_005fdirection"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_record_get_direction</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005frecord_005fget_005fdirection-231"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>This function provides information about the internals of the
record protocol and is only useful if a prior gnutls function call
(e.g.  <code>gnutls_handshake()</code>) was interrupted for some reason, that
is, if a function returned <code>GNUTLS_E_INTERRUPTED</code> or
<code>GNUTLS_E_AGAIN</code>.  In such a case, you might want to call <code>select()</code>
or <code>poll()</code> before calling the interrupted gnutls function again.  To
tell you whether a file descriptor should be selected for either
reading or writing, <code>gnutls_record_get_direction()</code> returns 0 if the
interrupted function was trying to read data, and 1 if it was
trying to write data.

     <p><strong>Returns:</strong> 0 if trying to read data, 1 if trying to write data. 
</p></blockquote></div>

<h4 class="subheading">gnutls_record_get_max_size</h4>

<p><a name="gnutls_005frecord_005fget_005fmax_005fsize"></a>

<div class="defun">
&mdash; Function: size_t <b>gnutls_record_get_max_size</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005frecord_005fget_005fmax_005fsize-232"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>This function returns the maximum record packet size in this
connection.  The maximum record size is negotiated by the client
after the first handshake message. 
</p></blockquote></div>

<h4 class="subheading">gnutls_record_recv</h4>

<p><a name="gnutls_005frecord_005frecv"></a>

<div class="defun">
&mdash; Function: ssize_t <b>gnutls_record_recv</b> (<var>gnutls_session_t session, void * data, size_t sizeofdata</var>)<var><a name="index-gnutls_005frecord_005frecv-233"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>data</var>: the buffer that the data will be read into

     <p><var>sizeofdata</var>: the number of requested bytes

     <p>This function has the similar semantics with <code>recv()</code>. The only
difference is that is accepts a GNUTLS session, and uses different
error codes.

     <p>In the special case that a server requests a renegotiation, the
client may receive an error code of <code>GNUTLS_E_REHANDSHAKE</code>.  This
message may be simply ignored, replied with an alert containing
NO_RENEGOTIATION, or replied with a new handshake, depending on
the client's will.

     <p>If <code>EINTR</code> is returned by the internal push function (the default
is <code>recv()</code>) then <code>GNUTLS_E_INTERRUPTED</code> will be returned.  If
<code>GNUTLS_E_INTERRUPTED</code> or <code>GNUTLS_E_AGAIN</code> is returned, you must
call this function again to get the data.  See also
<code>gnutls_record_get_direction()</code>.

     <p>A server may also receive <code>GNUTLS_E_REHANDSHAKE</code> when a client has
initiated a handshake. In that case the server can only initiate a
handshake or terminate the connection.

     <p><strong>Returns:</strong> the number of bytes received and zero on EOF.  A negative
error code is returned in case of an error.  The number of bytes
received might be less than <code>sizeofdata</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_record_send</h4>

<p><a name="gnutls_005frecord_005fsend"></a>

<div class="defun">
&mdash; Function: ssize_t <b>gnutls_record_send</b> (<var>gnutls_session_t session, const void * data, size_t sizeofdata</var>)<var><a name="index-gnutls_005frecord_005fsend-234"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>data</var>: contains the data to send

     <p><var>sizeofdata</var>: is the length of the data

     <p>This function has the similar semantics with <code>send()</code>. The only
difference is that is accepts a GNUTLS session, and uses different
error codes.

     <p>Note that if the send buffer is full, <code>send()</code> will block this
function.  See the <code>send()</code> documentation for full information.  You
can replace the default push function by using
<code>gnutls_transport_set_ptr2()</code> with a call to <code>send()</code> with a
MSG_DONTWAIT flag if blocking is a problem.

     <p>If the EINTR is returned by the internal push function (the
default is <code>send()</code>} then <code>GNUTLS_E_INTERRUPTED</code> will be returned. If
<code>GNUTLS_E_INTERRUPTED</code> or <code>GNUTLS_E_AGAIN</code> is returned, you must
call this function again, with the same parameters; alternatively
you could provide a <code>NULL</code> pointer for data, and 0 for
size. cf. <code>gnutls_record_get_direction()</code>.

     <p><strong>Returns:</strong> the number of bytes sent, or a negative error code.  The
number of bytes sent might be less than <code>sizeofdata</code>.  The maximum
number of bytes this function can send in a single call depends on
the negotiated maximum record size. 
</p></blockquote></div>

<h4 class="subheading">gnutls_record_set_max_size</h4>

<p><a name="gnutls_005frecord_005fset_005fmax_005fsize"></a>

<div class="defun">
&mdash; Function: ssize_t <b>gnutls_record_set_max_size</b> (<var>gnutls_session_t session, size_t size</var>)<var><a name="index-gnutls_005frecord_005fset_005fmax_005fsize-235"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>size</var>: is the new size

     <p>This function sets the maximum record packet size in this
connection.  This property can only be set to clients.  The server
may choose not to accept the requested size.

     <p>Acceptable values are 512(=2^9), 1024(=2^10), 2048(=2^11) and
4096(=2^12).  Returns 0 on success. The requested record size does
get in effect immediately only while sending data. The receive
part will take effect after a successful handshake.

     <p>This function uses a TLS extension called 'max record size'.  Not
all TLS implementations use or even understand this extension. 
</p></blockquote></div>

<h4 class="subheading">gnutls_rehandshake</h4>

<p><a name="gnutls_005frehandshake"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_rehandshake</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005frehandshake-236"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>This function will renegotiate security parameters with the
client.  This should only be called in case of a server.

     <p>This message informs the peer that we want to renegotiate
parameters (perform a handshake).

     <p>If this function succeeds (returns 0), you must call the
<code>gnutls_handshake()</code> function in order to negotiate the new
parameters.

     <p>If the client does not wish to renegotiate parameters he will
should with an alert message, thus the return code will be
<code>GNUTLS_E_WARNING_ALERT_RECEIVED</code> and the alert will be
<code>GNUTLS_A_NO_RENEGOTIATION</code>.  A client may also choose to ignore
this message.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_rsa_export_get_modulus_bits</h4>

<p><a name="gnutls_005frsa_005fexport_005fget_005fmodulus_005fbits"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_rsa_export_get_modulus_bits</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005frsa_005fexport_005fget_005fmodulus_005fbits-237"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p>Get the export RSA parameter's modulus size.

     <p><strong>Returns:</strong> the bits used in the last RSA-EXPORT key exchange with the
peer, or a negative value in case of error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_rsa_export_get_pubkey</h4>

<p><a name="gnutls_005frsa_005fexport_005fget_005fpubkey"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_rsa_export_get_pubkey</b> (<var>gnutls_session_t session, gnutls_datum_t * exponent, gnutls_datum_t * modulus</var>)<var><a name="index-gnutls_005frsa_005fexport_005fget_005fpubkey-238"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p><var>exponent</var>: will hold the exponent.

     <p><var>modulus</var>: will hold the modulus.

     <p>This function will return the peer's public key exponent and
modulus used in the last RSA-EXPORT authentication.  The output
parameters must be freed with <code>gnutls_free()</code>.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, otherwise
an error code is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_rsa_params_cpy</h4>

<p><a name="gnutls_005frsa_005fparams_005fcpy"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_rsa_params_cpy</b> (<var>gnutls_rsa_params_t dst, gnutls_rsa_params_t src</var>)<var><a name="index-gnutls_005frsa_005fparams_005fcpy-239"></a></var><br>
<blockquote><p><var>dst</var>: Is the destination structure, which should be initialized.

     <p><var>src</var>: Is the source structure

     <p>This function will copy the RSA parameters structure from source
to destination. 
</p></blockquote></div>

<h4 class="subheading">gnutls_rsa_params_deinit</h4>

<p><a name="gnutls_005frsa_005fparams_005fdeinit"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_rsa_params_deinit</b> (<var>gnutls_rsa_params_t rsa_params</var>)<var><a name="index-gnutls_005frsa_005fparams_005fdeinit-240"></a></var><br>
<blockquote><p><var>rsa_params</var>: Is a structure that holds the parameters

     <p>This function will deinitialize the RSA parameters structure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_rsa_params_export_pkcs1</h4>

<p><a name="gnutls_005frsa_005fparams_005fexport_005fpkcs1"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_rsa_params_export_pkcs1</b> (<var>gnutls_rsa_params_t params, gnutls_x509_crt_fmt_t format, unsigned char * params_data, size_t * params_data_size</var>)<var><a name="index-gnutls_005frsa_005fparams_005fexport_005fpkcs1-241"></a></var><br>
<blockquote><p><var>params</var>: Holds the RSA parameters

     <p><var>format</var>: the format of output params. One of PEM or DER.

     <p><var>params_data</var>: will contain a PKCS1 RSAPublicKey structure PEM or DER encoded

     <p><var>params_data_size</var>: holds the size of params_data (and will be replaced by the actual size of parameters)

     <p>This function will export the given RSA parameters to a PKCS1
RSAPublicKey structure. If the buffer provided is not long enough to
hold the output, then GNUTLS_E_SHORT_MEMORY_BUFFER will be returned.

     <p>If the structure is PEM encoded, it will have a header
of "BEGIN RSA PRIVATE KEY".

     <p>In case of failure a negative value will be returned, and
0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_rsa_params_export_raw</h4>

<p><a name="gnutls_005frsa_005fparams_005fexport_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_rsa_params_export_raw</b> (<var>gnutls_rsa_params_t params, gnutls_datum_t * m, gnutls_datum_t * e, gnutls_datum_t * d, gnutls_datum_t * p, gnutls_datum_t * q, gnutls_datum_t * u, unsigned int * bits</var>)<var><a name="index-gnutls_005frsa_005fparams_005fexport_005fraw-242"></a></var><br>
<blockquote><p><var>params</var>: a structure that holds the rsa parameters

     <p><var>m</var>: will hold the modulus

     <p><var>e</var>: will hold the public exponent

     <p><var>d</var>: will hold the private exponent

     <p><var>p</var>: will hold the first prime (p)

     <p><var>q</var>: will hold the second prime (q)

     <p><var>u</var>: will hold the coefficient

     <p><var>bits</var>: if non null will hold the prime's number of bits

     <p>This function will export the RSA parameters found in the given
structure. The new parameters will be allocated using
<code>gnutls_malloc()</code> and will be stored in the appropriate datum. 
</p></blockquote></div>

<h4 class="subheading">gnutls_rsa_params_generate2</h4>

<p><a name="gnutls_005frsa_005fparams_005fgenerate2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_rsa_params_generate2</b> (<var>gnutls_rsa_params_t params, unsigned int bits</var>)<var><a name="index-gnutls_005frsa_005fparams_005fgenerate2-243"></a></var><br>
<blockquote><p><var>params</var>: The structure where the parameters will be stored

     <p><var>bits</var>: is the prime's number of bits

     <p>This function will generate new temporary RSA parameters for use in
RSA-EXPORT ciphersuites.  This function is normally slow.

     <p>Note that if the parameters are to be used in export cipher suites the
bits value should be 512 or less. 
Also note that the generation of new RSA parameters is only useful
to servers. Clients use the parameters sent by the server, thus it's
no use calling this in client side. 
</p></blockquote></div>

<h4 class="subheading">gnutls_rsa_params_import_pkcs1</h4>

<p><a name="gnutls_005frsa_005fparams_005fimport_005fpkcs1"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_rsa_params_import_pkcs1</b> (<var>gnutls_rsa_params_t params, const gnutls_datum_t * pkcs1_params, gnutls_x509_crt_fmt_t format</var>)<var><a name="index-gnutls_005frsa_005fparams_005fimport_005fpkcs1-244"></a></var><br>
<blockquote><p><var>params</var>: A structure where the parameters will be copied to

     <p><var>pkcs1_params</var>: should contain a PKCS1 RSAPublicKey structure PEM or DER encoded

     <p><var>format</var>: the format of params. PEM or DER.

     <p>This function will extract the RSAPublicKey found in a PKCS1 formatted
structure.

     <p>If the structure is PEM encoded, it should have a header
of "BEGIN RSA PRIVATE KEY".

     <p>In case of failure a negative value will be returned, and
0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_rsa_params_import_raw</h4>

<p><a name="gnutls_005frsa_005fparams_005fimport_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_rsa_params_import_raw</b> (<var>gnutls_rsa_params_t rsa_params, const gnutls_datum_t * m, const gnutls_datum_t * e, const gnutls_datum_t * d, const gnutls_datum_t * p, const gnutls_datum_t * q, const gnutls_datum_t * u</var>)<var><a name="index-gnutls_005frsa_005fparams_005fimport_005fraw-245"></a></var><br>
<blockquote><p><var>rsa_params</var>: Is a structure will hold the parameters

     <p><var>m</var>: holds the modulus

     <p><var>e</var>: holds the public exponent

     <p><var>d</var>: holds the private exponent

     <p><var>p</var>: holds the first prime (p)

     <p><var>q</var>: holds the second prime (q)

     <p><var>u</var>: holds the coefficient

     <p>This function will replace the parameters in the given structure. 
The new parameters should be stored in the appropriate gnutls_datum. 
</p></blockquote></div>

<h4 class="subheading">gnutls_rsa_params_init</h4>

<p><a name="gnutls_005frsa_005fparams_005finit"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_rsa_params_init</b> (<var>gnutls_rsa_params_t * rsa_params</var>)<var><a name="index-gnutls_005frsa_005fparams_005finit-246"></a></var><br>
<blockquote><p><var>rsa_params</var>: Is a structure that will hold the parameters

     <p>This function will initialize the temporary RSA parameters structure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_server_name_get</h4>

<p><a name="gnutls_005fserver_005fname_005fget"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_server_name_get</b> (<var>gnutls_session_t session, void * data, size_t * data_length, unsigned int * type, unsigned int indx</var>)<var><a name="index-gnutls_005fserver_005fname_005fget-247"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>data</var>: will hold the data

     <p><var>data_length</var>: will hold the data length. Must hold the maximum size of data.

     <p><var>type</var>: will hold the server name indicator type

     <p><var>indx</var>: is the index of the server_name

     <p>This function will allow you to get the name indication (if any),
a client has sent. The name indication may be any of the enumeration
gnutls_server_name_type_t.

     <p>If <code>type</code> is GNUTLS_NAME_DNS, then this function is to be used by servers
that support virtual hosting, and the data will be a null terminated UTF-8 string.

     <p>If <code>data</code> has not enough size to hold the server name GNUTLS_E_SHORT_MEMORY_BUFFER
is returned, and <code>data_length</code> will hold the required size.

     <p><code>index</code> is used to retrieve more than one server names (if sent by the client). 
The first server name has an index of 0, the second 1 and so on. If no name with the given
index exists GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_server_name_set</h4>

<p><a name="gnutls_005fserver_005fname_005fset"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_server_name_set</b> (<var>gnutls_session_t session, gnutls_server_name_type_t type, const void * name, size_t name_length</var>)<var><a name="index-gnutls_005fserver_005fname_005fset-248"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>type</var>: specifies the indicator type

     <p><var>name</var>: is a string that contains the server name.

     <p><var>name_length</var>: holds the length of name

     <p>This function is to be used by clients that want to inform
(via a TLS extension mechanism) the server of the name they
connected to. This should be used by clients that connect
to servers that do virtual hosting.

     <p>The value of <code>name</code> depends on the <code>ind</code> type. In case of GNUTLS_NAME_DNS,
an ASCII or UTF-8 null terminated string, without the trailing dot, is expected. 
IPv4 or IPv6 addresses are not permitted. 
</p></blockquote></div>

<h4 class="subheading">gnutls_session_enable_compatibility_mode</h4>

<p><a name="gnutls_005fsession_005fenable_005fcompatibility_005fmode"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_session_enable_compatibility_mode</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fsession_005fenable_005fcompatibility_005fmode-249"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>This function can be used to disable certain (security) features in
TLS in order to maintain maximum compatibility with buggy
clients. It is equivalent to calling:
<code>gnutls_record_disable_padding()</code>

     <p>Normally only servers that require maximum compatibility with
everything out there, need to call this function. 
</p></blockquote></div>

<h4 class="subheading">gnutls_session_get_client_random</h4>

<p><a name="gnutls_005fsession_005fget_005fclient_005frandom"></a>

<div class="defun">
&mdash; Function: const void * <b>gnutls_session_get_client_random</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fsession_005fget_005fclient_005frandom-250"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Return a pointer to the 32-byte client random field used in the
session.  The pointer must not be modified or deallocated.

     <p>If a client random value has not yet been established, the output
will be garbage; in particular, a <code>NULL</code> return value should not be
expected.

     <p><strong>Returns:</strong> pointer to client random data. 
</p></blockquote></div>

<h4 class="subheading">gnutls_session_get_data2</h4>

<p><a name="gnutls_005fsession_005fget_005fdata2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_session_get_data2</b> (<var>gnutls_session_t session, gnutls_datum_t * data</var>)<var><a name="index-gnutls_005fsession_005fget_005fdata2-251"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Returns all session parameters, in order to support resuming. 
The client should call this, and keep the returned session, if he wants to
resume that current version later by calling <code>gnutls_session_set_data()</code>
This function must be called after a successful handshake. The returned
datum must be freed with <code>gnutls_free()</code>.

     <p>Resuming sessions is really useful and speedups connections after
a succesful one.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, otherwise
an error code is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_session_get_data</h4>

<p><a name="gnutls_005fsession_005fget_005fdata"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_session_get_data</b> (<var>gnutls_session_t session, void * session_data, size_t * session_data_size</var>)<var><a name="index-gnutls_005fsession_005fget_005fdata-252"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>session_data</var>: is a pointer to space to hold the session.

     <p><var>session_data_size</var>: is the session_data's size, or it will be set by the function.

     <p>Returns all session parameters, in order to support resuming.  The
client should call this, and keep the returned session, if he
wants to resume that current version later by calling
<code>gnutls_session_set_data()</code> This function must be called after a
successful handshake.

     <p>Resuming sessions is really useful and speedups connections after
a succesful one.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, otherwise
an error code is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_session_get_id</h4>

<p><a name="gnutls_005fsession_005fget_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_session_get_id</b> (<var>gnutls_session_t session, void * session_id, size_t * session_id_size</var>)<var><a name="index-gnutls_005fsession_005fget_005fid-253"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>session_id</var>: is a pointer to space to hold the session id.

     <p><var>session_id_size</var>: is the session id's size, or it will be set by the function.

     <p>Returns the current session id. This can be used if you want to
check if the next session you tried to resume was actually
resumed.  This is because resumed sessions have the same sessionID
with the original session.

     <p>Session id is some data set by the server, that identify the
current session.  In TLS 1.0 and SSL 3.0 session id is always less
than 32 bytes.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, otherwise
an error code is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_session_get_master_secret</h4>

<p><a name="gnutls_005fsession_005fget_005fmaster_005fsecret"></a>

<div class="defun">
&mdash; Function: const void * <b>gnutls_session_get_master_secret</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fsession_005fget_005fmaster_005fsecret-254"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Return a pointer to the 48-byte master secret in the session.  The
pointer must not be modified or deallocated.

     <p>If a master secret value has not yet been established, the output
will be garbage; in particular, a <code>NULL</code> return value should not be
expected.

     <p>Consider using <code>gnutls_prf()</code> rather than extracting the master
secret and use it to derive further data.

     <p><strong>Returns:</strong> pointer to master secret data. 
</p></blockquote></div>

<h4 class="subheading">gnutls_session_get_ptr</h4>

<p><a name="gnutls_005fsession_005fget_005fptr"></a>

<div class="defun">
&mdash; Function: void * <b>gnutls_session_get_ptr</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fsession_005fget_005fptr-255"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Get user pointer for session.  Useful in callbacks.  This is the
pointer set with <code>gnutls_session_set_ptr()</code>.

     <p><strong>Returns:</strong> the user given pointer from the session structure, or
<code>NULL</code> if it was never set. 
</p></blockquote></div>

<h4 class="subheading">gnutls_session_get_server_random</h4>

<p><a name="gnutls_005fsession_005fget_005fserver_005frandom"></a>

<div class="defun">
&mdash; Function: const void * <b>gnutls_session_get_server_random</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fsession_005fget_005fserver_005frandom-256"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Return a pointer to the 32-byte server random field used in the
session.  The pointer must not be modified or deallocated.

     <p>If a server random value has not yet been established, the output
will be garbage; in particular, a <code>NULL</code> return value should not be
expected.

     <p><strong>Returns:</strong> pointer to server random data. 
</p></blockquote></div>

<h4 class="subheading">gnutls_session_is_resumed</h4>

<p><a name="gnutls_005fsession_005fis_005fresumed"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_session_is_resumed</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fsession_005fis_005fresumed-257"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Check whether session is resumed or not.

     <p><strong>Returns:</strong> non zero if this session is resumed, or a zero if this is
a new session. 
</p></blockquote></div>

<h4 class="subheading">gnutls_session_set_data</h4>

<p><a name="gnutls_005fsession_005fset_005fdata"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_session_set_data</b> (<var>gnutls_session_t session, const void * session_data, size_t session_data_size</var>)<var><a name="index-gnutls_005fsession_005fset_005fdata-258"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>session_data</var>: is a pointer to space to hold the session.

     <p><var>session_data_size</var>: is the session's size

     <p>Sets all session parameters, in order to resume a previously
established session.  The session data given must be the one
returned by <code>gnutls_session_get_data()</code>.  This function should be
called before <code>gnutls_handshake()</code>.

     <p>Keep in mind that session resuming is advisory. The server may
choose not to resume the session, thus a full handshake will be
performed.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, otherwise
an error code is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_session_set_finished_function</h4>

<p><a name="gnutls_005fsession_005fset_005ffinished_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_session_set_finished_function</b> (<var>gnutls_session_t session, gnutls_finished_callback_func finished_func</var>)<var><a name="index-gnutls_005fsession_005fset_005ffinished_005ffunction-259"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>finished_func</var>: a <code>gnutls_finished_callback_func</code> callback.

     <p>Register a callback function for the session that will be called
when a TLS Finished message has been generated.  The function is
typically used to copy away the TLS finished message for later use
as a channel binding or similar purpose.

     <p><strong>The callback should follow this prototype:</strong>
void callback (gnutls_session_t session, const void *finished, size_t len);

     <p>The <code>finished</code> parameter will contain the binary TLS finished
message, and <code>len</code> will contains its length.  For SSLv3 connections,
the <code>len</code> parameter will be 36 and for TLS connections it will be
12.

     <p>It is recommended that the function returns quickly in order to not
delay the handshake.  Use the function to store a copy of the TLS
finished message for later use.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_session_set_ptr</h4>

<p><a name="gnutls_005fsession_005fset_005fptr"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_session_set_ptr</b> (<var>gnutls_session_t session, void * ptr</var>)<var><a name="index-gnutls_005fsession_005fset_005fptr-260"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>ptr</var>: is the user pointer

     <p>This function will set (associate) the user given pointer <code>ptr</code> to
the session structure.  This is pointer can be accessed with
<code>gnutls_session_get_ptr()</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_set_default_export_priority</h4>

<p><a name="gnutls_005fset_005fdefault_005fexport_005fpriority"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_set_default_export_priority</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fset_005fdefault_005fexport_005fpriority-261"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Sets some default priority on the ciphers, key exchange methods, macs
and compression methods.  This function also includes weak algorithms.

     <p><strong>This is the same as calling:</strong>
gnutls_priority_set_direct (session, "EXPORT", NULL);

     <p>This function is kept around for backwards compatibility, but
because of its wide use it is still fully supported.  If you wish
to allow users to provide a string that specify which ciphers to
use (which is recommended), you should use
<code>gnutls_priority_set_direct()</code> or <code>gnutls_priority_set()</code> instead.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_set_default_priority</h4>

<p><a name="gnutls_005fset_005fdefault_005fpriority"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_set_default_priority</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fset_005fdefault_005fpriority-262"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Sets some default priority on the ciphers, key exchange methods,
macs and compression methods.

     <p><strong>This is the same as calling:</strong>
gnutls_priority_set_direct (session, "NORMAL", NULL);

     <p>This function is kept around for backwards compatibility, but
because of its wide use it is still fully supported.  If you wish
to allow users to provide a string that specify which ciphers to
use (which is recommended), you should use
<code>gnutls_priority_set_direct()</code> or <code>gnutls_priority_set()</code> instead.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_sign_algorithm_get_name</h4>

<p><a name="gnutls_005fsign_005falgorithm_005fget_005fname"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_sign_algorithm_get_name</b> (<var>gnutls_sign_algorithm_t sign</var>)<var><a name="index-gnutls_005fsign_005falgorithm_005fget_005fname-263"></a></var><br>
<blockquote><p>Convert a <code>gnutls_sign_algorithm_t</code> value to a string.

     <p><strong>Returns:</strong> a string that contains the name of the specified sign
algorithm, or <code>NULL</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_sign_callback_get</h4>

<p><a name="gnutls_005fsign_005fcallback_005fget"></a>

<div class="defun">
&mdash; Function: gnutls_sign_func <b>gnutls_sign_callback_get</b> (<var>gnutls_session_t session, void ** userdata</var>)<var><a name="index-gnutls_005fsign_005fcallback_005fget-264"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p><var>userdata</var>: if non-<code>NULL</code>, will be set to abstract callback pointer.

     <p>Retrieve the callback function, and its userdata pointer.

     <p><strong>Returns:</strong> The function pointer set by <code>gnutls_sign_callback_set()</code>, or
if not set, <code>NULL</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_sign_callback_set</h4>

<p><a name="gnutls_005fsign_005fcallback_005fset"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_sign_callback_set</b> (<var>gnutls_session_t session, gnutls_sign_func sign_func, void * userdata</var>)<var><a name="index-gnutls_005fsign_005fcallback_005fset-265"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p><var>sign_func</var>: function pointer to application's sign callback.

     <p><var>userdata</var>: void pointer that will be passed to sign callback.

     <p>Set the callback function.  The function must have this prototype:

     <p>typedef int (*gnutls_sign_func) (gnutls_session_t session,
void *userdata,
gnutls_certificate_type_t cert_type,
const gnutls_datum_t * cert,
const gnutls_datum_t * hash,
gnutls_datum_t * signature);

     <p>The <code>userdata</code> parameter is passed to the <code>sign_func</code> verbatim, and
can be used to store application-specific data needed in the
callback function.  See also <code>gnutls_sign_callback_get()</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_sign_get_id</h4>

<p><a name="gnutls_005fsign_005fget_005fid"></a>

<div class="defun">
&mdash; Function: gnutls_sign_algorithm_t <b>gnutls_sign_get_id</b> (<var>const char * name</var>)<var><a name="index-gnutls_005fsign_005fget_005fid-266"></a></var><br>
<blockquote><p><var>name</var>: is a MAC algorithm name

     <p>The names are compared in a case insensitive way.

     <p><strong>Returns:</strong> return a <code>gnutls_sign_algorithm_t</code> value corresponding to
the specified cipher, or <code>GNUTLS_SIGN_UNKNOWN</code> on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_sign_get_name</h4>

<p><a name="gnutls_005fsign_005fget_005fname"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_sign_get_name</b> (<var>gnutls_sign_algorithm_t algorithm</var>)<var><a name="index-gnutls_005fsign_005fget_005fname-267"></a></var><br>
<blockquote><p><var>algorithm</var>: is a public key signature algorithm

     <p>Convert a <code>gnutls_sign_algorithm_t</code> value to a string.

     <p><strong>Returns:</strong> a pointer to a string that contains the name of the
specified public key signature algorithm, or <code>NULL</code>.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_sign_list</h4>

<p><a name="gnutls_005fsign_005flist"></a>

<div class="defun">
&mdash; Function: const gnutls_sign_algorithm_t * <b>gnutls_sign_list</b> (<var> void</var>)<var><a name="index-gnutls_005fsign_005flist-268"></a></var><br>
<blockquote>
     <p>Get a list of supported public key signature algorithms.

     <p><strong>Returns:</strong> a zero-terminated list of <code>gnutls_sign_algorithm_t</code>
integers indicating the available ciphers. 
</p></blockquote></div>

<h4 class="subheading">gnutls_srp_allocate_client_credentials</h4>

<p><a name="gnutls_005fsrp_005fallocate_005fclient_005fcredentials"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_srp_allocate_client_credentials</b> (<var>gnutls_srp_client_credentials_t * sc</var>)<var><a name="index-gnutls_005fsrp_005fallocate_005fclient_005fcredentials-269"></a></var><br>
<blockquote><p><var>sc</var>: is a pointer to an <code>gnutls_srp_server_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus
this helper function is provided in order to allocate it.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, or an
error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_srp_allocate_server_credentials</h4>

<p><a name="gnutls_005fsrp_005fallocate_005fserver_005fcredentials"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_srp_allocate_server_credentials</b> (<var>gnutls_srp_server_credentials_t * sc</var>)<var><a name="index-gnutls_005fsrp_005fallocate_005fserver_005fcredentials-270"></a></var><br>
<blockquote><p><var>sc</var>: is a pointer to an <code>gnutls_srp_server_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus this
helper function is provided in order to allocate it.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, or an
error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_srp_base64_decode_alloc</h4>

<p><a name="gnutls_005fsrp_005fbase64_005fdecode_005falloc"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_srp_base64_decode_alloc</b> (<var>const gnutls_datum_t * b64_data, gnutls_datum_t * result</var>)<var><a name="index-gnutls_005fsrp_005fbase64_005fdecode_005falloc-271"></a></var><br>
<blockquote><p><var>b64_data</var>: contains the encoded data

     <p><var>result</var>: the place where decoded data lie

     <p>This function will decode the given encoded data. The decoded data
will be allocated, and stored into result.  It will decode using
the base64 algorithm as used in libsrp.

     <p>You should use <code>gnutls_free()</code> to free the returned data.

     <p>Warning!  This base64 encoding is not the "standard" encoding, so
do not use it for non-SRP purposes.

     <p><strong>Returns:</strong> 0 on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_srp_base64_decode</h4>

<p><a name="gnutls_005fsrp_005fbase64_005fdecode"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_srp_base64_decode</b> (<var>const gnutls_datum_t * b64_data, char * result, size_t * result_size</var>)<var><a name="index-gnutls_005fsrp_005fbase64_005fdecode-272"></a></var><br>
<blockquote><p><var>b64_data</var>: contain the encoded data

     <p><var>result</var>: the place where decoded data will be copied

     <p><var>result_size</var>: holds the size of the result

     <p>This function will decode the given encoded data, using the base64
encoding found in libsrp.

     <p>Note that b64_data should be null terminated.

     <p>Warning!  This base64 encoding is not the "standard" encoding, so
do not use it for non-SRP purposes.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> if the buffer given is not
long enough, or 0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_srp_base64_encode_alloc</h4>

<p><a name="gnutls_005fsrp_005fbase64_005fencode_005falloc"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_srp_base64_encode_alloc</b> (<var>const gnutls_datum_t * data, gnutls_datum_t * result</var>)<var><a name="index-gnutls_005fsrp_005fbase64_005fencode_005falloc-273"></a></var><br>
<blockquote><p><var>data</var>: contains the raw data

     <p><var>result</var>: will hold the newly allocated encoded data

     <p>This function will convert the given data to printable data, using
the base64 encoding.  This is the encoding used in SRP password
files.  This function will allocate the required memory to hold
the encoded data.

     <p>You should use <code>gnutls_free()</code> to free the returned data.

     <p>Warning!  This base64 encoding is not the "standard" encoding, so
do not use it for non-SRP purposes.

     <p><strong>Returns:</strong> 0 on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_srp_base64_encode</h4>

<p><a name="gnutls_005fsrp_005fbase64_005fencode"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_srp_base64_encode</b> (<var>const gnutls_datum_t * data, char * result, size_t * result_size</var>)<var><a name="index-gnutls_005fsrp_005fbase64_005fencode-274"></a></var><br>
<blockquote><p><var>data</var>: contain the raw data

     <p><var>result</var>: the place where base64 data will be copied

     <p><var>result_size</var>: holds the size of the result

     <p>This function will convert the given data to printable data, using
the base64 encoding, as used in the libsrp.  This is the encoding
used in SRP password files.  If the provided buffer is not long
enough GNUTLS_E_SHORT_MEMORY_BUFFER is returned.

     <p>Warning!  This base64 encoding is not the "standard" encoding, so
do not use it for non-SRP purposes.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> if the buffer given is not
long enough, or 0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_srp_free_client_credentials</h4>

<p><a name="gnutls_005fsrp_005ffree_005fclient_005fcredentials"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_srp_free_client_credentials</b> (<var>gnutls_srp_client_credentials_t sc</var>)<var><a name="index-gnutls_005fsrp_005ffree_005fclient_005fcredentials-275"></a></var><br>
<blockquote><p><var>sc</var>: is an <code>gnutls_srp_client_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus
this helper function is provided in order to free (deallocate) it. 
</p></blockquote></div>

<h4 class="subheading">gnutls_srp_free_server_credentials</h4>

<p><a name="gnutls_005fsrp_005ffree_005fserver_005fcredentials"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_srp_free_server_credentials</b> (<var>gnutls_srp_server_credentials_t sc</var>)<var><a name="index-gnutls_005fsrp_005ffree_005fserver_005fcredentials-276"></a></var><br>
<blockquote><p><var>sc</var>: is an <code>gnutls_srp_server_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus
this helper function is provided in order to free (deallocate) it. 
</p></blockquote></div>

<h4 class="subheading">gnutls_srp_server_get_username</h4>

<p><a name="gnutls_005fsrp_005fserver_005fget_005fusername"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_srp_server_get_username</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fsrp_005fserver_005fget_005fusername-277"></a></var><br>
<blockquote><p><var>session</var>: is a gnutls session

     <p>This function will return the username of the peer.  This should
only be called in case of SRP authentication and in case of a
server.  Returns NULL in case of an error.

     <p><strong>Returns:</strong> SRP username of the peer, or NULL in case of error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_srp_set_client_credentials_function</h4>

<p><a name="gnutls_005fsrp_005fset_005fclient_005fcredentials_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_srp_set_client_credentials_function</b> (<var>gnutls_srp_client_credentials_t cred, gnutls_srp_client_credentials_function * func</var>)<var><a name="index-gnutls_005fsrp_005fset_005fclient_005fcredentials_005ffunction-278"></a></var><br>
<blockquote><p><var>cred</var>: is a <code>gnutls_srp_server_credentials_t</code> structure.

     <p><var>func</var>: is the callback function

     <p>This function can be used to set a callback to retrieve the username and
password for client SRP authentication.

     <p>The callback's function form is:

     <p>int (*callback)(gnutls_session_t, char** username, char**password);

     <p>The <code>username</code> and <code>password</code> must be allocated using
<code>gnutls_malloc()</code>.  <code>username</code> and <code>password</code> should be ASCII strings
or UTF-8 strings prepared using the "SASLprep" profile of
"stringprep".

     <p>The callback function will be called once per handshake before the
initial hello message is sent.

     <p>The callback should not return a negative error code the second
time called, since the handshake procedure will be aborted.

     <p>The callback function should return 0 on success. 
-1 indicates an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_srp_set_client_credentials</h4>

<p><a name="gnutls_005fsrp_005fset_005fclient_005fcredentials"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_srp_set_client_credentials</b> (<var>gnutls_srp_client_credentials_t res, const char * username, const char * password</var>)<var><a name="index-gnutls_005fsrp_005fset_005fclient_005fcredentials-279"></a></var><br>
<blockquote><p><var>res</var>: is an <code>gnutls_srp_client_credentials_t</code> structure.

     <p><var>username</var>: is the user's userid

     <p><var>password</var>: is the user's password

     <p>This function sets the username and password, in a
<code>gnutls_srp_client_credentials_t</code> structure.  Those will be used in
SRP authentication.  <code>username</code> and <code>password</code> should be ASCII
strings or UTF-8 strings prepared using the "SASLprep" profile of
"stringprep".

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, or an
error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_srp_set_prime_bits</h4>

<p><a name="gnutls_005fsrp_005fset_005fprime_005fbits"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_srp_set_prime_bits</b> (<var>gnutls_session_t session, unsigned int bits</var>)<var><a name="index-gnutls_005fsrp_005fset_005fprime_005fbits-280"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>bits</var>: is the number of bits

     <p>This function sets the minimum accepted number of bits, for use in
an SRP key exchange.  If zero, the default 2048 bits will be used.

     <p>In the client side it sets the minimum accepted number of bits.  If
a server sends a prime with less bits than that
<code>GNUTLS_E_RECEIVED_ILLEGAL_PARAMETER</code> will be returned by the
handshake.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_srp_set_server_credentials_file</h4>

<p><a name="gnutls_005fsrp_005fset_005fserver_005fcredentials_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_srp_set_server_credentials_file</b> (<var>gnutls_srp_server_credentials_t res, const char * password_file, const char * password_conf_file</var>)<var><a name="index-gnutls_005fsrp_005fset_005fserver_005fcredentials_005ffile-281"></a></var><br>
<blockquote><p><var>res</var>: is an <code>gnutls_srp_server_credentials_t</code> structure.

     <p><var>password_file</var>: is the SRP password file (tpasswd)

     <p><var>password_conf_file</var>: is the SRP password conf file (tpasswd.conf)

     <p>This function sets the password files, in a
<code>gnutls_srp_server_credentials_t</code> structure.  Those password files
hold usernames and verifiers and will be used for SRP
authentication.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, or an
error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_srp_set_server_credentials_function</h4>

<p><a name="gnutls_005fsrp_005fset_005fserver_005fcredentials_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_srp_set_server_credentials_function</b> (<var>gnutls_srp_server_credentials_t cred, gnutls_srp_server_credentials_function * func</var>)<var><a name="index-gnutls_005fsrp_005fset_005fserver_005fcredentials_005ffunction-282"></a></var><br>
<blockquote><p><var>cred</var>: is a <code>gnutls_srp_server_credentials_t</code> structure.

     <p><var>func</var>: is the callback function

     <p>This function can be used to set a callback to retrieve the user's SRP credentials. 
The callback's function form is:
int (*callback)(gnutls_session_t, const char* username,
gnutls_datum_t* salt, gnutls_datum_t *verifier, gnutls_datum_t* g,
gnutls_datum_t* n);

     <p><code>username</code> contains the actual username. 
The <code>salt</code>, <code>verifier</code>, <code>generator</code> and <code>prime</code> must be filled
in using the <code>gnutls_malloc()</code>. For convenience <code>prime</code> and <code>generator</code>
may also be one of the static parameters defined in extra.h.

     <p>In case the callback returned a negative number then gnutls will
assume that the username does not exist.

     <p>In order to prevent attackers from guessing valid usernames,
if a user does not exist, g and n values should be filled in
using a random user's parameters. In that case the callback must
return the special value (1).

     <p>The callback function will only be called once per handshake. 
The callback function should return 0 on success, while
-1 indicates an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_srp_verifier</h4>

<p><a name="gnutls_005fsrp_005fverifier"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_srp_verifier</b> (<var>const char * username, const char * password, const gnutls_datum_t * salt, const gnutls_datum_t * generator, const gnutls_datum_t * prime, gnutls_datum_t * res</var>)<var><a name="index-gnutls_005fsrp_005fverifier-283"></a></var><br>
<blockquote><p><var>username</var>: is the user's name

     <p><var>password</var>: is the user's password

     <p><var>salt</var>: should be some randomly generated bytes

     <p><var>generator</var>: is the generator of the group

     <p><var>prime</var>: is the group's prime

     <p><var>res</var>: where the verifier will be stored.

     <p>This function will create an SRP verifier, as specified in
RFC2945.  The <code>prime</code> and <code>generator</code> should be one of the static
parameters defined in gnutls/extra.h or may be generated using the
libgcrypt functions <code>gcry_prime_generate()</code> and
<code>gcry_prime_group_generator()</code>.

     <p>The verifier will be allocated with <code>malloc</code> and will be stored in
<code>res</code> using binary format.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, or an
error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_strerror_name</h4>

<p><a name="gnutls_005fstrerror_005fname"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_strerror_name</b> (<var>int error</var>)<var><a name="index-gnutls_005fstrerror_005fname-284"></a></var><br>
<blockquote><p><var>error</var>: is an error returned by a gnutls function.

     <p>Return the GnuTLS error code define as a string.  For example,
gnutls_strerror_name (GNUTLS_E_DH_PRIME_UNACCEPTABLE) will return
the string "GNUTLS_E_DH_PRIME_UNACCEPTABLE".

     <p><strong>Returns:</strong> A string corresponding to the symbol name of the error
code.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_strerror</h4>

<p><a name="gnutls_005fstrerror"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_strerror</b> (<var>int error</var>)<var><a name="index-gnutls_005fstrerror-285"></a></var><br>
<blockquote><p><var>error</var>: is a GnuTLS error code, a negative value

     <p>This function is similar to <code>strerror()</code>.  Differences: it accepts an
error number returned by a gnutls function; In case of an unknown
error a descriptive string is sent instead of NULL.

     <p>Error codes are always a negative value.

     <p><strong>Returns:</strong> A string explaining the GnuTLS error message. 
</p></blockquote></div>

<h4 class="subheading">gnutls_transport_get_ptr2</h4>

<p><a name="gnutls_005ftransport_005fget_005fptr2"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_transport_get_ptr2</b> (<var>gnutls_session_t session, gnutls_transport_ptr_t * recv_ptr, gnutls_transport_ptr_t * send_ptr</var>)<var><a name="index-gnutls_005ftransport_005fget_005fptr2-286"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>recv_ptr</var>: will hold the value for the pull function

     <p><var>send_ptr</var>: will hold the value for the push function

     <p>Used to get the arguments of the transport functions (like PUSH
and PULL).  These should have been set using
<code>gnutls_transport_set_ptr2()</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_transport_get_ptr</h4>

<p><a name="gnutls_005ftransport_005fget_005fptr"></a>

<div class="defun">
&mdash; Function: gnutls_transport_ptr_t <b>gnutls_transport_get_ptr</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005ftransport_005fget_005fptr-287"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Used to get the first argument of the transport function (like
PUSH and PULL).  This must have been set using
<code>gnutls_transport_set_ptr()</code>.

     <p><strong>Returns:</strong> first argument of the transport function. 
</p></blockquote></div>

<h4 class="subheading">gnutls_transport_set_errno</h4>

<p><a name="gnutls_005ftransport_005fset_005ferrno"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_transport_set_errno</b> (<var>gnutls_session_t session, int err</var>)<var><a name="index-gnutls_005ftransport_005fset_005ferrno-288"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>err</var>: error value to store in session-specific errno variable.

     <p>Store <code>err</code> in the session-specific errno variable.  Useful values
for <code>err</code> is EAGAIN and EINTR, other values are treated will be
treated as real errors in the push/pull function.

     <p>This function is useful in replacement push/pull functions set by
gnutls_transport_set_push_function and
gnutls_transport_set_pullpush_function under Windows, where the
replacement push/pull may not have access to the same <code>errno</code>
variable that is used by GnuTLS (e.g., the application is linked to
msvcr71.dll and gnutls is linked to msvcrt.dll).

     <p>If you don't have the <code>session</code> variable easily accessible from the
push/pull function, and don't worry about thread conflicts, you can
also use <code>gnutls_transport_set_global_errno()</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_transport_set_global_errno</h4>

<p><a name="gnutls_005ftransport_005fset_005fglobal_005ferrno"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_transport_set_global_errno</b> (<var>int err</var>)<var><a name="index-gnutls_005ftransport_005fset_005fglobal_005ferrno-289"></a></var><br>
<blockquote><p><var>err</var>: error value to store in global errno variable.

     <p>Store <code>err</code> in the global errno variable.  Useful values for <code>err</code> is
EAGAIN and EINTR, other values are treated will be treated as real
errors in the push/pull function.

     <p>This function is useful in replacement push/pull functions set by
gnutls_transport_set_push_function and
gnutls_transport_set_pullpush_function under Windows, where the
replacement push/pull may not have access to the same <code>errno</code>
variable that is used by GnuTLS (e.g., the application is linked to
msvcr71.dll and gnutls is linked to msvcrt.dll).

     <p>Whether this function is thread safe or not depends on whether the
global variable errno is thread safe, some system libraries make it
a thread-local variable.  When feasible, using the guaranteed
thread-safe <code>gnutls_transport_set_errno()</code> may be better. 
</p></blockquote></div>

<h4 class="subheading">gnutls_transport_set_lowat</h4>

<p><a name="gnutls_005ftransport_005fset_005flowat"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_transport_set_lowat</b> (<var>gnutls_session_t session, int num</var>)<var><a name="index-gnutls_005ftransport_005fset_005flowat-290"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>num</var>: is the low water value.

     <p>Used to set the lowat value in order for select to check if there
are pending data to socket buffer. Used only if you have changed
the default low water value (default is 1).  Normally you will not
need that function.  This function is only useful if using
berkeley style sockets.  Otherwise it must be called and set lowat
to zero. 
</p></blockquote></div>

<h4 class="subheading">gnutls_transport_set_ptr2</h4>

<p><a name="gnutls_005ftransport_005fset_005fptr2"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_transport_set_ptr2</b> (<var>gnutls_session_t session, gnutls_transport_ptr_t recv_ptr, gnutls_transport_ptr_t send_ptr</var>)<var><a name="index-gnutls_005ftransport_005fset_005fptr2-291"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>recv_ptr</var>: is the value for the pull function

     <p><var>send_ptr</var>: is the value for the push function

     <p>Used to set the first argument of the transport function (like
PUSH and PULL). In berkeley style sockets this function will set
the connection handle.  With this function you can use two
different pointers for receiving and sending. 
</p></blockquote></div>

<h4 class="subheading">gnutls_transport_set_ptr</h4>

<p><a name="gnutls_005ftransport_005fset_005fptr"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_transport_set_ptr</b> (<var>gnutls_session_t session, gnutls_transport_ptr_t ptr</var>)<var><a name="index-gnutls_005ftransport_005fset_005fptr-292"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>ptr</var>: is the value.

     <p>Used to set the first argument of the transport function (like
PUSH and PULL).  In berkeley style sockets this function will set
the connection handle. 
</p></blockquote></div>

<h4 class="subheading">gnutls_transport_set_pull_function</h4>

<p><a name="gnutls_005ftransport_005fset_005fpull_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_transport_set_pull_function</b> (<var>gnutls_session_t session, gnutls_pull_func pull_func</var>)<var><a name="index-gnutls_005ftransport_005fset_005fpull_005ffunction-293"></a></var><br>
<blockquote><p><var>session</var>: gnutls session

     <p><var>pull_func</var>: a callback function similar to <code>read()</code>

     <p>This is the function where you set a function for gnutls
to receive data. Normally, if you use berkeley style sockets,
do not need to use this function since the default (recv(2)) will
probably be ok.

     <p>PULL_FUNC is of the form,
ssize_t (*gnutls_pull_func)(gnutls_transport_ptr_t, void*, size_t);
</p></blockquote></div>

<h4 class="subheading">gnutls_transport_set_push_function</h4>

<p><a name="gnutls_005ftransport_005fset_005fpush_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_transport_set_push_function</b> (<var>gnutls_session_t session, gnutls_push_func push_func</var>)<var><a name="index-gnutls_005ftransport_005fset_005fpush_005ffunction-294"></a></var><br>
<blockquote><p><var>session</var>: gnutls session

     <p><var>push_func</var>: a callback function similar to <code>write()</code>

     <p>This is the function where you set a push function for gnutls
to use in order to send data. If you are going to use berkeley style
sockets, you do not need to use this function since
the default (send(2)) will probably be ok. Otherwise you should
specify this function for gnutls to be able to send data.

     <p>PUSH_FUNC is of the form,
ssize_t (*gnutls_push_func)(gnutls_transport_ptr_t, const void*, size_t);
</p></blockquote></div>

<div class="node">
<a name="X.509-certificate-functions"></a>
<a name="X_002e509-certificate-functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#GnuTLS_002dextra-functions">GnuTLS-extra functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Core-functions">Core functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Function-reference">Function reference</a>

</div>

<h3 class="section">9.2 <acronym>X.509</acronym> Certificate Functions</h3>

<p><a name="sec_003ax509api"></a><a name="index-g_t_0040acronym_007bX_002e509_007d-Functions-295"></a>
The following functions are to be used for <acronym>X.509</acronym> certificate handling. 
Their prototypes lie in <samp><span class="file">gnutls/x509.h</span></samp>.

<h4 class="subheading">gnutls_pkcs12_bag_decrypt</h4>

<p><a name="gnutls_005fpkcs12_005fbag_005fdecrypt"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_bag_decrypt</b> (<var>gnutls_pkcs12_bag_t bag, const char * pass</var>)<var><a name="index-gnutls_005fpkcs12_005fbag_005fdecrypt-296"></a></var><br>
<blockquote><p><var>bag</var>: The bag

     <p><var>pass</var>: The password used for encryption. This can only be ASCII.

     <p>This function will decrypt the given encrypted bag and return 0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_bag_deinit</h4>

<p><a name="gnutls_005fpkcs12_005fbag_005fdeinit"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_pkcs12_bag_deinit</b> (<var>gnutls_pkcs12_bag_t bag</var>)<var><a name="index-gnutls_005fpkcs12_005fbag_005fdeinit-297"></a></var><br>
<blockquote><p><var>bag</var>: The structure to be initialized

     <p>This function will deinitialize a PKCS12 Bag structure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_bag_encrypt</h4>

<p><a name="gnutls_005fpkcs12_005fbag_005fencrypt"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_bag_encrypt</b> (<var>gnutls_pkcs12_bag_t bag, const char * pass, unsigned int flags</var>)<var><a name="index-gnutls_005fpkcs12_005fbag_005fencrypt-298"></a></var><br>
<blockquote><p><var>bag</var>: The bag

     <p><var>pass</var>: The password used for encryption. This can only be ASCII.

     <p><var>flags</var>: should be one of gnutls_pkcs_encrypt_flags_t elements bitwise or'd

     <p>This function will encrypt the given bag and return 0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_bag_get_count</h4>

<p><a name="gnutls_005fpkcs12_005fbag_005fget_005fcount"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_bag_get_count</b> (<var>gnutls_pkcs12_bag_t bag</var>)<var><a name="index-gnutls_005fpkcs12_005fbag_005fget_005fcount-299"></a></var><br>
<blockquote><p><var>bag</var>: The bag

     <p>This function will return the number of the elements withing the bag. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_bag_get_data</h4>

<p><a name="gnutls_005fpkcs12_005fbag_005fget_005fdata"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_bag_get_data</b> (<var>gnutls_pkcs12_bag_t bag, int indx, gnutls_datum_t * data</var>)<var><a name="index-gnutls_005fpkcs12_005fbag_005fget_005fdata-300"></a></var><br>
<blockquote><p><var>bag</var>: The bag

     <p><var>indx</var>: The element of the bag to get the data from

     <p><var>data</var>: where the bag's data will be. Should be treated as constant.

     <p>This function will return the bag's data. The data is a constant
that is stored into the bag. Should not be accessed after the bag
is deleted.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.and a negative error code on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_bag_get_friendly_name</h4>

<p><a name="gnutls_005fpkcs12_005fbag_005fget_005ffriendly_005fname"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_bag_get_friendly_name</b> (<var>gnutls_pkcs12_bag_t bag, int indx, char ** name</var>)<var><a name="index-gnutls_005fpkcs12_005fbag_005fget_005ffriendly_005fname-301"></a></var><br>
<blockquote><p><var>bag</var>: The bag

     <p><var>indx</var>: The bag's element to add the id

     <p><var>name</var>: will hold a pointer to the name (to be treated as const)

     <p>This function will return the friendly name, of the specified bag element. 
The key ID is usually used to distinguish the local private key and the certificate pair.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. or a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_bag_get_key_id</h4>

<p><a name="gnutls_005fpkcs12_005fbag_005fget_005fkey_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_bag_get_key_id</b> (<var>gnutls_pkcs12_bag_t bag, int indx, gnutls_datum_t * id</var>)<var><a name="index-gnutls_005fpkcs12_005fbag_005fget_005fkey_005fid-302"></a></var><br>
<blockquote><p><var>bag</var>: The bag

     <p><var>indx</var>: The bag's element to add the id

     <p><var>id</var>: where the ID will be copied (to be treated as const)

     <p>This function will return the key ID, of the specified bag element. 
The key ID is usually used to distinguish the local private key and the certificate pair.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. or a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_bag_get_type</h4>

<p><a name="gnutls_005fpkcs12_005fbag_005fget_005ftype"></a>

<div class="defun">
&mdash; Function: gnutls_pkcs12_bag_type_t <b>gnutls_pkcs12_bag_get_type</b> (<var>gnutls_pkcs12_bag_t bag, int indx</var>)<var><a name="index-gnutls_005fpkcs12_005fbag_005fget_005ftype-303"></a></var><br>
<blockquote><p><var>bag</var>: The bag

     <p><var>indx</var>: The element of the bag to get the type

     <p>This function will return the bag's type. One of the gnutls_pkcs12_bag_type_t
enumerations. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_bag_init</h4>

<p><a name="gnutls_005fpkcs12_005fbag_005finit"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_bag_init</b> (<var>gnutls_pkcs12_bag_t * bag</var>)<var><a name="index-gnutls_005fpkcs12_005fbag_005finit-304"></a></var><br>
<blockquote><p><var>bag</var>: The structure to be initialized

     <p>This function will initialize a PKCS12 bag structure. PKCS12 Bags
usually contain private keys, lists of X.509 Certificates and X.509 Certificate
revocation lists.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_bag_set_crl</h4>

<p><a name="gnutls_005fpkcs12_005fbag_005fset_005fcrl"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_bag_set_crl</b> (<var>gnutls_pkcs12_bag_t bag, gnutls_x509_crl_t crl</var>)<var><a name="index-gnutls_005fpkcs12_005fbag_005fset_005fcrl-305"></a></var><br>
<blockquote><p><var>bag</var>: The bag

     <p><var>crl</var>: the CRL to be copied.

     <p>This function will insert the given CRL into the
bag. This is just a wrapper over <code>gnutls_pkcs12_bag_set_data()</code>.

     <p><strong>Returns:</strong> the index of the added bag on success, or a negative value
on failure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_bag_set_crt</h4>

<p><a name="gnutls_005fpkcs12_005fbag_005fset_005fcrt"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_bag_set_crt</b> (<var>gnutls_pkcs12_bag_t bag, gnutls_x509_crt_t crt</var>)<var><a name="index-gnutls_005fpkcs12_005fbag_005fset_005fcrt-306"></a></var><br>
<blockquote><p><var>bag</var>: The bag

     <p><var>crt</var>: the certificate to be copied.

     <p>This function will insert the given certificate into the
bag. This is just a wrapper over <code>gnutls_pkcs12_bag_set_data()</code>.

     <p><strong>Returns:</strong> the index of the added bag on success, or a negative
value on failure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_bag_set_data</h4>

<p><a name="gnutls_005fpkcs12_005fbag_005fset_005fdata"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_bag_set_data</b> (<var>gnutls_pkcs12_bag_t bag, gnutls_pkcs12_bag_type_t type, const gnutls_datum_t * data</var>)<var><a name="index-gnutls_005fpkcs12_005fbag_005fset_005fdata-307"></a></var><br>
<blockquote><p><var>bag</var>: The bag

     <p><var>type</var>: The data's type

     <p><var>data</var>: the data to be copied.

     <p>This function will insert the given data of the given type into
the bag.

     <p><strong>Returns:</strong> the index of the added bag on success, or a negative
value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_bag_set_friendly_name</h4>

<p><a name="gnutls_005fpkcs12_005fbag_005fset_005ffriendly_005fname"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_bag_set_friendly_name</b> (<var>gnutls_pkcs12_bag_t bag, int indx, const char * name</var>)<var><a name="index-gnutls_005fpkcs12_005fbag_005fset_005ffriendly_005fname-308"></a></var><br>
<blockquote><p><var>bag</var>: The bag

     <p><var>indx</var>: The bag's element to add the id

     <p><var>name</var>: the name

     <p>This function will add the given key friendly name, to the specified, by the index, bag
element. The name will be encoded as a 'Friendly name' bag attribute,
which is usually used to set a user name to the local private key and the certificate pair.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. or a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_bag_set_key_id</h4>

<p><a name="gnutls_005fpkcs12_005fbag_005fset_005fkey_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_bag_set_key_id</b> (<var>gnutls_pkcs12_bag_t bag, int indx, const gnutls_datum_t * id</var>)<var><a name="index-gnutls_005fpkcs12_005fbag_005fset_005fkey_005fid-309"></a></var><br>
<blockquote><p><var>bag</var>: The bag

     <p><var>indx</var>: The bag's element to add the id

     <p><var>id</var>: the ID

     <p>This function will add the given key ID, to the specified, by the index, bag
element. The key ID will be encoded as a 'Local key identifier' bag attribute,
which is usually used to distinguish the local private key and the certificate pair.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. or a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_deinit</h4>

<p><a name="gnutls_005fpkcs12_005fdeinit"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_pkcs12_deinit</b> (<var>gnutls_pkcs12_t pkcs12</var>)<var><a name="index-gnutls_005fpkcs12_005fdeinit-310"></a></var><br>
<blockquote><p><var>pkcs12</var>: The structure to be initialized

     <p>This function will deinitialize a PKCS12 structure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_export</h4>

<p><a name="gnutls_005fpkcs12_005fexport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_export</b> (<var>gnutls_pkcs12_t pkcs12, gnutls_x509_crt_fmt_t format, void * output_data, size_t * output_data_size</var>)<var><a name="index-gnutls_005fpkcs12_005fexport-311"></a></var><br>
<blockquote><p><var>pkcs12</var>: Holds the pkcs12 structure

     <p><var>format</var>: the format of output params. One of PEM or DER.

     <p><var>output_data</var>: will contain a structure PEM or DER encoded

     <p><var>output_data_size</var>: holds the size of output_data (and will be
replaced by the actual size of parameters)

     <p>This function will export the pkcs12 structure to DER or PEM format.

     <p>If the buffer provided is not long enough to hold the output, then
*output_data_size will be updated and GNUTLS_E_SHORT_MEMORY_BUFFER
will be returned.

     <p>If the structure is PEM encoded, it will have a header
of "BEGIN PKCS12".

     <p><strong>Return value:</strong> In case of failure a negative value will be
returned, and 0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_generate_mac</h4>

<p><a name="gnutls_005fpkcs12_005fgenerate_005fmac"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_generate_mac</b> (<var>gnutls_pkcs12_t pkcs12, const char * pass</var>)<var><a name="index-gnutls_005fpkcs12_005fgenerate_005fmac-312"></a></var><br>
<blockquote><p><var>pkcs12</var>: should contain a gnutls_pkcs12_t structure

     <p><var>pass</var>: The password for the MAC

     <p>This function will generate a MAC for the PKCS12 structure.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_get_bag</h4>

<p><a name="gnutls_005fpkcs12_005fget_005fbag"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_get_bag</b> (<var>gnutls_pkcs12_t pkcs12, int indx, gnutls_pkcs12_bag_t bag</var>)<var><a name="index-gnutls_005fpkcs12_005fget_005fbag-313"></a></var><br>
<blockquote><p><var>pkcs12</var>: should contain a gnutls_pkcs12_t structure

     <p><var>indx</var>: contains the index of the bag to extract

     <p><var>bag</var>: An initialized bag, where the contents of the bag will be copied

     <p>This function will return a Bag from the PKCS12 structure.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.

     <p>After the last Bag has been read GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE
will be returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_import</h4>

<p><a name="gnutls_005fpkcs12_005fimport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_import</b> (<var>gnutls_pkcs12_t pkcs12, const gnutls_datum_t * data, gnutls_x509_crt_fmt_t format, unsigned int flags</var>)<var><a name="index-gnutls_005fpkcs12_005fimport-314"></a></var><br>
<blockquote><p><var>pkcs12</var>: The structure to store the parsed PKCS12.

     <p><var>data</var>: The DER or PEM encoded PKCS12.

     <p><var>format</var>: One of DER or PEM

     <p><var>flags</var>: an ORed sequence of gnutls_privkey_pkcs8_flags

     <p>This function will convert the given DER or PEM encoded PKCS12
to the native gnutls_pkcs12_t format. The output will be stored in 'pkcs12'.

     <p>If the PKCS12 is PEM encoded it should have a header of "PKCS12".

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_init</h4>

<p><a name="gnutls_005fpkcs12_005finit"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_init</b> (<var>gnutls_pkcs12_t * pkcs12</var>)<var><a name="index-gnutls_005fpkcs12_005finit-315"></a></var><br>
<blockquote><p><var>pkcs12</var>: The structure to be initialized

     <p>This function will initialize a PKCS12 structure. PKCS12 structures
usually contain lists of X.509 Certificates and X.509 Certificate
revocation lists.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_set_bag</h4>

<p><a name="gnutls_005fpkcs12_005fset_005fbag"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_set_bag</b> (<var>gnutls_pkcs12_t pkcs12, gnutls_pkcs12_bag_t bag</var>)<var><a name="index-gnutls_005fpkcs12_005fset_005fbag-316"></a></var><br>
<blockquote><p><var>pkcs12</var>: should contain a gnutls_pkcs12_t structure

     <p><var>bag</var>: An initialized bag

     <p>This function will insert a Bag into the PKCS12 structure.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs12_verify_mac</h4>

<p><a name="gnutls_005fpkcs12_005fverify_005fmac"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs12_verify_mac</b> (<var>gnutls_pkcs12_t pkcs12, const char * pass</var>)<var><a name="index-gnutls_005fpkcs12_005fverify_005fmac-317"></a></var><br>
<blockquote><p><var>pkcs12</var>: should contain a gnutls_pkcs12_t structure

     <p><var>pass</var>: The password for the MAC

     <p>This function will verify the MAC for the PKCS12 structure.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs7_deinit</h4>

<p><a name="gnutls_005fpkcs7_005fdeinit"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_pkcs7_deinit</b> (<var>gnutls_pkcs7_t pkcs7</var>)<var><a name="index-gnutls_005fpkcs7_005fdeinit-318"></a></var><br>
<blockquote><p><var>pkcs7</var>: The structure to be initialized

     <p>This function will deinitialize a PKCS7 structure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs7_delete_crl</h4>

<p><a name="gnutls_005fpkcs7_005fdelete_005fcrl"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs7_delete_crl</b> (<var>gnutls_pkcs7_t pkcs7, int indx</var>)<var><a name="index-gnutls_005fpkcs7_005fdelete_005fcrl-319"></a></var><br>
<blockquote><p><var>indx</var>: the index of the crl to delete

     <p>This function will delete a crl from a PKCS7 or RFC2630 crl set. 
Index starts from 0. Returns 0 on success.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs7_delete_crt</h4>

<p><a name="gnutls_005fpkcs7_005fdelete_005fcrt"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs7_delete_crt</b> (<var>gnutls_pkcs7_t pkcs7, int indx</var>)<var><a name="index-gnutls_005fpkcs7_005fdelete_005fcrt-320"></a></var><br>
<blockquote><p><var>indx</var>: the index of the certificate to delete

     <p>This function will delete a certificate from a PKCS7 or RFC2630
certificate set.  Index starts from 0. Returns 0 on success.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs7_export</h4>

<p><a name="gnutls_005fpkcs7_005fexport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs7_export</b> (<var>gnutls_pkcs7_t pkcs7, gnutls_x509_crt_fmt_t format, void * output_data, size_t * output_data_size</var>)<var><a name="index-gnutls_005fpkcs7_005fexport-321"></a></var><br>
<blockquote><p><var>pkcs7</var>: Holds the pkcs7 structure

     <p><var>format</var>: the format of output params. One of PEM or DER.

     <p><var>output_data</var>: will contain a structure PEM or DER encoded

     <p><var>output_data_size</var>: holds the size of output_data (and will be
replaced by the actual size of parameters)

     <p>This function will export the pkcs7 structure to DER or PEM format.

     <p>If the buffer provided is not long enough to hold the output, then
*<code>output_data_size</code> is updated and <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code>
will be returned.

     <p>If the structure is PEM encoded, it will have a header
of "BEGIN PKCS7".

     <p><strong>Return value:</strong> In case of failure a negative value will be
returned, and 0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs7_get_crl_count</h4>

<p><a name="gnutls_005fpkcs7_005fget_005fcrl_005fcount"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs7_get_crl_count</b> (<var>gnutls_pkcs7_t pkcs7</var>)<var><a name="index-gnutls_005fpkcs7_005fget_005fcrl_005fcount-322"></a></var><br>
<blockquote><p>This function will return the number of certifcates in the PKCS7
or RFC2630 crl set.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs7_get_crl_raw</h4>

<p><a name="gnutls_005fpkcs7_005fget_005fcrl_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs7_get_crl_raw</b> (<var>gnutls_pkcs7_t pkcs7, int indx, void * crl, size_t * crl_size</var>)<var><a name="index-gnutls_005fpkcs7_005fget_005fcrl_005fraw-323"></a></var><br>
<blockquote><p><var>indx</var>: contains the index of the crl to extract

     <p><var>crl</var>: the contents of the crl will be copied there (may be null)

     <p><var>crl_size</var>: should hold the size of the crl

     <p>This function will return a crl of the PKCS7 or RFC2630 crl set.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.  If the provided buffer is not long enough,
then <code>crl_size</code> is updated and <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> is
returned.  After the last crl has been read
<code>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</code> will be returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs7_get_crt_count</h4>

<p><a name="gnutls_005fpkcs7_005fget_005fcrt_005fcount"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs7_get_crt_count</b> (<var>gnutls_pkcs7_t pkcs7</var>)<var><a name="index-gnutls_005fpkcs7_005fget_005fcrt_005fcount-324"></a></var><br>
<blockquote><p>This function will return the number of certifcates in the PKCS7
or RFC2630 certificate set.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs7_get_crt_raw</h4>

<p><a name="gnutls_005fpkcs7_005fget_005fcrt_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs7_get_crt_raw</b> (<var>gnutls_pkcs7_t pkcs7, int indx, void * certificate, size_t * certificate_size</var>)<var><a name="index-gnutls_005fpkcs7_005fget_005fcrt_005fraw-325"></a></var><br>
<blockquote><p><var>indx</var>: contains the index of the certificate to extract

     <p><var>certificate</var>: the contents of the certificate will be copied
there (may be null)

     <p><var>certificate_size</var>: should hold the size of the certificate

     <p>This function will return a certificate of the PKCS7 or RFC2630
certificate set.

     <p>After the last certificate has been read
<code>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</code> will be returned.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.  If the provided buffer is not long enough,
then <code>certificate_size</code> is updated and
<code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs7_import</h4>

<p><a name="gnutls_005fpkcs7_005fimport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs7_import</b> (<var>gnutls_pkcs7_t pkcs7, const gnutls_datum_t * data, gnutls_x509_crt_fmt_t format</var>)<var><a name="index-gnutls_005fpkcs7_005fimport-326"></a></var><br>
<blockquote><p><var>pkcs7</var>: The structure to store the parsed PKCS7.

     <p><var>data</var>: The DER or PEM encoded PKCS7.

     <p><var>format</var>: One of DER or PEM

     <p>This function will convert the given DER or PEM encoded PKCS7 to
the native <code>gnutls_pkcs7_t</code> format.  The output will be stored in
'pkcs7'.

     <p>If the PKCS7 is PEM encoded it should have a header of "PKCS7".

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs7_init</h4>

<p><a name="gnutls_005fpkcs7_005finit"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs7_init</b> (<var>gnutls_pkcs7_t * pkcs7</var>)<var><a name="index-gnutls_005fpkcs7_005finit-327"></a></var><br>
<blockquote><p><var>pkcs7</var>: The structure to be initialized

     <p>This function will initialize a PKCS7 structure. PKCS7 structures
usually contain lists of X.509 Certificates and X.509 Certificate
revocation lists.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs7_set_crl_raw</h4>

<p><a name="gnutls_005fpkcs7_005fset_005fcrl_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs7_set_crl_raw</b> (<var>gnutls_pkcs7_t pkcs7, const gnutls_datum_t * crl</var>)<var><a name="index-gnutls_005fpkcs7_005fset_005fcrl_005fraw-328"></a></var><br>
<blockquote><p><var>crl</var>: the DER encoded crl to be added

     <p>This function will add a crl to the PKCS7 or RFC2630 crl set.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs7_set_crl</h4>

<p><a name="gnutls_005fpkcs7_005fset_005fcrl"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs7_set_crl</b> (<var>gnutls_pkcs7_t pkcs7, gnutls_x509_crl_t crl</var>)<var><a name="index-gnutls_005fpkcs7_005fset_005fcrl-329"></a></var><br>
<blockquote><p><var>crl</var>: the DER encoded crl to be added

     <p>This function will add a parsed CRL to the PKCS7 or RFC2630 crl
set.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs7_set_crt_raw</h4>

<p><a name="gnutls_005fpkcs7_005fset_005fcrt_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs7_set_crt_raw</b> (<var>gnutls_pkcs7_t pkcs7, const gnutls_datum_t * crt</var>)<var><a name="index-gnutls_005fpkcs7_005fset_005fcrt_005fraw-330"></a></var><br>
<blockquote><p><var>crt</var>: the DER encoded certificate to be added

     <p>This function will add a certificate to the PKCS7 or RFC2630
certificate set.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_pkcs7_set_crt</h4>

<p><a name="gnutls_005fpkcs7_005fset_005fcrt"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_pkcs7_set_crt</b> (<var>gnutls_pkcs7_t pkcs7, gnutls_x509_crt_t crt</var>)<var><a name="index-gnutls_005fpkcs7_005fset_005fcrt-331"></a></var><br>
<blockquote><p><var>crt</var>: the certificate to be copied.

     <p>This function will add a parsed certificate to the PKCS7 or
RFC2630 certificate set.  This is a wrapper function over
<code>gnutls_pkcs7_set_crt_raw()</code> .

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_check_issuer</h4>

<p><a name="gnutls_005fx509_005fcrl_005fcheck_005fissuer"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_check_issuer</b> (<var>gnutls_x509_crl_t cert, gnutls_x509_crt_t issuer</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fcheck_005fissuer-332"></a></var><br>
<blockquote><p><var>issuer</var>: is the certificate of a possible issuer

     <p>This function will check if the given CRL was issued by the
given issuer certificate. It will return true (1) if the given CRL was issued
by the given issuer, and false (0) if not.

     <p>A negative value is returned in case of an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_deinit</h4>

<p><a name="gnutls_005fx509_005fcrl_005fdeinit"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_x509_crl_deinit</b> (<var>gnutls_x509_crl_t crl</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fdeinit-333"></a></var><br>
<blockquote><p><var>crl</var>: The structure to be initialized

     <p>This function will deinitialize a CRL structure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_export</h4>

<p><a name="gnutls_005fx509_005fcrl_005fexport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_export</b> (<var>gnutls_x509_crl_t crl, gnutls_x509_crt_fmt_t format, void * output_data, size_t * output_data_size</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fexport-334"></a></var><br>
<blockquote><p><var>crl</var>: Holds the revocation list

     <p><var>format</var>: the format of output params. One of PEM or DER.

     <p><var>output_data</var>: will contain a private key PEM or DER encoded

     <p><var>output_data_size</var>: holds the size of output_data (and will
be replaced by the actual size of parameters)

     <p>This function will export the revocation list to DER or PEM format.

     <p>If the buffer provided is not long enough to hold the output, then
¤GNUTLS_E_SHORT_MEMORY_BUFFER will be returned.

     <p>If the structure is PEM encoded, it will have a header
of "BEGIN X509 CRL".

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. and a negative value on failure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_get_crt_count</h4>

<p><a name="gnutls_005fx509_005fcrl_005fget_005fcrt_005fcount"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_get_crt_count</b> (<var>gnutls_x509_crl_t crl</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fget_005fcrt_005fcount-335"></a></var><br>
<blockquote><p><var>crl</var>: should contain a <code>gnutls_x509_crl_t</code> structure

     <p>This function will return the number of revoked certificates in the
given CRL.

     <p><strong>Returns:</strong> number of certificates, a negative value on failure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_get_crt_serial</h4>

<p><a name="gnutls_005fx509_005fcrl_005fget_005fcrt_005fserial"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_get_crt_serial</b> (<var>gnutls_x509_crl_t crl, int indx, unsigned char * serial, size_t * serial_size, time_t * t</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fget_005fcrt_005fserial-336"></a></var><br>
<blockquote><p><var>crl</var>: should contain a <code>gnutls_x509_crl_t</code> structure

     <p><var>indx</var>: the index of the certificate to extract (starting from 0)

     <p><var>serial</var>: where the serial number will be copied

     <p><var>serial_size</var>: initially holds the size of serial

     <p><var>t</var>: if non null, will hold the time this certificate was revoked

     <p>This function will retrieve the serial number of the specified, by
the index, revoked certificate.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. and a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_get_dn_oid</h4>

<p><a name="gnutls_005fx509_005fcrl_005fget_005fdn_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_get_dn_oid</b> (<var>gnutls_x509_crl_t crl, int indx, void * oid, size_t * sizeof_oid</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fget_005fdn_005foid-337"></a></var><br>
<blockquote><p><var>crl</var>: should contain a gnutls_x509_crl_t structure

     <p><var>indx</var>: Specifies which DN OID to send. Use zero to get the first one.

     <p><var>oid</var>: a pointer to a structure to hold the name (may be null)

     <p><var>sizeof_oid</var>: initially holds the size of 'oid'

     <p>This function will extract the requested OID of the name of the CRL
issuer, specified by the given index.

     <p>If oid is null then only the size will be filled.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> if the provided buffer is
not long enough, and in that case the sizeof_oid will be updated
with the required size.  On success 0 is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_get_issuer_dn_by_oid</h4>

<p><a name="gnutls_005fx509_005fcrl_005fget_005fissuer_005fdn_005fby_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_get_issuer_dn_by_oid</b> (<var>gnutls_x509_crl_t crl, const char * oid, int indx, unsigned int raw_flag, void * buf, size_t * sizeof_buf</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fget_005fissuer_005fdn_005fby_005foid-338"></a></var><br>
<blockquote><p><var>crl</var>: should contain a gnutls_x509_crl_t structure

     <p><var>oid</var>: holds an Object Identified in null terminated string

     <p><var>indx</var>: In case multiple same OIDs exist in the RDN, this specifies which to send. Use zero to get the first one.

     <p><var>raw_flag</var>: If non zero returns the raw DER data of the DN part.

     <p><var>buf</var>: a pointer to a structure to hold the peer's name (may be null)

     <p><var>sizeof_buf</var>: initially holds the size of <code>buf</code>

     <p>This function will extract the part of the name of the CRL issuer
specified by the given OID. The output will be encoded as described
in RFC2253. The output string will be ASCII or UTF-8 encoded,
depending on the certificate data.

     <p>Some helper macros with popular OIDs can be found in gnutls/x509.h
If raw flag is zero, this function will only return known OIDs as
text. Other OIDs will be DER encoded, as described in RFC2253 &ndash; in
hex format with a '\#' prefix.  You can check about known OIDs
using <code>gnutls_x509_dn_oid_known()</code>.

     <p>If buf is null then only the size will be filled.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> if the provided buffer is
not long enough, and in that case the sizeof_buf will be updated
with the required size, and 0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_get_issuer_dn</h4>

<p><a name="gnutls_005fx509_005fcrl_005fget_005fissuer_005fdn"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_get_issuer_dn</b> (<var>const gnutls_x509_crl_t crl, char * buf, size_t * sizeof_buf</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fget_005fissuer_005fdn-339"></a></var><br>
<blockquote><p><var>crl</var>: should contain a gnutls_x509_crl_t structure

     <p><var>buf</var>: a pointer to a structure to hold the peer's name (may be null)

     <p><var>sizeof_buf</var>: initially holds the size of <code>buf</code>

     <p>This function will copy the name of the CRL issuer in the provided
buffer. The name will be in the form "C=xxxx,O=yyyy,CN=zzzz" as
described in RFC2253. The output string will be ASCII or UTF-8
encoded, depending on the certificate data.

     <p>If buf is <code>NULL</code> then only the size will be filled.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> if the provided buffer is
not long enough, and in that case the sizeof_buf will be updated
with the required size, and 0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_get_next_update</h4>

<p><a name="gnutls_005fx509_005fcrl_005fget_005fnext_005fupdate"></a>

<div class="defun">
&mdash; Function: time_t <b>gnutls_x509_crl_get_next_update</b> (<var>gnutls_x509_crl_t crl</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fget_005fnext_005fupdate-340"></a></var><br>
<blockquote><p><var>crl</var>: should contain a <code>gnutls_x509_crl_t</code> structure

     <p>This function will return the time the next CRL will be issued. 
This field is optional in a CRL so it might be normal to get an
error instead.

     <p><strong>Returns:</strong> when the next CRL will be issued, or (time_t)-1 on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_get_signature_algorithm</h4>

<p><a name="gnutls_005fx509_005fcrl_005fget_005fsignature_005falgorithm"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_get_signature_algorithm</b> (<var>gnutls_x509_crl_t crl</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fget_005fsignature_005falgorithm-341"></a></var><br>
<blockquote><p><var>crl</var>: should contain a <code>gnutls_x509_crl_t</code> structure

     <p>This function will return a value of the <code>gnutls_sign_algorithm_t</code>
enumeration that is the signature algorithm.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_get_signature</h4>

<p><a name="gnutls_005fx509_005fcrl_005fget_005fsignature"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_get_signature</b> (<var>gnutls_x509_crl_t crl, char * sig, size_t * sizeof_sig</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fget_005fsignature-342"></a></var><br>
<blockquote><p><var>crl</var>: should contain a gnutls_x509_crl_t structure

     <p><var>sig</var>: a pointer where the signature part will be copied (may be null).

     <p><var>sizeof_sig</var>: initially holds the size of <code>sig</code>

     <p>This function will extract the signature field of a CRL.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. and a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_get_this_update</h4>

<p><a name="gnutls_005fx509_005fcrl_005fget_005fthis_005fupdate"></a>

<div class="defun">
&mdash; Function: time_t <b>gnutls_x509_crl_get_this_update</b> (<var>gnutls_x509_crl_t crl</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fget_005fthis_005fupdate-343"></a></var><br>
<blockquote><p><var>crl</var>: should contain a <code>gnutls_x509_crl_t</code> structure

     <p>This function will return the time this CRL was issued.

     <p><strong>Returns:</strong> when the CRL was issued, or (time_t)-1 on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_get_version</h4>

<p><a name="gnutls_005fx509_005fcrl_005fget_005fversion"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_get_version</b> (<var>gnutls_x509_crl_t crl</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fget_005fversion-344"></a></var><br>
<blockquote><p><var>crl</var>: should contain a <code>gnutls_x509_crl_t</code> structure

     <p>This function will return the version of the specified CRL.

     <p><strong>Returns:</strong> The version number, or a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_import</h4>

<p><a name="gnutls_005fx509_005fcrl_005fimport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_import</b> (<var>gnutls_x509_crl_t crl, const gnutls_datum_t * data, gnutls_x509_crt_fmt_t format</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fimport-345"></a></var><br>
<blockquote><p><var>crl</var>: The structure to store the parsed CRL.

     <p><var>data</var>: The DER or PEM encoded CRL.

     <p><var>format</var>: One of DER or PEM

     <p>This function will convert the given DER or PEM encoded CRL
to the native <code>gnutls_x509_crl_t</code> format. The output will be stored in 'crl'.

     <p>If the CRL is PEM encoded it should have a header of "X509 CRL".

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_init</h4>

<p><a name="gnutls_005fx509_005fcrl_005finit"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_init</b> (<var>gnutls_x509_crl_t * crl</var>)<var><a name="index-gnutls_005fx509_005fcrl_005finit-346"></a></var><br>
<blockquote><p><var>crl</var>: The structure to be initialized

     <p>This function will initialize a CRL structure. CRL stands for
Certificate Revocation List. A revocation list usually contains
lists of certificate serial numbers that have been revoked by an
Authority. The revocation lists are always signed with the
authority's private key.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_print</h4>

<p><a name="gnutls_005fx509_005fcrl_005fprint"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_print</b> (<var>gnutls_x509_crl_t crl, gnutls_certificate_print_formats_t format, gnutls_datum_t * out</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fprint-347"></a></var><br>
<blockquote><p><var>crl</var>: The structure to be printed

     <p><var>format</var>: Indicate the format to use

     <p><var>out</var>: Newly allocated datum with zero terminated string.

     <p>This function will pretty print a X.509 certificate revocation
list, suitable for display to a human.

     <p>The output <code>out</code> needs to be deallocate using <code>gnutls_free()</code>.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_set_crt_serial</h4>

<p><a name="gnutls_005fx509_005fcrl_005fset_005fcrt_005fserial"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_set_crt_serial</b> (<var>gnutls_x509_crl_t crl, const void * serial, size_t serial_size, time_t revocation_time</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fset_005fcrt_005fserial-348"></a></var><br>
<blockquote><p><var>crl</var>: should contain a gnutls_x509_crl_t structure

     <p><var>serial</var>: The revoked certificate's serial number

     <p><var>serial_size</var>: Holds the size of the serial field.

     <p><var>revocation_time</var>: The time this certificate was revoked

     <p>This function will set a revoked certificate's serial number to the CRL.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_set_crt</h4>

<p><a name="gnutls_005fx509_005fcrl_005fset_005fcrt"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_set_crt</b> (<var>gnutls_x509_crl_t crl, gnutls_x509_crt_t crt, time_t revocation_time</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fset_005fcrt-349"></a></var><br>
<blockquote><p><var>crl</var>: should contain a gnutls_x509_crl_t structure

     <p><var>crt</var>: a certificate of type <code>gnutls_x509_crt_t</code> with the revoked certificate

     <p><var>revocation_time</var>: The time this certificate was revoked

     <p>This function will set a revoked certificate's serial number to the CRL.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_set_next_update</h4>

<p><a name="gnutls_005fx509_005fcrl_005fset_005fnext_005fupdate"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_set_next_update</b> (<var>gnutls_x509_crl_t crl, time_t exp_time</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fset_005fnext_005fupdate-350"></a></var><br>
<blockquote><p><var>crl</var>: should contain a gnutls_x509_crl_t structure

     <p><var>exp_time</var>: The actual time

     <p>This function will set the time this CRL will be updated.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_set_this_update</h4>

<p><a name="gnutls_005fx509_005fcrl_005fset_005fthis_005fupdate"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_set_this_update</b> (<var>gnutls_x509_crl_t crl, time_t act_time</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fset_005fthis_005fupdate-351"></a></var><br>
<blockquote><p><var>crl</var>: should contain a gnutls_x509_crl_t structure

     <p><var>act_time</var>: The actual time

     <p>This function will set the time this CRL was issued.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_set_version</h4>

<p><a name="gnutls_005fx509_005fcrl_005fset_005fversion"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_set_version</b> (<var>gnutls_x509_crl_t crl, unsigned int version</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fset_005fversion-352"></a></var><br>
<blockquote><p><var>crl</var>: should contain a gnutls_x509_crl_t structure

     <p><var>version</var>: holds the version number. For CRLv1 crls must be 1.

     <p>This function will set the version of the CRL. This
must be one for CRL version 1, and so on. The CRLs generated
by gnutls should have a version number of 2.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_sign2</h4>

<p><a name="gnutls_005fx509_005fcrl_005fsign2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_sign2</b> (<var>gnutls_x509_crl_t crl, gnutls_x509_crt_t issuer, gnutls_x509_privkey_t issuer_key, gnutls_digest_algorithm_t dig, unsigned int flags</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fsign2-353"></a></var><br>
<blockquote><p><var>crl</var>: should contain a gnutls_x509_crl_t structure

     <p><var>issuer</var>: is the certificate of the certificate issuer

     <p><var>issuer_key</var>: holds the issuer's private key

     <p><var>dig</var>: The message digest to use. GNUTLS_DIG_SHA1 is the safe choice unless you know what you're doing.

     <p><var>flags</var>: must be 0

     <p>This function will sign the CRL with the issuer's private key, and
will copy the issuer's information into the CRL.

     <p>This must be the last step in a certificate CRL since all
the previously set parameters are now signed.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_sign</h4>

<p><a name="gnutls_005fx509_005fcrl_005fsign"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_sign</b> (<var>gnutls_x509_crl_t crl, gnutls_x509_crt_t issuer, gnutls_x509_privkey_t issuer_key</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fsign-354"></a></var><br>
<blockquote><p><var>crl</var>: should contain a gnutls_x509_crl_t structure

     <p><var>issuer</var>: is the certificate of the certificate issuer

     <p><var>issuer_key</var>: holds the issuer's private key

     <p>This function is the same a <code>gnutls_x509_crl_sign2()</code> with no flags, and
SHA1 as the hash algorithm.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crl_verify</h4>

<p><a name="gnutls_005fx509_005fcrl_005fverify"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crl_verify</b> (<var>gnutls_x509_crl_t crl, const gnutls_x509_crt_t * CA_list, int CA_list_length, unsigned int flags, unsigned int * verify</var>)<var><a name="index-gnutls_005fx509_005fcrl_005fverify-355"></a></var><br>
<blockquote><p><var>crl</var>: is the crl to be verified

     <p><var>CA_list</var>: is a certificate list that is considered to be trusted one

     <p><var>CA_list_length</var>: holds the number of CA certificates in CA_list

     <p><var>flags</var>: Flags that may be used to change the verification algorithm. Use OR of the gnutls_certificate_verify_flags enumerations.

     <p><var>verify</var>: will hold the crl verification output.

     <p>This function will try to verify the given crl and return its status. 
See <code>gnutls_x509_crt_list_verify()</code> for a detailed description of
return values.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.and a negative value in case of an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_deinit</h4>

<p><a name="gnutls_005fx509_005fcrq_005fdeinit"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_x509_crq_deinit</b> (<var>gnutls_x509_crq_t crq</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fdeinit-356"></a></var><br>
<blockquote><p><var>crq</var>: The structure to be initialized

     <p>This function will deinitialize a CRL structure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_export</h4>

<p><a name="gnutls_005fx509_005fcrq_005fexport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_export</b> (<var>gnutls_x509_crq_t crq, gnutls_x509_crt_fmt_t format, void * output_data, size_t * output_data_size</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fexport-357"></a></var><br>
<blockquote><p><var>crq</var>: Holds the request

     <p><var>format</var>: the format of output params. One of PEM or DER.

     <p><var>output_data</var>: will contain a certificate request PEM or DER encoded

     <p><var>output_data_size</var>: holds the size of output_data (and will be
replaced by the actual size of parameters)

     <p>This function will export the certificate request to a PKCS10

     <p>If the buffer provided is not long enough to hold the output, then
GNUTLS_E_SHORT_MEMORY_BUFFER will be returned and
*output_data_size will be updated.

     <p>If the structure is PEM encoded, it will have a header of "BEGIN
NEW CERTIFICATE REQUEST".

     <p><strong>Return value:</strong> In case of failure a negative value will be
returned, and 0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_get_attribute_by_oid</h4>

<p><a name="gnutls_005fx509_005fcrq_005fget_005fattribute_005fby_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_get_attribute_by_oid</b> (<var>gnutls_x509_crq_t crq, const char * oid, int indx, void * buf, size_t * sizeof_buf</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fget_005fattribute_005fby_005foid-358"></a></var><br>
<blockquote><p><var>crq</var>: should contain a gnutls_x509_crq_t structure

     <p><var>oid</var>: holds an Object Identified in null terminated string

     <p><var>indx</var>: In case multiple same OIDs exist in the attribute list, this specifies
which to send. Use zero to get the first one.

     <p><var>buf</var>: a pointer to a structure to hold the attribute data (may be null)

     <p><var>sizeof_buf</var>: initially holds the size of <code>buf</code>

     <p>This function will return the attribute in the certificate request specified
by the given Object ID. The attribute will be DER encoded.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_get_challenge_password</h4>

<p><a name="gnutls_005fx509_005fcrq_005fget_005fchallenge_005fpassword"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_get_challenge_password</b> (<var>gnutls_x509_crq_t crq, char * pass, size_t * sizeof_pass</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fget_005fchallenge_005fpassword-359"></a></var><br>
<blockquote><p><var>crq</var>: should contain a gnutls_x509_crq_t structure

     <p><var>pass</var>: will hold a null terminated password

     <p><var>sizeof_pass</var>: Initially holds the size of <code>pass</code>.

     <p>This function will return the challenge password in the
request.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_get_dn_by_oid</h4>

<p><a name="gnutls_005fx509_005fcrq_005fget_005fdn_005fby_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_get_dn_by_oid</b> (<var>gnutls_x509_crq_t crq, const char * oid, int indx, unsigned int raw_flag, void * buf, size_t * sizeof_buf</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fget_005fdn_005fby_005foid-360"></a></var><br>
<blockquote><p><var>crq</var>: should contain a gnutls_x509_crq_t structure

     <p><var>oid</var>: holds an Object Identified in null terminated string

     <p><var>indx</var>: In case multiple same OIDs exist in the RDN, this specifies
which to send. Use zero to get the first one.

     <p><var>raw_flag</var>: If non zero returns the raw DER data of the DN part.

     <p><var>buf</var>: a pointer to a structure to hold the name (may be null)

     <p><var>sizeof_buf</var>: initially holds the size of <code>buf</code>

     <p>This function will extract the part of the name of the Certificate
request subject, specified by the given OID. The output will be
encoded as described in RFC2253. The output string will be ASCII
or UTF-8 encoded, depending on the certificate data.

     <p>Some helper macros with popular OIDs can be found in gnutls/x509.h
If raw flag is zero, this function will only return known OIDs as
text. Other OIDs will be DER encoded, as described in RFC2253 &ndash;
in hex format with a '\#' prefix.  You can check about known OIDs
using <code>gnutls_x509_dn_oid_known()</code>.

     <p>If <code>buf</code> is null then only the size will be filled.

     <p><strong>Returns:</strong> GNUTLS_E_SHORT_MEMORY_BUFFER if the provided buffer is not
long enough, and in that case the *sizeof_buf will be updated with
the required size.  On success 0 is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_get_dn_oid</h4>

<p><a name="gnutls_005fx509_005fcrq_005fget_005fdn_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_get_dn_oid</b> (<var>gnutls_x509_crq_t crq, int indx, void * oid, size_t * sizeof_oid</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fget_005fdn_005foid-361"></a></var><br>
<blockquote><p><var>crq</var>: should contain a gnutls_x509_crq_t structure

     <p><var>indx</var>: Specifies which DN OID to send. Use zero to get the first one.

     <p><var>oid</var>: a pointer to a structure to hold the name (may be null)

     <p><var>sizeof_oid</var>: initially holds the size of <code>oid</code>

     <p>This function will extract the requested OID of the name of the
Certificate request subject, specified by the given index.

     <p>If oid is null then only the size will be filled.

     <p><strong>Returns:</strong> GNUTLS_E_SHORT_MEMORY_BUFFER if the provided buffer is not
long enough, and in that case the *sizeof_oid will be updated with
the required size.  On success 0 is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_get_dn</h4>

<p><a name="gnutls_005fx509_005fcrq_005fget_005fdn"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_get_dn</b> (<var>gnutls_x509_crq_t crq, char * buf, size_t * sizeof_buf</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fget_005fdn-362"></a></var><br>
<blockquote><p><var>crq</var>: should contain a gnutls_x509_crq_t structure

     <p><var>buf</var>: a pointer to a structure to hold the name (may be null)

     <p><var>sizeof_buf</var>: initially holds the size of <code>buf</code>

     <p>This function will copy the name of the Certificate request
subject in the provided buffer. The name will be in the form
"C=xxxx,O=yyyy,CN=zzzz" as described in RFC2253. The output string
will be ASCII or UTF-8 encoded, depending on the certificate data.

     <p>If <code>buf</code> is null then only the size will be filled.

     <p><strong>Returns:</strong> GNUTLS_E_SHORT_MEMORY_BUFFER if the provided buffer is not
long enough, and in that case the *sizeof_buf will be updated with
the required size.  On success 0 is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_get_pk_algorithm</h4>

<p><a name="gnutls_005fx509_005fcrq_005fget_005fpk_005falgorithm"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_get_pk_algorithm</b> (<var>gnutls_x509_crq_t crq, unsigned int * bits</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fget_005fpk_005falgorithm-363"></a></var><br>
<blockquote><p><var>crq</var>: should contain a gnutls_x509_crq_t structure

     <p><var>bits</var>: if bits is non null it will hold the size of the parameters' in bits

     <p>This function will return the public key algorithm of a PKCS \<code>10</code>
certificate request.

     <p>If bits is non null, it should have enough size to hold the parameters
size in bits. For RSA the bits returned is the modulus. 
For DSA the bits returned are of the public
exponent.

     <p><strong>Returns:</strong> a member of the <code>gnutls_pk_algorithm_t</code> enumeration on
success, or a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_get_version</h4>

<p><a name="gnutls_005fx509_005fcrq_005fget_005fversion"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_get_version</b> (<var>gnutls_x509_crq_t crq</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fget_005fversion-364"></a></var><br>
<blockquote><p><var>crq</var>: should contain a gnutls_x509_crq_t structure

     <p>This function will return the version of the specified Certificate request.

     <p><strong>Returns:</strong> version of certificate request, or a negative value on
error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_import</h4>

<p><a name="gnutls_005fx509_005fcrq_005fimport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_import</b> (<var>gnutls_x509_crq_t crq, const gnutls_datum_t * data, gnutls_x509_crt_fmt_t format</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fimport-365"></a></var><br>
<blockquote><p><var>crq</var>: The structure to store the parsed certificate request.

     <p><var>data</var>: The DER or PEM encoded certificate.

     <p><var>format</var>: One of DER or PEM

     <p>This function will convert the given DER or PEM encoded Certificate
to the native gnutls_x509_crq_t format. The output will be stored in <code>cert</code>.

     <p>If the Certificate is PEM encoded it should have a header of "NEW CERTIFICATE REQUEST".

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_init</h4>

<p><a name="gnutls_005fx509_005fcrq_005finit"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_init</b> (<var>gnutls_x509_crq_t * crq</var>)<var><a name="index-gnutls_005fx509_005fcrq_005finit-366"></a></var><br>
<blockquote><p><var>crq</var>: The structure to be initialized

     <p>This function will initialize a PKCS10 certificate request structure.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_set_attribute_by_oid</h4>

<p><a name="gnutls_005fx509_005fcrq_005fset_005fattribute_005fby_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_set_attribute_by_oid</b> (<var>gnutls_x509_crq_t crq, const char * oid, void * buf, size_t sizeof_buf</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fset_005fattribute_005fby_005foid-367"></a></var><br>
<blockquote><p><var>crq</var>: should contain a gnutls_x509_crq_t structure

     <p><var>oid</var>: holds an Object Identified in null terminated string

     <p><var>buf</var>: a pointer to a structure that holds the attribute data

     <p><var>sizeof_buf</var>: holds the size of <code>buf</code>

     <p>This function will set the attribute in the certificate request specified
by the given Object ID. The attribute must be be DER encoded.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_set_challenge_password</h4>

<p><a name="gnutls_005fx509_005fcrq_005fset_005fchallenge_005fpassword"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_set_challenge_password</b> (<var>gnutls_x509_crq_t crq, const char * pass</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fset_005fchallenge_005fpassword-368"></a></var><br>
<blockquote><p><var>crq</var>: should contain a gnutls_x509_crq_t structure

     <p><var>pass</var>: holds a null terminated password

     <p>This function will set a challenge password to be used when revoking the request.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_set_dn_by_oid</h4>

<p><a name="gnutls_005fx509_005fcrq_005fset_005fdn_005fby_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_set_dn_by_oid</b> (<var>gnutls_x509_crq_t crq, const char * oid, unsigned int raw_flag, const void * data, unsigned int sizeof_data</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fset_005fdn_005fby_005foid-369"></a></var><br>
<blockquote><p><var>crq</var>: should contain a gnutls_x509_crq_t structure

     <p><var>oid</var>: holds an Object Identifier in a null terminated string

     <p><var>raw_flag</var>: must be 0, or 1 if the data are DER encoded

     <p><var>data</var>: a pointer to the input data

     <p><var>sizeof_data</var>: holds the size of <code>data</code>

     <p>This function will set the part of the name of the Certificate request subject, specified
by the given OID. The input string should be ASCII or UTF-8 encoded.

     <p>Some helper macros with popular OIDs can be found in gnutls/x509.h
With this function you can only set the known OIDs. You can test
for known OIDs using <code>gnutls_x509_dn_oid_known()</code>. For OIDs that are
not known (by gnutls) you should properly DER encode your data, and
call this function with raw_flag set.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_set_key_rsa_raw</h4>

<p><a name="gnutls_005fx509_005fcrq_005fset_005fkey_005frsa_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_set_key_rsa_raw</b> (<var>gnutls_x509_crq_t crq, const gnutls_datum_t * m, const gnutls_datum_t * e</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fset_005fkey_005frsa_005fraw-370"></a></var><br>
<blockquote><p><var>crq</var>: should contain a <code>gnutls_x509_crq_t</code> structure

     <p><var>m</var>: holds the modulus

     <p><var>e</var>: holds the public exponent

     <p>This function will set the public parameters from the given private
key to the request. Only RSA keys are currently supported.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_set_key</h4>

<p><a name="gnutls_005fx509_005fcrq_005fset_005fkey"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_set_key</b> (<var>gnutls_x509_crq_t crq, gnutls_x509_privkey_t key</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fset_005fkey-371"></a></var><br>
<blockquote><p><var>crq</var>: should contain a gnutls_x509_crq_t structure

     <p><var>key</var>: holds a private key

     <p>This function will set the public parameters from the given private key to the
request. Only RSA keys are currently supported.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_set_version</h4>

<p><a name="gnutls_005fx509_005fcrq_005fset_005fversion"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_set_version</b> (<var>gnutls_x509_crq_t crq, unsigned int version</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fset_005fversion-372"></a></var><br>
<blockquote><p><var>crq</var>: should contain a gnutls_x509_crq_t structure

     <p><var>version</var>: holds the version number. For v1 Requests must be 1.

     <p>This function will set the version of the certificate request. For
version 1 requests this must be one.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_sign2</h4>

<p><a name="gnutls_005fx509_005fcrq_005fsign2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_sign2</b> (<var>gnutls_x509_crq_t crq, gnutls_x509_privkey_t key, gnutls_digest_algorithm_t dig, unsigned int flags</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fsign2-373"></a></var><br>
<blockquote><p><var>crq</var>: should contain a <code>gnutls_x509_crq_t</code> structure

     <p><var>key</var>: holds a private key

     <p><var>dig</var>: The message digest to use, <code>GNUTLS_DIG_SHA1</code> is the safe choice unless you know what you're doing.

     <p><var>flags</var>: must be 0

     <p>This function will sign the certificate request with a private key. 
This must be the same key as the one used in
<code>gnutls_x509_crt_set_key()</code> since a certificate request is self
signed.

     <p>This must be the last step in a certificate request generation
since all the previously set parameters are now signed.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error. 
<code>GNUTLS_E_ASN1_VALUE_NOT_FOUND</code> is returned if you didn't set all
information in the certificate request (e.g., the version using
<code>gnutls_x509_crq_set_version()</code>). 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crq_sign</h4>

<p><a name="gnutls_005fx509_005fcrq_005fsign"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crq_sign</b> (<var>gnutls_x509_crq_t crq, gnutls_x509_privkey_t key</var>)<var><a name="index-gnutls_005fx509_005fcrq_005fsign-374"></a></var><br>
<blockquote><p><var>crq</var>: should contain a gnutls_x509_crq_t structure

     <p><var>key</var>: holds a private key

     <p>This function is the same a <code>gnutls_x509_crq_sign2()</code> with no flags, and
SHA1 as the hash algorithm.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_check_hostname</h4>

<p><a name="gnutls_005fx509_005fcrt_005fcheck_005fhostname"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_check_hostname</b> (<var>gnutls_x509_crt_t cert, const char * hostname</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fcheck_005fhostname-375"></a></var><br>
<blockquote><p><var>cert</var>: should contain an gnutls_x509_crt_t structure

     <p><var>hostname</var>: A null terminated string that contains a DNS name

     <p>This function will check if the given certificate's subject matches
the given hostname.  This is a basic implementation of the matching
described in RFC2818 (HTTPS), which takes into account wildcards,
and the DNSName/IPAddress subject alternative name PKIX extension.

     <p><strong>Returns:</strong> non zero for a successful match, and zero on failure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_check_issuer</h4>

<p><a name="gnutls_005fx509_005fcrt_005fcheck_005fissuer"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_check_issuer</b> (<var>gnutls_x509_crt_t cert, gnutls_x509_crt_t issuer</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fcheck_005fissuer-376"></a></var><br>
<blockquote><p><var>cert</var>: is the certificate to be checked

     <p><var>issuer</var>: is the certificate of a possible issuer

     <p>This function will check if the given certificate was issued by the
given issuer. It will return true (1) if the given certificate is issued
by the given issuer, and false (0) if not.

     <p>A negative value is returned in case of an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_check_revocation</h4>

<p><a name="gnutls_005fx509_005fcrt_005fcheck_005frevocation"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_check_revocation</b> (<var>gnutls_x509_crt_t cert, const gnutls_x509_crl_t * crl_list, int crl_list_length</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fcheck_005frevocation-377"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>crl_list</var>: should contain a list of gnutls_x509_crl_t structures

     <p><var>crl_list_length</var>: the length of the crl_list

     <p>This function will return check if the given certificate is
revoked.  It is assumed that the CRLs have been verified before.

     <p><strong>Returns:</strong> 0 if the certificate is NOT revoked, and 1 if it is.  A
negative value is returned on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_cpy_crl_dist_points</h4>

<p><a name="gnutls_005fx509_005fcrt_005fcpy_005fcrl_005fdist_005fpoints"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_cpy_crl_dist_points</b> (<var>gnutls_x509_crt_t dst, gnutls_x509_crt_t src</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fcpy_005fcrl_005fdist_005fpoints-378"></a></var><br>
<blockquote><p><var>dst</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>src</var>: the certificate where the dist points will be copied from

     <p>This function will copy the CRL distribution points certificate
extension, from the source to the destination certificate. 
This may be useful to copy from a CA certificate to issued ones.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_deinit</h4>

<p><a name="gnutls_005fx509_005fcrt_005fdeinit"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_x509_crt_deinit</b> (<var>gnutls_x509_crt_t cert</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fdeinit-379"></a></var><br>
<blockquote><p><var>cert</var>: The structure to be initialized

     <p>This function will deinitialize a CRL structure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_export</h4>

<p><a name="gnutls_005fx509_005fcrt_005fexport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_export</b> (<var>gnutls_x509_crt_t cert, gnutls_x509_crt_fmt_t format, void * output_data, size_t * output_data_size</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fexport-380"></a></var><br>
<blockquote><p><var>cert</var>: Holds the certificate

     <p><var>format</var>: the format of output params. One of PEM or DER.

     <p><var>output_data</var>: will contain a certificate PEM or DER encoded

     <p><var>output_data_size</var>: holds the size of output_data (and will be
replaced by the actual size of parameters)

     <p>This function will export the certificate to DER or PEM format.

     <p>If the buffer provided is not long enough to hold the output, then
*output_data_size is updated and GNUTLS_E_SHORT_MEMORY_BUFFER will
be returned.

     <p>If the structure is PEM encoded, it will have a header
of "BEGIN CERTIFICATE".

     <p><strong>Return value:</strong> In case of failure a negative value will be
returned, and 0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_activation_time</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005factivation_005ftime"></a>

<div class="defun">
&mdash; Function: time_t <b>gnutls_x509_crt_get_activation_time</b> (<var>gnutls_x509_crt_t cert</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005factivation_005ftime-381"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p>This function will return the time this Certificate was or will be
activated.

     <p><strong>Returns:</strong> activation time, or (time_t)-1 on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_authority_key_id</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fauthority_005fkey_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_authority_key_id</b> (<var>gnutls_x509_crt_t cert, void * ret, size_t * ret_size, unsigned int * critical</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fauthority_005fkey_005fid-382"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>critical</var>: will be non zero if the extension is marked as critical (may be null)

     <p>This function will return the X.509v3 certificate authority's key identifier. 
This is obtained by the X.509 Authority Key identifier extension
field (2.5.29.35). Note that this function only returns the keyIdentifier
field of the extension.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.and a negative value in case of an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_basic_constraints</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fbasic_005fconstraints"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_basic_constraints</b> (<var>gnutls_x509_crt_t cert, unsigned int * critical, int * ca, int * pathlen</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fbasic_005fconstraints-383"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>critical</var>: will be non zero if the extension is marked as critical

     <p><var>ca</var>: pointer to output integer indicating CA status, may be NULL,
value is 1 if the certificate CA flag is set, 0 otherwise.

     <p><var>pathlen</var>: pointer to output integer indicating path length (may be
NULL), non-negative values indicate a present pathLenConstraint
field and the actual value, -1 indicate that the field is absent.

     <p>This function will read the certificate's basic constraints, and
return the certificates CA status.  It reads the basicConstraints
X.509 extension (2.5.29.19).

     <p><strong>Return value:</strong> If the certificate is a CA a positive value will be
returned, or zero if the certificate does not have CA flag set.  A
negative value may be returned in case of errors.  If the
certificate does not contain the basicConstraints extension
GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE will be returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_ca_status</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fca_005fstatus"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_ca_status</b> (<var>gnutls_x509_crt_t cert, unsigned int * critical</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fca_005fstatus-384"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>critical</var>: will be non zero if the extension is marked as critical

     <p>This function will return certificates CA status, by reading the
basicConstraints X.509 extension (2.5.29.19). If the certificate is
a CA a positive value will be returned, or zero if the certificate
does not have CA flag set.

     <p>Use <code>gnutls_x509_crt_get_basic_constraints()</code> if you want to read the
pathLenConstraint field too.

     <p>A negative value may be returned in case of parsing error. 
If the certificate does not contain the basicConstraints extension
GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE will be returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_crl_dist_points</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fcrl_005fdist_005fpoints"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_crl_dist_points</b> (<var>gnutls_x509_crt_t cert, unsigned int seq, void * ret, size_t * ret_size, unsigned int * reason_flags, unsigned int * critical</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fcrl_005fdist_005fpoints-385"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>seq</var>: specifies the sequence number of the distribution point (0 for the first one, 1 for the second etc.)

     <p><var>ret</var>: is the place where the distribution point will be copied to

     <p><var>ret_size</var>: holds the size of ret.

     <p><var>reason_flags</var>: Revocation reasons flags.

     <p><var>critical</var>: will be non zero if the extension is marked as critical (may be null)

     <p>This function will return the CRL distribution points (2.5.29.31),
contained in the given certificate.

     <p><code>reason_flags</code> should be an ORed sequence of
GNUTLS_CRL_REASON_UNUSED, GNUTLS_CRL_REASON_KEY_COMPROMISE,
GNUTLS_CRL_REASON_CA_COMPROMISE,
GNUTLS_CRL_REASON_AFFILIATION_CHANGED,
GNUTLS_CRL_REASON_SUPERSEEDED,
GNUTLS_CRL_REASON_CESSATION_OF_OPERATION,
GNUTLS_CRL_REASON_CERTIFICATE_HOLD,
GNUTLS_CRL_REASON_PRIVILEGE_WITHDRAWN,
GNUTLS_CRL_REASON_AA_COMPROMISE, or zero for all possible reasons.

     <p>This is specified in X509v3 Certificate Extensions. GNUTLS will
return the distribution point type, or a negative error code on
error.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> and updates &amp;<code>ret_size</code> if
&amp;<code>ret_size</code> is not enough to hold the distribution point, or the
type of the distribution point if everything was ok. The type is
one of the enumerated <code>gnutls_x509_subject_alt_name_t</code>.  If the
certificate does not have an Alternative name with the specified
sequence number then <code>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</code> is
returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_dn_by_oid</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fdn_005fby_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_dn_by_oid</b> (<var>gnutls_x509_crt_t cert, const char * oid, int indx, unsigned int raw_flag, void * buf, size_t * sizeof_buf</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fdn_005fby_005foid-386"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>oid</var>: holds an Object Identified in null terminated string

     <p><var>indx</var>: In case multiple same OIDs exist in the RDN, this specifies which to send. Use zero to get the first one.

     <p><var>raw_flag</var>: If non zero returns the raw DER data of the DN part.

     <p><var>buf</var>: a pointer where the DN part will be copied (may be null).

     <p><var>sizeof_buf</var>: initially holds the size of <code>buf</code>

     <p>This function will extract the part of the name of the Certificate
subject specified by the given OID. The output, if the raw flag is not
used, will be encoded as described in RFC2253. Thus a string that is
ASCII or UTF-8 encoded, depending on the certificate data.

     <p>Some helper macros with popular OIDs can be found in gnutls/x509.h
If raw flag is zero, this function will only return known OIDs as
text. Other OIDs will be DER encoded, as described in RFC2253 &ndash;
in hex format with a '\#' prefix.  You can check about known OIDs
using <code>gnutls_x509_dn_oid_known()</code>.

     <p>If <code>buf</code> is null then only the size will be filled.

     <p><strong>Returns:</strong> GNUTLS_E_SHORT_MEMORY_BUFFER if the provided buffer is not
long enough, and in that case the *sizeof_buf will be updated with
the required size.  On success 0 is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_dn_oid</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fdn_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_dn_oid</b> (<var>gnutls_x509_crt_t cert, int indx, void * oid, size_t * sizeof_oid</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fdn_005foid-387"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>indx</var>: This specifies which OID to return. Use zero to get the first one.

     <p><var>oid</var>: a pointer to a buffer to hold the OID (may be null)

     <p><var>sizeof_oid</var>: initially holds the size of <code>oid</code>

     <p>This function will extract the OIDs of the name of the Certificate
subject specified by the given index.

     <p>If oid is null then only the size will be filled.

     <p><strong>Returns:</strong> GNUTLS_E_SHORT_MEMORY_BUFFER if the provided buffer is not
long enough, and in that case the *sizeof_oid will be updated with
the required size.  On success 0 is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_dn</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fdn"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_dn</b> (<var>gnutls_x509_crt_t cert, char * buf, size_t * sizeof_buf</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fdn-388"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>buf</var>: a pointer to a structure to hold the name (may be null)

     <p><var>sizeof_buf</var>: initially holds the size of <code>buf</code>

     <p>This function will copy the name of the Certificate in the
provided buffer. The name will be in the form
"C=xxxx,O=yyyy,CN=zzzz" as described in RFC2253. The output string
will be ASCII or UTF-8 encoded, depending on the certificate data.

     <p>If <code>buf</code> is null then only the size will be filled.

     <p><strong>Returns:</strong> GNUTLS_E_SHORT_MEMORY_BUFFER if the provided buffer is not
long enough, and in that case the *sizeof_buf will be updated with
the required size.  On success 0 is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_expiration_time</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fexpiration_005ftime"></a>

<div class="defun">
&mdash; Function: time_t <b>gnutls_x509_crt_get_expiration_time</b> (<var>gnutls_x509_crt_t cert</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fexpiration_005ftime-389"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p>This function will return the time this Certificate was or will be
expired.

     <p><strong>Returns:</strong> expiration time, or (time_t)-1 on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_extension_by_oid</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fextension_005fby_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_extension_by_oid</b> (<var>gnutls_x509_crt_t cert, const char * oid, int indx, void * buf, size_t * sizeof_buf, unsigned int * critical</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fextension_005fby_005foid-390"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>oid</var>: holds an Object Identified in null terminated string

     <p><var>indx</var>: In case multiple same OIDs exist in the extensions, this specifies which to send. Use zero to get the first one.

     <p><var>buf</var>: a pointer to a structure to hold the name (may be null)

     <p><var>sizeof_buf</var>: initially holds the size of <code>buf</code>

     <p><var>critical</var>: will be non zero if the extension is marked as critical

     <p>This function will return the extension specified by the OID in the certificate. 
The extensions will be returned as binary data DER encoded, in the provided
buffer.

     <p>A negative value may be returned in case of parsing error. 
If the certificate does not contain the specified extension
GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE will be returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_extension_data</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fextension_005fdata"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_extension_data</b> (<var>gnutls_x509_crt_t cert, int indx, void * data, size_t * sizeof_data</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fextension_005fdata-391"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>indx</var>: Specifies which extension OID to send. Use zero to get the first one.

     <p><var>data</var>: a pointer to a structure to hold the data (may be null)

     <p><var>sizeof_data</var>: initially holds the size of <code>oid</code>

     <p>This function will return the requested extension data in the
certificate.  The extension data will be stored as a string in the
provided buffer.

     <p>Use <code>gnutls_x509_crt_get_extension_info()</code> to extract the OID and
critical flag.  Use <code>gnutls_x509_crt_get_extension_by_oid()</code> instead,
if you want to get data indexed by the extension OID rather than
sequence.

     <p>Return 0 on success.  A negative value may be returned in case of
parsing error.  If you have reached the last extension available
GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE will be returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_extension_info</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fextension_005finfo"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_extension_info</b> (<var>gnutls_x509_crt_t cert, int indx, void * oid, size_t * sizeof_oid, int * critical</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fextension_005finfo-392"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>indx</var>: Specifies which extension OID to send. Use zero to get the first one.

     <p><var>oid</var>: a pointer to a structure to hold the OID

     <p><var>sizeof_oid</var>: initially holds the maximum size of <code>oid</code>, on return
holds actual size of <code>oid</code>.

     <p><var>critical</var>: output variable with critical flag, may be NULL.

     <p>This function will return the requested extension OID in the
certificate, and the critical flag for it.  The extension OID will
be stored as a string in the provided buffer.  Use
<code>gnutls_x509_crt_get_extension_data()</code> to extract the data.

     <p>If the buffer provided is not long enough to hold the output, then
*<code>sizeof_oid</code> is updated and <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> will be
returned.

     <p>Return 0 on success.  A negative value may be returned in case of
parsing error.  If you have reached the last extension available
GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE will be returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_extension_oid</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fextension_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_extension_oid</b> (<var>gnutls_x509_crt_t cert, int indx, void * oid, size_t * sizeof_oid</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fextension_005foid-393"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>indx</var>: Specifies which extension OID to send. Use zero to get the first one.

     <p><var>oid</var>: a pointer to a structure to hold the OID (may be null)

     <p><var>sizeof_oid</var>: initially holds the size of <code>oid</code>

     <p>This function will return the requested extension OID in the certificate. 
The extension OID will be stored as a string in the provided buffer.

     <p>A negative value may be returned in case of parsing error. 
If your have reached the last extension available
GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE will be returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_fingerprint</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005ffingerprint"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_fingerprint</b> (<var>gnutls_x509_crt_t cert, gnutls_digest_algorithm_t algo, void * buf, size_t * sizeof_buf</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005ffingerprint-394"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>algo</var>: is a digest algorithm

     <p><var>buf</var>: a pointer to a structure to hold the fingerprint (may be null)

     <p><var>sizeof_buf</var>: initially holds the size of <code>buf</code>

     <p>This function will calculate and copy the certificate's fingerprint
in the provided buffer.

     <p>If the buffer is null then only the size will be filled.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> if the provided buffer is
not long enough, and in that case the *sizeof_buf will be updated
with the required size.  On success 0 is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_issuer_dn_by_oid</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fissuer_005fdn_005fby_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_issuer_dn_by_oid</b> (<var>gnutls_x509_crt_t cert, const char * oid, int indx, unsigned int raw_flag, void * buf, size_t * sizeof_buf</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fissuer_005fdn_005fby_005foid-395"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>oid</var>: holds an Object Identified in null terminated string

     <p><var>indx</var>: In case multiple same OIDs exist in the RDN, this specifies which to send. Use zero to get the first one.

     <p><var>raw_flag</var>: If non zero returns the raw DER data of the DN part.

     <p><var>buf</var>: a pointer to a structure to hold the name (may be null)

     <p><var>sizeof_buf</var>: initially holds the size of <code>buf</code>

     <p>This function will extract the part of the name of the Certificate
issuer specified by the given OID. The output, if the raw flag is not
used, will be encoded as described in RFC2253. Thus a string that is
ASCII or UTF-8 encoded, depending on the certificate data.

     <p>Some helper macros with popular OIDs can be found in gnutls/x509.h
If raw flag is zero, this function will only return known OIDs as
text. Other OIDs will be DER encoded, as described in RFC2253 &ndash;
in hex format with a '\#' prefix.  You can check about known OIDs
using <code>gnutls_x509_dn_oid_known()</code>.

     <p>If <code>buf</code> is null then only the size will be filled.

     <p><strong>Returns:</strong> GNUTLS_E_SHORT_MEMORY_BUFFER if the provided buffer is not
long enough, and in that case the *sizeof_buf will be updated with
the required size.  On success 0 is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_issuer_dn_oid</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fissuer_005fdn_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_issuer_dn_oid</b> (<var>gnutls_x509_crt_t cert, int indx, void * oid, size_t * sizeof_oid</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fissuer_005fdn_005foid-396"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>indx</var>: This specifies which OID to return. Use zero to get the first one.

     <p><var>oid</var>: a pointer to a buffer to hold the OID (may be null)

     <p><var>sizeof_oid</var>: initially holds the size of <code>oid</code>

     <p>This function will extract the OIDs of the name of the Certificate
issuer specified by the given index.

     <p>If <code>oid</code> is null then only the size will be filled.

     <p><strong>Returns:</strong> GNUTLS_E_SHORT_MEMORY_BUFFER if the provided buffer is not
long enough, and in that case the *sizeof_oid will be updated with
the required size.  On success 0 is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_issuer_dn</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fissuer_005fdn"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_issuer_dn</b> (<var>gnutls_x509_crt_t cert, char * buf, size_t * sizeof_buf</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fissuer_005fdn-397"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>buf</var>: a pointer to a structure to hold the name (may be null)

     <p><var>sizeof_buf</var>: initially holds the size of <code>buf</code>

     <p>This function will copy the name of the Certificate issuer in the
provided buffer. The name will be in the form
"C=xxxx,O=yyyy,CN=zzzz" as described in RFC2253. The output string
will be ASCII or UTF-8 encoded, depending on the certificate data.

     <p>If <code>buf</code> is null then only the size will be filled.

     <p><strong>Returns:</strong> GNUTLS_E_SHORT_MEMORY_BUFFER if the provided buffer is not
long enough, and in that case the *sizeof_buf will be updated with
the required size.  On success 0 is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_issuer</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fissuer"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_issuer</b> (<var>gnutls_x509_crt_t cert, gnutls_x509_dn_t * dn</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fissuer-398"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>dn</var>: output variable with pointer to opaque DN

     <p>Return the Certificate's Issuer DN as an opaque data type.  You may
use <code>gnutls_x509_dn_get_rdn_ava()</code> to decode the DN.

     <p>Note that <code>dn</code> should be treated as constant. Because points
into the <code>cert</code> object, you may not deallocate <code>cert</code>
and continue to access <code>dn</code>.

     <p><strong>Returns:</strong> Returns 0 on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_key_id</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fkey_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_key_id</b> (<var>gnutls_x509_crt_t crt, unsigned int flags, unsigned char * output_data, size_t * output_data_size</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fkey_005fid-399"></a></var><br>
<blockquote><p><var>crt</var>: Holds the certificate

     <p><var>flags</var>: should be 0 for now

     <p><var>output_data</var>: will contain the key ID

     <p><var>output_data_size</var>: holds the size of output_data (and will be
replaced by the actual size of parameters)

     <p>This function will return a unique ID the depends on the public
key parameters. This ID can be used in checking whether a
certificate corresponds to the given private key.

     <p>If the buffer provided is not long enough to hold the output, then
*output_data_size is updated and GNUTLS_E_SHORT_MEMORY_BUFFER will
be returned.  The output will normally be a SHA-1 hash output,
which is 20 bytes.

     <p><strong>Return value:</strong> In case of failure a negative value will be
returned, and 0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_key_purpose_oid</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fkey_005fpurpose_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_key_purpose_oid</b> (<var>gnutls_x509_crt_t cert, int indx, void * oid, size_t * sizeof_oid, unsigned int * critical</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fkey_005fpurpose_005foid-400"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>indx</var>: This specifies which OID to return. Use zero to get the first one.

     <p><var>oid</var>: a pointer to a buffer to hold the OID (may be null)

     <p><var>sizeof_oid</var>: initially holds the size of <code>oid</code>

     <p>This function will extract the key purpose OIDs of the Certificate
specified by the given index. These are stored in the Extended Key
Usage extension (2.5.29.37) See the GNUTLS_KP_* definitions for
human readable names.

     <p>If <code>oid</code> is null then only the size will be filled.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> if the provided buffer is
not long enough, and in that case the *sizeof_oid will be updated
with the required size.  On success 0 is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_key_usage</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fkey_005fusage"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_key_usage</b> (<var>gnutls_x509_crt_t cert, unsigned int * key_usage, unsigned int * critical</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fkey_005fusage-401"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>key_usage</var>: where the key usage bits will be stored

     <p><var>critical</var>: will be non zero if the extension is marked as critical

     <p>This function will return certificate's key usage, by reading the
keyUsage X.509 extension (2.5.29.15). The key usage value will

     <p><strong>ORed values of the:</strong> <code>GNUTLS_KEY_DIGITAL_SIGNATURE</code>,
<code>GNUTLS_KEY_NON_REPUDIATION</code>, <code>GNUTLS_KEY_KEY_ENCIPHERMENT</code>,
<code>GNUTLS_KEY_DATA_ENCIPHERMENT</code>, <code>GNUTLS_KEY_KEY_AGREEMENT</code>,
<code>GNUTLS_KEY_KEY_CERT_SIGN</code>, <code>GNUTLS_KEY_CRL_SIGN</code>,
<code>GNUTLS_KEY_ENCIPHER_ONLY</code>, <code>GNUTLS_KEY_DECIPHER_ONLY</code>.

     <p><strong>Returns:</strong> the certificate key usage, or a negative value in case of
parsing error.  If the certificate does not contain the keyUsage
extension <code>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</code> will be returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_pk_algorithm</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fpk_005falgorithm"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_pk_algorithm</b> (<var>gnutls_x509_crt_t cert, unsigned int * bits</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fpk_005falgorithm-402"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>bits</var>: if bits is non null it will hold the size of the parameters' in bits

     <p>This function will return the public key algorithm of an X.509
certificate.

     <p>If bits is non null, it should have enough size to hold the parameters
size in bits. For RSA the bits returned is the modulus. 
For DSA the bits returned are of the public
exponent.

     <p><strong>Returns:</strong> a member of the <code>gnutls_pk_algorithm_t</code> enumeration on
success, or a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_pk_dsa_raw</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fpk_005fdsa_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_pk_dsa_raw</b> (<var>gnutls_x509_crt_t crt, gnutls_datum_t * p, gnutls_datum_t * q, gnutls_datum_t * g, gnutls_datum_t * y</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fpk_005fdsa_005fraw-403"></a></var><br>
<blockquote><p><var>crt</var>: Holds the certificate

     <p><var>p</var>: will hold the p

     <p><var>q</var>: will hold the q

     <p><var>g</var>: will hold the g

     <p><var>y</var>: will hold the y

     <p>This function will export the DSA public key's parameters found in
the given certificate.  The new parameters will be allocated using
<code>gnutls_malloc()</code> and will be stored in the appropriate datum.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_pk_rsa_raw</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fpk_005frsa_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_pk_rsa_raw</b> (<var>gnutls_x509_crt_t crt, gnutls_datum_t * m, gnutls_datum_t * e</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fpk_005frsa_005fraw-404"></a></var><br>
<blockquote><p><var>crt</var>: Holds the certificate

     <p><var>m</var>: will hold the modulus

     <p><var>e</var>: will hold the public exponent

     <p>This function will export the RSA public key's parameters found in
the given structure.  The new parameters will be allocated using
<code>gnutls_malloc()</code> and will be stored in the appropriate datum.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_proxy</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fproxy"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_proxy</b> (<var>gnutls_x509_crt_t cert, unsigned int * critical, int * pathlen, char ** policyLanguage, char ** policy, size_t * sizeof_policy</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fproxy-405"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>critical</var>: will be non zero if the extension is marked as critical

     <p><var>pathlen</var>: pointer to output integer indicating path length (may be
NULL), non-negative values indicate a present pCPathLenConstraint
field and the actual value, -1 indicate that the field is absent.

     <p>This function will read the certificate's basic constraints, and
return the certificates CA status.  It reads the basicConstraints
X.509 extension (2.5.29.19).

     <p><strong>Return value:</strong> If the certificate is a CA a positive value will be
returned, or zero if the certificate does not have CA flag set.  A
negative value may be returned in case of errors.  If the
certificate does not contain the basicConstraints extension
GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE will be returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_raw_dn</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fraw_005fdn"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_raw_dn</b> (<var>gnutls_x509_crt_t cert, gnutls_datum_t * start</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fraw_005fdn-406"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>start</var>: will hold the starting point of the DN

     <p>This function will return a pointer to the DER encoded DN structure and
the length.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. or a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_raw_issuer_dn</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fraw_005fissuer_005fdn"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_raw_issuer_dn</b> (<var>gnutls_x509_crt_t cert, gnutls_datum_t * start</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fraw_005fissuer_005fdn-407"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>start</var>: will hold the starting point of the DN

     <p>This function will return a pointer to the DER encoded DN structure
and the length.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.or a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_serial</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fserial"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_serial</b> (<var>gnutls_x509_crt_t cert, void * result, size_t * result_size</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fserial-408"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>result</var>: The place where the serial number will be copied

     <p><var>result_size</var>: Holds the size of the result field.

     <p>This function will return the X.509 certificate's serial number. 
This is obtained by the X509 Certificate serialNumber
field. Serial is not always a 32 or 64bit number. Some CAs use
large serial numbers, thus it may be wise to handle it as something
opaque.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.and a negative value in case of an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_signature_algorithm</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fsignature_005falgorithm"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_signature_algorithm</b> (<var>gnutls_x509_crt_t cert</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fsignature_005falgorithm-409"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p>This function will return a value of the <code>gnutls_sign_algorithm_t</code>
enumeration that is the signature algorithm.

     <p><strong>Returns:</strong> a <code>gnutls_sign_algorithm_t</code> value, or a negative value on
error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_signature</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fsignature"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_signature</b> (<var>gnutls_x509_crt_t cert, char * sig, size_t * sizeof_sig</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fsignature-410"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>sig</var>: a pointer where the signature part will be copied (may be null).

     <p><var>sizeof_sig</var>: initially holds the size of <code>sig</code>

     <p>This function will extract the signature field of a certificate.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. and a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_subject_alt_name2</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fsubject_005falt_005fname2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_subject_alt_name2</b> (<var>gnutls_x509_crt_t cert, unsigned int seq, void * ret, size_t * ret_size, unsigned int * ret_type, unsigned int * critical</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fsubject_005falt_005fname2-411"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>seq</var>: specifies the sequence number of the alt name (0 for the first one, 1 for the second etc.)

     <p><var>ret</var>: is the place where the alternative name will be copied to

     <p><var>ret_size</var>: holds the size of ret.

     <p><var>ret_type</var>: holds the type of the alternative name (one of gnutls_x509_subject_alt_name_t).

     <p><var>critical</var>: will be non zero if the extension is marked as critical (may be null)

     <p>This function will return the alternative names, contained in the
given certificate. It is the same as <code>gnutls_x509_crt_get_subject_alt_name()</code>
except for the fact that it will return the type of the alternative
name in <code>ret_type</code> even if the function fails for some reason (i.e. 
the buffer provided is not enough).

     <p>The return values are the same as with <code>gnutls_x509_crt_get_subject_alt_name()</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_subject_alt_name</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fsubject_005falt_005fname"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_subject_alt_name</b> (<var>gnutls_x509_crt_t cert, unsigned int seq, void * ret, size_t * ret_size, unsigned int * critical</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fsubject_005falt_005fname-412"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>seq</var>: specifies the sequence number of the alt name (0 for the first one, 1 for the second etc.)

     <p><var>ret</var>: is the place where the alternative name will be copied to

     <p><var>ret_size</var>: holds the size of ret.

     <p><var>critical</var>: will be non zero if the extension is marked as critical (may be null)

     <p>This function will return the alternative names, contained in the
given certificate.

     <p>This is specified in X509v3 Certificate Extensions.  GNUTLS will
return the Alternative name (2.5.29.17), or a negative error code.

     <p>When the SAN type is otherName, it will extract the data in the
otherName's value field, and <code>GNUTLS_SAN_OTHERNAME</code> is returned. 
You may use <code>gnutls_x509_crt_get_subject_alt_othername_oid()</code> to get
the corresponding OID and the "virtual" SAN types (e.g.,
<code>GNUTLS_SAN_OTHERNAME_XMPP</code>).

     <p>If an otherName OID is known, the data will be decoded.  Otherwise
the returned data will be DER encoded, and you will have to decode
it yourself.  Currently, only the RFC 3920 id-on-xmppAddr SAN is
recognized.

     <p><strong>Returns:</strong> the alternative subject name type on success, one of the
enumerated <code>gnutls_x509_subject_alt_name_t</code>.  It will return
<code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> if <code>ret_size</code> is not large enough to
hold the value.  In that case <code>ret_size</code> will be updated with the
required size.  If the certificate does not have an Alternative
name with the specified sequence number then
<code>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</code> is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_subject_alt_othername_oid</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fsubject_005falt_005fothername_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_subject_alt_othername_oid</b> (<var>gnutls_x509_crt_t cert, unsigned int seq, void * ret, size_t * ret_size</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fsubject_005falt_005fothername_005foid-413"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>seq</var>: specifies the sequence number of the alt name (0 for the first one, 1 for the second etc.)

     <p><var>ret</var>: is the place where the otherName OID will be copied to

     <p><var>ret_size</var>: holds the size of ret.

     <p>This function will extract the type OID of an otherName Subject
Alternative Name, contained in the given certificate, and return
the type as an enumerated element.

     <p>This function is only useful if
<code>gnutls_x509_crt_get_subject_alt_name()</code> returned
<code>GNUTLS_SAN_OTHERNAME</code>.

     <p><strong>Returns:</strong> the alternative subject name type on success, one of the
enumerated gnutls_x509_subject_alt_name_t.  For supported OIDs, it
will return one of the virtual (GNUTLS_SAN_OTHERNAME_*) types,
e.g. <code>GNUTLS_SAN_OTHERNAME_XMPP</code>, and <code>GNUTLS_SAN_OTHERNAME</code> for
unknown OIDs.  It will return <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> if
<code>ret_size</code> is not large enough to hold the value.  In that case
<code>ret_size</code> will be updated with the required size.  If the
certificate does not have an Alternative name with the specified
sequence number and with the otherName type then
<code>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</code> is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_subject_key_id</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fsubject_005fkey_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_subject_key_id</b> (<var>gnutls_x509_crt_t cert, void * ret, size_t * ret_size, unsigned int * critical</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fsubject_005fkey_005fid-414"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>ret</var>: The place where the identifier will be copied

     <p><var>ret_size</var>: Holds the size of the result field.

     <p><var>critical</var>: will be non zero if the extension is marked as critical (may be null)

     <p>This function will return the X.509v3 certificate's subject key identifier. 
This is obtained by the X.509 Subject Key identifier extension
field (2.5.29.14).

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.and a negative value in case of an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_subject</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fsubject"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_subject</b> (<var>gnutls_x509_crt_t cert, gnutls_x509_dn_t * dn</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fsubject-415"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p><var>dn</var>: output variable with pointer to opaque DN.

     <p>Return the Certificate's Subject DN as an opaque data type.  You
may use <code>gnutls_x509_dn_get_rdn_ava()</code> to decode the DN.

     <p>Note that <code>dn</code> should be treated as constant. Because points
into the <code>cert</code> object, you may not deallocate <code>cert</code>
and continue to access <code>dn</code>.

     <p><strong>Returns:</strong> Returns 0 on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_get_version</h4>

<p><a name="gnutls_005fx509_005fcrt_005fget_005fversion"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_get_version</b> (<var>gnutls_x509_crt_t cert</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fget_005fversion-416"></a></var><br>
<blockquote><p><var>cert</var>: should contain a <code>gnutls_x509_crt_t</code> structure

     <p>This function will return the version of the specified Certificate.

     <p><strong>Returns:</strong> version of certificate, or a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_import</h4>

<p><a name="gnutls_005fx509_005fcrt_005fimport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_import</b> (<var>gnutls_x509_crt_t cert, const gnutls_datum_t * data, gnutls_x509_crt_fmt_t format</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fimport-417"></a></var><br>
<blockquote><p><var>cert</var>: The structure to store the parsed certificate.

     <p><var>data</var>: The DER or PEM encoded certificate.

     <p><var>format</var>: One of DER or PEM

     <p>This function will convert the given DER or PEM encoded Certificate
to the native gnutls_x509_crt_t format. The output will be stored in <code>cert</code>.

     <p>If the Certificate is PEM encoded it should have a header of "X509 CERTIFICATE", or
"CERTIFICATE".

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_init</h4>

<p><a name="gnutls_005fx509_005fcrt_005finit"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_init</b> (<var>gnutls_x509_crt_t * cert</var>)<var><a name="index-gnutls_005fx509_005fcrt_005finit-418"></a></var><br>
<blockquote><p><var>cert</var>: The structure to be initialized

     <p>This function will initialize an X.509 certificate structure.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_list_import</h4>

<p><a name="gnutls_005fx509_005fcrt_005flist_005fimport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_list_import</b> (<var>gnutls_x509_crt_t * certs, unsigned int * cert_max, const gnutls_datum_t * data, gnutls_x509_crt_fmt_t format, unsigned int flags</var>)<var><a name="index-gnutls_005fx509_005fcrt_005flist_005fimport-419"></a></var><br>
<blockquote><p><var>certs</var>: The structures to store the parsed certificate. Must not be initialized.

     <p><var>cert_max</var>: Initially must hold the maximum number of certs. It will be updated with the number of certs available.

     <p><var>data</var>: The PEM encoded certificate.

     <p><var>format</var>: One of DER or PEM.

     <p><var>flags</var>: must be zero or an OR'd sequence of gnutls_certificate_import_flags.

     <p>This function will convert the given PEM encoded certificate list
to the native gnutls_x509_crt_t format. The output will be stored
in <code>certs</code>.  They will be automatically initialized.

     <p>If the Certificate is PEM encoded it should have a header of "X509
CERTIFICATE", or "CERTIFICATE".

     <p><strong>Returns:</strong> the number of certificates read or a negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_list_verify</h4>

<p><a name="gnutls_005fx509_005fcrt_005flist_005fverify"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_list_verify</b> (<var>const gnutls_x509_crt_t * cert_list, int cert_list_length, const gnutls_x509_crt_t * CA_list, int CA_list_length, const gnutls_x509_crl_t * CRL_list, int CRL_list_length, unsigned int flags, unsigned int * verify</var>)<var><a name="index-gnutls_005fx509_005fcrt_005flist_005fverify-420"></a></var><br>
<blockquote><p><var>cert_list</var>: is the certificate list to be verified

     <p><var>cert_list_length</var>: holds the number of certificate in cert_list

     <p><var>CA_list</var>: is the CA list which will be used in verification

     <p><var>CA_list_length</var>: holds the number of CA certificate in CA_list

     <p><var>CRL_list</var>: holds a list of CRLs.

     <p><var>CRL_list_length</var>: the length of CRL list.

     <p><var>flags</var>: Flags that may be used to change the verification algorithm. Use OR of the gnutls_certificate_verify_flags enumerations.

     <p><var>verify</var>: will hold the certificate verification output.

     <p>This function will try to verify the given certificate list and return its status. 
Note that expiration and activation dates are not checked
by this function, you should check them using the appropriate functions.

     <p>If no flags are specified (0), this function will use the
basicConstraints (2.5.29.19) PKIX extension. This means that only a certificate
authority is allowed to sign a certificate.

     <p>You must also check the peer's name in order to check if the verified
certificate belongs to the actual peer.

     <p>The certificate verification output will be put in <code>verify</code> and will be
one or more of the gnutls_certificate_status_t enumerated elements bitwise or'd. 
For a more detailed verification status use <code>gnutls_x509_crt_verify()</code> per list
element.

     <p><strong>GNUTLS_CERT_INVALID:</strong> the certificate chain is not valid.

     <p><strong>GNUTLS_CERT_REVOKED:</strong> a certificate in the chain has been revoked.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.and a negative value in case of an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_print</h4>

<p><a name="gnutls_005fx509_005fcrt_005fprint"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_print</b> (<var>gnutls_x509_crt_t cert, gnutls_certificate_print_formats_t format, gnutls_datum_t * out</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fprint-421"></a></var><br>
<blockquote><p><var>cert</var>: The structure to be printed

     <p><var>format</var>: Indicate the format to use

     <p><var>out</var>: Newly allocated datum with zero terminated string.

     <p>This function will pretty print a X.509 certificate, suitable for
display to a human.

     <p>If the format is <code>GNUTLS_CRT_PRINT_FULL</code> then all fields of the
certificate will be output, on multiple lines.  The
<code>GNUTLS_CRT_PRINT_ONELINE</code> format will generate one line with some
selected fields, which is useful for logging purposes.

     <p>The output <code>out</code> needs to be deallocate using <code>gnutls_free()</code>.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_activation_time</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005factivation_005ftime"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_activation_time</b> (<var>gnutls_x509_crt_t cert, time_t act_time</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005factivation_005ftime-422"></a></var><br>
<blockquote><p><var>cert</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>act_time</var>: The actual time

     <p>This function will set the time this Certificate was or will be
activated.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_authority_key_id</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fauthority_005fkey_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_authority_key_id</b> (<var>gnutls_x509_crt_t cert, const void * id, size_t id_size</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fauthority_005fkey_005fid-423"></a></var><br>
<blockquote><p><var>cert</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>id</var>: The key ID

     <p><var>id_size</var>: Holds the size of the serial field.

     <p>This function will set the X.509 certificate's authority key ID extension. 
Only the keyIdentifier field can be set with this function.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_basic_constraints</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fbasic_005fconstraints"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_basic_constraints</b> (<var>gnutls_x509_crt_t crt, unsigned int ca, int pathLenConstraint</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fbasic_005fconstraints-424"></a></var><br>
<blockquote><p><var>crt</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>ca</var>: true(1) or false(0). Depending on the Certificate authority status.

     <p><var>pathLenConstraint</var>: non-negative values indicate maximum length of path,
and negative values indicate that the pathLenConstraints field should
not be present.

     <p>This function will set the basicConstraints certificate extension.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_ca_status</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fca_005fstatus"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_ca_status</b> (<var>gnutls_x509_crt_t crt, unsigned int ca</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fca_005fstatus-425"></a></var><br>
<blockquote><p><var>crt</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>ca</var>: true(1) or false(0). Depending on the Certificate authority status.

     <p>This function will set the basicConstraints certificate extension. 
Use <code>gnutls_x509_crt_set_basic_constraints()</code> if you want to control
the pathLenConstraint field too.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_crl_dist_points2</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fcrl_005fdist_005fpoints2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_crl_dist_points2</b> (<var>gnutls_x509_crt_t crt, gnutls_x509_subject_alt_name_t type, const void * data, unsigned int data_size, unsigned int reason_flags</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fcrl_005fdist_005fpoints2-426"></a></var><br>
<blockquote><p><var>crt</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>type</var>: is one of the gnutls_x509_subject_alt_name_t enumerations

     <p><var>data</var>: The data to be set

     <p><var>data_size</var>: The data size

     <p><var>reason_flags</var>: revocation reasons

     <p>This function will set the CRL distribution points certificate extension.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_crl_dist_points</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fcrl_005fdist_005fpoints"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_crl_dist_points</b> (<var>gnutls_x509_crt_t crt, gnutls_x509_subject_alt_name_t type, const void * data_string, unsigned int reason_flags</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fcrl_005fdist_005fpoints-427"></a></var><br>
<blockquote><p><var>crt</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>type</var>: is one of the gnutls_x509_subject_alt_name_t enumerations

     <p><var>data_string</var>: The data to be set

     <p><var>reason_flags</var>: revocation reasons

     <p>This function will set the CRL distribution points certificate extension.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_crq</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fcrq"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_crq</b> (<var>gnutls_x509_crt_t crt, gnutls_x509_crq_t crq</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fcrq-428"></a></var><br>
<blockquote><p><var>crt</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>crq</var>: holds a certificate request

     <p>This function will set the name and public parameters from the
given certificate request to the certificate. Only RSA keys are
currently supported.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_dn_by_oid</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fdn_005fby_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_dn_by_oid</b> (<var>gnutls_x509_crt_t crt, const char * oid, unsigned int raw_flag, const void * name, unsigned int sizeof_name</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fdn_005fby_005foid-429"></a></var><br>
<blockquote><p><var>crt</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>oid</var>: holds an Object Identifier in a null terminated string

     <p><var>raw_flag</var>: must be 0, or 1 if the data are DER encoded

     <p><var>name</var>: a pointer to the name

     <p><var>sizeof_name</var>: holds the size of <code>name</code>

     <p>This function will set the part of the name of the Certificate
subject, specified by the given OID. The input string should be
ASCII or UTF-8 encoded.

     <p>Some helper macros with popular OIDs can be found in gnutls/x509.h
With this function you can only set the known OIDs. You can test
for known OIDs using <code>gnutls_x509_dn_oid_known()</code>. For OIDs that are
not known (by gnutls) you should properly DER encode your data,
and call this function with <code>raw_flag</code> set.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_expiration_time</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fexpiration_005ftime"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_expiration_time</b> (<var>gnutls_x509_crt_t cert, time_t exp_time</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fexpiration_005ftime-430"></a></var><br>
<blockquote><p><var>cert</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>exp_time</var>: The actual time

     <p>This function will set the time this Certificate will expire.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_extension_by_oid</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fextension_005fby_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_extension_by_oid</b> (<var>gnutls_x509_crt_t crt, const char * oid, const void * buf, size_t sizeof_buf, unsigned int critical</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fextension_005fby_005foid-431"></a></var><br>
<blockquote><p><var>crt</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>oid</var>: holds an Object Identified in null terminated string

     <p><var>buf</var>: a pointer to a DER encoded data

     <p><var>sizeof_buf</var>: holds the size of <code>buf</code>

     <p><var>critical</var>: should be non zero if the extension is to be marked as critical

     <p>This function will set an the extension, by the specified OID, in
the certificate.  The extension data should be binary data DER
encoded.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.and a negative value in case of an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_issuer_dn_by_oid</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fissuer_005fdn_005fby_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_issuer_dn_by_oid</b> (<var>gnutls_x509_crt_t crt, const char * oid, unsigned int raw_flag, const void * name, unsigned int sizeof_name</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fissuer_005fdn_005fby_005foid-432"></a></var><br>
<blockquote><p><var>crt</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>oid</var>: holds an Object Identifier in a null terminated string

     <p><var>raw_flag</var>: must be 0, or 1 if the data are DER encoded

     <p><var>name</var>: a pointer to the name

     <p><var>sizeof_name</var>: holds the size of <code>name</code>

     <p>This function will set the part of the name of the Certificate
issuer, specified by the given OID.  The input string should be
ASCII or UTF-8 encoded.

     <p>Some helper macros with popular OIDs can be found in gnutls/x509.h
With this function you can only set the known OIDs. You can test
for known OIDs using <code>gnutls_x509_dn_oid_known()</code>. For OIDs that are
not known (by gnutls) you should properly DER encode your data,
and call this function with <code>raw_flag</code> set.

     <p>Normally you do not need to call this function, since the signing
operation will copy the signer's name as the issuer of the
certificate.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_key_purpose_oid</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fkey_005fpurpose_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_key_purpose_oid</b> (<var>gnutls_x509_crt_t cert, const void * oid, unsigned int critical</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fkey_005fpurpose_005foid-433"></a></var><br>
<blockquote><p><var>cert</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>oid</var>: a pointer to a null terminated string that holds the OID

     <p><var>critical</var>: Whether this extension will be critical or not

     <p>This function will set the key purpose OIDs of the Certificate. 
These are stored in the Extended Key Usage extension (2.5.29.37)
See the GNUTLS_KP_* definitions for human readable names.

     <p>Subsequent calls to this function will append OIDs to the OID list.

     <p>On success 0 is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_key_usage</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fkey_005fusage"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_key_usage</b> (<var>gnutls_x509_crt_t crt, unsigned int usage</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fkey_005fusage-434"></a></var><br>
<blockquote><p><var>crt</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>usage</var>: an ORed sequence of the GNUTLS_KEY_* elements.

     <p>This function will set the keyUsage certificate extension.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_key</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fkey"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_key</b> (<var>gnutls_x509_crt_t crt, gnutls_x509_privkey_t key</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fkey-435"></a></var><br>
<blockquote><p><var>crt</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>key</var>: holds a private key

     <p>This function will set the public parameters from the given
private key to the certificate. Only RSA keys are currently
supported.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_proxy_dn</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fproxy_005fdn"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_proxy_dn</b> (<var>gnutls_x509_crt_t crt, gnutls_x509_crt_t eecrt, unsigned int raw_flag, const void * name, unsigned int sizeof_name</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fproxy_005fdn-436"></a></var><br>
<blockquote><p><var>crt</var>: a gnutls_x509_crt_t structure with the new proxy cert

     <p><var>eecrt</var>: the end entity certificate that will be issuing the proxy

     <p><var>raw_flag</var>: must be 0, or 1 if the CN is DER encoded

     <p><var>name</var>: a pointer to the CN name, may be NULL (but MUST then be added later)

     <p><var>sizeof_name</var>: holds the size of <code>name</code>

     <p>This function will set the subject in <code>crt</code> to the end entity's
<code>eecrt</code> subject name, and add a single Common Name component <code>name</code>
of size <code>sizeof_name</code>.  This corresponds to the required proxy
certificate naming style.  Note that if <code>name</code> is <code>NULL</code>, you MUST
set it later by using <code>gnutls_x509_crt_set_dn_by_oid()</code> or similar.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_proxy</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fproxy"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_proxy</b> (<var>gnutls_x509_crt_t crt, int pathLenConstraint, const char * policyLanguage, const char * policy, size_t sizeof_policy</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fproxy-437"></a></var><br>
<blockquote><p><var>crt</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>pathLenConstraint</var>: non-negative values indicate maximum length of path,
and negative values indicate that the pathLenConstraints field should
not be present.

     <p><var>policyLanguage</var>: OID describing the language of <code>policy</code>.

     <p><var>policy</var>: opaque byte array with policy language, can be <code>NULL</code>

     <p><var>sizeof_policy</var>: size of <code>policy</code>.

     <p>This function will set the proxyCertInfo extension.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_serial</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fserial"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_serial</b> (<var>gnutls_x509_crt_t cert, const void * serial, size_t serial_size</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fserial-438"></a></var><br>
<blockquote><p><var>cert</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>serial</var>: The serial number

     <p><var>serial_size</var>: Holds the size of the serial field.

     <p>This function will set the X.509 certificate's serial number. 
Serial is not always a 32 or 64bit number.  Some CAs use large
serial numbers, thus it may be wise to handle it as something
opaque.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_subject_alt_name</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fsubject_005falt_005fname"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_subject_alt_name</b> (<var>gnutls_x509_crt_t crt, gnutls_x509_subject_alt_name_t type, const void * data, unsigned int data_size, unsigned int flags</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fsubject_005falt_005fname-439"></a></var><br>
<blockquote><p><var>crt</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>type</var>: is one of the gnutls_x509_subject_alt_name_t enumerations

     <p><var>data</var>: The data to be set

     <p><var>data_size</var>: The size of data to be set

     <p><var>flags</var>: GNUTLS_FSAN_SET to clear previous data or GNUTLS_FSAN_APPEND to append.

     <p>This function will set the subject alternative name certificate
extension. It can set the following types:

     <p>&amp;GNUTLS_SAN_DNSNAME: as a text string

     <p>&amp;GNUTLS_SAN_RFC822NAME: as a text string

     <p>&amp;GNUTLS_SAN_URI: as a text string

     <p>&amp;GNUTLS_SAN_IPADDRESS: as a binary IP address (4 or 16 bytes)

     <p>Other values can be set as binary values with the proper DER encoding.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.

     <p><strong>Since:</strong> 2.6.0
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_subject_alternative_name</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fsubject_005falternative_005fname"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_subject_alternative_name</b> (<var>gnutls_x509_crt_t crt, gnutls_x509_subject_alt_name_t type, const char * data_string</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fsubject_005falternative_005fname-440"></a></var><br>
<blockquote><p><var>crt</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>type</var>: is one of the gnutls_x509_subject_alt_name_t enumerations

     <p><var>data_string</var>: The data to be set, a zero terminated string

     <p>This function will set the subject alternative name certificate
extension. This function assumes that data can be expressed as a null
terminated string.

     <p>The name of the function is unfortunate since it is incosistent with
<code>gnutls_x509_crt_get_subject_alt_name()</code>.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_subject_key_id</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fsubject_005fkey_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_subject_key_id</b> (<var>gnutls_x509_crt_t cert, const void * id, size_t id_size</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fsubject_005fkey_005fid-441"></a></var><br>
<blockquote><p><var>cert</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>id</var>: The key ID

     <p><var>id_size</var>: Holds the size of the serial field.

     <p>This function will set the X.509 certificate's subject key ID
extension.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_set_version</h4>

<p><a name="gnutls_005fx509_005fcrt_005fset_005fversion"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_set_version</b> (<var>gnutls_x509_crt_t crt, unsigned int version</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fset_005fversion-442"></a></var><br>
<blockquote><p><var>crt</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>version</var>: holds the version number. For X.509v1 certificates must be 1.

     <p>This function will set the version of the certificate.  This must
be one for X.509 version 1, and so on.  Plain certificates without
extensions must have version set to one.

     <p>To create well-formed certificates, you must specify version 3 if
you use any certificate extensions.  Extensions are created by
functions such as <code>gnutls_x509_crt_set_subject_alt_name()</code>
or <code>gnutls_x509_crt_set_key_usage()</code>.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_sign2</h4>

<p><a name="gnutls_005fx509_005fcrt_005fsign2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_sign2</b> (<var>gnutls_x509_crt_t crt, gnutls_x509_crt_t issuer, gnutls_x509_privkey_t issuer_key, gnutls_digest_algorithm_t dig, unsigned int flags</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fsign2-443"></a></var><br>
<blockquote><p><var>crt</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>issuer</var>: is the certificate of the certificate issuer

     <p><var>issuer_key</var>: holds the issuer's private key

     <p><var>dig</var>: The message digest to use, <code>GNUTLS_DIG_SHA1</code> is a safe choice

     <p><var>flags</var>: must be 0

     <p>This function will sign the certificate with the issuer's private key, and
will copy the issuer's information into the certificate.

     <p>This must be the last step in a certificate generation since all
the previously set parameters are now signed.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_sign</h4>

<p><a name="gnutls_005fx509_005fcrt_005fsign"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_sign</b> (<var>gnutls_x509_crt_t crt, gnutls_x509_crt_t issuer, gnutls_x509_privkey_t issuer_key</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fsign-444"></a></var><br>
<blockquote><p><var>crt</var>: a certificate of type <code>gnutls_x509_crt_t</code>

     <p><var>issuer</var>: is the certificate of the certificate issuer

     <p><var>issuer_key</var>: holds the issuer's private key

     <p>This function is the same a <code>gnutls_x509_crt_sign2()</code> with no flags,
and SHA1 as the hash algorithm.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_verify_data</h4>

<p><a name="gnutls_005fx509_005fcrt_005fverify_005fdata"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_verify_data</b> (<var>gnutls_x509_crt_t crt, unsigned int flags, const gnutls_datum_t * data, const gnutls_datum_t * signature</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fverify_005fdata-445"></a></var><br>
<blockquote><p><var>crt</var>: Holds the certificate

     <p><var>flags</var>: should be 0 for now

     <p><var>data</var>: holds the data to be signed

     <p><var>signature</var>: contains the signature

     <p>This function will verify the given signed data, using the
parameters from the certificate.

     <p><strong>Returns:</strong> In case of a verification failure 0 is returned, and 1 on
success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_crt_verify</h4>

<p><a name="gnutls_005fx509_005fcrt_005fverify"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_crt_verify</b> (<var>gnutls_x509_crt_t cert, const gnutls_x509_crt_t * CA_list, int CA_list_length, unsigned int flags, unsigned int * verify</var>)<var><a name="index-gnutls_005fx509_005fcrt_005fverify-446"></a></var><br>
<blockquote><p><var>cert</var>: is the certificate to be verified

     <p><var>CA_list</var>: is one certificate that is considered to be trusted one

     <p><var>CA_list_length</var>: holds the number of CA certificate in CA_list

     <p><var>flags</var>: Flags that may be used to change the verification algorithm. Use OR of the gnutls_certificate_verify_flags enumerations.

     <p><var>verify</var>: will hold the certificate verification output.

     <p>This function will try to verify the given certificate and return its status. 
The verification output in this functions cannot be GNUTLS_CERT_NOT_VALID.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.and a negative value in case of an error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_dn_deinit</h4>

<p><a name="gnutls_005fx509_005fdn_005fdeinit"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_x509_dn_deinit</b> (<var>gnutls_x509_dn_t idn</var>)<var><a name="index-gnutls_005fx509_005fdn_005fdeinit-447"></a></var><br>
<blockquote><p><var>idn</var>: a DN opaque object pointer.

     <p>This function deallocates the DN object as returned by
<code>gnutls_x509_dn_import()</code>.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_dn_export</h4>

<p><a name="gnutls_005fx509_005fdn_005fexport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_dn_export</b> (<var>gnutls_x509_dn_t dn, gnutls_x509_crt_fmt_t format, void * output_data, size_t * output_data_size</var>)<var><a name="index-gnutls_005fx509_005fdn_005fexport-448"></a></var><br>
<blockquote><p><var>dn</var>: Holds the opaque DN object

     <p><var>format</var>: the format of output params. One of PEM or DER.

     <p><var>output_data</var>: will contain a DN PEM or DER encoded

     <p><var>output_data_size</var>: holds the size of output_data (and will be
replaced by the actual size of parameters)

     <p>This function will export the DN to DER or PEM format.

     <p>If the buffer provided is not long enough to hold the output, then
*<code>output_data_size</code> is updated and <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code>
will be returned.

     <p>If the structure is PEM encoded, it will have a header
of "BEGIN NAME".

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_dn_get_rdn_ava</h4>

<p><a name="gnutls_005fx509_005fdn_005fget_005frdn_005fava"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_dn_get_rdn_ava</b> (<var>gnutls_x509_dn_t dn, int irdn, int iava, gnutls_x509_ava_st * ava</var>)<var><a name="index-gnutls_005fx509_005fdn_005fget_005frdn_005fava-449"></a></var><br>
<blockquote><p><var>dn</var>: input variable with opaque DN pointer

     <p><var>irdn</var>: index of RDN

     <p><var>iava</var>: index of AVA.

     <p><var>ava</var>: Pointer to structure which will hold output information.

     <p>Get pointers to data within the DN.

     <p>Note that <code>ava</code> will contain pointers into the <code>dn</code> structure, so you
should not modify any data or deallocate it.  Note also that the DN
in turn points into the original certificate structure, and thus
you may not deallocate the certificate and continue to access <code>dn</code>.

     <p><strong>Returns:</strong> Returns 0 on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_dn_import</h4>

<p><a name="gnutls_005fx509_005fdn_005fimport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_dn_import</b> (<var>gnutls_x509_dn_t odn, const gnutls_datum_t * data</var>)<var><a name="index-gnutls_005fx509_005fdn_005fimport-450"></a></var><br>
<blockquote><p><var>odn</var>: the structure that will hold the imported DN

     <p><var>data</var>: should contain a DER encoded RDN sequence

     <p>This function parses an RDN sequence and stores the result to a
<code>gnutls_x509_dn_t</code> structure. The structure must have been initialized
with <code>gnutls_x509_dn_init()</code>. You may use <code>gnutls_x509_dn_get_rdn_ava()</code> to
decode the DN. 
This function parses an RDN sequence and stores the result to a
<code>gnutls_x509_dn_t</code> structure. The structure must have been initialized
with <code>gnutls_x509_dn_init()</code>. You may use <code>gnutls_x509_dn_get_rdn_ava()</code> to
decode the DN.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_dn_init</h4>

<p><a name="gnutls_005fx509_005fdn_005finit"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_dn_init</b> (<var>gnutls_x509_dn_t * odn</var>)<var><a name="index-gnutls_005fx509_005fdn_005finit-451"></a></var><br>
<blockquote><p><var>odn</var>: the object to be initialized

     <p>This function initializes a <code>gnutls_x509_dn_t</code> structure.

     <p>The object returned must be deallocated using
<code>gnutls_x509_dn_deinit()</code>.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_dn_oid_known</h4>

<p><a name="gnutls_005fx509_005fdn_005foid_005fknown"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_dn_oid_known</b> (<var>const char * oid</var>)<var><a name="index-gnutls_005fx509_005fdn_005foid_005fknown-452"></a></var><br>
<blockquote><p><var>oid</var>: holds an Object Identifier in a null terminated string

     <p>This function will inform about known DN OIDs. This is useful since
functions like <code>gnutls_x509_crt_set_dn_by_oid()</code> use the information
on known OIDs to properly encode their input. Object Identifiers
that are not known are not encoded by these functions, and their
input is stored directly into the ASN.1 structure. In that case of
unknown OIDs, you have the responsibility of DER encoding your
data.

     <p><strong>Returns:</strong> 1 on known OIDs and 0 otherwise. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_cpy</h4>

<p><a name="gnutls_005fx509_005fprivkey_005fcpy"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_privkey_cpy</b> (<var>gnutls_x509_privkey_t dst, gnutls_x509_privkey_t src</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005fcpy-453"></a></var><br>
<blockquote><p><var>dst</var>: The destination key, which should be initialized.

     <p><var>src</var>: The source key

     <p>This function will copy a private key from source to destination
key.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_deinit</h4>

<p><a name="gnutls_005fx509_005fprivkey_005fdeinit"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_x509_privkey_deinit</b> (<var>gnutls_x509_privkey_t key</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005fdeinit-454"></a></var><br>
<blockquote><p><var>key</var>: The structure to be initialized

     <p>This function will deinitialize a private key structure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_export_dsa_raw</h4>

<p><a name="gnutls_005fx509_005fprivkey_005fexport_005fdsa_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_privkey_export_dsa_raw</b> (<var>gnutls_x509_privkey_t key, gnutls_datum_t * p, gnutls_datum_t * q, gnutls_datum_t * g, gnutls_datum_t * y, gnutls_datum_t * x</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005fexport_005fdsa_005fraw-455"></a></var><br>
<blockquote><p><var>p</var>: will hold the p

     <p><var>q</var>: will hold the q

     <p><var>g</var>: will hold the g

     <p><var>y</var>: will hold the y

     <p><var>x</var>: will hold the x

     <p>This function will export the DSA private key's parameters found
in the given structure. The new parameters will be allocated using
<code>gnutls_malloc()</code> and will be stored in the appropriate datum.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_export_pkcs8</h4>

<p><a name="gnutls_005fx509_005fprivkey_005fexport_005fpkcs8"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_privkey_export_pkcs8</b> (<var>gnutls_x509_privkey_t key, gnutls_x509_crt_fmt_t format, const char * password, unsigned int flags, void * output_data, size_t * output_data_size</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005fexport_005fpkcs8-456"></a></var><br>
<blockquote><p><var>key</var>: Holds the key

     <p><var>format</var>: the format of output params. One of PEM or DER.

     <p><var>password</var>: the password that will be used to encrypt the key.

     <p><var>flags</var>: an ORed sequence of gnutls_pkcs_encrypt_flags_t

     <p><var>output_data</var>: will contain a private key PEM or DER encoded

     <p><var>output_data_size</var>: holds the size of output_data (and will be
replaced by the actual size of parameters)

     <p>This function will export the private key to a PKCS8 structure. 
Both RSA and DSA keys can be exported. For DSA keys we use
PKCS <code>11</code> definitions. If the flags do not specify the encryption
cipher, then the default 3DES (PBES2) will be used.

     <p>The <code>password</code> can be either ASCII or UTF-8 in the default PBES2
encryption schemas, or ASCII for the PKCS12 schemas.

     <p>If the buffer provided is not long enough to hold the output, then
*output_data_size is updated and GNUTLS_E_SHORT_MEMORY_BUFFER will
be returned.

     <p>If the structure is PEM encoded, it will have a header
of "BEGIN ENCRYPTED PRIVATE KEY" or "BEGIN PRIVATE KEY" if
encryption is not used.

     <p><strong>Return value:</strong> In case of failure a negative value will be
returned, and 0 on success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_export_rsa_raw</h4>

<p><a name="gnutls_005fx509_005fprivkey_005fexport_005frsa_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_privkey_export_rsa_raw</b> (<var>gnutls_x509_privkey_t key, gnutls_datum_t * m, gnutls_datum_t * e, gnutls_datum_t * d, gnutls_datum_t * p, gnutls_datum_t * q, gnutls_datum_t * u</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005fexport_005frsa_005fraw-457"></a></var><br>
<blockquote><p><var>key</var>: a structure that holds the rsa parameters

     <p><var>m</var>: will hold the modulus

     <p><var>e</var>: will hold the public exponent

     <p><var>d</var>: will hold the private exponent

     <p><var>p</var>: will hold the first prime (p)

     <p><var>q</var>: will hold the second prime (q)

     <p><var>u</var>: will hold the coefficient

     <p>This function will export the RSA private key's parameters found
in the given structure. The new parameters will be allocated using
<code>gnutls_malloc()</code> and will be stored in the appropriate datum.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_export</h4>

<p><a name="gnutls_005fx509_005fprivkey_005fexport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_privkey_export</b> (<var>gnutls_x509_privkey_t key, gnutls_x509_crt_fmt_t format, void * output_data, size_t * output_data_size</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005fexport-458"></a></var><br>
<blockquote><p><var>key</var>: Holds the key

     <p><var>format</var>: the format of output params. One of PEM or DER.

     <p><var>output_data</var>: will contain a private key PEM or DER encoded

     <p><var>output_data_size</var>: holds the size of output_data (and will be
replaced by the actual size of parameters)

     <p>This function will export the private key to a PKCS1 structure for
RSA keys, or an integer sequence for DSA keys.  The DSA keys are in
the same format with the parameters used by openssl.

     <p>If the buffer provided is not long enough to hold the output, then
*<code>output_data_size</code> is updated and <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code>
will be returned.

     <p>If the structure is PEM encoded, it will have a header
of "BEGIN RSA PRIVATE KEY".

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_fix</h4>

<p><a name="gnutls_005fx509_005fprivkey_005ffix"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_privkey_fix</b> (<var>gnutls_x509_privkey_t key</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005ffix-459"></a></var><br>
<blockquote><p><var>key</var>: Holds the key

     <p>This function will recalculate the secondary parameters in a key. 
In RSA keys, this can be the coefficient and exponent1,2.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_generate</h4>

<p><a name="gnutls_005fx509_005fprivkey_005fgenerate"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_privkey_generate</b> (<var>gnutls_x509_privkey_t key, gnutls_pk_algorithm_t algo, unsigned int bits, unsigned int flags</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005fgenerate-460"></a></var><br>
<blockquote><p><var>key</var>: should contain a <code>gnutls_x509_privkey_t</code> structure

     <p><var>algo</var>: is one of RSA or DSA.

     <p><var>bits</var>: the size of the modulus

     <p><var>flags</var>: unused for now.  Must be 0.

     <p>This function will generate a random private key. Note that this
function must be called on an empty private key.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_get_key_id</h4>

<p><a name="gnutls_005fx509_005fprivkey_005fget_005fkey_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_privkey_get_key_id</b> (<var>gnutls_x509_privkey_t key, unsigned int flags, unsigned char * output_data, size_t * output_data_size</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005fget_005fkey_005fid-461"></a></var><br>
<blockquote><p><var>key</var>: Holds the key

     <p><var>flags</var>: should be 0 for now

     <p><var>output_data</var>: will contain the key ID

     <p><var>output_data_size</var>: holds the size of output_data (and will be
replaced by the actual size of parameters)

     <p>This function will return a unique ID the depends on the public key
parameters. This ID can be used in checking whether a certificate
corresponds to the given key.

     <p>If the buffer provided is not long enough to hold the output, then
*<code>output_data_size</code> is updated and <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> will
be returned.  The output will normally be a SHA-1 hash output,
which is 20 bytes.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_get_pk_algorithm</h4>

<p><a name="gnutls_005fx509_005fprivkey_005fget_005fpk_005falgorithm"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_privkey_get_pk_algorithm</b> (<var>gnutls_x509_privkey_t key</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005fget_005fpk_005falgorithm-462"></a></var><br>
<blockquote><p><var>key</var>: should contain a <code>gnutls_x509_privkey_t</code> structure

     <p>This function will return the public key algorithm of a private
key.

     <p><strong>Returns:</strong> a member of the <code>gnutls_pk_algorithm_t</code> enumeration on
success, or a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_import_dsa_raw</h4>

<p><a name="gnutls_005fx509_005fprivkey_005fimport_005fdsa_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_privkey_import_dsa_raw</b> (<var>gnutls_x509_privkey_t key, const gnutls_datum_t * p, const gnutls_datum_t * q, const gnutls_datum_t * g, const gnutls_datum_t * y, const gnutls_datum_t * x</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005fimport_005fdsa_005fraw-463"></a></var><br>
<blockquote><p><var>key</var>: The structure to store the parsed key

     <p><var>p</var>: holds the p

     <p><var>q</var>: holds the q

     <p><var>g</var>: holds the g

     <p><var>y</var>: holds the y

     <p><var>x</var>: holds the x

     <p>This function will convert the given DSA raw parameters to the
native <code>gnutls_x509_privkey_t</code> format.  The output will be stored
in <code>key</code>.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_import_pkcs8</h4>

<p><a name="gnutls_005fx509_005fprivkey_005fimport_005fpkcs8"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_privkey_import_pkcs8</b> (<var>gnutls_x509_privkey_t key, const gnutls_datum_t * data, gnutls_x509_crt_fmt_t format, const char * password, unsigned int flags</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005fimport_005fpkcs8-464"></a></var><br>
<blockquote><p><var>key</var>: The structure to store the parsed key

     <p><var>data</var>: The DER or PEM encoded key.

     <p><var>format</var>: One of DER or PEM

     <p><var>password</var>: the password to decrypt the key (if it is encrypted).

     <p><var>flags</var>: 0 if encrypted or GNUTLS_PKCS_PLAIN if not encrypted.

     <p>This function will convert the given DER or PEM encoded PKCS8 2.0 encrypted key
to the native gnutls_x509_privkey_t format. The output will be stored in <code>key</code>. 
Both RSA and DSA keys can be imported, and flags can only be used to indicate
an unencrypted key.

     <p>The <code>password</code> can be either ASCII or UTF-8 in the default PBES2
encryption schemas, or ASCII for the PKCS12 schemas.

     <p>If the Certificate is PEM encoded it should have a header of "ENCRYPTED PRIVATE KEY",
or "PRIVATE KEY". You only need to specify the flags if the key is DER encoded, since
in that case the encryption status cannot be auto-detected.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_import_rsa_raw</h4>

<p><a name="gnutls_005fx509_005fprivkey_005fimport_005frsa_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_privkey_import_rsa_raw</b> (<var>gnutls_x509_privkey_t key, const gnutls_datum_t * m, const gnutls_datum_t * e, const gnutls_datum_t * d, const gnutls_datum_t * p, const gnutls_datum_t * q, const gnutls_datum_t * u</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005fimport_005frsa_005fraw-465"></a></var><br>
<blockquote><p><var>key</var>: The structure to store the parsed key

     <p><var>m</var>: holds the modulus

     <p><var>e</var>: holds the public exponent

     <p><var>d</var>: holds the private exponent

     <p><var>p</var>: holds the first prime (p)

     <p><var>q</var>: holds the second prime (q)

     <p><var>u</var>: holds the coefficient

     <p>This function will convert the given RSA raw parameters to the
native <code>gnutls_x509_privkey_t</code> format.  The output will be stored in
<code>key</code>.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_import</h4>

<p><a name="gnutls_005fx509_005fprivkey_005fimport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_privkey_import</b> (<var>gnutls_x509_privkey_t key, const gnutls_datum_t * data, gnutls_x509_crt_fmt_t format</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005fimport-466"></a></var><br>
<blockquote><p><var>key</var>: The structure to store the parsed key

     <p><var>data</var>: The DER or PEM encoded certificate.

     <p><var>format</var>: One of DER or PEM

     <p>This function will convert the given DER or PEM encoded key to the
native <code>gnutls_x509_privkey_t</code> format. The output will be stored in
<code>key</code> .

     <p>If the key is PEM encoded it should have a header of "RSA PRIVATE
KEY", or "DSA PRIVATE KEY".

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_init</h4>

<p><a name="gnutls_005fx509_005fprivkey_005finit"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_privkey_init</b> (<var>gnutls_x509_privkey_t * key</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005finit-467"></a></var><br>
<blockquote><p><var>key</var>: The structure to be initialized

     <p>This function will initialize an private key structure.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_sign_data</h4>

<p><a name="gnutls_005fx509_005fprivkey_005fsign_005fdata"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_privkey_sign_data</b> (<var>gnutls_x509_privkey_t key, gnutls_digest_algorithm_t digest, unsigned int flags, const gnutls_datum_t * data, void * signature, size_t * signature_size</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005fsign_005fdata-468"></a></var><br>
<blockquote><p><var>key</var>: Holds the key

     <p><var>digest</var>: should be MD5 or SHA1

     <p><var>flags</var>: should be 0 for now

     <p><var>data</var>: holds the data to be signed

     <p><var>signature</var>: will contain the signature

     <p><var>signature_size</var>: holds the size of signature (and will be replaced
by the new size)

     <p>This function will sign the given data using a signature algorithm
supported by the private key. Signature algorithms are always used
together with a hash functions.  Different hash functions may be
used for the RSA algorithm, but only SHA-1 for the DSA keys.

     <p>If the buffer provided is not long enough to hold the output, then
*<code>signature_size</code> is updated and <code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> will
be returned.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_sign_hash</h4>

<p><a name="gnutls_005fx509_005fprivkey_005fsign_005fhash"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_privkey_sign_hash</b> (<var>gnutls_x509_privkey_t key, const gnutls_datum_t * hash, gnutls_datum_t * signature</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005fsign_005fhash-469"></a></var><br>
<blockquote><p><var>key</var>: Holds the key

     <p><var>hash</var>: holds the data to be signed

     <p><var>signature</var>: will contain newly allocated signature

     <p>This function will sign the given hash using the private key.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_privkey_verify_data</h4>

<p><a name="gnutls_005fx509_005fprivkey_005fverify_005fdata"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_privkey_verify_data</b> (<var>gnutls_x509_privkey_t key, unsigned int flags, const gnutls_datum_t * data, const gnutls_datum_t * signature</var>)<var><a name="index-gnutls_005fx509_005fprivkey_005fverify_005fdata-470"></a></var><br>
<blockquote><p><var>key</var>: Holds the key

     <p><var>flags</var>: should be 0 for now

     <p><var>data</var>: holds the data to be signed

     <p><var>signature</var>: contains the signature

     <p>This function will verify the given signed data, using the
parameters in the private key.

     <p><strong>Returns:</strong> In case of a verification failure 0 is returned, and 1 on
success. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_rdn_get_by_oid</h4>

<p><a name="gnutls_005fx509_005frdn_005fget_005fby_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_rdn_get_by_oid</b> (<var>const gnutls_datum_t * idn, const char * oid, int indx, unsigned int raw_flag, void * buf, size_t * sizeof_buf</var>)<var><a name="index-gnutls_005fx509_005frdn_005fget_005fby_005foid-471"></a></var><br>
<blockquote><p><var>idn</var>: should contain a DER encoded RDN sequence

     <p><var>oid</var>: an Object Identifier

     <p><var>indx</var>: In case multiple same OIDs exist in the RDN indicates which
to send. Use 0 for the first one.

     <p><var>raw_flag</var>: If non zero then the raw DER data are returned.

     <p><var>buf</var>: a pointer to a structure to hold the peer's name

     <p><var>sizeof_buf</var>: holds the size of <code>buf</code>

     <p>This function will return the name of the given Object identifier,
of the RDN sequence.  The name will be encoded using the rules
from RFC2253.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, or
<code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> is returned and *<code>sizeof_buf</code> is
updated if the provided buffer is not long enough, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_rdn_get_oid</h4>

<p><a name="gnutls_005fx509_005frdn_005fget_005foid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_rdn_get_oid</b> (<var>const gnutls_datum_t * idn, int indx, void * buf, size_t * sizeof_buf</var>)<var><a name="index-gnutls_005fx509_005frdn_005fget_005foid-472"></a></var><br>
<blockquote><p><var>idn</var>: should contain a DER encoded RDN sequence

     <p><var>indx</var>: Indicates which OID to return. Use 0 for the first one.

     <p>This function will return the specified Object identifier, of the
RDN sequence.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, or
<code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> is returned and *<code>sizeof_buf</code> is
updated if the provided buffer is not long enough, otherwise a
negative error value.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_x509_rdn_get</h4>

<p><a name="gnutls_005fx509_005frdn_005fget"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_x509_rdn_get</b> (<var>const gnutls_datum_t * idn, char * buf, size_t * sizeof_buf</var>)<var><a name="index-gnutls_005fx509_005frdn_005fget-473"></a></var><br>
<blockquote><p><var>idn</var>: should contain a DER encoded RDN sequence

     <p><var>buf</var>: a pointer to a structure to hold the peer's name

     <p><var>sizeof_buf</var>: holds the size of <code>buf</code>

     <p>This function will return the name of the given RDN sequence.  The
name will be in the form "C=xxxx,O=yyyy,CN=zzzz" as described in
RFC2253.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, or
<code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> is returned and *<code>sizeof_buf</code> is
updated if the provided buffer is not long enough, otherwise a
negative error value. 
</p></blockquote></div>

<div class="node">
<a name="GnuTLS-extra-functions"></a>
<a name="GnuTLS_002dextra-functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#OpenPGP-functions">OpenPGP functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#X_002e509-certificate-functions">X.509 certificate functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Function-reference">Function reference</a>

</div>

<h3 class="section">9.3 <acronym>GnuTLS-extra</acronym> Functions</h3>

<p><a name="index-g_t_0040acronym_007bGnuTLS_002dextra_007d-functions-474"></a>
These functions are only available in the GPLv3+ version of the
library called <code>gnutls-extra</code>. The prototypes for this library
lie in <samp><span class="file">gnutls/extra.h</span></samp>.

<h4 class="subheading">gnutls_extra_check_version</h4>

<p><a name="gnutls_005fextra_005fcheck_005fversion"></a>

<div class="defun">
&mdash; Function: const char * <b>gnutls_extra_check_version</b> (<var>const char * req_version</var>)<var><a name="index-gnutls_005fextra_005fcheck_005fversion-475"></a></var><br>
<blockquote><p><var>req_version</var>: the version to check

     <p>Check that the version of the gnutls-extra library is at minimum
the requested one and return the version string; return NULL if the
condition is not satisfied.  If a NULL is passed to this function,
no check is done, but the version string is simply returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_global_init_extra</h4>

<p><a name="gnutls_005fglobal_005finit_005fextra"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_global_init_extra</b> (<var> void</var>)<var><a name="index-gnutls_005fglobal_005finit_005fextra-476"></a></var><br>
<blockquote>
     <p>This function initializes the global state of gnutls-extra library
to defaults.  Returns zero on success.

     <p>Note that <code>gnutls_global_init()</code> has to be called before this
function.  If this function is not called then the gnutls-extra
library will not be usable. 
</p></blockquote></div>

<div class="node">
<a name="OpenPGP-functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#GnuTLS_002dextra-functions">GnuTLS-extra functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Function-reference">Function reference</a>

</div>

<h3 class="section">9.4 <acronym>OpenPGP</acronym> Functions</h3>

<p><a name="index-g_t_0040acronym_007bOpenPGP_007d-functions-477"></a><a name="sec_003aopenpgpapi"></a>The following functions are to be used for <acronym>OpenPGP</acronym>
certificate handling.  Their prototypes lie in
<samp><span class="file">gnutls/openpgp.h</span></samp>.

<h4 class="subheading">gnutls_certificate_set_openpgp_key_file2</h4>

<p><a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005ffile2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_set_openpgp_key_file2</b> (<var>gnutls_certificate_credentials_t res, const char * certfile, const char * keyfile, const char * subkey_id, gnutls_openpgp_crt_fmt_t format</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005ffile2-478"></a></var><br>
<blockquote><p><var>res</var>: the destination context to save the data.

     <p><var>certfile</var>: the file that contains the public key.

     <p><var>keyfile</var>: the file that contains the secret key.

     <p><var>subkey_id</var>: a hex encoded subkey id

     <p><var>format</var>: the format of the keys

     <p>This funtion is used to load OpenPGP keys into the GnuTLS credential
structure. The files should contain non encrypted keys.

     <p>The special keyword "auto" is also accepted as &amp;subkey_id. In that case
the <code>gnutls_openpgp_crt_get_auth_subkey()</code> will be used to retrieve the subkey.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_openpgp_key_file</h4>

<p><a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_set_openpgp_key_file</b> (<var>gnutls_certificate_credentials_t res, const char * certfile, const char * keyfile, gnutls_openpgp_crt_fmt_t format</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005ffile-479"></a></var><br>
<blockquote><p><var>res</var>: the destination context to save the data.

     <p><var>certfile</var>: the file that contains the public key.

     <p><var>keyfile</var>: the file that contains the secret key.

     <p><var>format</var>: the format of the keys

     <p>This funtion is used to load OpenPGP keys into the GnuTLS
credentials structure.  The files should only contain one key which
is not encrypted.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_openpgp_key_mem2</h4>

<p><a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005fmem2"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_set_openpgp_key_mem2</b> (<var>gnutls_certificate_credentials_t res, const gnutls_datum_t * icert, const gnutls_datum_t * ikey, const char * subkey_id, gnutls_openpgp_crt_fmt_t format</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005fmem2-480"></a></var><br>
<blockquote><p><var>res</var>: the destination context to save the data.

     <p><var>subkey_id</var>: a hex encoded subkey id

     <p><var>format</var>: the format of the keys

     <p>This funtion is used to load OpenPGP keys into the GnuTLS
credentials structure.  The files should only contain one key which
is not encrypted.

     <p>The special keyword "auto" is also accepted as &amp;subkey_id. In that
case the <code>gnutls_openpgp_crt_get_auth_subkey()</code> will be used to
retrieve the subkey.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_openpgp_key_mem</h4>

<p><a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005fmem"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_set_openpgp_key_mem</b> (<var>gnutls_certificate_credentials_t res, const gnutls_datum_t * icert, const gnutls_datum_t * ikey, gnutls_openpgp_crt_fmt_t format</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005fmem-481"></a></var><br>
<blockquote><p><var>res</var>: the destination context to save the data.

     <p><var>format</var>: the format of the keys

     <p>This funtion is used to load OpenPGP keys into the GnuTLS credential
structure. The files should contain non encrypted keys.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_openpgp_keyring_file</h4>

<p><a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkeyring_005ffile"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_set_openpgp_keyring_file</b> (<var>gnutls_certificate_credentials_t c, const char * file, gnutls_openpgp_crt_fmt_t format</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fopenpgp_005fkeyring_005ffile-482"></a></var><br>
<blockquote><p><var>c</var>: A certificate credentials structure

     <p><var>file</var>: filename of the keyring.

     <p>The function is used to set keyrings that will be used internally
by various OpenPGP functions. For example to find a key when it
is needed for an operations. The keyring will also be used at the
verification functions.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_openpgp_keyring_mem</h4>

<p><a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkeyring_005fmem"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_set_openpgp_keyring_mem</b> (<var>gnutls_certificate_credentials_t c, const opaque * data, size_t dlen, gnutls_openpgp_crt_fmt_t format</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fopenpgp_005fkeyring_005fmem-483"></a></var><br>
<blockquote><p><var>c</var>: A certificate credentials structure

     <p><var>data</var>: buffer with keyring data.

     <p><var>dlen</var>: length of data buffer.

     <p>The function is used to set keyrings that will be used internally
by various OpenPGP functions. For example to find a key when it
is needed for an operations. The keyring will also be used at the
verification functions.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_certificate_set_openpgp_key</h4>

<p><a name="gnutls_005fcertificate_005fset_005fopenpgp_005fkey"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_certificate_set_openpgp_key</b> (<var>gnutls_certificate_credentials_t res, gnutls_openpgp_crt_t crt, gnutls_openpgp_privkey_t pkey</var>)<var><a name="index-gnutls_005fcertificate_005fset_005fopenpgp_005fkey-484"></a></var><br>
<blockquote><p><var>res</var>: is an <code>gnutls_certificate_credentials_t</code> structure.

     <p><var>pkey</var>: is an openpgp private key

     <p>This function sets a certificate/private key pair in the
gnutls_certificate_credentials_t structure. This function may be called
more than once (in case multiple keys/certificates exist for the
server).

     <p>With this function the subkeys of the certificate are not used. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_check_hostname</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fcheck_005fhostname"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_check_hostname</b> (<var>gnutls_openpgp_crt_t key, const char * hostname</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fcheck_005fhostname-485"></a></var><br>
<blockquote><p><var>key</var>: should contain an <code>gnutls_openpgp_crt_t</code> structure

     <p><var>hostname</var>: A null terminated string that contains a DNS name

     <p>This function will check if the given key's owner matches the
given hostname. This is a basic implementation of the matching
described in RFC2818 (HTTPS), which takes into account wildcards.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_deinit</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fdeinit"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_openpgp_crt_deinit</b> (<var>gnutls_openpgp_crt_t key</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fdeinit-486"></a></var><br>
<blockquote><p><var>key</var>: The structure to be initialized

     <p>This function will deinitialize a key structure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_export</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fexport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_export</b> (<var>gnutls_openpgp_crt_t key, gnutls_openpgp_crt_fmt_t format, void * output_data, size_t * output_data_size</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fexport-487"></a></var><br>
<blockquote><p><var>key</var>: Holds the key.

     <p><var>format</var>: One of gnutls_openpgp_crt_fmt_t elements.

     <p><var>output_data</var>: will contain the key base64 encoded or raw

     <p><var>output_data_size</var>: holds the size of output_data (and will
be replaced by the actual size of parameters)

     <p>This function will convert the given key to RAW or Base64 format. 
If the buffer provided is not long enough to hold the output, then
<code>GNUTLS_E_SHORT_MEMORY_BUFFER</code> will be returned.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_auth_subkey</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fauth_005fsubkey"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_auth_subkey</b> (<var>gnutls_openpgp_crt_t crt, gnutls_openpgp_keyid_t keyid, unsigned int flag</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fauth_005fsubkey-488"></a></var><br>
<blockquote><p><var>keyid</var>: the struct to save the keyid.

     <p><var>flag</var>: Non zero indicates that a valid subkey is always returned.

     <p>Returns the 64-bit keyID of the first valid OpenPGP subkey marked
for authentication.  If flag is non zero and no authentication
subkey exists, then a valid subkey will be returned even if it is
not marked for authentication. 
Returns the 64-bit keyID of the first valid OpenPGP subkey marked
for authentication.  If flag is non zero and no authentication
subkey exists, then a valid subkey will be returned even if it is
not marked for authentication.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_creation_time</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fcreation_005ftime"></a>

<div class="defun">
&mdash; Function: time_t <b>gnutls_openpgp_crt_get_creation_time</b> (<var>gnutls_openpgp_crt_t key</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fcreation_005ftime-489"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP public key.

     <p>Get key creation time.

     <p><strong>Returns:</strong> the timestamp when the OpenPGP key was created. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_expiration_time</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fexpiration_005ftime"></a>

<div class="defun">
&mdash; Function: time_t <b>gnutls_openpgp_crt_get_expiration_time</b> (<var>gnutls_openpgp_crt_t key</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fexpiration_005ftime-490"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP public key.

     <p>Get key expiration time.  A value of '0' means that the key doesn't
expire at all.

     <p><strong>Returns:</strong> the time when the OpenPGP key expires. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_fingerprint</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005ffingerprint"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_fingerprint</b> (<var>gnutls_openpgp_crt_t key, void * fpr, size_t * fprlen</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005ffingerprint-491"></a></var><br>
<blockquote><p><var>key</var>: the raw data that contains the OpenPGP public key.

     <p><var>fpr</var>: the buffer to save the fingerprint, must hold at least 20 bytes.

     <p><var>fprlen</var>: the integer to save the length of the fingerprint.

     <p>Get key fingerprint.  Depending on the algorithm, the fingerprint
can be 16 or 20 bytes.

     <p><strong>Returns:</strong> On success, 0 is returned.  Otherwise, an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_key_id</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fkey_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_key_id</b> (<var>gnutls_openpgp_crt_t key, gnutls_openpgp_keyid_t keyid</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fkey_005fid-492"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP public key.

     <p><var>keyid</var>: the buffer to save the keyid.

     <p>Get key id string.

     <p><strong>Returns:</strong> the 64-bit keyID of the OpenPGP key.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_key_usage</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fkey_005fusage"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_key_usage</b> (<var>gnutls_openpgp_crt_t key, unsigned int * key_usage</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fkey_005fusage-493"></a></var><br>
<blockquote><p><var>key</var>: should contain a gnutls_openpgp_crt_t structure

     <p><var>key_usage</var>: where the key usage bits will be stored

     <p>This function will return certificate's key usage, by checking the
key algorithm. The key usage value will ORed values of the:
<code>GNUTLS_KEY_DIGITAL_SIGNATURE</code>, <code>GNUTLS_KEY_KEY_ENCIPHERMENT</code>.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_name</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fname"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_name</b> (<var>gnutls_openpgp_crt_t key, int idx, char * buf, size_t * sizeof_buf</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fname-494"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP public key.

     <p><var>idx</var>: the index of the ID to extract

     <p><var>buf</var>: a pointer to a structure to hold the name

     <p><var>sizeof_buf</var>: holds the maximum size of <code>buf</code>, on return hold the
actual/required size of <code>buf</code>.

     <p>Extracts the userID from the parsed OpenPGP key.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, and if the index of the ID
does not exist <code>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</code>, or an
error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_pk_algorithm</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fpk_005falgorithm"></a>

<div class="defun">
&mdash; Function: gnutls_pk_algorithm_t <b>gnutls_openpgp_crt_get_pk_algorithm</b> (<var>gnutls_openpgp_crt_t key, unsigned int * bits</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fpk_005falgorithm-495"></a></var><br>
<blockquote><p><var>key</var>: is an OpenPGP key

     <p><var>bits</var>: if bits is non null it will hold the size of the parameters' in bits

     <p>This function will return the public key algorithm of an OpenPGP
certificate.

     <p>If bits is non null, it should have enough size to hold the parameters
size in bits. For RSA the bits returned is the modulus. 
For DSA the bits returned are of the public exponent.

     <p><strong>Returns:</strong> a member of the <code>gnutls_pk_algorithm_t</code> enumeration on
success, or a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_pk_dsa_raw</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fpk_005fdsa_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_pk_dsa_raw</b> (<var>gnutls_openpgp_crt_t crt, gnutls_datum_t * p, gnutls_datum_t * q, gnutls_datum_t * g, gnutls_datum_t * y</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fpk_005fdsa_005fraw-496"></a></var><br>
<blockquote><p><var>crt</var>: Holds the certificate

     <p><var>p</var>: will hold the p

     <p><var>q</var>: will hold the q

     <p><var>g</var>: will hold the g

     <p><var>y</var>: will hold the y

     <p>This function will export the DSA public key's parameters found in
the given certificate.  The new parameters will be allocated using
<code>gnutls_malloc()</code> and will be stored in the appropriate datum.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_pk_rsa_raw</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fpk_005frsa_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_pk_rsa_raw</b> (<var>gnutls_openpgp_crt_t crt, gnutls_datum_t * m, gnutls_datum_t * e</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fpk_005frsa_005fraw-497"></a></var><br>
<blockquote><p><var>crt</var>: Holds the certificate

     <p><var>m</var>: will hold the modulus

     <p><var>e</var>: will hold the public exponent

     <p>This function will export the RSA public key's parameters found in
the given structure.  The new parameters will be allocated using
<code>gnutls_malloc()</code> and will be stored in the appropriate datum.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_preferred_key_id</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fpreferred_005fkey_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_preferred_key_id</b> (<var>gnutls_openpgp_crt_t key, gnutls_openpgp_keyid_t keyid</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fpreferred_005fkey_005fid-498"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP public key.

     <p><var>keyid</var>: the struct to save the keyid.

     <p>Get preferred key id.  If it hasn't been set it returns
<code>GNUTLS_E_INVALID_REQUEST</code>.

     <p><strong>Returns:</strong> the 64-bit preferred keyID of the OpenPGP key. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_revoked_status</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005frevoked_005fstatus"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_revoked_status</b> (<var>gnutls_openpgp_crt_t key</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005frevoked_005fstatus-499"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP public key.

     <p>Get revocation status of key.

     <p><strong>Returns:</strong> true (1) if the key has been revoked, or false (0) if it
has not.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_subkey_count</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fcount"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_subkey_count</b> (<var>gnutls_openpgp_crt_t key</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fcount-500"></a></var><br>
<blockquote><p><var>key</var>: is an OpenPGP key

     <p>This function will return the number of subkeys present in the
given OpenPGP certificate.

     <p><strong>Returns:</strong> the number of subkeys, or a negative value on error.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_subkey_creation_time</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fcreation_005ftime"></a>

<div class="defun">
&mdash; Function: time_t <b>gnutls_openpgp_crt_get_subkey_creation_time</b> (<var>gnutls_openpgp_crt_t key, unsigned int idx</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fcreation_005ftime-501"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP public key.

     <p><var>idx</var>: the subkey index

     <p>Get subkey creation time.

     <p><strong>Returns:</strong> the timestamp when the OpenPGP sub-key was created.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_subkey_expiration_time</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fexpiration_005ftime"></a>

<div class="defun">
&mdash; Function: time_t <b>gnutls_openpgp_crt_get_subkey_expiration_time</b> (<var>gnutls_openpgp_crt_t key, unsigned int idx</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fexpiration_005ftime-502"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP public key.

     <p><var>idx</var>: the subkey index

     <p>Get subkey expiration time.  A value of '0' means that the key
doesn't expire at all.

     <p><strong>Returns:</strong> the time when the OpenPGP key expires.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_subkey_fingerprint</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005ffingerprint"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_subkey_fingerprint</b> (<var>gnutls_openpgp_crt_t key, unsigned int idx, void * fpr, size_t * fprlen</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005ffingerprint-503"></a></var><br>
<blockquote><p><var>key</var>: the raw data that contains the OpenPGP public key.

     <p><var>idx</var>: the subkey index

     <p><var>fpr</var>: the buffer to save the fingerprint, must hold at least 20 bytes.

     <p><var>fprlen</var>: the integer to save the length of the fingerprint.

     <p>Get key fingerprint of a subkey.  Depending on the algorithm, the
fingerprint can be 16 or 20 bytes.

     <p><strong>Returns:</strong> On success, 0 is returned.  Otherwise, an error code.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_subkey_idx</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fidx"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_subkey_idx</b> (<var>gnutls_openpgp_crt_t key, const gnutls_openpgp_keyid_t keyid</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fidx-504"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP public key.

     <p><var>keyid</var>: the keyid.

     <p>Get subkey's index.

     <p><strong>Returns:</strong> the index of the subkey or a negative error value.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_subkey_id</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_subkey_id</b> (<var>gnutls_openpgp_crt_t key, unsigned int idx, gnutls_openpgp_keyid_t keyid</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fid-505"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP public key.

     <p><var>idx</var>: the subkey index

     <p><var>keyid</var>: the buffer to save the keyid.

     <p>Get the subkey's key-id.

     <p><strong>Returns:</strong> the 64-bit keyID of the OpenPGP key. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_subkey_pk_algorithm</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005falgorithm"></a>

<div class="defun">
&mdash; Function: gnutls_pk_algorithm_t <b>gnutls_openpgp_crt_get_subkey_pk_algorithm</b> (<var>gnutls_openpgp_crt_t key, unsigned int idx, unsigned int * bits</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005falgorithm-506"></a></var><br>
<blockquote><p><var>key</var>: is an OpenPGP key

     <p><var>idx</var>: is the subkey index

     <p><var>bits</var>: if bits is non null it will hold the size of the parameters' in bits

     <p>This function will return the public key algorithm of a subkey of an OpenPGP
certificate.

     <p>If bits is non null, it should have enough size to hold the
parameters size in bits.  For RSA the bits returned is the modulus. 
For DSA the bits returned are of the public exponent.

     <p><strong>Returns:</strong> a member of the <code>gnutls_pk_algorithm_t</code> enumeration on
success, or a negative value on error.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_subkey_pk_dsa_raw</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005fdsa_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_subkey_pk_dsa_raw</b> (<var>gnutls_openpgp_crt_t crt, unsigned int idx, gnutls_datum_t * p, gnutls_datum_t * q, gnutls_datum_t * g, gnutls_datum_t * y</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005fdsa_005fraw-507"></a></var><br>
<blockquote><p><var>crt</var>: Holds the certificate

     <p><var>idx</var>: Is the subkey index

     <p><var>p</var>: will hold the p

     <p><var>q</var>: will hold the q

     <p><var>g</var>: will hold the g

     <p><var>y</var>: will hold the y

     <p>This function will export the DSA public key's parameters found in
the given certificate.  The new parameters will be allocated using
<code>gnutls_malloc()</code> and will be stored in the appropriate datum.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_subkey_pk_rsa_raw</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005frsa_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_subkey_pk_rsa_raw</b> (<var>gnutls_openpgp_crt_t crt, unsigned int idx, gnutls_datum_t * m, gnutls_datum_t * e</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005frsa_005fraw-508"></a></var><br>
<blockquote><p><var>crt</var>: Holds the certificate

     <p><var>idx</var>: Is the subkey index

     <p><var>m</var>: will hold the modulus

     <p><var>e</var>: will hold the public exponent

     <p>This function will export the RSA public key's parameters found in
the given structure.  The new parameters will be allocated using
<code>gnutls_malloc()</code> and will be stored in the appropriate datum.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_subkey_revoked_status</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005frevoked_005fstatus"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_subkey_revoked_status</b> (<var>gnutls_openpgp_crt_t key, unsigned int idx</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005frevoked_005fstatus-509"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP public key.

     <p><var>idx</var>: is the subkey index

     <p>Get subkey revocation status.  A negative value indicates an error.

     <p><strong>Returns:</strong> true (1) if the key has been revoked, or false (0) if it
has not.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_subkey_usage</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fusage"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_subkey_usage</b> (<var>gnutls_openpgp_crt_t key, unsigned int idx, unsigned int * key_usage</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fusage-510"></a></var><br>
<blockquote><p><var>key</var>: should contain a gnutls_openpgp_crt_t structure

     <p><var>idx</var>: the subkey index

     <p><var>key_usage</var>: where the key usage bits will be stored

     <p>This function will return certificate's key usage, by checking the
key algorithm.  The key usage value will ORed values of
<code>GNUTLS_KEY_DIGITAL_SIGNATURE</code> or <code>GNUTLS_KEY_KEY_ENCIPHERMENT</code>.

     <p>A negative value may be returned in case of parsing error.

     <p><strong>Returns:</strong> key usage value.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_get_version</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fget_005fversion"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_get_version</b> (<var>gnutls_openpgp_crt_t key</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fget_005fversion-511"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP public key.

     <p>Extract the version of the OpenPGP key.

     <p><strong>Returns:</strong> the version number is returned, or a negative value on errors. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_import</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fimport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_import</b> (<var>gnutls_openpgp_crt_t key, const gnutls_datum_t * data, gnutls_openpgp_crt_fmt_t format</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fimport-512"></a></var><br>
<blockquote><p><var>key</var>: The structure to store the parsed key.

     <p><var>data</var>: The RAW or BASE64 encoded key.

     <p><var>format</var>: One of gnutls_openpgp_crt_fmt_t elements.

     <p>This function will convert the given RAW or Base64 encoded key to
the native <code>gnutls_openpgp_crt_t</code> format. The output will be stored
in 'key'.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_init</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005finit"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_init</b> (<var>gnutls_openpgp_crt_t * key</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005finit-513"></a></var><br>
<blockquote><p><var>key</var>: The structure to be initialized

     <p>This function will initialize an OpenPGP key structure.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_print</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fprint"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_print</b> (<var>gnutls_openpgp_crt_t cert, gnutls_certificate_print_formats_t format, gnutls_datum_t * out</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fprint-514"></a></var><br>
<blockquote><p><var>cert</var>: The structure to be printed

     <p><var>format</var>: Indicate the format to use

     <p><var>out</var>: Newly allocated datum with zero terminated string.

     <p>This function will pretty print an OpenPGP certificate, suitable
for display to a human.

     <p>The format should be zero for future compatibility.

     <p>The output <code>out</code> needs to be deallocate using <code>gnutls_free()</code>.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_set_preferred_key_id</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fset_005fpreferred_005fkey_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_set_preferred_key_id</b> (<var>gnutls_openpgp_crt_t key, const gnutls_openpgp_keyid_t keyid</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fset_005fpreferred_005fkey_005fid-515"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP public key.

     <p><var>keyid</var>: the selected keyid

     <p>This allows setting a preferred key id for the given certificate. 
This key will be used by functions that involve key handling. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_verify_ring</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fverify_005fring"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_verify_ring</b> (<var>gnutls_openpgp_crt_t key, gnutls_openpgp_keyring_t keyring, unsigned int flags, unsigned int * verify</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fverify_005fring-516"></a></var><br>
<blockquote><p><var>key</var>: the structure that holds the key.

     <p><var>keyring</var>: holds the keyring to check against

     <p><var>flags</var>: unused (should be 0)

     <p><var>verify</var>: will hold the certificate verification output.

     <p>Verify all signatures in the key, using the given set of keys
(keyring).

     <p>The key verification output will be put in <code>verify</code> and will be one
or more of the <code>gnutls_certificate_status_t</code> enumerated elements
bitwise or'd.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_crt_verify_self</h4>

<p><a name="gnutls_005fopenpgp_005fcrt_005fverify_005fself"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_crt_verify_self</b> (<var>gnutls_openpgp_crt_t key, unsigned int flags, unsigned int * verify</var>)<var><a name="index-gnutls_005fopenpgp_005fcrt_005fverify_005fself-517"></a></var><br>
<blockquote><p><var>key</var>: the structure that holds the key.

     <p><var>flags</var>: unused (should be 0)

     <p><var>verify</var>: will hold the key verification output.

     <p>Verifies the self signature in the key.  The key verification
output will be put in <code>verify</code> and will be one or more of the
gnutls_certificate_status_t enumerated elements bitwise or'd.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_keyring_check_id</h4>

<p><a name="gnutls_005fopenpgp_005fkeyring_005fcheck_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_keyring_check_id</b> (<var>gnutls_openpgp_keyring_t ring, const gnutls_openpgp_keyid_t keyid, unsigned int flags</var>)<var><a name="index-gnutls_005fopenpgp_005fkeyring_005fcheck_005fid-518"></a></var><br>
<blockquote><p><var>ring</var>: holds the keyring to check against

     <p><var>keyid</var>: will hold the keyid to check for.

     <p><var>flags</var>: unused (should be 0)

     <p>Check if a given key ID exists in the keyring.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success (if keyid exists) and a
negative error code on failure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_keyring_deinit</h4>

<p><a name="gnutls_005fopenpgp_005fkeyring_005fdeinit"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_openpgp_keyring_deinit</b> (<var>gnutls_openpgp_keyring_t keyring</var>)<var><a name="index-gnutls_005fopenpgp_005fkeyring_005fdeinit-519"></a></var><br>
<blockquote><p><var>keyring</var>: The structure to be initialized

     <p>This function will deinitialize a keyring structure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_keyring_get_crt_count</h4>

<p><a name="gnutls_005fopenpgp_005fkeyring_005fget_005fcrt_005fcount"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_keyring_get_crt_count</b> (<var>gnutls_openpgp_keyring_t ring</var>)<var><a name="index-gnutls_005fopenpgp_005fkeyring_005fget_005fcrt_005fcount-520"></a></var><br>
<blockquote><p><var>ring</var>: is an OpenPGP key ring

     <p>This function will return the number of OpenPGP certificates
present in the given keyring.

     <p><strong>Returns:</strong> the number of subkeys, or a negative value on error. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_keyring_get_crt</h4>

<p><a name="gnutls_005fopenpgp_005fkeyring_005fget_005fcrt"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_keyring_get_crt</b> (<var>gnutls_openpgp_keyring_t ring, unsigned int idx, gnutls_openpgp_crt_t * cert</var>)<var><a name="index-gnutls_005fopenpgp_005fkeyring_005fget_005fcrt-521"></a></var><br>
<blockquote><p><var>idx</var>: the index of the certificate to export

     <p>This function will extract an OpenPGP certificate from the given
keyring.  If the index given is out of range
<code>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE</code> will be returned. The
returned structure needs to be deinited.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_keyring_import</h4>

<p><a name="gnutls_005fopenpgp_005fkeyring_005fimport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_keyring_import</b> (<var>gnutls_openpgp_keyring_t keyring, const gnutls_datum_t * data, gnutls_openpgp_crt_fmt_t format</var>)<var><a name="index-gnutls_005fopenpgp_005fkeyring_005fimport-522"></a></var><br>
<blockquote><p><var>keyring</var>: The structure to store the parsed key.

     <p><var>data</var>: The RAW or BASE64 encoded keyring.

     <p><var>format</var>: One of <code>gnutls_openpgp_keyring_fmt</code> elements.

     <p>This function will convert the given RAW or Base64 encoded keyring
to the native <code>gnutls_openpgp_keyring_t</code> format.  The output will be
stored in 'keyring'.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_keyring_init</h4>

<p><a name="gnutls_005fopenpgp_005fkeyring_005finit"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_keyring_init</b> (<var>gnutls_openpgp_keyring_t * keyring</var>)<var><a name="index-gnutls_005fopenpgp_005fkeyring_005finit-523"></a></var><br>
<blockquote><p><var>keyring</var>: The structure to be initialized

     <p>This function will initialize an keyring structure.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_deinit</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fdeinit"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_openpgp_privkey_deinit</b> (<var>gnutls_openpgp_privkey_t key</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fdeinit-524"></a></var><br>
<blockquote><p><var>key</var>: The structure to be initialized

     <p>This function will deinitialize a key structure. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_export_dsa_raw</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fexport_005fdsa_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_export_dsa_raw</b> (<var>gnutls_openpgp_privkey_t pkey, gnutls_datum_t * p, gnutls_datum_t * q, gnutls_datum_t * g, gnutls_datum_t * y, gnutls_datum_t * x</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fexport_005fdsa_005fraw-525"></a></var><br>
<blockquote><p><var>pkey</var>: Holds the certificate

     <p><var>p</var>: will hold the p

     <p><var>q</var>: will hold the q

     <p><var>g</var>: will hold the g

     <p><var>y</var>: will hold the y

     <p><var>x</var>: will hold the x

     <p>This function will export the DSA private key's parameters found in
the given certificate.  The new parameters will be allocated using
<code>gnutls_malloc()</code> and will be stored in the appropriate datum.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_export_rsa_raw</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fexport_005frsa_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_export_rsa_raw</b> (<var>gnutls_openpgp_privkey_t pkey, gnutls_datum_t * m, gnutls_datum_t * e, gnutls_datum_t * d, gnutls_datum_t * p, gnutls_datum_t * q, gnutls_datum_t * u</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fexport_005frsa_005fraw-526"></a></var><br>
<blockquote><p><var>pkey</var>: Holds the certificate

     <p><var>m</var>: will hold the modulus

     <p><var>e</var>: will hold the public exponent

     <p><var>d</var>: will hold the private exponent

     <p><var>p</var>: will hold the first prime (p)

     <p><var>q</var>: will hold the second prime (q)

     <p><var>u</var>: will hold the coefficient

     <p>This function will export the RSA private key's parameters found in
the given structure.  The new parameters will be allocated using
<code>gnutls_malloc()</code> and will be stored in the appropriate datum.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_export_subkey_dsa_raw</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fexport_005fsubkey_005fdsa_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_export_subkey_dsa_raw</b> (<var>gnutls_openpgp_privkey_t pkey, unsigned int idx, gnutls_datum_t * p, gnutls_datum_t * q, gnutls_datum_t * g, gnutls_datum_t * y, gnutls_datum_t * x</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fexport_005fsubkey_005fdsa_005fraw-527"></a></var><br>
<blockquote><p><var>pkey</var>: Holds the certificate

     <p><var>idx</var>: Is the subkey index

     <p><var>p</var>: will hold the p

     <p><var>q</var>: will hold the q

     <p><var>g</var>: will hold the g

     <p><var>y</var>: will hold the y

     <p><var>x</var>: will hold the x

     <p>This function will export the DSA private key's parameters found
in the given certificate.  The new parameters will be allocated
using <code>gnutls_malloc()</code> and will be stored in the appropriate datum.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_export_subkey_rsa_raw</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fexport_005fsubkey_005frsa_005fraw"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_export_subkey_rsa_raw</b> (<var>gnutls_openpgp_privkey_t pkey, unsigned int idx, gnutls_datum_t * m, gnutls_datum_t * e, gnutls_datum_t * d, gnutls_datum_t * p, gnutls_datum_t * q, gnutls_datum_t * u</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fexport_005fsubkey_005frsa_005fraw-528"></a></var><br>
<blockquote><p><var>pkey</var>: Holds the certificate

     <p><var>idx</var>: Is the subkey index

     <p><var>m</var>: will hold the modulus

     <p><var>e</var>: will hold the public exponent

     <p><var>d</var>: will hold the private exponent

     <p><var>p</var>: will hold the first prime (p)

     <p><var>q</var>: will hold the second prime (q)

     <p><var>u</var>: will hold the coefficient

     <p>This function will export the RSA private key's parameters found in
the given structure.  The new parameters will be allocated using
<code>gnutls_malloc()</code> and will be stored in the appropriate datum.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, otherwise an error.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_export</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fexport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_export</b> (<var>gnutls_openpgp_privkey_t key, gnutls_openpgp_crt_fmt_t format, const char * password, unsigned int flags, void * output_data, size_t * output_data_size</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fexport-529"></a></var><br>
<blockquote><p><var>key</var>: Holds the key.

     <p><var>format</var>: One of gnutls_openpgp_crt_fmt_t elements.

     <p><var>password</var>: the password that will be used to encrypt the key. (unused for now)

     <p><var>flags</var>: zero for future compatibility

     <p><var>output_data</var>: will contain the key base64 encoded or raw

     <p><var>output_data_size</var>: holds the size of output_data (and will be
replaced by the actual size of parameters)

     <p>This function will convert the given key to RAW or Base64 format. 
If the buffer provided is not long enough to hold the output, then
GNUTLS_E_SHORT_MEMORY_BUFFER will be returned.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_get_fingerprint</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fget_005ffingerprint"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_get_fingerprint</b> (<var>gnutls_openpgp_privkey_t key, void * fpr, size_t * fprlen</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005ffingerprint-530"></a></var><br>
<blockquote><p><var>key</var>: the raw data that contains the OpenPGP secret key.

     <p><var>fpr</var>: the buffer to save the fingerprint, must hold at least 20 bytes.

     <p><var>fprlen</var>: the integer to save the length of the fingerprint.

     <p>Get the fingerprint of the OpenPGP key. Depends on the
algorithm, the fingerprint can be 16 or 20 bytes.

     <p><strong>Returns:</strong> On success, 0 is returned, or an error code.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_get_key_id</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fget_005fkey_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_get_key_id</b> (<var>gnutls_openpgp_privkey_t key, gnutls_openpgp_keyid_t keyid</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fkey_005fid-531"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP secret key.

     <p><var>keyid</var>: the buffer to save the keyid.

     <p>Get key-id.

     <p><strong>Returns:</strong> the 64-bit keyID of the OpenPGP key.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_get_pk_algorithm</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fget_005fpk_005falgorithm"></a>

<div class="defun">
&mdash; Function: gnutls_pk_algorithm_t <b>gnutls_openpgp_privkey_get_pk_algorithm</b> (<var>gnutls_openpgp_privkey_t key, unsigned int * bits</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fpk_005falgorithm-532"></a></var><br>
<blockquote><p><var>key</var>: is an OpenPGP key

     <p><var>bits</var>: if bits is non null it will hold the size of the parameters' in bits

     <p>This function will return the public key algorithm of an OpenPGP
certificate.

     <p>If bits is non null, it should have enough size to hold the parameters
size in bits. For RSA the bits returned is the modulus. 
For DSA the bits returned are of the public exponent.

     <p><strong>Returns:</strong> a member of the <code>gnutls_pk_algorithm_t</code> enumeration on
success, or a negative value on error.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_get_preferred_key_id</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fget_005fpreferred_005fkey_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_get_preferred_key_id</b> (<var>gnutls_openpgp_privkey_t key, gnutls_openpgp_keyid_t keyid</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fpreferred_005fkey_005fid-533"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP public key.

     <p><var>keyid</var>: the struct to save the keyid.

     <p>Get the preferred key-id for the key.

     <p><strong>Returns:</strong> the 64-bit preferred keyID of the OpenPGP key, or if it
hasn't been set it returns <code>GNUTLS_E_INVALID_REQUEST</code>. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_get_revoked_status</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fget_005frevoked_005fstatus"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_get_revoked_status</b> (<var>gnutls_openpgp_privkey_t key</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005frevoked_005fstatus-534"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP private key.

     <p>Get revocation status of key.

     <p><strong>Returns:</strong> true (1) if the key has been revoked, or false (0) if it
has not, or a negative value indicates an error.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_get_subkey_count</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fcount"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_get_subkey_count</b> (<var>gnutls_openpgp_privkey_t key</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fcount-535"></a></var><br>
<blockquote><p><var>key</var>: is an OpenPGP key

     <p>This function will return the number of subkeys present in the
given OpenPGP certificate.

     <p><strong>Returns:</strong> the number of subkeys, or a negative value on error.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_get_subkey_creation_time</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fcreation_005ftime"></a>

<div class="defun">
&mdash; Function: time_t <b>gnutls_openpgp_privkey_get_subkey_creation_time</b> (<var>gnutls_openpgp_privkey_t key, unsigned int idx</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fcreation_005ftime-536"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP private key.

     <p><var>idx</var>: the subkey index

     <p>Get subkey creation time.

     <p><strong>Returns:</strong> the timestamp when the OpenPGP key was created.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_get_subkey_expiration_time</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fexpiration_005ftime"></a>

<div class="defun">
&mdash; Function: time_t <b>gnutls_openpgp_privkey_get_subkey_expiration_time</b> (<var>gnutls_openpgp_privkey_t key, unsigned int idx</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fexpiration_005ftime-537"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP private key.

     <p><var>idx</var>: the subkey index

     <p>Get subkey expiration time.  A value of '0' means that the key
doesn't expire at all.

     <p><strong>Returns:</strong> the time when the OpenPGP key expires.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_get_subkey_fingerprint</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005ffingerprint"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_get_subkey_fingerprint</b> (<var>gnutls_openpgp_privkey_t key, unsigned int idx, void * fpr, size_t * fprlen</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005ffingerprint-538"></a></var><br>
<blockquote><p><var>key</var>: the raw data that contains the OpenPGP secret key.

     <p><var>idx</var>: the subkey index

     <p><var>fpr</var>: the buffer to save the fingerprint, must hold at least 20 bytes.

     <p><var>fprlen</var>: the integer to save the length of the fingerprint.

     <p>Get the fingerprint of an OpenPGP subkey.  Depends on the
algorithm, the fingerprint can be 16 or 20 bytes.

     <p><strong>Returns:</strong> On success, 0 is returned, or an error code.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_get_subkey_idx</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fidx"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_get_subkey_idx</b> (<var>gnutls_openpgp_privkey_t key, const gnutls_openpgp_keyid_t keyid</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fidx-539"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP private key.

     <p><var>keyid</var>: the keyid.

     <p>Get index of subkey.

     <p><strong>Returns:</strong> the index of the subkey or a negative error value.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_get_subkey_id</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_get_subkey_id</b> (<var>gnutls_openpgp_privkey_t key, unsigned int idx, gnutls_openpgp_keyid_t keyid</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fid-540"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP secret key.

     <p><var>idx</var>: the subkey index

     <p><var>keyid</var>: the buffer to save the keyid.

     <p>Get the key-id for the subkey.

     <p><strong>Returns:</strong> the 64-bit keyID of the OpenPGP key.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_get_subkey_pk_algorithm</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fpk_005falgorithm"></a>

<div class="defun">
&mdash; Function: gnutls_pk_algorithm_t <b>gnutls_openpgp_privkey_get_subkey_pk_algorithm</b> (<var>gnutls_openpgp_privkey_t key, unsigned int idx, unsigned int * bits</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fpk_005falgorithm-541"></a></var><br>
<blockquote><p><var>key</var>: is an OpenPGP key

     <p><var>idx</var>: is the subkey index

     <p><var>bits</var>: if bits is non null it will hold the size of the parameters' in bits

     <p>This function will return the public key algorithm of a subkey of an OpenPGP
certificate.

     <p>If bits is non null, it should have enough size to hold the parameters
size in bits. For RSA the bits returned is the modulus. 
For DSA the bits returned are of the public exponent.

     <p><strong>Returns:</strong> a member of the <code>gnutls_pk_algorithm_t</code> enumeration on
success, or a negative value on error.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_get_subkey_revoked_status</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005frevoked_005fstatus"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_get_subkey_revoked_status</b> (<var>gnutls_openpgp_privkey_t key, unsigned int idx</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005frevoked_005fstatus-542"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP private key.

     <p><var>idx</var>: is the subkey index

     <p>Get revocation status of key.

     <p><strong>Returns:</strong> true (1) if the key has been revoked, or false (0) if it
has not, or a negative value indicates an error.

     <p><strong>Since:</strong> 2.4.0
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_import</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fimport"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_import</b> (<var>gnutls_openpgp_privkey_t key, const gnutls_datum_t * data, gnutls_openpgp_crt_fmt_t format, const char * password, unsigned int flags</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fimport-543"></a></var><br>
<blockquote><p><var>key</var>: The structure to store the parsed key.

     <p><var>data</var>: The RAW or BASE64 encoded key.

     <p><var>format</var>: One of gnutls_openpgp_crt_fmt_t elements.

     <p><var>password</var>: (unused for now)

     <p><var>flags</var>: should be zero

     <p>This function will convert the given RAW or Base64 encoded key to
the native gnutls_openpgp_privkey_t format.  The output will be
stored in 'key'.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_init</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005finit"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_init</b> (<var>gnutls_openpgp_privkey_t * key</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005finit-544"></a></var><br>
<blockquote><p><var>key</var>: The structure to be initialized

     <p>This function will initialize an OpenPGP key structure.

     <p><strong>Returns:</strong> <code>GNUTLS_E_SUCCESS</code> on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_set_preferred_key_id</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fset_005fpreferred_005fkey_005fid"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_set_preferred_key_id</b> (<var>gnutls_openpgp_privkey_t key, const gnutls_openpgp_keyid_t keyid</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fset_005fpreferred_005fkey_005fid-545"></a></var><br>
<blockquote><p><var>key</var>: the structure that contains the OpenPGP public key.

     <p><var>keyid</var>: the selected keyid

     <p>This allows setting a preferred key id for the given certificate. 
This key will be used by functions that involve key handling.

     <p><strong>Returns:</strong> On success, 0 is returned, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_privkey_sign_hash</h4>

<p><a name="gnutls_005fopenpgp_005fprivkey_005fsign_005fhash"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_openpgp_privkey_sign_hash</b> (<var>gnutls_openpgp_privkey_t key, const gnutls_datum_t * hash, gnutls_datum_t * signature</var>)<var><a name="index-gnutls_005fopenpgp_005fprivkey_005fsign_005fhash-546"></a></var><br>
<blockquote><p><var>key</var>: Holds the key

     <p><var>hash</var>: holds the data to be signed

     <p><var>signature</var>: will contain newly allocated signature

     <p>This function will sign the given hash using the private key.  You
should use <code>gnutls_openpgp_privkey_set_subkey()</code> before calling this
function to set the subkey to use.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> is returned, otherwise a
negative error value. 
</p></blockquote></div>

<h4 class="subheading">gnutls_openpgp_set_recv_key_function</h4>

<p><a name="gnutls_005fopenpgp_005fset_005frecv_005fkey_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_openpgp_set_recv_key_function</b> (<var>gnutls_session_t session, gnutls_openpgp_recv_key_func func</var>)<var><a name="index-gnutls_005fopenpgp_005fset_005frecv_005fkey_005ffunction-547"></a></var><br>
<blockquote><p><var>session</var>: a TLS session

     <p><var>func</var>: the callback

     <p>This funtion will set a key retrieval function for OpenPGP keys. This
callback is only useful in server side, and will be used if the peer
sent a key fingerprint instead of a full key. 
</p></blockquote></div>

<div class="node">
<a name="TLS-Inner-Application-(TLS%2fIA)-functions"></a>
<a name="TLS-Inner-Application-_0028TLS_002fIA_0029-functions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Error-codes-and-descriptions">Error codes and descriptions</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#OpenPGP-functions">OpenPGP functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Function-reference">Function reference</a>

</div>

<h3 class="section">9.5 <acronym>TLS</acronym> Inner Application (<acronym>TLS/IA</acronym>) Functions</h3>

<p><a name="index-g_t_0040acronym_007bTLS_007d-Inner-Application-_0028_0040acronym_007bTLS_002fIA_007d_0029-functions-548"></a><a name="index-Inner-Application-_0028_0040acronym_007bTLS_002fIA_007d_0029-functions-549"></a>
The following functions are used for <acronym>TLS</acronym> Inner Application
(<acronym>TLS/IA</acronym>).  Their prototypes lie in <samp><span class="file">gnutls/extra.h</span></samp>. 
You need to link with <samp><span class="file">libgnutls-extra</span></samp> to be able to use these
functions (see <a href="#GnuTLS_002dextra-functions">GnuTLS-extra functions</a>).

<p>The typical control flow in an TLS/IA client (that would not require
an Application Phase for resumed sessions) would be similar to the
following:

<pre class="example">     int client_avp (gnuls_session_t *session, void *ptr,
                     const char *last, size_t lastlen,
     		char **new, size_t *newlen)
     {
     ...
     }
     ...
     int main ()
     {
       gnutls_ia_client_credentials_t iacred;
     ...
       gnutls_init (&amp;session, GNUTLS_CLIENT);
     ...
       /* Enable TLS/IA. */
       gnutls_ia_allocate_client_credentials(&amp;iacred);
       gnutls_ia_set_client_avp_function(iacred, client_avp);
       gnutls_credentials_set (session, GNUTLS_CRD_IA, iacred);
     ...
       ret = gnutls_handshake (session);
       // Error handling...
     ...
       if (gnutls_ia_handshake_p (session))
         {
           ret = gnutls_ia_handshake (session);
           // Error handling...
     ...
</pre>
<p>See below for detailed descriptions of all the functions used above.

<p>The function <code>client_avp</code> would have to be implemented by your
application.  The function is responsible for handling the AVP data. 
See <code>gnutls_ia_set_client_avp_function</code> below for more
information on how that function should be implemented.

<p>The control flow in a typical server is similar to the above, use
<code>gnutls_ia_server_credentials_t</code> instead of
<code>gnutls_ia_client_credentials_t</code>, and replace the call to the
client functions with the corresponding server functions.

<h4 class="subheading">gnutls_ia_allocate_client_credentials</h4>

<p><a name="gnutls_005fia_005fallocate_005fclient_005fcredentials"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_ia_allocate_client_credentials</b> (<var>gnutls_ia_client_credentials_t * sc</var>)<var><a name="index-gnutls_005fia_005fallocate_005fclient_005fcredentials-550"></a></var><br>
<blockquote><p><var>sc</var>: is a pointer to an <code>gnutls_ia_server_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus this
helper function is provided in order to allocate it.

     <p>Adding this credential to a session will enable TLS/IA, and will
require an Application Phase after the TLS handshake (if the server
support TLS/IA).  Use <code>gnutls_ia_require_inner_phase()</code> to toggle the
TLS/IA mode.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, otherwise
an error code is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_allocate_server_credentials</h4>

<p><a name="gnutls_005fia_005fallocate_005fserver_005fcredentials"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_ia_allocate_server_credentials</b> (<var>gnutls_ia_server_credentials_t * sc</var>)<var><a name="index-gnutls_005fia_005fallocate_005fserver_005fcredentials-551"></a></var><br>
<blockquote><p><var>sc</var>: is a pointer to an <code>gnutls_ia_server_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus this
helper function is provided in order to allocate it.

     <p>Adding this credential to a session will enable TLS/IA, and will
require an Application Phase after the TLS handshake (if the client
support TLS/IA).  Use <code>gnutls_ia_require_inner_phase()</code> to toggle the
TLS/IA mode.

     <p><strong>Returns:</strong> On success, <code>GNUTLS_E_SUCCESS</code> (0) is returned, otherwise
an error code is returned. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_enable</h4>

<p><a name="gnutls_005fia_005fenable"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_ia_enable</b> (<var>gnutls_session_t session, int allow_skip_on_resume</var>)<var><a name="index-gnutls_005fia_005fenable-552"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>allow_skip_on_resume</var>: non-zero if local party allows to skip the
TLS/IA application phases for a resumed session.

     <p>Specify whether we must advertise support for the TLS/IA extension
during the handshake.

     <p>At the client side, we always advertise TLS/IA if gnutls_ia_enable
was called before the handshake; at the server side, we also
require that the client has advertised that it wants to run TLS/IA
before including the advertisement, as required by the protocol.

     <p>Similarly, at the client side we always advertise that we allow
TLS/IA to be skipped for resumed sessions if <code>allow_skip_on_resume</code>
is non-zero; at the server side, we also require that the session
is indeed resumable and that the client has also advertised that it
allows TLS/IA to be skipped for resumed sessions.

     <p>After the TLS handshake, call <code>gnutls_ia_handshake_p()</code> to find out
whether both parties agreed to do a TLS/IA handshake, before
calling <code>gnutls_ia_handshake()</code> or one of the lower level gnutls_ia_*
functions. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_endphase_send</h4>

<p><a name="gnutls_005fia_005fendphase_005fsend"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_ia_endphase_send</b> (<var>gnutls_session_t session, int final_p</var>)<var><a name="index-gnutls_005fia_005fendphase_005fsend-553"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>final_p</var>: Set iff this should signal the final phase.

     <p>Send a TLS/IA end phase message.

     <p>In the client, this should only be used to acknowledge an end phase
message sent by the server.

     <p>In the server, this can be called instead of <code>gnutls_ia_send()</code> if
the server wishes to end an application phase.

     <p><strong>Return value:</strong> Return 0 on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_extract_inner_secret</h4>

<p><a name="gnutls_005fia_005fextract_005finner_005fsecret"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_ia_extract_inner_secret</b> (<var>gnutls_session_t session, char * buffer</var>)<var><a name="index-gnutls_005fia_005fextract_005finner_005fsecret-554"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>buffer</var>: pre-allocated buffer to hold 48 bytes of inner secret.

     <p>Copy the 48 bytes large inner secret into the specified buffer

     <p>This function is typically used after the TLS/IA handshake has
concluded.  The TLS/IA inner secret can be used as input to a PRF
to derive session keys.  Do not use the inner secret directly as a
session key, because for a resumed session that does not include an
application phase, the inner secret will be identical to the inner
secret in the original session.  It is important to include, for
example, the client and server randomness when deriving a sesssion
key from the inner secret. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_free_client_credentials</h4>

<p><a name="gnutls_005fia_005ffree_005fclient_005fcredentials"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_ia_free_client_credentials</b> (<var>gnutls_ia_client_credentials_t sc</var>)<var><a name="index-gnutls_005fia_005ffree_005fclient_005fcredentials-555"></a></var><br>
<blockquote><p><var>sc</var>: is an <code>gnutls_ia_client_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus this
helper function is provided in order to free (deallocate) it. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_free_server_credentials</h4>

<p><a name="gnutls_005fia_005ffree_005fserver_005fcredentials"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_ia_free_server_credentials</b> (<var>gnutls_ia_server_credentials_t sc</var>)<var><a name="index-gnutls_005fia_005ffree_005fserver_005fcredentials-556"></a></var><br>
<blockquote><p><var>sc</var>: is an <code>gnutls_ia_server_credentials_t</code> structure.

     <p>This structure is complex enough to manipulate directly thus this
helper function is provided in order to free (deallocate) it. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_generate_challenge</h4>

<p><a name="gnutls_005fia_005fgenerate_005fchallenge"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_ia_generate_challenge</b> (<var>gnutls_session_t session, size_t buffer_size, char * buffer</var>)<var><a name="index-gnutls_005fia_005fgenerate_005fchallenge-557"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>buffer_size</var>: size of output buffer.

     <p><var>buffer</var>: pre-allocated buffer to contain <code>buffer_size</code> bytes of output.

     <p>Generate an application challenge that the client cannot control or
predict, based on the TLS/IA inner secret.

     <p><strong>Return value:</strong> Returns 0 on success, or an negative error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_get_client_avp_ptr</h4>

<p><a name="gnutls_005fia_005fget_005fclient_005favp_005fptr"></a>

<div class="defun">
&mdash; Function: void * <b>gnutls_ia_get_client_avp_ptr</b> (<var>gnutls_ia_client_credentials_t cred</var>)<var><a name="index-gnutls_005fia_005fget_005fclient_005favp_005fptr-558"></a></var><br>
<blockquote><p><var>cred</var>: is a <code>gnutls_ia_client_credentials_t</code> structure.

     <p>Returns the pointer that will be provided to the TLS/IA callback
function as the first argument.

     <p><strong>Returns:</strong> The client callback data pointer. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_get_server_avp_ptr</h4>

<p><a name="gnutls_005fia_005fget_005fserver_005favp_005fptr"></a>

<div class="defun">
&mdash; Function: void * <b>gnutls_ia_get_server_avp_ptr</b> (<var>gnutls_ia_server_credentials_t cred</var>)<var><a name="index-gnutls_005fia_005fget_005fserver_005favp_005fptr-559"></a></var><br>
<blockquote><p><var>cred</var>: is a <code>gnutls_ia_client_credentials_t</code> structure.

     <p>Returns the pointer that will be provided to the TLS/IA callback
function as the first argument.

     <p><strong>Returns:</strong> The server callback data pointer. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_handshake_p</h4>

<p><a name="gnutls_005fia_005fhandshake_005fp"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_ia_handshake_p</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fia_005fhandshake_005fp-560"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Predicate to be used after <code>gnutls_handshake()</code> to decide whether to
invoke <code>gnutls_ia_handshake()</code>.  Usable by both clients and servers.

     <p><strong>Return value:</strong> non-zero if TLS/IA handshake is expected, zero
otherwise. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_handshake</h4>

<p><a name="gnutls_005fia_005fhandshake"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_ia_handshake</b> (<var>gnutls_session_t session</var>)<var><a name="index-gnutls_005fia_005fhandshake-561"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p>Perform a TLS/IA handshake.  This should be called after
<code>gnutls_handshake()</code> iff <code>gnutls_ia_handshake_p()</code>.

     <p>Return 0 on success, or an error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_permute_inner_secret</h4>

<p><a name="gnutls_005fia_005fpermute_005finner_005fsecret"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_ia_permute_inner_secret</b> (<var>gnutls_session_t session, size_t session_keys_size, const char * session_keys</var>)<var><a name="index-gnutls_005fia_005fpermute_005finner_005fsecret-562"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>session_keys_size</var>: Size of generated session keys (0 if none).

     <p><var>session_keys</var>: Generated session keys, used to permute inner secret
(NULL if none).

     <p>Permute the inner secret using the generated session keys.

     <p>This can be called in the TLS/IA AVP callback to mix any generated
session keys with the TLS/IA inner secret.

     <p><strong>Return value:</strong> Return zero on success, or a negative error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_recv</h4>

<p><a name="gnutls_005fia_005frecv"></a>

<div class="defun">
&mdash; Function: ssize_t <b>gnutls_ia_recv</b> (<var>gnutls_session_t session, char * data, size_t sizeofdata</var>)<var><a name="index-gnutls_005fia_005frecv-563"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>data</var>: the buffer that the data will be read into, must hold &gt;= 12 bytes.

     <p><var>sizeofdata</var>: the number of requested bytes, must be &gt;= 12.

     <p>Receive TLS/IA data.  This function has the similar semantics with
<code>recv()</code>. The only difference is that is accepts a GNUTLS session,
and uses different error codes.

     <p>If the server attempt to finish an application phase, this function
will return <code>GNUTLS_E_WARNING_IA_IPHF_RECEIVED</code> or
<code>GNUTLS_E_WARNING_IA_FPHF_RECEIVED</code>.  The caller should then invoke
<code>gnutls_ia_verify_endphase()</code>, and if it runs the client side, also
send an endphase message of its own using gnutls_ia_endphase_send.

     <p>If EINTR is returned by the internal push function (the default is
<code>code</code>{<code>recv()</code>}) then GNUTLS_E_INTERRUPTED will be returned.  If
GNUTLS_E_INTERRUPTED or GNUTLS_E_AGAIN is returned, you must call
this function again, with the same parameters; alternatively you
could provide a NULL pointer for data, and 0 for size.

     <p><strong>Returns:</strong> The number of bytes received.  A negative error code is
returned in case of an error.  The
<code>GNUTLS_E_WARNING_IA_IPHF_RECEIVED</code> and
<code>GNUTLS_E_WARNING_IA_FPHF_RECEIVED</code> errors are returned when an
application phase finished message has been sent by the server. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_send</h4>

<p><a name="gnutls_005fia_005fsend"></a>

<div class="defun">
&mdash; Function: ssize_t <b>gnutls_ia_send</b> (<var>gnutls_session_t session, const char * data, size_t sizeofdata</var>)<var><a name="index-gnutls_005fia_005fsend-564"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>data</var>: contains the data to send

     <p><var>sizeofdata</var>: is the length of the data

     <p>Send TLS/IA application payload data.  This function has the
similar semantics with <code>send()</code>. The only difference is that is
accepts a GNUTLS session, and uses different error codes.

     <p>The TLS/IA protocol is synchronous, so you cannot send more than
one packet at a time.  The client always send the first packet.

     <p>To finish an application phase in the server, use
<code>gnutls_ia_endphase_send()</code>.  The client cannot end an application
phase unilaterally; rather, a client is required to respond with an
endphase of its own if gnutls_ia_recv indicates that the server has
sent one.

     <p>If the EINTR is returned by the internal push function (the default
is <code>send()</code>} then <code>GNUTLS_E_INTERRUPTED</code> will be returned.  If
<code>GNUTLS_E_INTERRUPTED</code> or <code>GNUTLS_E_AGAIN</code> is returned, you must call
this function again, with the same parameters; alternatively you
could provide a <code>NULL</code> pointer for data, and 0 for size.

     <p><strong>Returns:</strong> The number of bytes sent, or a negative error code. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_set_client_avp_function</h4>

<p><a name="gnutls_005fia_005fset_005fclient_005favp_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_ia_set_client_avp_function</b> (<var>gnutls_ia_client_credentials_t cred, gnutls_ia_avp_func avp_func</var>)<var><a name="index-gnutls_005fia_005fset_005fclient_005favp_005ffunction-565"></a></var><br>
<blockquote><p><var>cred</var>: is a <code>gnutls_ia_client_credentials_t</code> structure.

     <p><var>avp_func</var>: is the callback function

     <p>Set the TLS/IA AVP callback handler used for the session.

     <p>The AVP callback is called to process AVPs received from the
server, and to get a new AVP to send to the server.

     <p>The callback's function form is:
int (*avp_func) (gnutls_session_t session, void *ptr,
const char *last, size_t lastlen,
char **next, size_t *nextlen);

     <p>The <code>session</code> parameter is the <code>gnutls_session_t</code> structure
corresponding to the current session.  The <code>ptr</code> parameter is the
application hook pointer, set through
<code>gnutls_ia_set_client_avp_ptr()</code>.  The AVP received from the server
is present in <code>last</code> of <code>lastlen</code> size, which will be <code>NULL</code> on the
first invocation.  The newly allocated output AVP to send to the
server should be placed in *<code>next</code> of *<code>nextlen</code> size.

     <p>The callback may invoke <code>gnutls_ia_permute_inner_secret()</code> to mix any
generated session keys with the TLS/IA inner secret.

     <p>Return 0 (<code>GNUTLS_IA_APPLICATION_PAYLOAD</code>) on success, or a negative
error code to abort the TLS/IA handshake.

     <p>Note that the callback must use allocate the <code>next</code> parameter using
<code>gnutls_malloc()</code>, because it is released via <code>gnutls_free()</code> by the
TLS/IA handshake function. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_set_client_avp_ptr</h4>

<p><a name="gnutls_005fia_005fset_005fclient_005favp_005fptr"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_ia_set_client_avp_ptr</b> (<var>gnutls_ia_client_credentials_t cred, void * ptr</var>)<var><a name="index-gnutls_005fia_005fset_005fclient_005favp_005fptr-566"></a></var><br>
<blockquote><p><var>cred</var>: is a <code>gnutls_ia_client_credentials_t</code> structure.

     <p><var>ptr</var>: is the pointer

     <p>Sets the pointer that will be provided to the TLS/IA callback
function as the first argument. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_set_server_avp_function</h4>

<p><a name="gnutls_005fia_005fset_005fserver_005favp_005ffunction"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_ia_set_server_avp_function</b> (<var>gnutls_ia_server_credentials_t cred, gnutls_ia_avp_func avp_func</var>)<var><a name="index-gnutls_005fia_005fset_005fserver_005favp_005ffunction-567"></a></var><br>
<blockquote><p><var>cred</var>: is a <code>gnutls_ia_server_credentials_t</code> structure.

     <p>Set the TLS/IA AVP callback handler used for the session.

     <p>The callback's function form is:
int (*avp_func) (gnutls_session_t session, void *ptr,
const char *last, size_t lastlen,
char **next, size_t *nextlen);

     <p>The <code>session</code> parameter is the <code>gnutls_session_t</code> structure
corresponding to the current session.  The <code>ptr</code> parameter is the
application hook pointer, set through
<code>gnutls_ia_set_server_avp_ptr()</code>.  The AVP received from the client
is present in <code>last</code> of <code>lastlen</code> size.  The newly allocated output
AVP to send to the client should be placed in *<code>next</code> of *<code>nextlen</code>
size.

     <p>The AVP callback is called to process incoming AVPs from the
client, and to get a new AVP to send to the client.  It can also be
used to instruct the TLS/IA handshake to do go into the
Intermediate or Final phases.  It return a negative error code, or
an <code>gnutls_ia_apptype_t</code> message type.

     <p>The callback may invoke <code>gnutls_ia_permute_inner_secret()</code> to mix any
generated session keys with the TLS/IA inner secret.

     <p>Specifically, return <code>GNUTLS_IA_APPLICATION_PAYLOAD</code> (0) to send
another AVP to the client, return
<code>GNUTLS_IA_INTERMEDIATE_PHASE_FINISHED</code> (1) to indicate that an
IntermediatePhaseFinished message should be sent, and return
<code>GNUTLS_IA_FINAL_PHASE_FINISHED</code> (2) to indicate that an
FinalPhaseFinished message should be sent.  In the last two cases,
the contents of the <code>next</code> and <code>nextlen</code> parameter is not used.

     <p>Note that the callback must use allocate the <code>next</code> parameter using
<code>gnutls_malloc()</code>, because it is released via <code>gnutls_free()</code> by the
TLS/IA handshake function. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_set_server_avp_ptr</h4>

<p><a name="gnutls_005fia_005fset_005fserver_005favp_005fptr"></a>

<div class="defun">
&mdash; Function: void <b>gnutls_ia_set_server_avp_ptr</b> (<var>gnutls_ia_server_credentials_t cred, void * ptr</var>)<var><a name="index-gnutls_005fia_005fset_005fserver_005favp_005fptr-568"></a></var><br>
<blockquote><p><var>cred</var>: is a <code>gnutls_ia_client_credentials_t</code> structure.

     <p><var>ptr</var>: is the pointer

     <p>Sets the pointer that will be provided to the TLS/IA callback
function as the first argument. 
</p></blockquote></div>

<h4 class="subheading">gnutls_ia_verify_endphase</h4>

<p><a name="gnutls_005fia_005fverify_005fendphase"></a>

<div class="defun">
&mdash; Function: int <b>gnutls_ia_verify_endphase</b> (<var>gnutls_session_t session, const char * checksum</var>)<var><a name="index-gnutls_005fia_005fverify_005fendphase-569"></a></var><br>
<blockquote><p><var>session</var>: is a <code>gnutls_session_t</code> structure.

     <p><var>checksum</var>: 12-byte checksum data, received from <code>gnutls_ia_recv()</code>.

     <p>Verify TLS/IA end phase checksum data.  If verification fails, the
<code>GNUTLS_A_INNER_APPLICATION_VERIFICATION</code> alert is sent to the other
sie.

     <p>This function is called when <code>gnutls_ia_recv()</code> return
<code>GNUTLS_E_WARNING_IA_IPHF_RECEIVED</code> or
<code>GNUTLS_E_WARNING_IA_FPHF_RECEIVED</code>.

     <p><strong>Return value:</strong> Return 0 on successful verification, or an error
code.  If the checksum verification of the end phase message fails,
<code>GNUTLS_E_IA_VERIFY_FAILED</code> is returned. 
</p></blockquote></div>

<div class="node">
<a name="Error-codes-and-descriptions"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Function-reference">Function reference</a>

</div>

<h3 class="section">9.6 Error Codes and Descriptions</h3>

<p><a name="Error-Codes"></a><a name="index-Error-codes-570"></a>
The error codes used throughout the library are described below.  The
return code <code>GNUTLS_E_SUCCESS</code> indicate successful operation, and
is guaranteed to have the value 0, so you can use it in logical
expressions.

     <dl>
<dt><code>GNUTLS_E_AGAIN:</code><dd>Function was interrupted.

     <br><dt><code>GNUTLS_E_ASN1_DER_ERROR:</code><dd>ASN1 parser: Error in DER parsing.

     <br><dt><code>GNUTLS_E_ASN1_DER_OVERFLOW:</code><dd>ASN1 parser: Overflow in DER parsing.

     <br><dt><code>GNUTLS_E_ASN1_ELEMENT_NOT_FOUND:</code><dd>ASN1 parser: Element was not found.

     <br><dt><code>GNUTLS_E_ASN1_GENERIC_ERROR:</code><dd>ASN1 parser: Generic parsing error.

     <br><dt><code>GNUTLS_E_ASN1_IDENTIFIER_NOT_FOUND:</code><dd>ASN1 parser: Identifier was not found

     <br><dt><code>GNUTLS_E_ASN1_SYNTAX_ERROR:</code><dd>ASN1 parser: Syntax error.

     <br><dt><code>GNUTLS_E_ASN1_TAG_ERROR:</code><dd>ASN1 parser: Error in TAG.

     <br><dt><code>GNUTLS_E_ASN1_TAG_IMPLICIT:</code><dd>ASN1 parser: error in implicit tag

     <br><dt><code>GNUTLS_E_ASN1_TYPE_ANY_ERROR:</code><dd>ASN1 parser: Error in type 'ANY'.

     <br><dt><code>GNUTLS_E_ASN1_VALUE_NOT_FOUND:</code><dd>ASN1 parser: Value was not found.

     <br><dt><code>GNUTLS_E_ASN1_VALUE_NOT_VALID:</code><dd>ASN1 parser: Value is not valid.

     <br><dt><code>GNUTLS_E_BASE64_DECODING_ERROR:</code><dd>Base64 decoding error.

     <br><dt><code>GNUTLS_E_BASE64_ENCODING_ERROR:</code><dd>Base64 encoding error.

     <br><dt><code>GNUTLS_E_BASE64_UNEXPECTED_HEADER_ERROR:</code><dd>Base64 unexpected header error.

     <br><dt><code>GNUTLS_E_CERTIFICATE_ERROR:</code><dd>Error in the certificate.

     <br><dt><code>GNUTLS_E_CERTIFICATE_KEY_MISMATCH:</code><dd>The certificate and the given key do not match.

     <br><dt><code>GNUTLS_E_COMPRESSION_FAILED:</code><dd>Compression of the TLS record packet has failed.

     <br><dt><code>GNUTLS_E_CONSTRAINT_ERROR:</code><dd>Some constraint limits were reached.

     <br><dt><code>GNUTLS_E_CRYPTO_ALREADY_REGISTERED:</code><dd>There is already a crypto algorithm with lower priority.

     <br><dt><code>GNUTLS_E_DB_ERROR:</code><dd>Error in Database backend.

     <br><dt><code>GNUTLS_E_DECOMPRESSION_FAILED:</code><dd>Decompression of the TLS record packet has failed.

     <br><dt><code>GNUTLS_E_DECRYPTION_FAILED:</code><dd>Decryption has failed.

     <br><dt><code>GNUTLS_E_DH_PRIME_UNACCEPTABLE:</code><dd>The Diffie Hellman prime sent by the server is not acceptable (not long enough).

     <br><dt><code>GNUTLS_E_ENCRYPTION_FAILED:</code><dd>Encryption has failed.

     <br><dt><code>GNUTLS_E_ERROR_IN_FINISHED_PACKET:</code><dd>An error was encountered at the TLS Finished packet calculation.

     <br><dt><code>GNUTLS_E_EXPIRED:</code><dd>The requested session has expired.

     <br><dt><code>GNUTLS_E_FATAL_ALERT_RECEIVED:</code><dd>A TLS fatal alert has been received.

     <br><dt><code>GNUTLS_E_FILE_ERROR:</code><dd>Error while reading file.

     <br><dt><code>GNUTLS_E_GOT_APPLICATION_DATA:</code><dd>TLS Application data were received, while expecting handshake data.

     <br><dt><code>GNUTLS_E_HANDSHAKE_TOO_LARGE:</code><dd>The handshake data size is too large (DoS?), check gnutls_handshake_set_max_packet_length().

     <br><dt><code>GNUTLS_E_HASH_FAILED:</code><dd>Hashing has failed.

     <br><dt><code>GNUTLS_E_IA_VERIFY_FAILED:</code><dd>Verifying TLS/IA phase checksum failed

     <br><dt><code>GNUTLS_E_ILLEGAL_SRP_USERNAME:</code><dd>The SRP username supplied is illegal.

     <br><dt><code>GNUTLS_E_INCOMPATIBLE_GCRYPT_LIBRARY:</code><dd>The gcrypt library version is too old.

     <br><dt><code>GNUTLS_E_INCOMPATIBLE_LIBTASN1_LIBRARY:</code><dd>The tasn1 library version is too old.

     <br><dt><code>GNUTLS_E_INIT_LIBEXTRA:</code><dd>The initialization of GnuTLS-extra has failed.

     <br><dt><code>GNUTLS_E_INSUFFICIENT_CREDENTIALS:</code><dd>Insufficient credentials for that request.

     <br><dt><code>GNUTLS_E_INTERNAL_ERROR:</code><dd>GnuTLS internal error.

     <br><dt><code>GNUTLS_E_INTERRUPTED:</code><dd>Function was interrupted.

     <br><dt><code>GNUTLS_E_INVALID_PASSWORD:</code><dd>The given password contains invalid characters.

     <br><dt><code>GNUTLS_E_INVALID_REQUEST:</code><dd>The request is invalid.

     <br><dt><code>GNUTLS_E_INVALID_SESSION:</code><dd>The specified session has been invalidated for some reason.

     <br><dt><code>GNUTLS_E_KEY_USAGE_VIOLATION:</code><dd>Key usage violation in certificate has been detected.

     <br><dt><code>GNUTLS_E_LARGE_PACKET:</code><dd>A large TLS record packet was received.

     <br><dt><code>GNUTLS_E_LIBRARY_VERSION_MISMATCH:</code><dd>The GnuTLS library version does not match the GnuTLS-extra library version.

     <br><dt><code>GNUTLS_E_LZO_INIT_FAILED:</code><dd>The initialization of LZO has failed.

     <br><dt><code>GNUTLS_E_MAC_VERIFY_FAILED:</code><dd>The Message Authentication Code verification failed.

     <br><dt><code>GNUTLS_E_MEMORY_ERROR:</code><dd>Internal error in memory allocation.

     <br><dt><code>GNUTLS_E_MPI_PRINT_FAILED:</code><dd>Could not export a large integer.

     <br><dt><code>GNUTLS_E_MPI_SCAN_FAILED:</code><dd>The scanning of a large integer has failed.

     <br><dt><code>GNUTLS_E_NO_CERTIFICATE_FOUND:</code><dd>The peer did not send any certificate.

     <br><dt><code>GNUTLS_E_NO_CIPHER_SUITES:</code><dd>No supported cipher suites have been found.

     <br><dt><code>GNUTLS_E_NO_COMPRESSION_ALGORITHMS:</code><dd>No supported compression algorithms have been found.

     <br><dt><code>GNUTLS_E_NO_TEMPORARY_DH_PARAMS:</code><dd>No temporary DH parameters were found.

     <br><dt><code>GNUTLS_E_NO_TEMPORARY_RSA_PARAMS:</code><dd>No temporary RSA parameters were found.

     <br><dt><code>GNUTLS_E_OPENPGP_FINGERPRINT_UNSUPPORTED:</code><dd>The OpenPGP fingerprint is not supported.

     <br><dt><code>GNUTLS_E_OPENPGP_GETKEY_FAILED:</code><dd>Could not get OpenPGP key.

     <br><dt><code>GNUTLS_E_OPENPGP_KEYRING_ERROR:</code><dd>Error loading the keyring.

     <br><dt><code>GNUTLS_E_OPENPGP_SUBKEY_ERROR:</code><dd>Could not find OpenPGP subkey.

     <br><dt><code>GNUTLS_E_OPENPGP_UID_REVOKED:</code><dd>The OpenPGP User ID is revoked.

     <br><dt><code>GNUTLS_E_PKCS1_WRONG_PAD:</code><dd>Wrong padding in PKCS1 packet.

     <br><dt><code>GNUTLS_E_PK_DECRYPTION_FAILED:</code><dd>Public key decryption has failed.

     <br><dt><code>GNUTLS_E_PK_ENCRYPTION_FAILED:</code><dd>Public key encryption has failed.

     <br><dt><code>GNUTLS_E_PK_SIGN_FAILED:</code><dd>Public key signing has failed.

     <br><dt><code>GNUTLS_E_PK_SIG_VERIFY_FAILED:</code><dd>Public key signature verification has failed.

     <br><dt><code>GNUTLS_E_PULL_ERROR:</code><dd>Error in the pull function.

     <br><dt><code>GNUTLS_E_PUSH_ERROR:</code><dd>Error in the push function.

     <br><dt><code>GNUTLS_E_RANDOM_FAILED:</code><dd>Failed to acquire random data.

     <br><dt><code>GNUTLS_E_RECEIVED_ILLEGAL_EXTENSION:</code><dd>An illegal TLS extension was received.

     <br><dt><code>GNUTLS_E_RECEIVED_ILLEGAL_PARAMETER:</code><dd>An illegal parameter has been received.

     <br><dt><code>GNUTLS_E_RECORD_LIMIT_REACHED:</code><dd>The upper limit of record packet sequence numbers has been reached. Wow!

     <br><dt><code>GNUTLS_E_REHANDSHAKE:</code><dd>Rehandshake was requested by the peer.

     <br><dt><code>GNUTLS_E_REQUESTED_DATA_NOT_AVAILABLE:</code><dd>The requested data were not available.

     <br><dt><code>GNUTLS_E_SHORT_MEMORY_BUFFER:</code><dd>The given memory buffer is too short to hold parameters.

     <br><dt><code>GNUTLS_E_SRP_PWD_ERROR:</code><dd>Error in password file.

     <br><dt><code>GNUTLS_E_SRP_PWD_PARSING_ERROR:</code><dd>Parsing error in password file.

     <br><dt><code>GNUTLS_E_SUCCESS:</code><dd>Success.

     <br><dt><code>GNUTLS_E_TOO_MANY_EMPTY_PACKETS:</code><dd>Too many empty record packets have been received.

     <br><dt><code>GNUTLS_E_UNEXPECTED_HANDSHAKE_PACKET:</code><dd>An unexpected TLS handshake packet was received.

     <br><dt><code>GNUTLS_E_UNEXPECTED_PACKET:</code><dd>An unexpected TLS packet was received.

     <br><dt><code>GNUTLS_E_UNEXPECTED_PACKET_LENGTH:</code><dd>A TLS packet with unexpected length was received.

     <br><dt><code>GNUTLS_E_UNKNOWN_ALGORITHM:</code><dd>The specified algorithm or protocol is unknown.

     <br><dt><code>GNUTLS_E_UNKNOWN_CIPHER_SUITE:</code><dd>Could not negotiate a supported cipher suite.

     <br><dt><code>GNUTLS_E_UNKNOWN_CIPHER_TYPE:</code><dd>The cipher type is unsupported.

     <br><dt><code>GNUTLS_E_UNKNOWN_COMPRESSION_ALGORITHM:</code><dd>Could not negotiate a supported compression method.

     <br><dt><code>GNUTLS_E_UNKNOWN_HASH_ALGORITHM:</code><dd>The hash algorithm is unknown.

     <br><dt><code>GNUTLS_E_UNKNOWN_PKCS_BAG_TYPE:</code><dd>The PKCS structure's bag type is unknown.

     <br><dt><code>GNUTLS_E_UNKNOWN_PKCS_CONTENT_TYPE:</code><dd>The PKCS structure's content type is unknown.

     <br><dt><code>GNUTLS_E_UNKNOWN_PK_ALGORITHM:</code><dd>An unknown public key algorithm was encountered.

     <br><dt><code>GNUTLS_E_UNSUPPORTED_CERTIFICATE_TYPE:</code><dd>The certificate type is not supported.

     <br><dt><code>GNUTLS_E_UNSUPPORTED_VERSION_PACKET:</code><dd>A record packet with illegal version was received.

     <br><dt><code>GNUTLS_E_UNWANTED_ALGORITHM:</code><dd>An algorithm that is not enabled was negotiated.

     <br><dt><code>GNUTLS_E_WARNING_ALERT_RECEIVED:</code><dd>A TLS warning alert has been received.

     <br><dt><code>GNUTLS_E_WARNING_IA_FPHF_RECEIVED:</code><dd>Received a TLS/IA Final Phase Finished message

     <br><dt><code>GNUTLS_E_WARNING_IA_IPHF_RECEIVED:</code><dd>Received a TLS/IA Intermediate Phase Finished message

     <br><dt><code>GNUTLS_E_X509_UNKNOWN_SAN:</code><dd>Unknown Subject Alternative name in X.509 certificate.

     <br><dt><code>GNUTLS_E_X509_UNSUPPORTED_ATTRIBUTE:</code><dd>The certificate has unsupported attributes.

     <br><dt><code>GNUTLS_E_X509_UNSUPPORTED_CRITICAL_EXTENSION:</code><dd>Unsupported critical extension in X.509 certificate.

     <br><dt><code>GNUTLS_E_X509_UNSUPPORTED_OID:</code><dd>The OID is not supported.

</dl>

<div class="node">
<a name="All-the-supported-ciphersuites-in-GnuTLS"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Guile-Bindings">Guile Bindings</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-reference">Function reference</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">10 All the Supported Ciphersuites in <acronym>GnuTLS</acronym></h2>

<p><a name="ciphersuites"></a><a name="index-Ciphersuites-571"></a>

<p>Available cipher suites:
<p><table summary=""><tr align="left"><td valign="top" width="60%">TLS_ANON_DH_ARCFOUR_MD5
</td><td valign="top" width="20%">0x00 0x18
</td><td valign="top" width="20%">SSL3.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_ANON_DH_3DES_EDE_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x1b
</td><td valign="top" width="20%">SSL3.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_ANON_DH_AES_128_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x34
</td><td valign="top" width="20%">SSL3.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_ANON_DH_AES_256_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x3a
</td><td valign="top" width="20%">SSL3.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_ANON_DH_CAMELLIA_128_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x46
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_ANON_DH_CAMELLIA_256_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x89
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_PSK_SHA_ARCFOUR_SHA1
</td><td valign="top" width="20%">0x00 0x8a
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_PSK_SHA_3DES_EDE_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x8b
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_PSK_SHA_AES_128_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x8c
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_PSK_SHA_AES_256_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x8d
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_DHE_PSK_SHA_ARCFOUR_SHA1
</td><td valign="top" width="20%">0x00 0x8e
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_DHE_PSK_SHA_3DES_EDE_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x8f
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_DHE_PSK_SHA_AES_128_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x90
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_DHE_PSK_SHA_AES_256_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x91
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_SRP_SHA_3DES_EDE_CBC_SHA1
</td><td valign="top" width="20%">0xc0 0x1a
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_SRP_SHA_AES_128_CBC_SHA1
</td><td valign="top" width="20%">0xc0 0x1d
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_SRP_SHA_AES_256_CBC_SHA1
</td><td valign="top" width="20%">0xc0 0x20
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_SRP_SHA_DSS_3DES_EDE_CBC_SHA1
</td><td valign="top" width="20%">0xc0 0x1c
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_SRP_SHA_RSA_3DES_EDE_CBC_SHA1
</td><td valign="top" width="20%">0xc0 0x1b
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_SRP_SHA_DSS_AES_128_CBC_SHA1
</td><td valign="top" width="20%">0xc0 0x1f
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_SRP_SHA_RSA_AES_128_CBC_SHA1
</td><td valign="top" width="20%">0xc0 0x1e
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_SRP_SHA_DSS_AES_256_CBC_SHA1
</td><td valign="top" width="20%">0xc0 0x22
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_SRP_SHA_RSA_AES_256_CBC_SHA1
</td><td valign="top" width="20%">0xc0 0x21
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_DHE_DSS_ARCFOUR_SHA1
</td><td valign="top" width="20%">0x00 0x66
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_DHE_DSS_3DES_EDE_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x13
</td><td valign="top" width="20%">SSL3.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_DHE_DSS_AES_128_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x32
</td><td valign="top" width="20%">SSL3.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_DHE_DSS_AES_256_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x38
</td><td valign="top" width="20%">SSL3.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_DHE_DSS_CAMELLIA_128_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x44
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_DHE_DSS_CAMELLIA_256_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x87
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_DHE_RSA_3DES_EDE_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x16
</td><td valign="top" width="20%">SSL3.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_DHE_RSA_AES_128_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x33
</td><td valign="top" width="20%">SSL3.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_DHE_RSA_AES_256_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x39
</td><td valign="top" width="20%">SSL3.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_DHE_RSA_CAMELLIA_128_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x45
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_DHE_RSA_CAMELLIA_256_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x88
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_RSA_NULL_MD5
</td><td valign="top" width="20%">0x00 0x01
</td><td valign="top" width="20%">SSL3.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_RSA_EXPORT_ARCFOUR_40_MD5
</td><td valign="top" width="20%">0x00 0x03
</td><td valign="top" width="20%">SSL3.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_RSA_ARCFOUR_SHA1
</td><td valign="top" width="20%">0x00 0x05
</td><td valign="top" width="20%">SSL3.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_RSA_ARCFOUR_MD5
</td><td valign="top" width="20%">0x00 0x04
</td><td valign="top" width="20%">SSL3.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_RSA_3DES_EDE_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x0a
</td><td valign="top" width="20%">SSL3.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_RSA_AES_128_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x2f
</td><td valign="top" width="20%">SSL3.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_RSA_AES_256_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x35
</td><td valign="top" width="20%">SSL3.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_RSA_CAMELLIA_128_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x41
</td><td valign="top" width="20%">TLS1.0
<br></td></tr><tr align="left"><td valign="top" width="60%">TLS_RSA_CAMELLIA_256_CBC_SHA1
</td><td valign="top" width="20%">0x00 0x84
</td><td valign="top" width="20%">TLS1.0
<br></td></tr></table>

<p>Available certificate types:
     <ul>
<li>X.509
<li>OPENPGP
</ul>

<p>Available protocols:
     <ul>
<li>SSL3.0
<li>TLS1.0
<li>TLS1.1
<li>TLS1.2
</ul>

<p>Available ciphers:
     <ul>
<li>AES-256-CBC
<li>AES-128-CBC
<li>3DES-CBC
<li>DES-CBC
<li>ARCFOUR-128
<li>ARCFOUR-40
<li>RC2-40
<li>CAMELLIA-256-CBC
<li>CAMELLIA-128-CBC
<li>NULL
</ul>

<p>Available MAC algorithms:
     <ul>
<li>SHA1
<li>MD5
<li>SHA256
<li>SHA384
<li>SHA512
<li>MD2
<li>RIPEMD160
<li>NULL
</ul>

<p>Available key exchange methods:
     <ul>
<li>ANON-DH
<li>RSA
<li>RSA-EXPORT
<li>DHE-RSA
<li>DHE-DSS
<li>SRP-DSS
<li>SRP-RSA
<li>SRP
<li>PSK
<li>DHE-PSK
</ul>

<p>Available public key algorithms:
     <ul>
<li>RSA
<li>DSA
</ul>

<p>Available public key signature algorithms:
     <ul>
<li>RSA-SHA
<li>RSA-SHA256
<li>RSA-SHA384
<li>RSA-SHA512
<li>RSA-RMD160
<li>DSA-SHA
<li>RSA-MD5
<li>RSA-MD2
</ul>

<p>Available compression methods:
     <ul>
<li>DEFLATE
<li>NULL
</ul>

<p>Some additional information regarding some of the algorithms:

     <dl>
<dt><code>RSA</code><dd>RSA is public key cryptosystem designed by Ronald Rivest, Adi Shamir
and Leonard Adleman.  It can be used with any hash functions.

     <br><dt><code>DSA</code><dd>DSA is the USA's Digital Signature Standard.  It uses only the SHA-1
hash algorithm.

     <br><dt><code>MD2</code><dd>MD2 is a cryptographic hash algorithm designed by Ron Rivest.  It is
optimized for 8-bit processors. Outputs 128 bits of data.  There are
no known weaknesses of this algorithm but since this algorithm is
rarely used and not really studied it should not be used today.

     <br><dt><code>MD5</code><dd>MD5 is a cryptographic hash algorithm designed by Ron Rivest. Outputs
128 bits of data.  It is considered to be broken.

     <br><dt><code>SHA-1</code><dd>SHA is a cryptographic hash algorithm designed by NSA. Outputs 160
bits of data.  It is also considered to be broken, though no practical
attacks have been found.

     <br><dt><code>RMD160</code><dd>RIPEMD is a cryptographic hash algorithm developed in the framework of
the EU project RIPE.  Outputs 160 bits of data.

</dl>

<!-- Guile Bindings -->
<!-- Documentation of the GNU Guile bindings. -->
<div class="node">
<a name="Guile-Bindings"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Internal-architecture-of-GnuTLS">Internal architecture of GnuTLS</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#All-the-supported-ciphersuites-in-GnuTLS">All the supported ciphersuites in GnuTLS</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">11 Guile Bindings</h2>

<p>This chapter describes the <a href="http://www.gnu.org/software/guile/">GNU Guile</a> Scheme programming interface to GnuTLS.  The reader is
assumed to have basic knowledge of the protocol and library.  Details
missing from this chapter may be found in <a href="#Function-reference">the C API reference</a>.

<p>At this stage, not all the C functions are available from Scheme, but
a large subset thereof is available.

<ul class="menu">
<li><a accesskey="1" href="#Guile-Preparations">Guile Preparations</a>:           Note on installation and environment. 
<li><a accesskey="2" href="#Guile-API-Conventions">Guile API Conventions</a>:        Naming conventions and other idiosyncrasies. 
<li><a accesskey="3" href="#Guile-Examples">Guile Examples</a>:               Quick start. 
<li><a accesskey="4" href="#Guile-Reference">Guile Reference</a>:              The Scheme GnuTLS programming interface. 
</ul>

<!-- ********************************************************************* -->
<div class="node">
<a name="Guile-Preparations"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Guile-API-Conventions">Guile API Conventions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Guile-Bindings">Guile Bindings</a>

</div>

<h3 class="section">11.1 Guile Preparations</h3>

<p>The GnuTLS Guile bindings are by default installed under the GnuTLS
installation directory (e.g., typically
<samp><span class="file">/usr/local/share/guile/site/</span></samp>).  Normally Guile will not find
the module there without help.  You may experience something like
this:

<pre class="example">     $ guile
     guile&gt; (use-modules (gnutls))
     &lt;unnamed port&gt;: no code for module (gnutls)
     guile&gt;
</pre>
<p>There are two ways to solve this.  The first is to make sure that when
building GnuTLS, the Guile bindings will be installed in the same
place where Guile looks.  You may do this by using the
<code>--with-guile-site-dir</code> parameter as follows:

<pre class="example">     $ ./configure --with-guile-site-dir=no
</pre>
<p>This will instruct GnuTLS to attempt to install the Guile bindings
where Guile will look for them.  It will use <code>guile-config info
pkgdatadir</code> to learn the path to use.

<p>If Guile was installed into <code>/usr</code>, you may also install GnuTLS
using the same prefix:

<pre class="example">     $ ./configure --prefix=/usr
</pre>
<p>If you want to specify the path to install the Guile bindings you can
also specify the path directly:

<pre class="example">     $ ./configure --with-guile-site-dir=/opt/guile/share/guile/site
</pre>
<p>The second solution requires some more work but may be easier to use
if you do not have system administrator rights to your machine.  You
need to instruct Guile so that it finds the GnuTLS Guile bindings. 
Either use the <code>GUILE_LOAD_PATH</code> environment variable as follows:

<pre class="example">     $ GUILE_LOAD_PATH="/usr/local/share/guile/site:$GUILE_LOAD_PATH" guile
     guile&gt; (use-modules (gnutls))
     guile&gt;
</pre>
<p>Alternatively, you can modify Guile's <code>%load-path</code> variable
(see <a href="guile.html#Build-Config">Guile's run-time options</a>).

<p>At this point, you might get an error regarding
<samp><span class="file">libguile-gnutls-v-0</span></samp> similar to:

<pre class="example">     gnutls.scm:361:1: In procedure dynamic-link in expression (load-extension "libguile-gnutls-v-0" "scm_init_gnutls"):
     gnutls.scm:361:1: file: "libguile-gnutls-v-0", message: "libguile-gnutls-v-0.so: cannot open shared object file: No such file or directory"
</pre>
<p>In this case, you will need to modify the run-time linker path, for
example as follows:

<pre class="example">     $ LD_LIBRARY_PATH=/usr/local/lib GUILE_LOAD_PATH=/usr/local/share/guile/site guile
     guile&gt; (use-modules (gnutls))
     guile&gt;
</pre>
<!-- ********************************************************************* -->
<div class="node">
<a name="Guile-API-Conventions"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Guile-Examples">Guile Examples</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Guile-Preparations">Guile Preparations</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Guile-Bindings">Guile Bindings</a>

</div>

<h3 class="section">11.2 Guile API Conventions</h3>

<p>This chapter details the conventions used by Guile API, as well as
specificities of the mapping of the C API to Scheme.

<ul class="menu">
<li><a accesskey="1" href="#Enumerates-and-Constants">Enumerates and Constants</a>:       Representation of C-side constants. 
<li><a accesskey="2" href="#Procedure-Names">Procedure Names</a>:                Naming conventions. 
<li><a accesskey="3" href="#Representation-of-Binary-Data">Representation of Binary Data</a>:  Binary data buffers. 
<li><a accesskey="4" href="#Input-and-Output">Input and Output</a>:               Input and output. 
<li><a accesskey="5" href="#Exception-Handling">Exception Handling</a>:             Exceptions. 
</ul>

<div class="node">
<a name="Enumerates-and-Constants"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Procedure-Names">Procedure Names</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Guile-API-Conventions">Guile API Conventions</a>

</div>

<h4 class="subsection">11.2.1 Enumerates and Constants</h4>

<p><a name="index-enumerate-572"></a><a name="index-constant-573"></a>
Lots of enumerates and constants are used in the GnuTLS C API.  For
each C enumerate type, a disjoint Scheme type is used&mdash;thus,
enumerate values and constants are not represented by Scheme symbols
nor by integers.  This makes it impossible to use an enumerate value
of the wrong type on the Scheme side: such errors are automatically
detected by type-checking.

<p>The enumerate values are bound to variables exported by the
<code>(gnutls)</code> and <code>(gnutls extra)</code> modules.  These variables
are named according to the following convention:

     <ul>
<li>All variable names are lower-case; the underscore <code>_</code>
character used in the C API is replaced by hyphen <code>-</code>. 
<li>All variable names are prepended by the name of the enumerate
type and the slash <code>/</code> character. 
<li>In some cases, the variable name is made more explicit than the
one of the C API, e.g., by avoid abbreviations. 
</ul>

<p>Consider for instance this C-side enumerate:

<pre class="example">     typedef enum
     {
       GNUTLS_CRD_CERTIFICATE = 1,
       GNUTLS_CRD_ANON,
       GNUTLS_CRD_SRP,
       GNUTLS_CRD_PSK,
       GNUTLS_CRD_IA
     } gnutls_credentials_type_t;
</pre>
<p>The corresponding Scheme values are bound to the following variables
exported by the <code>(gnutls)</code> module:

<pre class="example">     credentials/certificate
     credentials/anonymous
     credentials/srp
     credentials/psk
     credentials/ia
</pre>
<p>Hopefully, most variable names can be deduced from this convention.

<p>Scheme-side &ldquo;enumerate&rdquo; values can be compared using <code>eq?</code>
(see <a href="guile.html#Equality">equality predicates</a>).  Consider the following example:

<p><a name="index-session_002dcipher-574"></a>
<pre class="example">     (let ((session (make-session connection-end/client)))
     
       ;;
       ;; ...
       ;;
     
       ;; Check the ciphering algorithm currently used by SESSION.
       (if (eq? cipher/arcfour (session-cipher session))
           (format #t "We're using the ARCFOUR algorithm")))
</pre>
<p>In addition, all enumerate values can be converted to a human-readable
string, in a type-specific way.  For instance, <code>(cipher-&gt;string
cipher/arcfour)</code> yields <code>"ARCFOUR 128"</code>, while
<code>(key-usage-&gt;string key-usage/digital-signature)</code> yields
<code>"digital-signature"</code>.  Note that these strings may not be
sufficient for use in a user interface since they are fairly concise
and not internationalized.

<div class="node">
<a name="Procedure-Names"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Representation-of-Binary-Data">Representation of Binary Data</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Enumerates-and-Constants">Enumerates and Constants</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Guile-API-Conventions">Guile API Conventions</a>

</div>

<h4 class="subsection">11.2.2 Procedure Names</h4>

<p>Unlike C functions in GnuTLS, the corresponding Scheme procedures are
named in a way that is close to natural English.  Abbreviations are
also avoided.  For instance, the Scheme procedure corresponding to
<code>gnutls_certificate_set_dh_params</code> is named
<code>set-certificate-credentials-dh-parameters!</code>.  The <code>gnutls_</code>
prefix is always omitted from variable names since a similar effect
can be achieved using Guile's nifty binding renaming facilities,
should it be needed (see <a href="guile.html#Using-Guile-Modules">Using Guile Modules</a>).

<p>Often Scheme procedure names differ from C function names in a way
that makes it clearer what objects they operate on.  For example, the
Scheme procedure named <code>set-session-transport-port!</code> corresponds
to <code>gnutls_transport_set_ptr</code>, making it clear that this
procedure applies to session.

<div class="node">
<a name="Representation-of-Binary-Data"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Input-and-Output">Input and Output</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Procedure-Names">Procedure Names</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Guile-API-Conventions">Guile API Conventions</a>

</div>

<h4 class="subsection">11.2.3 Representation of Binary Data</h4>

<p>Many procedures operate on binary data.  For instance,
<code>pkcs3-import-dh-parameters</code> expects binary data as input and,
similarly, procedures like <code>pkcs1-export-rsa-parameters</code> return
binary data.

<p><a name="index-SRFI_002d4-575"></a><a name="index-homogeneous-vector-576"></a>
Binary data is represented on the Scheme side using SRFI-4 homogeneous
vectors (see <a href="guile.html#SRFI_002d4">SRFI-4</a>). 
Although any type of homogeneous vector may be used, <code>u8vector</code>s
(i.e., vectors of bytes) are highly recommended.

<p>As an example, generating and then exporting RSA parameters in the PEM
format can be done as follows:

<p><a name="index-make_002drsa_002dparameters-577"></a><a name="index-pkcs1_002dexport_002drsa_002dparameters-578"></a><a name="index-x509_002dcertificate_002dformat_002fpem-579"></a>
<pre class="example">     (let* ((rsa-params (make-rsa-parameters 1024))
            (raw-data
             (pkcs1-export-rsa-parameters rsa-params
                                          x509-certificate-format/pem)))
       (uniform-vector-write raw-data (open-output-file "some-file.pem")))
</pre>
<p>For an example of OpenPGP key import from a file, see <a href="#Importing-OpenPGP-Keys-Guile-Example">Importing OpenPGP Keys Guile Example</a>.

<div class="node">
<a name="Input-and-Output"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Exception-Handling">Exception Handling</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Representation-of-Binary-Data">Representation of Binary Data</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Guile-API-Conventions">Guile API Conventions</a>

</div>

<h4 class="subsection">11.2.4 Input and Output</h4>

<p><a name="index-set_002dsession_002dtransport_002dport_0021-580"></a><a name="index-set_002dsession_002dtransport_002dfd_0021-581"></a>
The underlying transport of a TLS session can be any Scheme
input/output port (see <a href="guile.html#Ports-and-File-Descriptors">Ports and File Descriptors</a>).  This has to be specified using
<code>set-session-transport-port!</code>.

<p>However, for better performance, a raw file descriptor can be
specified, using <code>set-session-transport-fd!</code>.  For instance, if
the transport layer is a socket port over an OS-provided socket, you
can use the <code>port-&gt;fdes</code> or <code>fileno</code> procedure to obtain the
underlying file descriptor and pass it to
<code>set-session-transport-fd!</code>  (see <a href="guile.html#Ports-and-File-Descriptors"><code>port-&gt;fdes</code> and <code>fileno</code></a>).  This would work as follows:

<pre class="example">     (let ((socket (socket PF_INET SOCK_STREAM 0))
           (session (make-session connection-end/client)))
     
       ;;
       ;; Establish a TCP connection...
       ;;
     
       ;; Use the file descriptor that underlies SOCKET.
       (set-session-transport-fd! session (fileno socket)))
</pre>
<p><a name="index-session_002drecord_002dport-582"></a>
Once a TLS session is established, data can be communicated through it
(i.e., <em>via</em> the TLS record layer) using the port returned by
<code>session-record-port</code>:

<pre class="example">     (let ((session (make-session connection-end/client)))
     
       ;;
       ;; Initialize the various parameters of SESSION, set up
       ;; a network connection, etc...
       ;;
     
       (let ((i/o (session-record-port session)))
         (write "Hello peer!" i/o)
         (let ((greetings (read i/o)))
     
           ;; ...
     
           (bye session close-request/rdwr))))
</pre>
<p><a name="index-record_002dsend-583"></a><a name="index-record_002dreceive_0021-584"></a>
A lower-level I/O API is provided by <code>record-send</code> and
<code>record-receive!</code> which take an SRFI-4 vector to represent the
data sent or received.  While it might improve performance, it is much
less convenient than the above and should rarely be needed.

<div class="node">
<a name="Exception-Handling"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Input-and-Output">Input and Output</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Guile-API-Conventions">Guile API Conventions</a>

</div>

<h4 class="subsection">11.2.5 Exception Handling</h4>

<p><a name="index-exceptions-585"></a><a name="index-errors-586"></a><a name="index-g_t_0040code_007bgnutls_002derror_007d-587"></a><a name="index-error_002d_003estring-588"></a>
GnuTLS errors are implemented as Scheme exceptions (see <a href="guile.html#Exceptions">exceptions in Guile</a>).  Each
time a GnuTLS function returns an error, an exception with key
<code>gnutls-error</code> is raised.  The additional arguments that are
thrown include an error code and the name of the GnuTLS procedure that
raised the exception.  The error code is pretty much like an enumerate
value: it is one of the <code>error/</code> variables exported by the
<code>(gnutls)</code> module (see <a href="#Enumerates-and-Constants">Enumerates and Constants</a>).  Exceptions
can be turned into error messages using the <code>error-&gt;string</code>
procedure.

<p>The following examples illustrates how GnuTLS exceptions can be
handled:

<pre class="example">     (let ((session (make-session connection-end/server)))
     
       ;;
       ;; ...
       ;;
     
       (catch 'gnutls-error
         (lambda ()
           (handshake session))
         (lambda (key err function . currently-unused)
           (format (current-error-port)
                   "a GnuTLS error was raised by `~a': ~a~%"
                   function (error-&gt;string err)))))
</pre>
<p>Again, error values can be compared using <code>eq?</code>:

<pre class="example">         ;; `gnutls-error' handler.
         (lambda (key err function . currently-unused)
           (if (eq? err error/fatal-alert-received)
               (format (current-error-port)
                       "a fatal alert was caught!~%")
               (format (current-error-port)
                       "something bad happened: ~a~%"
                       (error-&gt;string err))))
</pre>
<p>Note that the <code>catch</code> handler is currently passed only 3
arguments but future versions might provide it with additional
arguments.  Thus, it must be prepared to handle more than 3 arguments,
as in this example.

<!-- ********************************************************************* -->
<div class="node">
<a name="Guile-Examples"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Guile-Reference">Guile Reference</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Guile-API-Conventions">Guile API Conventions</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Guile-Bindings">Guile Bindings</a>

</div>

<h3 class="section">11.3 Guile Examples</h3>

<p>This chapter provides examples that illustrate common use cases.

<ul class="menu">
<li><a accesskey="1" href="#Anonymous-Authentication-Guile-Example">Anonymous Authentication Guile Example</a>:     Simplest client and server. 
<li><a accesskey="2" href="#OpenPGP-Authentication-Guile-Example">OpenPGP Authentication Guile Example</a>:       Using OpenPGP-based authentication. 
<li><a accesskey="3" href="#Importing-OpenPGP-Keys-Guile-Example">Importing OpenPGP Keys Guile Example</a>:       Importing keys from files. 
</ul>

<div class="node">
<a name="Anonymous-Authentication-Guile-Example"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#OpenPGP-Authentication-Guile-Example">OpenPGP Authentication Guile Example</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Guile-Examples">Guile Examples</a>

</div>

<h4 class="subsection">11.3.1 Anonymous Authentication Guile Example</h4>

<p><dfn>Anonymous authentication</dfn> is very easy to use.  No certificates
are needed by the communicating parties.  Yet, it allows them to
benefit from end-to-end encryption and integrity checks.

<p>The client-side code would look like this (assuming <var>some-socket</var>
is bound to an open socket port):

<p><a name="index-connection_002dend_002fclient-589"></a><a name="index-kx_002fanon_002ddh-590"></a><a name="index-close_002drequest_002frdwr-591"></a>
<pre class="example">     ;; Client-side.
     
     (let ((client (make-session connection-end/client)))
       ;; Use the default settings.
       (set-session-default-priority! client)
     
       ;; Don't use certificate-based authentication.
       (set-session-certificate-type-priority! client '())
     
       ;; Request the "anonymous Diffie-Hellman" key exchange method.
       (set-session-kx-priority! client (list kx/anon-dh))
     
       ;; Specify the underlying socket.
       (set-session-transport-fd! client (fileno some-socket))
     
       ;; Create anonymous credentials.
       (set-session-credentials! client
                                 (make-anonymous-client-credentials))
     
       ;; Perform the TLS handshake with the server.
       (handshake client)
     
       ;; Send data over the TLS record layer.
       (write "hello, world!" (session-record-port client))
     
       ;; Terminate the TLS session.
       (bye client close-request/rdwr))
</pre>
<p>The corresponding server would look like this (again, assuming
<var>some-socket</var> is bound to a socket port):

<p><a name="index-connection_002dend_002fserver-592"></a>
<pre class="example">     ;; Server-side.
     
     (let ((server (make-session connection-end/server)))
       (set-session-default-priority! server)
       (set-session-certificate-type-priority! server '())
       (set-session-kx-priority! server (list kx/anon-dh))
     
       ;; Specify the underlying transport socket.
       (set-session-transport-fd! server (fileno some-socket))
     
       ;; Create anonymous credentials.
       (let ((cred (make-anonymous-server-credentials))
             (dh-params (make-dh-parameters 1024)))
         ;; Note: DH parameter generation can take some time.
         (set-anonymous-server-dh-parameters! cred dh-params)
         (set-session-credentials! server cred))
     
       ;; Perform the TLS handshake with the client.
       (handshake server)
     
       ;; Receive data over the TLS record layer.
       (let ((message (read (session-record-port server))))
         (format #t "received the following message: ~a~%"
                 message)
     
         (bye server close-request/rdwr)))
</pre>
<p>This is it!

<div class="node">
<a name="OpenPGP-Authentication-Guile-Example"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Importing-OpenPGP-Keys-Guile-Example">Importing OpenPGP Keys Guile Example</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Anonymous-Authentication-Guile-Example">Anonymous Authentication Guile Example</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Guile-Examples">Guile Examples</a>

</div>

<h4 class="subsection">11.3.2 OpenPGP Authentication Guile Example</h4>

<p>GnuTLS allows users to authenticate using OpenPGP certificates.  The
relevant procedures are provided by the <code>(gnutls extra)</code> module. 
Using OpenPGP-based authentication is not more complicated than using
anonymous authentication.  It requires a bit of extra work, though, to
import the OpenPGP public and private key of the client/server.  Key
import is omitted here and is left as an exercise to the reader
(see <a href="#Importing-OpenPGP-Keys-Guile-Example">Importing OpenPGP Keys Guile Example</a>).

<p>Assuming <var>some-socket</var> is bound to an open socket port and
<var>pub</var> and <var>sec</var> are bound to the client's OpenPGP public and
secret key, respectively, client-side code would look like this:

<p><a name="index-certificate_002dtype_002fopenpgp-593"></a>
<pre class="example">     ;; Client-side.
     
     (define %certs (list certificate-type/openpgp))
     
     (let ((client (make-session connection-end/client))
           (cred   (make-certificate-credentials)))
       (set-session-default-priority! client)
     
       ;; Choose OpenPGP certificates.
       (set-session-certificate-type-priority! client %certs)
     
       ;; Prepare appropriate client credentials.
       (set-certificate-credentials-openpgp-keys! cred pub sec)
       (set-session-credentials! client cred)
     
       ;; Specify the underlying transport socket.
       (set-session-transport-fd! client (fileno some-socket))
     
       (handshake client)
       (write "hello, world!" (session-record-port client))
       (bye client close-request/rdwr))
</pre>
<p>Similarly, server-side code would be along these lines:

<pre class="example">     ;; Server-side.
     
     (define %certs (list certificate-type/openpgp))
     
     (let ((server (make-session connection-end/server))
           (rsa    (make-rsa-parameters 1024))
           (dh     (make-dh-parameters 1024)))
       (set-session-default-priority! server)
     
       ;; Choose OpenPGP certificates.
       (set-session-certificate-type-priority! server %certs)
     
       (let ((cred (make-certificate-credentials)))
         ;; Prepare credentials with RSA and Diffie-Hellman parameters.
         (set-certificate-credentials-dh-parameters! cred dh)
         (set-certificate-credentials-rsa-export-parameters! cred rsa)
         (set-certificate-credentials-openpgp-keys! cred pub sec)
         (set-session-credentials! server cred))
     
       (set-session-transport-fd! server (fileno some-socket))
     
       (handshake server)
       (let ((msg (read (session-record-port server))))
         (format #t "received: ~a~%" msg)
     
         (bye server close-request/rdwr)))
</pre>
<p>In practice, generating RSA parameters (and Diffie-Hellman parameters)
can time a long time.  Thus, you may want to generate them once and
store them in a file for future re-use (see <a href="#Core-Interface"><code>pkcs1-export-rsa-parameters</code> and <code>pkcs1-import-rsa-parameters</code></a>).

<div class="node">
<a name="Importing-OpenPGP-Keys-Guile-Example"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#OpenPGP-Authentication-Guile-Example">OpenPGP Authentication Guile Example</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Guile-Examples">Guile Examples</a>

</div>

<h4 class="subsection">11.3.3 Importing OpenPGP Keys Guile Example</h4>

<p>The following example provides a simple way of importing
&ldquo;ASCII-armored&rdquo; OpenPGP keys from files, using the
<code>import-openpgp-certificate</code> and <code>import-openpgp-private-key</code>
procedures provided by the <code>(gnutls extra)</code> module.

<p><a name="index-openpgp_002dcertificate_002dformat_002fbase64-594"></a><a name="index-openpgp_002dcertificate_002dformat_002fraw-595"></a>
<pre class="example">     (use-modules (srfi srfi-4)
                  (gnutls extra))
     
     (define (import-key-from-file import-proc file)
       ;; Import OpenPGP key from FILE using IMPORT-PROC.
     
       ;; Prepare a u8vector large enough to hold the raw
       ;; key contents.
       (let* ((size (stat:size (stat path)))
              (raw  (make-u8vector size)))
     
         ;; Fill in the u8vector with the contents of FILE.
         (uniform-vector-read! raw (open-input-file file))
     
         ;; Pass the u8vector to the import procedure.
         (import-proc raw openpgp-certificate-format/base64)))
     
     
     (define (import-public-key-from-file file)
       (import-key-from-file import-openpgp-certificate file))
     
     (define (import-private-key-from-file file)
       (import-key-from-file import-openpgp-private-key file))
</pre>
<p>The procedures <code>import-public-key-from-file</code> and
<code>import-private-key-from-file</code> can be passed a file name.  They
return an OpenPGP public key and private key object, respectively
(see <a href="#Extra-Interface">OpenPGP key objects</a>).

<!-- ********************************************************************* -->
<div class="node">
<a name="Guile-Reference"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Guile-Examples">Guile Examples</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Guile-Bindings">Guile Bindings</a>

</div>

<h3 class="section">11.4 Guile Reference</h3>

<p>This chapter documents GnuTLS Scheme procedures available to Guile
programmers.

<ul class="menu">
<li><a accesskey="1" href="#Core-Interface">Core Interface</a>:               Bindings for core GnuTLS. 
<li><a accesskey="2" href="#Extra-Interface">Extra Interface</a>:              Bindings for GnuTLS-Extra. 
</ul>

<div class="node">
<a name="Core-Interface"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Extra-Interface">Extra Interface</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Guile-Reference">Guile Reference</a>

</div>

<h4 class="subsection">11.4.1 Core Interface</h4>

<p>This section lists the Scheme procedures exported by the
<code>(gnutls)</code> module (see <a href="guile.html#The-Guile-module-system">The Guile module system</a>).  This module is licenced under the GNU
Lesser General Public Licence, version 2.1 or later.

<!-- Automatically generated, do not edit. -->
<!-- snarfed from ../guile/src/core.c:2767 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-log-level!</b><var> level<a name="index-set_002dlog_002dlevel_0021-596"></a></var><br>
<blockquote><p>Enable GnuTLS logging up to <var>level</var> (an integer). 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2749 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-log-procedure!</b><var> proc<a name="index-set_002dlog_002dprocedure_0021-597"></a></var><br>
<blockquote><p>Use <var>proc</var> (a two-argument procedure) as the global GnuTLS log procedure. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2679 -->
<div class="defun">
&mdash; Scheme Procedure: <b>x509-certificate-subject-alternative-name</b><var> cert index<a name="index-x509_002dcertificate_002dsubject_002dalternative_002dname-598"></a></var><br>
<blockquote><p>Return two values: the alternative name type for <var>cert</var> (i.e., one of the <code>x509-subject-alternative-name/</code> values) and the actual subject alternative name (a string) at <var>index</var>. Both values are <code>#f</code> if no alternative name is available at <var>index</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2644 -->
<div class="defun">
&mdash; Scheme Procedure: <b>x509-certificate-subject-key-id</b><var> cert<a name="index-x509_002dcertificate_002dsubject_002dkey_002did-599"></a></var><br>
<blockquote><p>Return the subject key ID (a u8vector) for <var>cert</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2613 -->
<div class="defun">
&mdash; Scheme Procedure: <b>x509-certificate-authority-key-id</b><var> cert<a name="index-x509_002dcertificate_002dauthority_002dkey_002did-600"></a></var><br>
<blockquote><p>Return the key ID (a u8vector) of the X.509 certificate authority of <var>cert</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2581 -->
<div class="defun">
&mdash; Scheme Procedure: <b>x509-certificate-key-id</b><var> cert<a name="index-x509_002dcertificate_002dkey_002did-601"></a></var><br>
<blockquote><p>Return a statistically unique ID (a u8vector) for <var>cert</var> that depends on its public key parameters.  This is normally a 20-byte SHA-1 hash. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2559 -->
<div class="defun">
&mdash; Scheme Procedure: <b>x509-certificate-version</b><var> cert<a name="index-x509_002dcertificate_002dversion-602"></a></var><br>
<blockquote><p>Return the version of <var>cert</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2532 -->
<div class="defun">
&mdash; Scheme Procedure: <b>x509-certificate-key-usage</b><var> cert<a name="index-x509_002dcertificate_002dkey_002dusage-603"></a></var><br>
<blockquote><p>Return the key usage of <var>cert</var> (i.e., a list of <code>key-usage/</code> values), or the empty list if <var>cert</var> does not contain such information. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2509 -->
<div class="defun">
&mdash; Scheme Procedure: <b>x509-certificate-public-key-algorithm</b><var> cert<a name="index-x509_002dcertificate_002dpublic_002dkey_002dalgorithm-604"></a></var><br>
<blockquote><p>Return two values: the public key algorithm (i.e., one of the <code>pk-algorithm/</code> values) of <var>cert</var> and the number of bits used. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2486 -->
<div class="defun">
&mdash; Scheme Procedure: <b>x509-certificate-signature-algorithm</b><var> cert<a name="index-x509_002dcertificate_002dsignature_002dalgorithm-605"></a></var><br>
<blockquote><p>Return the signature algorithm used by <var>cert</var> (i.e., one of the <code>sign-algorithm/</code> values). 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2454 -->
<div class="defun">
&mdash; Scheme Procedure: <b>x509-certificate-matches-hostname?</b><var> cert hostname<a name="index-x509_002dcertificate_002dmatches_002dhostname_003f-606"></a></var><br>
<blockquote><p>Return true if <var>cert</var> matches <var>hostname</var>, a string denoting a DNS host name.  This is the basic implementation of <a href="http://tools.ietf.org/html/rfc2818">RFC 2818</a> (aka. HTTPS). 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2436 -->
<div class="defun">
&mdash; Scheme Procedure: <b>x509-certificate-issuer-dn-oid</b><var> cert index<a name="index-x509_002dcertificate_002dissuer_002ddn_002doid-607"></a></var><br>
<blockquote><p>Return the OID (a string) at <var>index</var> from <var>cert</var>'s issuer DN.  Return <code>#f</code> if no OID is available at <var>index</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2422 -->
<div class="defun">
&mdash; Scheme Procedure: <b>x509-certificate-dn-oid</b><var> cert index<a name="index-x509_002dcertificate_002ddn_002doid-608"></a></var><br>
<blockquote><p>Return OID (a string) at <var>index</var> from <var>cert</var>.  Return <code>#f</code> if no OID is available at <var>index</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2360 -->
<div class="defun">
&mdash; Scheme Procedure: <b>x509-certificate-issuer-dn</b><var> cert<a name="index-x509_002dcertificate_002dissuer_002ddn-609"></a></var><br>
<blockquote><p>Return the distinguished name (DN) of X.509 certificate <var>cert</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2347 -->
<div class="defun">
&mdash; Scheme Procedure: <b>x509-certificate-dn</b><var> cert<a name="index-x509_002dcertificate_002ddn-610"></a></var><br>
<blockquote><p>Return the distinguished name (DN) of X.509 certificate <var>cert</var>.  The form of the DN is as described in <a href="http://tools.ietf.org/html/rfc2253">RFC 2253</a>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2257 -->
<div class="defun">
&mdash; Scheme Procedure: <b>pkcs8-import-x509-private-key</b><var> data format </var>[<var>pass </var>[<var>encrypted</var>]]<var><a name="index-pkcs8_002dimport_002dx509_002dprivate_002dkey-611"></a></var><br>
<blockquote><p>Return a new X.509 private key object resulting from the import of <var>data</var> (a uniform array) according to <var>format</var>.  Optionally, if <var>pass</var> is not <code>#f</code>, it should be a string denoting a passphrase.  <var>encrypted</var> tells whether the private key is encrypted (<code>#t</code> by default). 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2208 -->
<div class="defun">
&mdash; Scheme Procedure: <b>import-x509-private-key</b><var> data format<a name="index-import_002dx509_002dprivate_002dkey-612"></a></var><br>
<blockquote><p>Return a new X.509 private key object resulting from the import of <var>data</var> (a uniform array) according to <var>format</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2163 -->
<div class="defun">
&mdash; Scheme Procedure: <b>import-x509-certificate</b><var> data format<a name="index-import_002dx509_002dcertificate-613"></a></var><br>
<blockquote><p>Return a new X.509 certificate object resulting from the import of <var>data</var> (a uniform array) according to <var>format</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2135 -->
<div class="defun">
&mdash; Scheme Procedure: <b>server-session-psk-username</b><var> session<a name="index-server_002dsession_002dpsk_002dusername-614"></a></var><br>
<blockquote><p>Return the username associated with PSK server session <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2091 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-psk-client-credentials!</b><var> cred username key key-format<a name="index-set_002dpsk_002dclient_002dcredentials_0021-615"></a></var><br>
<blockquote><p>Set the client credentials for <var>cred</var>, a PSK client credentials object. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2071 -->
<div class="defun">
&mdash; Scheme Procedure: <b>make-psk-client-credentials</b><var><a name="index-make_002dpsk_002dclient_002dcredentials-616"></a></var><br>
<blockquote><p>Return a new PSK client credentials object. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2043 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-psk-server-credentials-file!</b><var> cred file<a name="index-set_002dpsk_002dserver_002dcredentials_002dfile_0021-617"></a></var><br>
<blockquote><p>Use <var>file</var> as the password file for PSK server credentials <var>cred</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:2023 -->
<div class="defun">
&mdash; Scheme Procedure: <b>make-psk-server-credentials</b><var><a name="index-make_002dpsk_002dserver_002dcredentials-618"></a></var><br>
<blockquote><p>Return new PSK server credentials. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1735 -->
<div class="defun">
&mdash; Scheme Procedure: <b>peer-certificate-status</b><var> session<a name="index-peer_002dcertificate_002dstatus-619"></a></var><br>
<blockquote><p>Verify the peer certificate for <var>session</var> and return a list of <code>certificate-status</code> values (such as <code>certificate-status/revoked</code>), or the empty list if the certificate is valid. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1707 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-certificate-credentials-verify-flags!</b><var> cred </var>[<var>flags...</var>]<var><a name="index-set_002dcertificate_002dcredentials_002dverify_002dflags_0021-620"></a></var><br>
<blockquote><p>Set the certificate verification flags to <var>flags</var>, a series of <code>certificate-verify</code> values. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1685 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-certificate-credentials-verify-limits!</b><var> cred max-bits max-depth<a name="index-set_002dcertificate_002dcredentials_002dverify_002dlimits_0021-621"></a></var><br>
<blockquote><p>Set the verification limits of <code>peer-certificate-status</code> for certificate credentials <var>cred</var> to <var>max_bits</var> bits for an acceptable certificate and <var>max_depth</var> as the maximum depth of a certificate chain. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1648 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-certificate-credentials-x509-keys!</b><var> cred certs privkey<a name="index-set_002dcertificate_002dcredentials_002dx509_002dkeys_0021-622"></a></var><br>
<blockquote><p>Have certificate credentials <var>cred</var> use the X.509 certificates listed in <var>certs</var> and X.509 private key <var>privkey</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1602 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-certificate-credentials-x509-key-data!</b><var> cred cert key format<a name="index-set_002dcertificate_002dcredentials_002dx509_002dkey_002ddata_0021-623"></a></var><br>
<blockquote><p>Use X.509 certificate <var>cert</var> and private key <var>key</var>, both uniform arrays containing the X.509 certificate and key in format <var>format</var>, for certificate credentials <var>cred</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1582 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-certificate-credentials-x509-crl-data!</b><var> cred data format<a name="index-set_002dcertificate_002dcredentials_002dx509_002dcrl_002ddata_0021-624"></a></var><br>
<blockquote><p>Use <var>data</var> (a uniform array) as the X.509 CRL (certificate revocation list) database for <var>cred</var>.  On success, return the number of CRLs processed. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1563 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-certificate-credentials-x509-trust-data!</b><var> cred data format<a name="index-set_002dcertificate_002dcredentials_002dx509_002dtrust_002ddata_0021-625"></a></var><br>
<blockquote><p>Use <var>data</var> (a uniform array) as the X.509 trust database for <var>cred</var>.  On success, return the number of certificates processed. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1544 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-certificate-credentials-x509-crl-file!</b><var> cred file format<a name="index-set_002dcertificate_002dcredentials_002dx509_002dcrl_002dfile_0021-626"></a></var><br>
<blockquote><p>Use <var>file</var> as the X.509 CRL (certificate revocation list) file for certificate credentials <var>cred</var>.  On success, return the number of CRLs processed. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1525 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-certificate-credentials-x509-trust-file!</b><var> cred file format<a name="index-set_002dcertificate_002dcredentials_002dx509_002dtrust_002dfile_0021-627"></a></var><br>
<blockquote><p>Use <var>file</var> as the X.509 trust file for certificate credentials <var>cred</var>.  On success, return the number of certificates processed. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1483 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-certificate-credentials-x509-key-files!</b><var> cred cert-file key-file format<a name="index-set_002dcertificate_002dcredentials_002dx509_002dkey_002dfiles_0021-628"></a></var><br>
<blockquote><p>Use <var>file</var> as the password file for PSK server credentials <var>cred</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1462 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-certificate-credentials-rsa-export-parameters!</b><var> cred rsa-params<a name="index-set_002dcertificate_002dcredentials_002drsa_002dexport_002dparameters_0021-629"></a></var><br>
<blockquote><p>Use RSA parameters <var>rsa_params</var> for certificate credentials <var>cred</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1441 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-certificate-credentials-dh-parameters!</b><var> cred dh-params<a name="index-set_002dcertificate_002dcredentials_002ddh_002dparameters_0021-630"></a></var><br>
<blockquote><p>Use Diffie-Hellman parameters <var>dh_params</var> for certificate credentials <var>cred</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1421 -->
<div class="defun">
&mdash; Scheme Procedure: <b>make-certificate-credentials</b><var><a name="index-make_002dcertificate_002dcredentials-631"></a></var><br>
<blockquote><p>Return new certificate credentials (i.e., for use with either X.509 or OpenPGP certificates. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1315 -->
<div class="defun">
&mdash; Scheme Procedure: <b>pkcs1-export-rsa-parameters</b><var> rsa-params format<a name="index-pkcs1_002dexport_002drsa_002dparameters-632"></a></var><br>
<blockquote><p>Export Diffie-Hellman parameters <var>rsa_params</var> in PKCS1 format according for <var>format</var> (an <code>x509-certificate-format</code> value).  Return a <code>u8vector</code> containing the result. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1270 -->
<div class="defun">
&mdash; Scheme Procedure: <b>pkcs1-import-rsa-parameters</b><var> array format<a name="index-pkcs1_002dimport_002drsa_002dparameters-633"></a></var><br>
<blockquote><p>Import Diffie-Hellman parameters in PKCS1 format (further specified by <var>format</var>, an <code>x509-certificate-format</code> value) from <var>array</var> (a homogeneous array) and return a new <code>rsa-params</code> object. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1238 -->
<div class="defun">
&mdash; Scheme Procedure: <b>make-rsa-parameters</b><var> bits<a name="index-make_002drsa_002dparameters-634"></a></var><br>
<blockquote><p>Return new RSA parameters. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1218 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-anonymous-server-dh-parameters!</b><var> cred dh-params<a name="index-set_002danonymous_002dserver_002ddh_002dparameters_0021-635"></a></var><br>
<blockquote><p>Set the Diffie-Hellman parameters of anonymous server credentials <var>cred</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1198 -->
<div class="defun">
&mdash; Scheme Procedure: <b>make-anonymous-client-credentials</b><var><a name="index-make_002danonymous_002dclient_002dcredentials-636"></a></var><br>
<blockquote><p>Return anonymous client credentials. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1180 -->
<div class="defun">
&mdash; Scheme Procedure: <b>make-anonymous-server-credentials</b><var><a name="index-make_002danonymous_002dserver_002dcredentials-637"></a></var><br>
<blockquote><p>Return anonymous server credentials. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1159 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-session-dh-prime-bits!</b><var> session bits<a name="index-set_002dsession_002ddh_002dprime_002dbits_0021-638"></a></var><br>
<blockquote><p>Use <var>bits</var> DH prime bits for <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1137 -->
<div class="defun">
&mdash; Scheme Procedure: <b>pkcs3-export-dh-parameters</b><var> dh-params format<a name="index-pkcs3_002dexport_002ddh_002dparameters-639"></a></var><br>
<blockquote><p>Export Diffie-Hellman parameters <var>dh_params</var> in PKCS3 format according for <var>format</var> (an <code>x509-certificate-format</code> value).  Return a <code>u8vector</code> containing the result. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1092 -->
<div class="defun">
&mdash; Scheme Procedure: <b>pkcs3-import-dh-parameters</b><var> array format<a name="index-pkcs3_002dimport_002ddh_002dparameters-640"></a></var><br>
<blockquote><p>Import Diffie-Hellman parameters in PKCS3 format (further specified by <var>format</var>, an <code>x509-certificate-format</code> value) from <var>array</var> (a homogeneous array) and return a new <code>dh-params</code> object. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:1060 -->
<div class="defun">
&mdash; Scheme Procedure: <b>make-dh-parameters</b><var> bits<a name="index-make_002ddh_002dparameters-641"></a></var><br>
<blockquote><p>Return new Diffie-Hellman parameters. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:979 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-session-transport-port!</b><var> session port<a name="index-set_002dsession_002dtransport_002dport_0021-642"></a></var><br>
<blockquote><p>Use <var>port</var> as the input/output port for <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:929 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-session-transport-fd!</b><var> session fd<a name="index-set_002dsession_002dtransport_002dfd_0021-643"></a></var><br>
<blockquote><p>Use file descriptor <var>fd</var> as the underlying transport for <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:890 -->
<div class="defun">
&mdash; Scheme Procedure: <b>session-record-port</b><var> session<a name="index-session_002drecord_002dport-644"></a></var><br>
<blockquote><p>Return a read-write port that may be used to communicate over <var>session</var>.  All invocations of <code>session-port</code> on a given session return the same object (in the sense of <code>eq?</code>). 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:673 -->
<div class="defun">
&mdash; Scheme Procedure: <b>record-receive!</b><var> session array<a name="index-record_002dreceive_0021-645"></a></var><br>
<blockquote><p>Receive data from <var>session</var> into <var>array</var>, a uniform homogeneous array.  Return the number of bytes actually received. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:640 -->
<div class="defun">
&mdash; Scheme Procedure: <b>record-send</b><var> session array<a name="index-record_002dsend-646"></a></var><br>
<blockquote><p>Send the record constituted by <var>array</var> through <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:558 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-session-credentials!</b><var> session cred<a name="index-set_002dsession_002dcredentials_0021-647"></a></var><br>
<blockquote><p>Use <var>cred</var> as <var>session</var>'s credentials. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:536 -->
<div class="defun">
&mdash; Scheme Procedure: <b>cipher-suite-&gt;string</b><var> kx cipher mac<a name="index-cipher_002dsuite_002d_003estring-648"></a></var><br>
<blockquote><p>Return the name of the given cipher suite. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:520 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-session-default-export-priority!</b><var> session<a name="index-set_002dsession_002ddefault_002dexport_002dpriority_0021-649"></a></var><br>
<blockquote><p>Have <var>session</var> use the default export priorities. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:504 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-session-default-priority!</b><var> session<a name="index-set_002dsession_002ddefault_002dpriority_0021-650"></a></var><br>
<blockquote><p>Have <var>session</var> use the default priorities. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/priorities.i.c:105 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-session-certificate-type-priority!</b><var> session items<a name="index-set_002dsession_002dcertificate_002dtype_002dpriority_0021-651"></a></var><br>
<blockquote><p>Use <var>items</var> (a list) as the list of preferred certificate-type for <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/priorities.i.c:85 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-session-protocol-priority!</b><var> session items<a name="index-set_002dsession_002dprotocol_002dpriority_0021-652"></a></var><br>
<blockquote><p>Use <var>items</var> (a list) as the list of preferred protocol for <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/priorities.i.c:65 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-session-kx-priority!</b><var> session items<a name="index-set_002dsession_002dkx_002dpriority_0021-653"></a></var><br>
<blockquote><p>Use <var>items</var> (a list) as the list of preferred kx for <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/priorities.i.c:45 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-session-compression-method-priority!</b><var> session items<a name="index-set_002dsession_002dcompression_002dmethod_002dpriority_0021-654"></a></var><br>
<blockquote><p>Use <var>items</var> (a list) as the list of preferred compression-method for <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/priorities.i.c:25 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-session-mac-priority!</b><var> session items<a name="index-set_002dsession_002dmac_002dpriority_0021-655"></a></var><br>
<blockquote><p>Use <var>items</var> (a list) as the list of preferred mac for <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/priorities.i.c:5 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-session-cipher-priority!</b><var> session items<a name="index-set_002dsession_002dcipher_002dpriority_0021-656"></a></var><br>
<blockquote><p>Use <var>items</var> (a list) as the list of preferred cipher for <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:481 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-server-session-certificate-request!</b><var> session request<a name="index-set_002dserver_002dsession_002dcertificate_002drequest_0021-657"></a></var><br>
<blockquote><p>Tell how <var>session</var>, a server-side session, should deal with certificate requests.  <var>request</var> should be either <code>certificate-request/request</code> or <code>certificate-request/require</code>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:441 -->
<div class="defun">
&mdash; Scheme Procedure: <b>session-our-certificate-chain</b><var> session<a name="index-session_002dour_002dcertificate_002dchain-658"></a></var><br>
<blockquote><p>Return our certificate chain for <var>session</var> (as sent to the peer) in raw format (a u8vector).  In the case of OpenPGP there is exactly one certificate.  Return the empty list if no certificate was used. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:394 -->
<div class="defun">
&mdash; Scheme Procedure: <b>session-peer-certificate-chain</b><var> session<a name="index-session_002dpeer_002dcertificate_002dchain-659"></a></var><br>
<blockquote><p>Return the a list of certificates in raw format (u8vectors) where the first one is the peer's certificate.  In the case of OpenPGP, there is always exactly one certificate.  In the case of X.509, subsequent certificates indicate form a certificate chain.  Return the empty list if no certificate was sent. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:370 -->
<div class="defun">
&mdash; Scheme Procedure: <b>session-client-authentication-type</b><var> session<a name="index-session_002dclient_002dauthentication_002dtype-660"></a></var><br>
<blockquote><p>Return the client authentication type (a <code>credential-type</code> value) used in <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:350 -->
<div class="defun">
&mdash; Scheme Procedure: <b>session-server-authentication-type</b><var> session<a name="index-session_002dserver_002dauthentication_002dtype-661"></a></var><br>
<blockquote><p>Return the server authentication type (a <code>credential-type</code> value) used in <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:330 -->
<div class="defun">
&mdash; Scheme Procedure: <b>session-authentication-type</b><var> session<a name="index-session_002dauthentication_002dtype-662"></a></var><br>
<blockquote><p>Return the authentication type (a <code>credential-type</code> value) used by <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:310 -->
<div class="defun">
&mdash; Scheme Procedure: <b>session-protocol</b><var> session<a name="index-session_002dprotocol-663"></a></var><br>
<blockquote><p>Return the protocol used by <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:294 -->
<div class="defun">
&mdash; Scheme Procedure: <b>session-certificate-type</b><var> session<a name="index-session_002dcertificate_002dtype-664"></a></var><br>
<blockquote><p>Return <var>session</var>'s certificate type. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:277 -->
<div class="defun">
&mdash; Scheme Procedure: <b>session-compression-method</b><var> session<a name="index-session_002dcompression_002dmethod-665"></a></var><br>
<blockquote><p>Return <var>session</var>'s compression method. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:260 -->
<div class="defun">
&mdash; Scheme Procedure: <b>session-mac</b><var> session<a name="index-session_002dmac-666"></a></var><br>
<blockquote><p>Return <var>session</var>'s MAC. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:244 -->
<div class="defun">
&mdash; Scheme Procedure: <b>session-kx</b><var> session<a name="index-session_002dkx-667"></a></var><br>
<blockquote><p>Return <var>session</var>'s kx. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:228 -->
<div class="defun">
&mdash; Scheme Procedure: <b>session-cipher</b><var> session<a name="index-session_002dcipher-668"></a></var><br>
<blockquote><p>Return <var>session</var>'s cipher. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:201 -->
<div class="defun">
&mdash; Scheme Procedure: <b>alert-send</b><var> session level alert<a name="index-alert_002dsend-669"></a></var><br>
<blockquote><p>Send <var>alert</var> via <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:184 -->
<div class="defun">
&mdash; Scheme Procedure: <b>alert-get</b><var> session<a name="index-alert_002dget-670"></a></var><br>
<blockquote><p>Get an aleter from <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:166 -->
<div class="defun">
&mdash; Scheme Procedure: <b>rehandshake</b><var> session<a name="index-rehandshake-671"></a></var><br>
<blockquote><p>Perform a re-handshaking for <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:148 -->
<div class="defun">
&mdash; Scheme Procedure: <b>handshake</b><var> session<a name="index-handshake-672"></a></var><br>
<blockquote><p>Perform a handshake for <var>session</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:128 -->
<div class="defun">
&mdash; Scheme Procedure: <b>bye</b><var> session how<a name="index-bye-673"></a></var><br>
<blockquote><p>Close <var>session</var> according to <var>how</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:103 -->
<div class="defun">
&mdash; Scheme Procedure: <b>make-session</b><var> end<a name="index-make_002dsession-674"></a></var><br>
<blockquote><p>Return a new session for connection end <var>end</var>, either <code>connection-end/server</code> or <code>connection-end/client</code>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/core.c:92 -->
<div class="defun">
&mdash; Scheme Procedure: <b>gnutls-version</b><var><a name="index-gnutls_002dversion-675"></a></var><br>
<blockquote><p>Return a string denoting the version number of the underlying GnuTLS library, e.g., <code>"1.7.2"</code>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/smob-types.i.c:187 -->
<div class="defun">
&mdash; Scheme Procedure: <b>x509-private-key?</b><var> obj<a name="index-x509_002dprivate_002dkey_003f-676"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is of type <code>x509-private-key</code>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/smob-types.i.c:171 -->
<div class="defun">
&mdash; Scheme Procedure: <b>x509-certificate?</b><var> obj<a name="index-x509_002dcertificate_003f-677"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is of type <code>x509-certificate</code>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/smob-types.i.c:155 -->
<div class="defun">
&mdash; Scheme Procedure: <b>psk-client-credentials?</b><var> obj<a name="index-psk_002dclient_002dcredentials_003f-678"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is of type <code>psk-client-credentials</code>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/smob-types.i.c:139 -->
<div class="defun">
&mdash; Scheme Procedure: <b>psk-server-credentials?</b><var> obj<a name="index-psk_002dserver_002dcredentials_003f-679"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is of type <code>psk-server-credentials</code>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/smob-types.i.c:123 -->
<div class="defun">
&mdash; Scheme Procedure: <b>srp-client-credentials?</b><var> obj<a name="index-srp_002dclient_002dcredentials_003f-680"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is of type <code>srp-client-credentials</code>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/smob-types.i.c:107 -->
<div class="defun">
&mdash; Scheme Procedure: <b>srp-server-credentials?</b><var> obj<a name="index-srp_002dserver_002dcredentials_003f-681"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is of type <code>srp-server-credentials</code>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/smob-types.i.c:91 -->
<div class="defun">
&mdash; Scheme Procedure: <b>certificate-credentials?</b><var> obj<a name="index-certificate_002dcredentials_003f-682"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is of type <code>certificate-credentials</code>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/smob-types.i.c:75 -->
<div class="defun">
&mdash; Scheme Procedure: <b>rsa-parameters?</b><var> obj<a name="index-rsa_002dparameters_003f-683"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is of type <code>rsa-parameters</code>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/smob-types.i.c:59 -->
<div class="defun">
&mdash; Scheme Procedure: <b>dh-parameters?</b><var> obj<a name="index-dh_002dparameters_003f-684"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is of type <code>dh-parameters</code>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/smob-types.i.c:43 -->
<div class="defun">
&mdash; Scheme Procedure: <b>anonymous-server-credentials?</b><var> obj<a name="index-anonymous_002dserver_002dcredentials_003f-685"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is of type <code>anonymous-server-credentials</code>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/smob-types.i.c:27 -->
<div class="defun">
&mdash; Scheme Procedure: <b>anonymous-client-credentials?</b><var> obj<a name="index-anonymous_002dclient_002dcredentials_003f-686"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is of type <code>anonymous-client-credentials</code>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/smob-types.i.c:11 -->
<div class="defun">
&mdash; Scheme Procedure: <b>session?</b><var> obj<a name="index-session_003f-687"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is of type <code>session</code>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:876 -->
<div class="defun">
&mdash; Scheme Procedure: <b>error-&gt;string</b><var> enumval<a name="index-error_002d_003estring-688"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>error</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:855 -->
<div class="defun">
&mdash; Scheme Procedure: <b>certificate-verify-&gt;string</b><var> enumval<a name="index-certificate_002dverify_002d_003estring-689"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>certificate-verify</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:810 -->
<div class="defun">
&mdash; Scheme Procedure: <b>key-usage-&gt;string</b><var> enumval<a name="index-key_002dusage_002d_003estring-690"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>key-usage</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:762 -->
<div class="defun">
&mdash; Scheme Procedure: <b>psk-key-format-&gt;string</b><var> enumval<a name="index-psk_002dkey_002dformat_002d_003estring-691"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>psk-key-format</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:721 -->
<div class="defun">
&mdash; Scheme Procedure: <b>sign-algorithm-&gt;string</b><var> enumval<a name="index-sign_002dalgorithm_002d_003estring-692"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>sign-algorithm</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:700 -->
<div class="defun">
&mdash; Scheme Procedure: <b>pk-algorithm-&gt;string</b><var> enumval<a name="index-pk_002dalgorithm_002d_003estring-693"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>pk-algorithm</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:679 -->
<div class="defun">
&mdash; Scheme Procedure: <b>x509-subject-alternative-name-&gt;string</b><var> enumval<a name="index-x509_002dsubject_002dalternative_002dname_002d_003estring-694"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>x509-subject-alternative-name</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:636 -->
<div class="defun">
&mdash; Scheme Procedure: <b>x509-certificate-format-&gt;string</b><var> enumval<a name="index-x509_002dcertificate_002dformat_002d_003estring-695"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>x509-certificate-format</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:595 -->
<div class="defun">
&mdash; Scheme Procedure: <b>certificate-type-&gt;string</b><var> enumval<a name="index-certificate_002dtype_002d_003estring-696"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>certificate-type</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:574 -->
<div class="defun">
&mdash; Scheme Procedure: <b>protocol-&gt;string</b><var> enumval<a name="index-protocol_002d_003estring-697"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>protocol</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:531 -->
<div class="defun">
&mdash; Scheme Procedure: <b>close-request-&gt;string</b><var> enumval<a name="index-close_002drequest_002d_003estring-698"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>close-request</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:490 -->
<div class="defun">
&mdash; Scheme Procedure: <b>certificate-request-&gt;string</b><var> enumval<a name="index-certificate_002drequest_002d_003estring-699"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>certificate-request</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:448 -->
<div class="defun">
&mdash; Scheme Procedure: <b>certificate-status-&gt;string</b><var> enumval<a name="index-certificate_002dstatus_002d_003estring-700"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>certificate-status</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:404 -->
<div class="defun">
&mdash; Scheme Procedure: <b>handshake-description-&gt;string</b><var> enumval<a name="index-handshake_002ddescription_002d_003estring-701"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>handshake-description</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:355 -->
<div class="defun">
&mdash; Scheme Procedure: <b>alert-description-&gt;string</b><var> enumval<a name="index-alert_002ddescription_002d_003estring-702"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>alert-description</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:286 -->
<div class="defun">
&mdash; Scheme Procedure: <b>alert-level-&gt;string</b><var> enumval<a name="index-alert_002dlevel_002d_003estring-703"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>alert-level</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:245 -->
<div class="defun">
&mdash; Scheme Procedure: <b>connection-end-&gt;string</b><var> enumval<a name="index-connection_002dend_002d_003estring-704"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>connection-end</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:204 -->
<div class="defun">
&mdash; Scheme Procedure: <b>compression-method-&gt;string</b><var> enumval<a name="index-compression_002dmethod_002d_003estring-705"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>compression-method</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:183 -->
<div class="defun">
&mdash; Scheme Procedure: <b>digest-&gt;string</b><var> enumval<a name="index-digest_002d_003estring-706"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>digest</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:139 -->
<div class="defun">
&mdash; Scheme Procedure: <b>mac-&gt;string</b><var> enumval<a name="index-mac_002d_003estring-707"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>mac</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:118 -->
<div class="defun">
&mdash; Scheme Procedure: <b>credentials-&gt;string</b><var> enumval<a name="index-credentials_002d_003estring-708"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>credentials</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:74 -->
<div class="defun">
&mdash; Scheme Procedure: <b>params-&gt;string</b><var> enumval<a name="index-params_002d_003estring-709"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>params</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:33 -->
<div class="defun">
&mdash; Scheme Procedure: <b>kx-&gt;string</b><var> enumval<a name="index-kx_002d_003estring-710"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>kx</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/enum-map.i.c:12 -->
<div class="defun">
&mdash; Scheme Procedure: <b>cipher-&gt;string</b><var> enumval<a name="index-cipher_002d_003estring-711"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>cipher</code> value. 
</p></blockquote></div>

<div class="node">
<a name="Extra-Interface"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Core-Interface">Core Interface</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Guile-Reference">Guile Reference</a>

</div>

<h4 class="subsection">11.4.2 Extra Interface</h4>

<p>This section lists the Scheme procedures exported by the <code>(gnutls
extra)</code> module.  This module is licenced under the GNU General Public
Licence, version 3 or later.

<!-- Automatically generated, do not edit. -->
<!-- snarfed from ../guile/src/extra.c:513 -->
<div class="defun">
&mdash; Scheme Procedure: <b>set-certificate-credentials-openpgp-keys!</b><var> cred pub sec<a name="index-set_002dcertificate_002dcredentials_002dopenpgp_002dkeys_0021-712"></a></var><br>
<blockquote><p>Use certificate <var>pub</var> and secret key <var>sec</var> in certificate credentials <var>cred</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/extra.c:475 -->
<div class="defun">
&mdash; Scheme Procedure: <b>openpgp-keyring-contains-key-id?</b><var> keyring id<a name="index-openpgp_002dkeyring_002dcontains_002dkey_002did_003f-713"></a></var><br>
<blockquote><p>Return <code>#f</code> if key ID <var>id</var> is in <var>keyring</var>, <code>#f</code> otherwise. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/extra.c:429 -->
<div class="defun">
&mdash; Scheme Procedure: <b>import-openpgp-keyring</b><var> data format<a name="index-import_002dopenpgp_002dkeyring-714"></a></var><br>
<blockquote><p>Import <var>data</var> (a u8vector) according to <var>format</var> and return the imported keyring. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/extra.c:403 -->
<div class="defun">
&mdash; Scheme Procedure: <b>openpgp-certificate-usage</b><var> key<a name="index-openpgp_002dcertificate_002dusage-715"></a></var><br>
<blockquote><p>Return a list of values denoting the key usage of <var>key</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/extra.c:386 -->
<div class="defun">
&mdash; Scheme Procedure: <b>openpgp-certificate-version</b><var> key<a name="index-openpgp_002dcertificate_002dversion-716"></a></var><br>
<blockquote><p>Return the version of the OpenPGP message format (RFC2440) honored by <var>key</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/extra.c:365 -->
<div class="defun">
&mdash; Scheme Procedure: <b>openpgp-certificate-algorithm</b><var> key<a name="index-openpgp_002dcertificate_002dalgorithm-717"></a></var><br>
<blockquote><p>Return two values: the certificate algorithm used by <var>key</var> and the number of bits used. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/extra.c:329 -->
<div class="defun">
&mdash; Scheme Procedure: <b>openpgp-certificate-names</b><var> key<a name="index-openpgp_002dcertificate_002dnames-718"></a></var><br>
<blockquote><p>Return the list of names for <var>key</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/extra.c:306 -->
<div class="defun">
&mdash; Scheme Procedure: <b>openpgp-certificate-name</b><var> key index<a name="index-openpgp_002dcertificate_002dname-719"></a></var><br>
<blockquote><p>Return the <var>index</var>th name of <var>key</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/extra.c:248 -->
<div class="defun">
&mdash; Scheme Procedure: <b>openpgp-certificate-fingerprint</b><var> key<a name="index-openpgp_002dcertificate_002dfingerprint-720"></a></var><br>
<blockquote><p>Return a new u8vector denoting the fingerprint of <var>key</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/extra.c:218 -->
<div class="defun">
&mdash; Scheme Procedure: <b>openpgp-certificate-fingerprint!</b><var> key fpr<a name="index-openpgp_002dcertificate_002dfingerprint_0021-721"></a></var><br>
<blockquote><p>Store in <var>fpr</var> (a u8vector) the fingerprint of <var>key</var>.  Return the number of bytes stored in <var>fpr</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/extra.c:183 -->
<div class="defun">
&mdash; Scheme Procedure: <b>openpgp-certificate-id!</b><var> key id<a name="index-openpgp_002dcertificate_002did_0021-722"></a></var><br>
<blockquote><p>Store the ID (an 8 byte sequence) of certificate <var>key</var> in <var>id</var> (a u8vector). 
</p></blockquote></div>

<!-- snarfed from ../guile/src/extra.c:157 -->
<div class="defun">
&mdash; Scheme Procedure: <b>openpgp-certificate-id</b><var> key<a name="index-openpgp_002dcertificate_002did-723"></a></var><br>
<blockquote><p>Return the ID (an 8-element u8vector) of certificate <var>key</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/extra.c:102 -->
<div class="defun">
&mdash; Scheme Procedure: <b>import-openpgp-private-key</b><var> data format </var>[<var>pass</var>]<var><a name="index-import_002dopenpgp_002dprivate_002dkey-724"></a></var><br>
<blockquote><p>Return a new OpenPGP private key object resulting from the import of <var>data</var> (a uniform array) according to <var>format</var>.  Optionally, a passphrase may be provided. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/extra.c:57 -->
<div class="defun">
&mdash; Scheme Procedure: <b>import-openpgp-certificate</b><var> data format<a name="index-import_002dopenpgp_002dcertificate-725"></a></var><br>
<blockquote><p>Return a new OpenPGP certificate object resulting from the import of <var>data</var> (a uniform array) according to <var>format</var>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/extra-enum-map.i.c:32 -->
<div class="defun">
&mdash; Scheme Procedure: <b>openpgp-certificate-format-&gt;string</b><var> enumval<a name="index-openpgp_002dcertificate_002dformat_002d_003estring-726"></a></var><br>
<blockquote><p>Return a string describing <var>enumval</var>, a <code>openpgp-certificate-format</code> value. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/extra-smob-types.i.c:43 -->
<div class="defun">
&mdash; Scheme Procedure: <b>openpgp-keyring?</b><var> obj<a name="index-openpgp_002dkeyring_003f-727"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is of type <code>openpgp-keyring</code>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/extra-smob-types.i.c:27 -->
<div class="defun">
&mdash; Scheme Procedure: <b>openpgp-private-key?</b><var> obj<a name="index-openpgp_002dprivate_002dkey_003f-728"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is of type <code>openpgp-private-key</code>. 
</p></blockquote></div>

<!-- snarfed from ../guile/src/extra-smob-types.i.c:11 -->
<div class="defun">
&mdash; Scheme Procedure: <b>openpgp-certificate?</b><var> obj<a name="index-openpgp_002dcertificate_003f-729"></a></var><br>
<blockquote><p>Return true if <var>obj</var> is of type <code>openpgp-certificate</code>. 
</p></blockquote></div>

<!-- Local Variables: -->
<!-- ispell-local-dictionary: "american" -->
<!-- End: -->
<div class="node">
<a name="Internal-architecture-of-GnuTLS"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Copying-Information">Copying Information</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Guile-Bindings">Guile Bindings</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">12 Internal Architecture of GnuTLS</h2>

<p><a name="index-Internal-architecture-730"></a>
This chapter is to give a brief description of the
way <acronym>GnuTLS</acronym> works. The focus is to give an idea
to potential developers and those who want to know what
happens inside the black box.

<ul class="menu">
<li><a accesskey="1" href="#The-TLS-Protocol">The TLS Protocol</a>
<li><a accesskey="2" href="#TLS-Handshake-Protocol">TLS Handshake Protocol</a>
<li><a accesskey="3" href="#TLS-Authentication-Methods">TLS Authentication Methods</a>
<li><a accesskey="4" href="#TLS-Extension-Handling">TLS Extension Handling</a>
<li><a accesskey="5" href="#Cryptographic-Backend">Cryptographic Backend</a>
</ul>

<div class="node">
<a name="The-TLS-Protocol"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#TLS-Handshake-Protocol">TLS Handshake Protocol</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Internal-architecture-of-GnuTLS">Internal architecture of GnuTLS</a>

</div>

<h3 class="section">12.1 The TLS Protocol</h3>

<p>The main needs for the TLS protocol to be used are
shown in the image below.

<div class="block-image"><img src="gnutls-client-server-use-case.png" alt="gnutls-client-server-use-case.png"></div>

<p>This is being accomplished by the following object diagram. 
Note that since <acronym>GnuTLS</acronym> is being developed in C
object are just structures with attributes. The operations listed
are functions that require the first parameter to be that object. 
<img src="gnutls-objects.png" alt="gnutls-objects.png">

<div class="node">
<a name="TLS-Handshake-Protocol"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#TLS-Authentication-Methods">TLS Authentication Methods</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#The-TLS-Protocol">The TLS Protocol</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Internal-architecture-of-GnuTLS">Internal architecture of GnuTLS</a>

</div>

<h3 class="section">12.2 TLS Handshake Protocol</h3>

<p>The <acronym>GnuTLS</acronym> handshake protocol is implemented as a state
machine that waits for input or returns immediately when the non-blocking
transport layer functions are used. The main idea is shown in the following
figure.

<div class="block-image"><img src="gnutls-handshake-state.png" alt="gnutls-handshake-state.png"></div>

<p>Also the way the input is processed varies per ciphersuite. Several
implementations of the internal handlers are available and
<a href="#gnutls_005fhandshake">gnutls_handshake</a> only multiplexes the input to the appropriate
handler. For example a <acronym>PSK</acronym> ciphersuite has a different
implementation of the <code>process_client_key_exchange</code> than a
certificate ciphersuite.

<div class="block-image"><img src="gnutls-handshake-sequence.png" alt="gnutls-handshake-sequence.png"></div>

<div class="node">
<a name="TLS-Authentication-Methods"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#TLS-Extension-Handling">TLS Extension Handling</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#TLS-Handshake-Protocol">TLS Handshake Protocol</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Internal-architecture-of-GnuTLS">Internal architecture of GnuTLS</a>

</div>

<h3 class="section">12.3 TLS Authentication Methods</h3>

<p>In <acronym>GnuTLS</acronym> authentication methods can be implemented quite easily. 
Since the required changes to add a new authentication method affect only the
handshake protocol, a simple interface is used. An authentication method needs
only to implement the functions as seen in the figure below.

<div class="block-image"><img src="gnutls-mod_auth_st.png" alt="gnutls-mod_auth_st.png"></div>

<p>The functions that need to be implemented are the ones responsible for interpreting
the handshake protocol messages. It is common for such functions to read data from
one or more <code>credentials_t</code> structures<a rel="footnote" href="#fn-17" name="fnd-17"><sup>17</sup></a> and write data, such as certificates, usernames etc. to <code>auth_info_t</code> structures.

<p>Simple examples of existing authentication methods can be seen in <code>auth_psk.c</code>
for PSK ciphersuites and <code>auth_srp.c</code> for SRP ciphersuites. After implementing these functions
the structure holding its pointers has to be registered in <code>gnutls_algorithms.c</code>
in the <code>_gnutls_kx_algorithms</code> structure.

<div class="node">
<a name="TLS-Extension-Handling"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Cryptographic-Backend">Cryptographic Backend</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#TLS-Authentication-Methods">TLS Authentication Methods</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Internal-architecture-of-GnuTLS">Internal architecture of GnuTLS</a>

</div>

<h3 class="section">12.4 TLS Extension Handling</h3>

<p>As with authentication methods, the TLS extensions handlers can be implemented
using the following interface.

<div class="block-image"><img src="gnutls-extensions_st.png" alt="gnutls-extensions_st.png"></div>

<p>Here there are two functions, one for receiving the extension data
and one for sending. These functions have to check internally whether
they operate in client or server side.

<p>A simple example of an extension handler can be seen in <code>ext_srp.c</code>
After implementing these functions, together with the extension number they
handle, they have to be registered in <code>gnutls_extensions.c</code> in the
<code>_gnutls_extensions</code> structure.

<h4 class="subsection">12.4.1 Adding a New TLS Extension</h4>

<p>Adding support for a new TLS extension is done from time to time, and
the process to do so is not difficult.  Here are the steps you need to
follow if you wish to do this yourself.  For sake of discussion, let's
consider adding support for the hypothetical TLS extension
<code>foobar</code>.

     <ol type=1 start=1>

     <li>Modify <code>configure.in</code> to add <code>--enable-foobar</code> or <code>--disable-foobar</code>.

     <p>Which to chose depends on whether you intend to make the extension be
enabled by default.  Look at existing checks (i.e., SRP, authz) for
how to model the code.  For example:

     <pre class="example">          AC_MSG_CHECKING([whether to disable foobar support])
          AC_ARG_ENABLE(foobar,
          	AS_HELP_STRING([--disable-foobar],
          		[disable foobar support]),
          	ac_enable_foobar=no)
          if test x$ac_enable_foobar != xno; then
           AC_MSG_RESULT(no)
           AC_DEFINE(ENABLE_FOOBAR, 1, [enable foobar])
          else
           ac_full=0
           AC_MSG_RESULT(yes)
          fi
          AM_CONDITIONAL(ENABLE_FOOBAR, test "$ac_enable_foobar" != "no")
</pre>
     <li>Add IANA extension value to <code>extensions_t</code> in <code>gnutls_int.h</code>.

     <p>A good name for the value would be GNUTLS_EXTENSION_FOOBAR.  Check
with <a href="http://www.iana.org/assignments/tls-extensiontype-values">http://www.iana.org/assignments/tls-extensiontype-values</a>
for allocated values.  For experiments, you could pick a number but
remember that some consider it a bad idea to deploy such modified
version since it will lead to interoperability problems in the future
when the IANA allocates that number to someone else, or when the
foobar protocol is allocated another number.

     <li>Add an entry to <code>_gnutls_extensions</code> in <code>gnutls_extensions.c</code>.

     <p>A typical entry would be:

     <pre class="example">          #if ENABLE_FOOBAR
            GNUTLS_EXTENSION_ENTRY (GNUTLS_EXTENSION_FOOBAR,
          			  _gnutls_foobar_recv_params,
          			  _gnutls_foobar_send_params),
          #endif
</pre>
     <p>The GNUTLS_EXTENSION_FOOBAR is the integer value you added to
<code>gnutls_int.h</code> earlier.  The two functions are new functions that
you will need to implement, most likely you'll need to add an
<code>#include "ext_foobar.h"</code> as well.

     <li>Add new files <code>ext_foobar.c</code> and <code>ext_foobar.h</code> that implements the extension.

     <p>The functions you are responsible to add are those mentioned in the
previous step.  As a starter, you could add this:

     <pre class="example">          int
          _gnutls_foobar_recv_params (gnutls_session_t session,
                                      const opaque * data,
                                      size_t data_size)
          {
            return 0;
          }
          
          int
          _gnutls_foobar_send_params (gnutls_session_t session,
                                      opaque * data,
                                      size_t _data_size)
          {
            return 0;
          }
</pre>
     <p>The <code>_gnutls_foobar_recv_params</code> function is responsible for
parsing incoming extension data (both in the client and server).

     <p>The <code>_gnutls_foobar_send_params</code> function is responsible for
sending extension data (both in the client and server).

     <p>If you receive length fields that doesn't match, return
<code>GNUTLS_E_UNEXPECTED_PACKET_LENGTH</code>.  If you receive invalid
data, return <code>GNUTLS_E_RECEIVED_ILLEGAL_PARAMETER</code>.  You can use
other error codes too.  Return 0 on success.

     <p>The function typically store some information in the <code>session</code>
variable for later usage.  If you need to add new fields there, check
<code>tls_ext_st</code> in <code>gnutls_int.h</code> and compare with existing TLS
extension specific variables.

     <p>Recall that both the client and server both send and receives
parameters, and your code most likely will need to do different things
depending on which mode it is in.  It may be useful to make this
distinction explicit in the code.  Thus, for example, a better
template than above would be:

     <pre class="example">          int
          _gnutls_foobar_recv_params (gnutls_session_t session,
                                      const opaque * data,
                                      size_t data_size)
          {
            if (session-&gt;security_parameters.entity == GNUTLS_CLIENT)
              return foobar_recv_client (session, data, data_size);
            else
              return foobar_recv_server (session, data, data_size);
          }
          
          int
          _gnutls_foobar_send_params (gnutls_session_t session,
                                      opaque * data,
                                      size_t data_size)
          {
            if (session-&gt;security_parameters.entity == GNUTLS_CLIENT)
              return foobar_send_client (session, data, data_size);
            else
              return foobar_send_server (session, data, data_size);
          }
</pre>
     <p>The functions used would be declared as <code>static</code> functions, of
the appropriate prototype, in the same file.

     <p>When adding the files, you'll need to add them to <code>Makefile.am</code>
as well, for example:

     <pre class="example">          if ENABLE_FOOBAR
          COBJECTS += ext_foobar.c
          HFILES += ext_foobar.h
          endif
</pre>
     <li>Add API functions to enable/disable the extension.

     <p>Normally the client will have one API to request use of the extension,
and setting some extension specific data.  The server will have one
API to let the library know that it is willing to accept the
extension, often this is implemented through a callback but it doesn't
have to.

     <p>The APIs need to be added to <code>includes/gnutls/gnutls.h</code> or
<code>includes/gnutls/extra.h</code> as appropriate.  It is recommended that
if you don't have a requirement to use the LGPLv2.1+ license for your
extension, that you place your work under the GPLv3+ license and thus
in the libgnutls-extra library.

     <p>You can implement the API function in the <code>ext_foobar.c</code> file, or
if that file ends up becoming rather larger, add a
<code>gnutls_foobar.c</code> file.

     </ol>

<h3 class="section">12.5 Certificate Handling</h3>

<p>What is provided by the certificate handling functions
is summarized in the following diagram.

<div class="block-image"><img src="gnutls-certificate-user-use-case.png" alt="gnutls-certificate-user-use-case.png"></div>

<div class="node">
<a name="Cryptographic-Backend"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#TLS-Extension-Handling">TLS Extension Handling</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Internal-architecture-of-GnuTLS">Internal architecture of GnuTLS</a>

</div>

<h3 class="section">12.6 Cryptographic Backend</h3>

<p>Several new systems provide hardware assisted cryptographic algorithm implementations
that offer implementations some orders of magnitude faster than the software. For this
reason in current releases of GnuTLS it is possible to override parts of the crypto
backend or the whole. It is possible to override them both at runtime and compile time, however
here we will discuss the runtime possibility. The API available for this functionality
is in <code>gnutls/crypto.h</code> header file.

<h4 class="subsection">12.6.1 Override specific algorithms</h4>

<p>When an optimized implementation of a single algorithm is available, say a
hardware assisted version of <acronym>AES-CBC</acronym> then the following functions
can be used to register those algorithms.

     <ul>
<li><a href="#gnutls_005fcrypto_005fsingle_005fcipher_005fregister2">gnutls_crypto_single_cipher_register2</a>
To register a cipher algorithm.

     <li><a href="#gnutls_005fcrypto_005fsingle_005fmac_005fregister2">gnutls_crypto_single_mac_register2</a>
To register a MAC algorithm.

     <p><a href="#gnutls_005fcrypto_005fsingle_005fdigest_005fregister2">gnutls_crypto_single_digest_register2</a>
To register a digest (hash) algorithm.

</ul>

<p>Those registration functions will only replace the specified algorithm and leave the
rest of subsystem intact.

<h4 class="subsection">12.6.2 Override parts of the backend</h4>

<p>In some systems, such as embedded ones, it might be desirable to override big parts
of the cryptographic backend, or even all of them. For this reason the following
functions are provided.

     <ul>
<li><a href="#gnutls_005fcrypto_005fcipher_005fregister2">gnutls_crypto_cipher_register2</a>
To override the cryptographic algorithms backend.

     <li><a href="#gnutls_005fcrypto_005fmac_005fregister2">gnutls_crypto_mac_register2</a>
To override the MAC algorithms backend.

     <li><a href="#gnutls_005fcrypto_005fdigest_005fregister2">gnutls_crypto_digest_register2</a>
To override the digest algorithms backend.

     <li><a href="#gnutls_005fcrypto_005frnd_005fregister2">gnutls_crypto_rnd_register2</a>
To override the random number generator backend.

     <li><a href="#gnutls_005fcrypto_005fbigint_005fregister2">gnutls_crypto_bigint_register2</a>
To override the big number number operations backend.

     <li><a href="#gnutls_005fcrypto_005fpk_005fregister2">gnutls_crypto_pk_register2</a>
To override the public key encryption backend. This is tight to the big number
operations so either both of them should be updated or care must be taken to
use the same format.

</ul>

<p>If all of them are used then GnuTLS will no longer use libgcrypt.

<div class="node">
<a name="Copying-Information"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Concept-Index">Concept Index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Internal-architecture-of-GnuTLS">Internal architecture of GnuTLS</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="appendix">Appendix A Copying Information</h2>

<ul class="menu">
<li><a accesskey="1" href="#GNU-Free-Documentation-License">GNU Free Documentation License</a>:    License for copying this manual. 
<li><a accesskey="2" href="#GNU-LGPL">GNU LGPL</a>:                      License for copying the core GnuTLS library. 
<li><a accesskey="3" href="#GNU-GPL">GNU GPL</a>:                       License for copying GNUTLS extra and tools. 
</ul>

<div class="node">
<a name="GNU-Free-Documentation-License"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#GNU-LGPL">GNU LGPL</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Copying-Information">Copying Information</a>

</div>

<h3 class="appendixsec">A.1 GNU Free Documentation License</h3>

<p><a name="index-FDL_002c-GNU-Free-Documentation-License-731"></a>

<!-- The GNU Free Documentation License. -->
<div align="center">Version 1.2, November 2002</div>

<!-- This file is intended to be included within another document, -->
<!-- hence no sectioning command or @node. -->
<pre class="display">     Copyright &copy; 2000,2001,2002 Free Software Foundation, Inc.
     51 Franklin St, Fifth Floor, Boston, MA  02110-1301, USA
     
     Everyone is permitted to copy and distribute verbatim copies
     of this license document, but changing it is not allowed.
</pre>
     <ol type=1 start=0>
<li>PREAMBLE

     <p>The purpose of this License is to make a manual, textbook, or other
functional and useful document <dfn>free</dfn> in the sense of freedom: to
assure everyone the effective freedom to copy and redistribute it,
with or without modifying it, either commercially or noncommercially. 
Secondarily, this License preserves for the author and publisher a way
to get credit for their work, while not being considered responsible
for modifications made by others.

     <p>This License is a kind of &ldquo;copyleft&rdquo;, which means that derivative
works of the document must themselves be free in the same sense.  It
complements the GNU General Public License, which is a copyleft
license designed for free software.

     <p>We have designed this License in order to use it for manuals for free
software, because free software needs free documentation: a free
program should come with manuals providing the same freedoms that the
software does.  But this License is not limited to software manuals;
it can be used for any textual work, regardless of subject matter or
whether it is published as a printed book.  We recommend this License
principally for works whose purpose is instruction or reference.

     <li>APPLICABILITY AND DEFINITIONS

     <p>This License applies to any manual or other work, in any medium, that
contains a notice placed by the copyright holder saying it can be
distributed under the terms of this License.  Such a notice grants a
world-wide, royalty-free license, unlimited in duration, to use that
work under the conditions stated herein.  The &ldquo;Document&rdquo;, below,
refers to any such manual or work.  Any member of the public is a
licensee, and is addressed as &ldquo;you&rdquo;.  You accept the license if you
copy, modify or distribute the work in a way requiring permission
under copyright law.

     <p>A &ldquo;Modified Version&rdquo; of the Document means any work containing the
Document or a portion of it, either copied verbatim, or with
modifications and/or translated into another language.

     <p>A &ldquo;Secondary Section&rdquo; is a named appendix or a front-matter section
of the Document that deals exclusively with the relationship of the
publishers or authors of the Document to the Document's overall
subject (or to related matters) and contains nothing that could fall
directly within that overall subject.  (Thus, if the Document is in
part a textbook of mathematics, a Secondary Section may not explain
any mathematics.)  The relationship could be a matter of historical
connection with the subject or with related matters, or of legal,
commercial, philosophical, ethical or political position regarding
them.

     <p>The &ldquo;Invariant Sections&rdquo; are certain Secondary Sections whose titles
are designated, as being those of Invariant Sections, in the notice
that says that the Document is released under this License.  If a
section does not fit the above definition of Secondary then it is not
allowed to be designated as Invariant.  The Document may contain zero
Invariant Sections.  If the Document does not identify any Invariant
Sections then there are none.

     <p>The &ldquo;Cover Texts&rdquo; are certain short passages of text that are listed,
as Front-Cover Texts or Back-Cover Texts, in the notice that says that
the Document is released under this License.  A Front-Cover Text may
be at most 5 words, and a Back-Cover Text may be at most 25 words.

     <p>A &ldquo;Transparent&rdquo; copy of the Document means a machine-readable copy,
represented in a format whose specification is available to the
general public, that is suitable for revising the document
straightforwardly with generic text editors or (for images composed of
pixels) generic paint programs or (for drawings) some widely available
drawing editor, and that is suitable for input to text formatters or
for automatic translation to a variety of formats suitable for input
to text formatters.  A copy made in an otherwise Transparent file
format whose markup, or absence of markup, has been arranged to thwart
or discourage subsequent modification by readers is not Transparent. 
An image format is not Transparent if used for any substantial amount
of text.  A copy that is not &ldquo;Transparent&rdquo; is called &ldquo;Opaque&rdquo;.

     <p>Examples of suitable formats for Transparent copies include plain
<span class="sc">ascii</span> without markup, Texinfo input format, LaTeX input
format, <acronym>SGML</acronym> or <acronym>XML</acronym> using a publicly available
<acronym>DTD</acronym>, and standard-conforming simple <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> designed for human modification.  Examples
of transparent image formats include <acronym>PNG</acronym>, <acronym>XCF</acronym> and
<acronym>JPG</acronym>.  Opaque formats include proprietary formats that can be
read and edited only by proprietary word processors, <acronym>SGML</acronym> or
<acronym>XML</acronym> for which the <acronym>DTD</acronym> and/or processing tools are
not generally available, and the machine-generated <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> produced by some word processors for
output purposes only.

     <p>The &ldquo;Title Page&rdquo; means, for a printed book, the title page itself,
plus such following pages as are needed to hold, legibly, the material
this License requires to appear in the title page.  For works in
formats which do not have any title page as such, &ldquo;Title Page&rdquo; means
the text near the most prominent appearance of the work's title,
preceding the beginning of the body of the text.

     <p>A section &ldquo;Entitled XYZ&rdquo; means a named subunit of the Document whose
title either is precisely XYZ or contains XYZ in parentheses following
text that translates XYZ in another language.  (Here XYZ stands for a
specific section name mentioned below, such as &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, &ldquo;Endorsements&rdquo;, or &ldquo;History&rdquo;.)  To &ldquo;Preserve the Title&rdquo;
of such a section when you modify the Document means that it remains a
section &ldquo;Entitled XYZ&rdquo; according to this definition.

     <p>The Document may include Warranty Disclaimers next to the notice which
states that this License applies to the Document.  These Warranty
Disclaimers are considered to be included by reference in this
License, but only as regards disclaiming warranties: any other
implication that these Warranty Disclaimers may have is void and has
no effect on the meaning of this License.

     <li>VERBATIM COPYING

     <p>You may copy and distribute the Document in any medium, either
commercially or noncommercially, provided that this License, the
copyright notices, and the license notice saying this License applies
to the Document are reproduced in all copies, and that you add no other
conditions whatsoever to those of this License.  You may not use
technical measures to obstruct or control the reading or further
copying of the copies you make or distribute.  However, you may accept
compensation in exchange for copies.  If you distribute a large enough
number of copies you must also follow the conditions in section 3.

     <p>You may also lend copies, under the same conditions stated above, and
you may publicly display copies.

     <li>COPYING IN QUANTITY

     <p>If you publish printed copies (or copies in media that commonly have
printed covers) of the Document, numbering more than 100, and the
Document's license notice requires Cover Texts, you must enclose the
copies in covers that carry, clearly and legibly, all these Cover
Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on
the back cover.  Both covers must also clearly and legibly identify
you as the publisher of these copies.  The front cover must present
the full title with all words of the title equally prominent and
visible.  You may add other material on the covers in addition. 
Copying with changes limited to the covers, as long as they preserve
the title of the Document and satisfy these conditions, can be treated
as verbatim copying in other respects.

     <p>If the required texts for either cover are too voluminous to fit
legibly, you should put the first ones listed (as many as fit
reasonably) on the actual cover, and continue the rest onto adjacent
pages.

     <p>If you publish or distribute Opaque copies of the Document numbering
more than 100, you must either include a machine-readable Transparent
copy along with each Opaque copy, or state in or with each Opaque copy
a computer-network location from which the general network-using
public has access to download using public-standard network protocols
a complete Transparent copy of the Document, free of added material. 
If you use the latter option, you must take reasonably prudent steps,
when you begin distribution of Opaque copies in quantity, to ensure
that this Transparent copy will remain thus accessible at the stated
location until at least one year after the last time you distribute an
Opaque copy (directly or through your agents or retailers) of that
edition to the public.

     <p>It is requested, but not required, that you contact the authors of the
Document well before redistributing any large number of copies, to give
them a chance to provide you with an updated version of the Document.

     <li>MODIFICATIONS

     <p>You may copy and distribute a Modified Version of the Document under
the conditions of sections 2 and 3 above, provided that you release
the Modified Version under precisely this License, with the Modified
Version filling the role of the Document, thus licensing distribution
and modification of the Modified Version to whoever possesses a copy
of it.  In addition, you must do these things in the Modified Version:

          <ol type=A start=1>
<li>Use in the Title Page (and on the covers, if any) a title distinct
from that of the Document, and from those of previous versions
(which should, if there were any, be listed in the History section
of the Document).  You may use the same title as a previous version
if the original publisher of that version gives permission.

          <li>List on the Title Page, as authors, one or more persons or entities
responsible for authorship of the modifications in the Modified
Version, together with at least five of the principal authors of the
Document (all of its principal authors, if it has fewer than five),
unless they release you from this requirement.

          <li>State on the Title page the name of the publisher of the
Modified Version, as the publisher.

          <li>Preserve all the copyright notices of the Document.

          <li>Add an appropriate copyright notice for your modifications
adjacent to the other copyright notices.

          <li>Include, immediately after the copyright notices, a license notice
giving the public permission to use the Modified Version under the
terms of this License, in the form shown in the Addendum below.

          <li>Preserve in that license notice the full lists of Invariant Sections
and required Cover Texts given in the Document's license notice.

          <li>Include an unaltered copy of this License.

          <li>Preserve the section Entitled &ldquo;History&rdquo;, Preserve its Title, and add
to it an item stating at least the title, year, new authors, and
publisher of the Modified Version as given on the Title Page.  If
there is no section Entitled &ldquo;History&rdquo; in the Document, create one
stating the title, year, authors, and publisher of the Document as
given on its Title Page, then add an item describing the Modified
Version as stated in the previous sentence.

          <li>Preserve the network location, if any, given in the Document for
public access to a Transparent copy of the Document, and likewise
the network locations given in the Document for previous versions
it was based on.  These may be placed in the &ldquo;History&rdquo; section. 
You may omit a network location for a work that was published at
least four years before the Document itself, or if the original
publisher of the version it refers to gives permission.

          <li>For any section Entitled &ldquo;Acknowledgements&rdquo; or &ldquo;Dedications&rdquo;, Preserve
the Title of the section, and preserve in the section all the
substance and tone of each of the contributor acknowledgements and/or
dedications given therein.

          <li>Preserve all the Invariant Sections of the Document,
unaltered in their text and in their titles.  Section numbers
or the equivalent are not considered part of the section titles.

          <li>Delete any section Entitled &ldquo;Endorsements&rdquo;.  Such a section
may not be included in the Modified Version.

          <li>Do not retitle any existing section to be Entitled &ldquo;Endorsements&rdquo; or
to conflict in title with any Invariant Section.

          <li>Preserve any Warranty Disclaimers.
          </ol>

     <p>If the Modified Version includes new front-matter sections or
appendices that qualify as Secondary Sections and contain no material
copied from the Document, you may at your option designate some or all
of these sections as invariant.  To do this, add their titles to the
list of Invariant Sections in the Modified Version's license notice. 
These titles must be distinct from any other section titles.

     <p>You may add a section Entitled &ldquo;Endorsements&rdquo;, provided it contains
nothing but endorsements of your Modified Version by various
parties&mdash;for example, statements of peer review or that the text has
been approved by an organization as the authoritative definition of a
standard.

     <p>You may add a passage of up to five words as a Front-Cover Text, and a
passage of up to 25 words as a Back-Cover Text, to the end of the list
of Cover Texts in the Modified Version.  Only one passage of
Front-Cover Text and one of Back-Cover Text may be added by (or
through arrangements made by) any one entity.  If the Document already
includes a cover text for the same cover, previously added by you or
by arrangement made by the same entity you are acting on behalf of,
you may not add another; but you may replace the old one, on explicit
permission from the previous publisher that added the old one.

     <p>The author(s) and publisher(s) of the Document do not by this License
give permission to use their names for publicity for or to assert or
imply endorsement of any Modified Version.

     <li>COMBINING DOCUMENTS

     <p>You may combine the Document with other documents released under this
License, under the terms defined in section 4 above for modified
versions, provided that you include in the combination all of the
Invariant Sections of all of the original documents, unmodified, and
list them all as Invariant Sections of your combined work in its
license notice, and that you preserve all their Warranty Disclaimers.

     <p>The combined work need only contain one copy of this License, and
multiple identical Invariant Sections may be replaced with a single
copy.  If there are multiple Invariant Sections with the same name but
different contents, make the title of each such section unique by
adding at the end of it, in parentheses, the name of the original
author or publisher of that section if known, or else a unique number. 
Make the same adjustment to the section titles in the list of
Invariant Sections in the license notice of the combined work.

     <p>In the combination, you must combine any sections Entitled &ldquo;History&rdquo;
in the various original documents, forming one section Entitled
&ldquo;History&rdquo;; likewise combine any sections Entitled &ldquo;Acknowledgements&rdquo;,
and any sections Entitled &ldquo;Dedications&rdquo;.  You must delete all
sections Entitled &ldquo;Endorsements.&rdquo;

     <li>COLLECTIONS OF DOCUMENTS

     <p>You may make a collection consisting of the Document and other documents
released under this License, and replace the individual copies of this
License in the various documents with a single copy that is included in
the collection, provided that you follow the rules of this License for
verbatim copying of each of the documents in all other respects.

     <p>You may extract a single document from such a collection, and distribute
it individually under this License, provided you insert a copy of this
License into the extracted document, and follow this License in all
other respects regarding verbatim copying of that document.

     <li>AGGREGATION WITH INDEPENDENT WORKS

     <p>A compilation of the Document or its derivatives with other separate
and independent documents or works, in or on a volume of a storage or
distribution medium, is called an &ldquo;aggregate&rdquo; if the copyright
resulting from the compilation is not used to limit the legal rights
of the compilation's users beyond what the individual works permit. 
When the Document is included in an aggregate, this License does not
apply to the other works in the aggregate which are not themselves
derivative works of the Document.

     <p>If the Cover Text requirement of section 3 is applicable to these
copies of the Document, then if the Document is less than one half of
the entire aggregate, the Document's Cover Texts may be placed on
covers that bracket the Document within the aggregate, or the
electronic equivalent of covers if the Document is in electronic form. 
Otherwise they must appear on printed covers that bracket the whole
aggregate.

     <li>TRANSLATION

     <p>Translation is considered a kind of modification, so you may
distribute translations of the Document under the terms of section 4. 
Replacing Invariant Sections with translations requires special
permission from their copyright holders, but you may include
translations of some or all Invariant Sections in addition to the
original versions of these Invariant Sections.  You may include a
translation of this License, and all the license notices in the
Document, and any Warranty Disclaimers, provided that you also include
the original English version of this License and the original versions
of those notices and disclaimers.  In case of a disagreement between
the translation and the original version of this License or a notice
or disclaimer, the original version will prevail.

     <p>If a section in the Document is Entitled &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, or &ldquo;History&rdquo;, the requirement (section 4) to Preserve
its Title (section 1) will typically require changing the actual
title.

     <li>TERMINATION

     <p>You may not copy, modify, sublicense, or distribute the Document except
as expressly provided for under this License.  Any other attempt to
copy, modify, sublicense or distribute the Document is void, and will
automatically terminate your rights under this License.  However,
parties who have received copies, or rights, from you under this
License will not have their licenses terminated so long as such
parties remain in full compliance.

     <li>FUTURE REVISIONS OF THIS LICENSE

     <p>The Free Software Foundation may publish new, revised versions
of the GNU Free Documentation License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.  See
<a href="http://www.gnu.org/copyleft/">http://www.gnu.org/copyleft/</a>.

     <p>Each version of the License is given a distinguishing version number. 
If the Document specifies that a particular numbered version of this
License &ldquo;or any later version&rdquo; applies to it, you have the option of
following the terms and conditions either of that specified version or
of any later version that has been published (not as a draft) by the
Free Software Foundation.  If the Document does not specify a version
number of this License, you may choose any version ever published (not
as a draft) by the Free Software Foundation.
     </ol>

<h3 class="heading">ADDENDUM: How to use this License for your documents</h3>

<p>To use this License in a document you have written, include a copy of
the License in the document and put the following copyright and
license notices just after the title page:

<pre class="smallexample">       Copyright (C)  <var>year</var>  <var>your name</var>.
       Permission is granted to copy, distribute and/or modify this document
       under the terms of the GNU Free Documentation License, Version 1.2
       or any later version published by the Free Software Foundation;
       with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
       Texts.  A copy of the license is included in the section entitled ``GNU
       Free Documentation License''.
</pre>
<p>If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts,
replace the &ldquo;with<small class="dots">...</small>Texts.&rdquo; line with this:

<pre class="smallexample">         with the Invariant Sections being <var>list their titles</var>, with
         the Front-Cover Texts being <var>list</var>, and with the Back-Cover Texts
         being <var>list</var>.
</pre>
<p>If you have Invariant Sections without Cover Texts, or some other
combination of the three, merge those two alternatives to suit the
situation.

<p>If your document contains nontrivial examples of program code, we
recommend releasing these examples in parallel under your choice of
free software license, such as the GNU General Public License,
to permit their use in free software.

<!-- Local Variables: -->
<!-- ispell-local-pdict: "ispell-dict" -->
<!-- End: -->
<div class="node">
<a name="GNU-LGPL"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#GNU-GPL">GNU GPL</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#GNU-Free-Documentation-License">GNU Free Documentation License</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Copying-Information">Copying Information</a>

</div>

<h3 class="appendixsec">A.2 GNU Lesser General Public License</h3>

<p><a name="index-LGPL_002c-GNU-Lesser-General-Public-License-732"></a><a name="index-License_002c-GNU-LGPL-733"></a>

<!-- The GNU Lesser General Public License. -->
<div align="center">Version 2.1, February 1999</div>

<!-- This file is intended to be included within another document, -->
<!-- hence no sectioning command or @node. -->
<pre class="display">     Copyright &copy; 1991, 1999 Free Software Foundation, Inc.
     51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA
     
     Everyone is permitted to copy and distribute verbatim copies
     of this license document, but changing it is not allowed.
     
     [This is the first released version of the Lesser GPL.  It also counts
     as the successor of the GNU Library Public License, version 2, hence the
     version number 2.1.]
</pre>
<h4 class="subheading">Preamble</h4>

<p>The licenses for most software are designed to take away your
freedom to share and change it.  By contrast, the GNU General Public
Licenses are intended to guarantee your freedom to share and change
free software&mdash;to make sure the software is free for all its users.

<p>This license, the Lesser General Public License, applies to some
specially designated software&mdash;typically libraries&mdash;of the Free
Software Foundation and other authors who decide to use it.  You can use
it too, but we suggest you first think carefully about whether this
license or the ordinary General Public License is the better strategy to
use in any particular case, based on the explanations below.

<p>When we speak of free software, we are referring to freedom of use,
not price.  Our General Public Licenses are designed to make sure that
you have the freedom to distribute copies of free software (and charge
for this service if you wish); that you receive source code or can get
it if you want it; that you can change the software and use pieces of it
in new free programs; and that you are informed that you can do these
things.

<p>To protect your rights, we need to make restrictions that forbid
distributors to deny you these rights or to ask you to surrender these
rights.  These restrictions translate to certain responsibilities for
you if you distribute copies of the library or if you modify it.

<p>For example, if you distribute copies of the library, whether gratis
or for a fee, you must give the recipients all the rights that we gave
you.  You must make sure that they, too, receive or can get the source
code.  If you link other code with the library, you must provide
complete object files to the recipients, so that they can relink them
with the library after making changes to the library and recompiling
it.  And you must show them these terms so they know their rights.

<p>We protect your rights with a two-step method: (1) we copyright the
library, and (2) we offer you this license, which gives you legal
permission to copy, distribute and/or modify the library.

<p>To protect each distributor, we want to make it very clear that
there is no warranty for the free library.  Also, if the library is
modified by someone else and passed on, the recipients should know
that what they have is not the original version, so that the original
author's reputation will not be affected by problems that might be
introduced by others.

<p>Finally, software patents pose a constant threat to the existence of
any free program.  We wish to make sure that a company cannot
effectively restrict the users of a free program by obtaining a
restrictive license from a patent holder.  Therefore, we insist that
any patent license obtained for a version of the library must be
consistent with the full freedom of use specified in this license.

<p>Most GNU software, including some libraries, is covered by the
ordinary GNU General Public License.  This license, the GNU Lesser
General Public License, applies to certain designated libraries, and
is quite different from the ordinary General Public License.  We use
this license for certain libraries in order to permit linking those
libraries into non-free programs.

<p>When a program is linked with a library, whether statically or using
a shared library, the combination of the two is legally speaking a
combined work, a derivative of the original library.  The ordinary
General Public License therefore permits such linking only if the
entire combination fits its criteria of freedom.  The Lesser General
Public License permits more lax criteria for linking other code with
the library.

<p>We call this license the <dfn>Lesser</dfn> General Public License because it
does <em>Less</em> to protect the user's freedom than the ordinary General
Public License.  It also provides other free software developers Less
of an advantage over competing non-free programs.  These disadvantages
are the reason we use the ordinary General Public License for many
libraries.  However, the Lesser license provides advantages in certain
special circumstances.

<p>For example, on rare occasions, there may be a special need to
encourage the widest possible use of a certain library, so that it becomes
a de-facto standard.  To achieve this, non-free programs must be
allowed to use the library.  A more frequent case is that a free
library does the same job as widely used non-free libraries.  In this
case, there is little to gain by limiting the free library to free
software only, so we use the Lesser General Public License.

<p>In other cases, permission to use a particular library in non-free
programs enables a greater number of people to use a large body of
free software.  For example, permission to use the GNU C Library in
non-free programs enables many more people to use the whole GNU
operating system, as well as its variant, the GNU/Linux operating
system.

<p>Although the Lesser General Public License is Less protective of the
users' freedom, it does ensure that the user of a program that is
linked with the Library has the freedom and the wherewithal to run
that program using a modified version of the Library.

<p>The precise terms and conditions for copying, distribution and
modification follow.  Pay close attention to the difference between a
&ldquo;work based on the library&rdquo; and a &ldquo;work that uses the library&rdquo;.  The
former contains code derived from the library, whereas the latter must
be combined with the library in order to run.

<h4 class="subheading">TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION</h4>

     <ol type=1 start=0>
<li>This License Agreement applies to any software library or other program
which contains a notice placed by the copyright holder or other
authorized party saying it may be distributed under the terms of this
Lesser General Public License (also called &ldquo;this License&rdquo;).  Each
licensee is addressed as &ldquo;you&rdquo;.

     <p>A &ldquo;library&rdquo; means a collection of software functions and/or data
prepared so as to be conveniently linked with application programs
(which use some of those functions and data) to form executables.

     <p>The &ldquo;Library&rdquo;, below, refers to any such software library or work
which has been distributed under these terms.  A &ldquo;work based on the
Library&rdquo; means either the Library or any derivative work under
copyright law: that is to say, a work containing the Library or a
portion of it, either verbatim or with modifications and/or translated
straightforwardly into another language.  (Hereinafter, translation is
included without limitation in the term &ldquo;modification&rdquo;.)

     <p>&ldquo;Source code&rdquo; for a work means the preferred form of the work for
making modifications to it.  For a library, complete source code means
all the source code for all modules it contains, plus any associated
interface definition files, plus the scripts used to control compilation
and installation of the library.

     <p>Activities other than copying, distribution and modification are not
covered by this License; they are outside its scope.  The act of
running a program using the Library is not restricted, and output from
such a program is covered only if its contents constitute a work based
on the Library (independent of the use of the Library in a tool for
writing it).  Whether that is true depends on what the Library does
and what the program that uses the Library does.

     <li>You may copy and distribute verbatim copies of the Library's
complete source code as you receive it, in any medium, provided that
you conspicuously and appropriately publish on each copy an
appropriate copyright notice and disclaimer of warranty; keep intact
all the notices that refer to this License and to the absence of any
warranty; and distribute a copy of this License along with the
Library.

     <p>You may charge a fee for the physical act of transferring a copy,
and you may at your option offer warranty protection in exchange for a
fee.

     <li>You may modify your copy or copies of the Library or any portion
of it, thus forming a work based on the Library, and copy and
distribute such modifications or work under the terms of Section 1
above, provided that you also meet all of these conditions:

          <ol type=a start=1>
<li>The modified work must itself be a software library.

          <li>You must cause the files modified to carry prominent notices
stating that you changed the files and the date of any change.

          <li>You must cause the whole of the work to be licensed at no
charge to all third parties under the terms of this License.

          <li>If a facility in the modified Library refers to a function or a
table of data to be supplied by an application program that uses
the facility, other than as an argument passed when the facility
is invoked, then you must make a good faith effort to ensure that,
in the event an application does not supply such function or
table, the facility still operates, and performs whatever part of
its purpose remains meaningful.

          <p>(For example, a function in a library to compute square roots has
a purpose that is entirely well-defined independent of the
application.  Therefore, Subsection 2d requires that any
application-supplied function or table used by this function must
be optional: if the application does not supply it, the square
root function must still compute square roots.)
          </ol>

     <p>These requirements apply to the modified work as a whole.  If
identifiable sections of that work are not derived from the Library,
and can be reasonably considered independent and separate works in
themselves, then this License, and its terms, do not apply to those
sections when you distribute them as separate works.  But when you
distribute the same sections as part of a whole which is a work based
on the Library, the distribution of the whole must be on the terms of
this License, whose permissions for other licensees extend to the
entire whole, and thus to each and every part regardless of who wrote
it.

     <p>Thus, it is not the intent of this section to claim rights or contest
your rights to work written entirely by you; rather, the intent is to
exercise the right to control the distribution of derivative or
collective works based on the Library.

     <p>In addition, mere aggregation of another work not based on the Library
with the Library (or with a work based on the Library) on a volume of
a storage or distribution medium does not bring the other work under
the scope of this License.

     <li>You may opt to apply the terms of the ordinary GNU General Public
License instead of this License to a given copy of the Library.  To do
this, you must alter all the notices that refer to this License, so
that they refer to the ordinary GNU General Public License, version 2,
instead of to this License.  (If a newer version than version 2 of the
ordinary GNU General Public License has appeared, then you can specify
that version instead if you wish.)  Do not make any other change in
these notices.

     <p>Once this change is made in a given copy, it is irreversible for
that copy, so the ordinary GNU General Public License applies to all
subsequent copies and derivative works made from that copy.

     <p>This option is useful when you wish to copy part of the code of
the Library into a program that is not a library.

     <li>You may copy and distribute the Library (or a portion or
derivative of it, under Section 2) in object code or executable form
under the terms of Sections 1 and 2 above provided that you accompany
it with the complete corresponding machine-readable source code, which
must be distributed under the terms of Sections 1 and 2 above on a
medium customarily used for software interchange.

     <p>If distribution of object code is made by offering access to copy
from a designated place, then offering equivalent access to copy the
source code from the same place satisfies the requirement to
distribute the source code, even though third parties are not
compelled to copy the source along with the object code.

     <li>A program that contains no derivative of any portion of the
Library, but is designed to work with the Library by being compiled or
linked with it, is called a &ldquo;work that uses the Library&rdquo;.  Such a
work, in isolation, is not a derivative work of the Library, and
therefore falls outside the scope of this License.

     <p>However, linking a &ldquo;work that uses the Library&rdquo; with the Library
creates an executable that is a derivative of the Library (because it
contains portions of the Library), rather than a &ldquo;work that uses the
library&rdquo;.  The executable is therefore covered by this License. 
Section 6 states terms for distribution of such executables.

     <p>When a &ldquo;work that uses the Library&rdquo; uses material from a header file
that is part of the Library, the object code for the work may be a
derivative work of the Library even though the source code is not. 
Whether this is true is especially significant if the work can be
linked without the Library, or if the work is itself a library.  The
threshold for this to be true is not precisely defined by law.

     <p>If such an object file uses only numerical parameters, data
structure layouts and accessors, and small macros and small inline
functions (ten lines or less in length), then the use of the object
file is unrestricted, regardless of whether it is legally a derivative
work.  (Executables containing this object code plus portions of the
Library will still fall under Section 6.)

     <p>Otherwise, if the work is a derivative of the Library, you may
distribute the object code for the work under the terms of Section 6. 
Any executables containing that work also fall under Section 6,
whether or not they are linked directly with the Library itself.

     <li>As an exception to the Sections above, you may also combine or
link a &ldquo;work that uses the Library&rdquo; with the Library to produce a
work containing portions of the Library, and distribute that work
under terms of your choice, provided that the terms permit
modification of the work for the customer's own use and reverse
engineering for debugging such modifications.

     <p>You must give prominent notice with each copy of the work that the
Library is used in it and that the Library and its use are covered by
this License.  You must supply a copy of this License.  If the work
during execution displays copyright notices, you must include the
copyright notice for the Library among them, as well as a reference
directing the user to the copy of this License.  Also, you must do one
of these things:

          <ol type=a start=1>
<li>Accompany the work with the complete corresponding
machine-readable source code for the Library including whatever
changes were used in the work (which must be distributed under
Sections 1 and 2 above); and, if the work is an executable linked
with the Library, with the complete machine-readable &ldquo;work that
uses the Library&rdquo;, as object code and/or source code, so that the
user can modify the Library and then relink to produce a modified
executable containing the modified Library.  (It is understood
that the user who changes the contents of definitions files in the
Library will not necessarily be able to recompile the application
to use the modified definitions.)

          <li>Use a suitable shared library mechanism for linking with the Library.  A
suitable mechanism is one that (1) uses at run time a copy of the
library already present on the user's computer system, rather than
copying library functions into the executable, and (2) will operate
properly with a modified version of the library, if the user installs
one, as long as the modified version is interface-compatible with the
version that the work was made with.

          <li>Accompany the work with a written offer, valid for at
least three years, to give the same user the materials
specified in Subsection 6a, above, for a charge no more
than the cost of performing this distribution.

          <li>If distribution of the work is made by offering access to copy
from a designated place, offer equivalent access to copy the above
specified materials from the same place.

          <li>Verify that the user has already received a copy of these
materials or that you have already sent this user a copy.
          </ol>

     <p>For an executable, the required form of the &ldquo;work that uses the
Library&rdquo; must include any data and utility programs needed for
reproducing the executable from it.  However, as a special exception,
the materials to be distributed need not include anything that is
normally distributed (in either source or binary form) with the major
components (compiler, kernel, and so on) of the operating system on
which the executable runs, unless that component itself accompanies the
executable.

     <p>It may happen that this requirement contradicts the license
restrictions of other proprietary libraries that do not normally
accompany the operating system.  Such a contradiction means you cannot
use both them and the Library together in an executable that you
distribute.

     <li>You may place library facilities that are a work based on the
Library side-by-side in a single library together with other library
facilities not covered by this License, and distribute such a combined
library, provided that the separate distribution of the work based on
the Library and of the other library facilities is otherwise
permitted, and provided that you do these two things:

          <ol type=a start=1>
<li>Accompany the combined library with a copy of the same work
based on the Library, uncombined with any other library
facilities.  This must be distributed under the terms of the
Sections above.

          <li>Give prominent notice with the combined library of the fact
that part of it is a work based on the Library, and explaining
where to find the accompanying uncombined form of the same work.
          </ol>

     <li>You may not copy, modify, sublicense, link with, or distribute
the Library except as expressly provided under this License.  Any
attempt otherwise to copy, modify, sublicense, link with, or
distribute the Library is void, and will automatically terminate your
rights under this License.  However, parties who have received copies,
or rights, from you under this License will not have their licenses
terminated so long as such parties remain in full compliance.

     <li>You are not required to accept this License, since you have not
signed it.  However, nothing else grants you permission to modify or
distribute the Library or its derivative works.  These actions are
prohibited by law if you do not accept this License.  Therefore, by
modifying or distributing the Library (or any work based on the
Library), you indicate your acceptance of this License to do so, and
all its terms and conditions for copying, distributing or modifying
the Library or works based on it.

     <li>Each time you redistribute the Library (or any work based on the
Library), the recipient automatically receives a license from the
original licensor to copy, distribute, link with or modify the Library
subject to these terms and conditions.  You may not impose any further
restrictions on the recipients' exercise of the rights granted herein. 
You are not responsible for enforcing compliance by third parties with
this License.

     <li>If, as a consequence of a court judgment or allegation of patent
infringement or for any other reason (not limited to patent issues),
conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot
distribute so as to satisfy simultaneously your obligations under this
License and any other pertinent obligations, then as a consequence you
may not distribute the Library at all.  For example, if a patent
license would not permit royalty-free redistribution of the Library by
all those who receive copies directly or indirectly through you, then
the only way you could satisfy both it and this License would be to
refrain entirely from distribution of the Library.

     <p>If any portion of this section is held invalid or unenforceable under any
particular circumstance, the balance of the section is intended to apply,
and the section as a whole is intended to apply in other circumstances.

     <p>It is not the purpose of this section to induce you to infringe any
patents or other property right claims or to contest validity of any
such claims; this section has the sole purpose of protecting the
integrity of the free software distribution system which is
implemented by public license practices.  Many people have made
generous contributions to the wide range of software distributed
through that system in reliance on consistent application of that
system; it is up to the author/donor to decide if he or she is willing
to distribute software through any other system and a licensee cannot
impose that choice.

     <p>This section is intended to make thoroughly clear what is believed to
be a consequence of the rest of this License.

     <li>If the distribution and/or use of the Library is restricted in
certain countries either by patents or by copyrighted interfaces, the
original copyright holder who places the Library under this License may add
an explicit geographical distribution limitation excluding those countries,
so that distribution is permitted only in or among countries not thus
excluded.  In such case, this License incorporates the limitation as if
written in the body of this License.

     <li>The Free Software Foundation may publish revised and/or new
versions of the Lesser General Public License from time to time. 
Such new versions will be similar in spirit to the present version,
but may differ in detail to address new problems or concerns.

     <p>Each version is given a distinguishing version number.  If the Library
specifies a version number of this License which applies to it and
&ldquo;any later version&rdquo;, you have the option of following the terms and
conditions either of that version or of any later version published by
the Free Software Foundation.  If the Library does not specify a
license version number, you may choose any version ever published by
the Free Software Foundation.

     <li>If you wish to incorporate parts of the Library into other free
programs whose distribution conditions are incompatible with these,
write to the author to ask for permission.  For software which is
copyrighted by the Free Software Foundation, write to the Free
Software Foundation; we sometimes make exceptions for this.  Our
decision will be guided by the two goals of preserving the free status
of all derivatives of our free software and of promoting the sharing
and reuse of software generally.

     <li>BECAUSE THE LIBRARY IS LICENSED FREE OF CHARGE, THERE IS NO
WARRANTY FOR THE LIBRARY, TO THE EXTENT PERMITTED BY APPLICABLE LAW. 
EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR
OTHER PARTIES PROVIDE THE LIBRARY &ldquo;AS IS&rdquo; WITHOUT WARRANTY OF ANY
KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE
LIBRARY IS WITH YOU.  SHOULD THE LIBRARY PROVE DEFECTIVE, YOU ASSUME
THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.

     <li>IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN
WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY
AND/OR REDISTRIBUTE THE LIBRARY AS PERMITTED ABOVE, BE LIABLE TO YOU
FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR
CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE
LIBRARY (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING
RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A
FAILURE OF THE LIBRARY TO OPERATE WITH ANY OTHER SOFTWARE), EVEN IF
SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH
DAMAGES.
     </ol>

<h4 class="subheading">How to Apply These Terms to Your New Libraries</h4>

<p>If you develop a new library, and you want it to be of the greatest
possible use to the public, we recommend making it free software that
everyone can redistribute and change.  You can do so by permitting
redistribution under these terms (or, alternatively, under the terms of the
ordinary General Public License).

<p>To apply these terms, attach the following notices to the library.  It is
safest to attach them to the start of each source file to most effectively
convey the exclusion of warranty; and each file should have at least the
&ldquo;copyright&rdquo; line and a pointer to where the full notice is found.

<pre class="smallexample">     <var>one line to give the library's name and an idea of what it does.</var>
     Copyright (C) <var>year</var>  <var>name of author</var>
     
     This library is free software; you can redistribute it and/or modify it
     under the terms of the GNU Lesser General Public License as published by
     the Free Software Foundation; either version 2.1 of the License, or (at
     your option) any later version.
     
     This library is distributed in the hope that it will be useful, but
     WITHOUT ANY WARRANTY; without even the implied warranty of
     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
     Lesser General Public License for more details.
     
     You should have received a copy of the GNU Lesser General Public
     License along with this library; if not, write to the Free Software
     Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301,
     USA.
</pre>
<p>Also add information on how to contact you by electronic and paper mail.

<p>You should also get your employer (if you work as a programmer) or your
school, if any, to sign a &ldquo;copyright disclaimer&rdquo; for the library, if
necessary.  Here is a sample; alter the names:

<pre class="smallexample">     Yoyodyne, Inc., hereby disclaims all copyright interest in the library
     `Frob' (a library for tweaking knobs) written by James Random Hacker.
     
     <var>signature of Ty Coon</var>, 1 April 1990
     Ty Coon, President of Vice
</pre>
<p>That's all there is to it!

<div class="node">
<a name="GNU-GPL"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#GNU-LGPL">GNU LGPL</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Copying-Information">Copying Information</a>

</div>

<h3 class="appendixsec">A.3 GNU General Public License</h3>

<p><a name="index-GPL_002c-GNU-General-Public-License-734"></a><a name="index-License_002c-GNU-GPL-735"></a>

<!-- The GNU General Public License. -->
<div align="center">Version 3, 29 June 2007</div>

<!-- This file is intended to be included within another document, -->
<!-- hence no sectioning command or @node. -->
<pre class="display">     Copyright &copy; 2007 Free Software Foundation, Inc. <a href="http://fsf.org/">http://fsf.org/</a>
     
     Everyone is permitted to copy and distribute verbatim copies of this
     license document, but changing it is not allowed.
</pre>
<h3 class="heading">Preamble</h3>

<p>The GNU General Public License is a free, copyleft license for
software and other kinds of works.

<p>The licenses for most software and other practical works are designed
to take away your freedom to share and change the works.  By contrast,
the GNU General Public License is intended to guarantee your freedom
to share and change all versions of a program&mdash;to make sure it remains
free software for all its users.  We, the Free Software Foundation,
use the GNU General Public License for most of our software; it
applies also to any other work released this way by its authors.  You
can apply it to your programs, too.

<p>When we speak of free software, we are referring to freedom, not
price.  Our General Public Licenses are designed to make sure that you
have the freedom to distribute copies of free software (and charge for
them if you wish), that you receive source code or can get it if you
want it, that you can change the software or use pieces of it in new
free programs, and that you know you can do these things.

<p>To protect your rights, we need to prevent others from denying you
these rights or asking you to surrender the rights.  Therefore, you
have certain responsibilities if you distribute copies of the
software, or if you modify it: responsibilities to respect the freedom
of others.

<p>For example, if you distribute copies of such a program, whether
gratis or for a fee, you must pass on to the recipients the same
freedoms that you received.  You must make sure that they, too,
receive or can get the source code.  And you must show them these
terms so they know their rights.

<p>Developers that use the GNU GPL protect your rights with two steps:
(1) assert copyright on the software, and (2) offer you this License
giving you legal permission to copy, distribute and/or modify it.

<p>For the developers' and authors' protection, the GPL clearly explains
that there is no warranty for this free software.  For both users' and
authors' sake, the GPL requires that modified versions be marked as
changed, so that their problems will not be attributed erroneously to
authors of previous versions.

<p>Some devices are designed to deny users access to install or run
modified versions of the software inside them, although the
manufacturer can do so.  This is fundamentally incompatible with the
aim of protecting users' freedom to change the software.  The
systematic pattern of such abuse occurs in the area of products for
individuals to use, which is precisely where it is most unacceptable. 
Therefore, we have designed this version of the GPL to prohibit the
practice for those products.  If such problems arise substantially in
other domains, we stand ready to extend this provision to those
domains in future versions of the GPL, as needed to protect the
freedom of users.

<p>Finally, every program is threatened constantly by software patents. 
States should not allow patents to restrict development and use of
software on general-purpose computers, but in those that do, we wish
to avoid the special danger that patents applied to a free program
could make it effectively proprietary.  To prevent this, the GPL
assures that patents cannot be used to render the program non-free.

<p>The precise terms and conditions for copying, distribution and
modification follow.

<h3 class="heading">TERMS AND CONDITIONS</h3>

     <ol type=1 start=0>
<li>Definitions.

     <p>&ldquo;This License&rdquo; refers to version 3 of the GNU General Public License.

     <p>&ldquo;Copyright&rdquo; also means copyright-like laws that apply to other kinds
of works, such as semiconductor masks.

     <p>&ldquo;The Program&rdquo; refers to any copyrightable work licensed under this
License.  Each licensee is addressed as &ldquo;you&rdquo;.  &ldquo;Licensees&rdquo; and
&ldquo;recipients&rdquo; may be individuals or organizations.

     <p>To &ldquo;modify&rdquo; a work means to copy from or adapt all or part of the work
in a fashion requiring copyright permission, other than the making of
an exact copy.  The resulting work is called a &ldquo;modified version&rdquo; of
the earlier work or a work &ldquo;based on&rdquo; the earlier work.

     <p>A &ldquo;covered work&rdquo; means either the unmodified Program or a work based
on the Program.

     <p>To &ldquo;propagate&rdquo; a work means to do anything with it that, without
permission, would make you directly or secondarily liable for
infringement under applicable copyright law, except executing it on a
computer or modifying a private copy.  Propagation includes copying,
distribution (with or without modification), making available to the
public, and in some countries other activities as well.

     <p>To &ldquo;convey&rdquo; a work means any kind of propagation that enables other
parties to make or receive copies.  Mere interaction with a user
through a computer network, with no transfer of a copy, is not
conveying.

     <p>An interactive user interface displays &ldquo;Appropriate Legal Notices&rdquo; to
the extent that it includes a convenient and prominently visible
feature that (1) displays an appropriate copyright notice, and (2)
tells the user that there is no warranty for the work (except to the
extent that warranties are provided), that licensees may convey the
work under this License, and how to view a copy of this License.  If
the interface presents a list of user commands or options, such as a
menu, a prominent item in the list meets this criterion.

     <li>Source Code.

     <p>The &ldquo;source code&rdquo; for a work means the preferred form of the work for
making modifications to it.  &ldquo;Object code&rdquo; means any non-source form
of a work.

     <p>A &ldquo;Standard Interface&rdquo; means an interface that either is an official
standard defined by a recognized standards body, or, in the case of
interfaces specified for a particular programming language, one that
is widely used among developers working in that language.

     <p>The &ldquo;System Libraries&rdquo; of an executable work include anything, other
than the work as a whole, that (a) is included in the normal form of
packaging a Major Component, but which is not part of that Major
Component, and (b) serves only to enable use of the work with that
Major Component, or to implement a Standard Interface for which an
implementation is available to the public in source code form.  A
&ldquo;Major Component&rdquo;, in this context, means a major essential component
(kernel, window system, and so on) of the specific operating system
(if any) on which the executable work runs, or a compiler used to
produce the work, or an object code interpreter used to run it.

     <p>The &ldquo;Corresponding Source&rdquo; for a work in object code form means all
the source code needed to generate, install, and (for an executable
work) run the object code and to modify the work, including scripts to
control those activities.  However, it does not include the work's
System Libraries, or general-purpose tools or generally available free
programs which are used unmodified in performing those activities but
which are not part of the work.  For example, Corresponding Source
includes interface definition files associated with source files for
the work, and the source code for shared libraries and dynamically
linked subprograms that the work is specifically designed to require,
such as by intimate data communication or control flow between those
subprograms and other parts of the work.

     <p>The Corresponding Source need not include anything that users can
regenerate automatically from other parts of the Corresponding Source.

     <p>The Corresponding Source for a work in source code form is that same
work.

     <li>Basic Permissions.

     <p>All rights granted under this License are granted for the term of
copyright on the Program, and are irrevocable provided the stated
conditions are met.  This License explicitly affirms your unlimited
permission to run the unmodified Program.  The output from running a
covered work is covered by this License only if the output, given its
content, constitutes a covered work.  This License acknowledges your
rights of fair use or other equivalent, as provided by copyright law.

     <p>You may make, run and propagate covered works that you do not convey,
without conditions so long as your license otherwise remains in force. 
You may convey covered works to others for the sole purpose of having
them make modifications exclusively for you, or provide you with
facilities for running those works, provided that you comply with the
terms of this License in conveying all material for which you do not
control copyright.  Those thus making or running the covered works for
you must do so exclusively on your behalf, under your direction and
control, on terms that prohibit them from making any copies of your
copyrighted material outside their relationship with you.

     <p>Conveying under any other circumstances is permitted solely under the
conditions stated below.  Sublicensing is not allowed; section 10
makes it unnecessary.

     <li>Protecting Users' Legal Rights From Anti-Circumvention Law.

     <p>No covered work shall be deemed part of an effective technological
measure under any applicable law fulfilling obligations under article
11 of the WIPO copyright treaty adopted on 20 December 1996, or
similar laws prohibiting or restricting circumvention of such
measures.

     <p>When you convey a covered work, you waive any legal power to forbid
circumvention of technological measures to the extent such
circumvention is effected by exercising rights under this License with
respect to the covered work, and you disclaim any intention to limit
operation or modification of the work as a means of enforcing, against
the work's users, your or third parties' legal rights to forbid
circumvention of technological measures.

     <li>Conveying Verbatim Copies.

     <p>You may convey verbatim copies of the Program's source code as you
receive it, in any medium, provided that you conspicuously and
appropriately publish on each copy an appropriate copyright notice;
keep intact all notices stating that this License and any
non-permissive terms added in accord with section 7 apply to the code;
keep intact all notices of the absence of any warranty; and give all
recipients a copy of this License along with the Program.

     <p>You may charge any price or no price for each copy that you convey,
and you may offer support or warranty protection for a fee.

     <li>Conveying Modified Source Versions.

     <p>You may convey a work based on the Program, or the modifications to
produce it from the Program, in the form of source code under the
terms of section 4, provided that you also meet all of these
conditions:

          <ol type=a start=1>
<li>The work must carry prominent notices stating that you modified it,
and giving a relevant date.

          <li>The work must carry prominent notices stating that it is released
under this License and any conditions added under section 7.  This
requirement modifies the requirement in section 4 to &ldquo;keep intact all
notices&rdquo;.

          <li>You must license the entire work, as a whole, under this License to
anyone who comes into possession of a copy.  This License will
therefore apply, along with any applicable section 7 additional terms,
to the whole of the work, and all its parts, regardless of how they
are packaged.  This License gives no permission to license the work in
any other way, but it does not invalidate such permission if you have
separately received it.

          <li>If the work has interactive user interfaces, each must display
Appropriate Legal Notices; however, if the Program has interactive
interfaces that do not display Appropriate Legal Notices, your work
need not make them do so.
          </ol>

     <p>A compilation of a covered work with other separate and independent
works, which are not by their nature extensions of the covered work,
and which are not combined with it such as to form a larger program,
in or on a volume of a storage or distribution medium, is called an
&ldquo;aggregate&rdquo; if the compilation and its resulting copyright are not
used to limit the access or legal rights of the compilation's users
beyond what the individual works permit.  Inclusion of a covered work
in an aggregate does not cause this License to apply to the other
parts of the aggregate.

     <li>Conveying Non-Source Forms.

     <p>You may convey a covered work in object code form under the terms of
sections 4 and 5, provided that you also convey the machine-readable
Corresponding Source under the terms of this License, in one of these
ways:

          <ol type=a start=1>
<li>Convey the object code in, or embodied in, a physical product
(including a physical distribution medium), accompanied by the
Corresponding Source fixed on a durable physical medium customarily
used for software interchange.

          <li>Convey the object code in, or embodied in, a physical product
(including a physical distribution medium), accompanied by a written
offer, valid for at least three years and valid for as long as you
offer spare parts or customer support for that product model, to give
anyone who possesses the object code either (1) a copy of the
Corresponding Source for all the software in the product that is
covered by this License, on a durable physical medium customarily used
for software interchange, for a price no more than your reasonable
cost of physically performing this conveying of source, or (2) access
to copy the Corresponding Source from a network server at no charge.

          <li>Convey individual copies of the object code with a copy of the written
offer to provide the Corresponding Source.  This alternative is
allowed only occasionally and noncommercially, and only if you
received the object code with such an offer, in accord with subsection
6b.

          <li>Convey the object code by offering access from a designated place
(gratis or for a charge), and offer equivalent access to the
Corresponding Source in the same way through the same place at no
further charge.  You need not require recipients to copy the
Corresponding Source along with the object code.  If the place to copy
the object code is a network server, the Corresponding Source may be
on a different server (operated by you or a third party) that supports
equivalent copying facilities, provided you maintain clear directions
next to the object code saying where to find the Corresponding Source. 
Regardless of what server hosts the Corresponding Source, you remain
obligated to ensure that it is available for as long as needed to
satisfy these requirements.

          <li>Convey the object code using peer-to-peer transmission, provided you
inform other peers where the object code and Corresponding Source of
the work are being offered to the general public at no charge under
subsection 6d.

          </ol>

     <p>A separable portion of the object code, whose source code is excluded
from the Corresponding Source as a System Library, need not be
included in conveying the object code work.

     <p>A &ldquo;User Product&rdquo; is either (1) a &ldquo;consumer product&rdquo;, which means any
tangible personal property which is normally used for personal,
family, or household purposes, or (2) anything designed or sold for
incorporation into a dwelling.  In determining whether a product is a
consumer product, doubtful cases shall be resolved in favor of
coverage.  For a particular product received by a particular user,
&ldquo;normally used&rdquo; refers to a typical or common use of that class of
product, regardless of the status of the particular user or of the way
in which the particular user actually uses, or expects or is expected
to use, the product.  A product is a consumer product regardless of
whether the product has substantial commercial, industrial or
non-consumer uses, unless such uses represent the only significant
mode of use of the product.

     <p>&ldquo;Installation Information&rdquo; for a User Product means any methods,
procedures, authorization keys, or other information required to
install and execute modified versions of a covered work in that User
Product from a modified version of its Corresponding Source.  The
information must suffice to ensure that the continued functioning of
the modified object code is in no case prevented or interfered with
solely because modification has been made.

     <p>If you convey an object code work under this section in, or with, or
specifically for use in, a User Product, and the conveying occurs as
part of a transaction in which the right of possession and use of the
User Product is transferred to the recipient in perpetuity or for a
fixed term (regardless of how the transaction is characterized), the
Corresponding Source conveyed under this section must be accompanied
by the Installation Information.  But this requirement does not apply
if neither you nor any third party retains the ability to install
modified object code on the User Product (for example, the work has
been installed in ROM).

     <p>The requirement to provide Installation Information does not include a
requirement to continue to provide support service, warranty, or
updates for a work that has been modified or installed by the
recipient, or for the User Product in which it has been modified or
installed.  Access to a network may be denied when the modification
itself materially and adversely affects the operation of the network
or violates the rules and protocols for communication across the
network.

     <p>Corresponding Source conveyed, and Installation Information provided,
in accord with this section must be in a format that is publicly
documented (and with an implementation available to the public in
source code form), and must require no special password or key for
unpacking, reading or copying.

     <li>Additional Terms.

     <p>&ldquo;Additional permissions&rdquo; are terms that supplement the terms of this
License by making exceptions from one or more of its conditions. 
Additional permissions that are applicable to the entire Program shall
be treated as though they were included in this License, to the extent
that they are valid under applicable law.  If additional permissions
apply only to part of the Program, that part may be used separately
under those permissions, but the entire Program remains governed by
this License without regard to the additional permissions.

     <p>When you convey a copy of a covered work, you may at your option
remove any additional permissions from that copy, or from any part of
it.  (Additional permissions may be written to require their own
removal in certain cases when you modify the work.)  You may place
additional permissions on material, added by you to a covered work,
for which you have or can give appropriate copyright permission.

     <p>Notwithstanding any other provision of this License, for material you
add to a covered work, you may (if authorized by the copyright holders
of that material) supplement the terms of this License with terms:

          <ol type=a start=1>
<li>Disclaiming warranty or limiting liability differently from the terms
of sections 15 and 16 of this License; or

          <li>Requiring preservation of specified reasonable legal notices or author
attributions in that material or in the Appropriate Legal Notices
displayed by works containing it; or

          <li>Prohibiting misrepresentation of the origin of that material, or
requiring that modified versions of such material be marked in
reasonable ways as different from the original version; or

          <li>Limiting the use for publicity purposes of names of licensors or
authors of the material; or

          <li>Declining to grant rights under trademark law for use of some trade
names, trademarks, or service marks; or

          <li>Requiring indemnification of licensors and authors of that material by
anyone who conveys the material (or modified versions of it) with
contractual assumptions of liability to the recipient, for any
liability that these contractual assumptions directly impose on those
licensors and authors.
          </ol>

     <p>All other non-permissive additional terms are considered &ldquo;further
restrictions&rdquo; within the meaning of section 10.  If the Program as you
received it, or any part of it, contains a notice stating that it is
governed by this License along with a term that is a further
restriction, you may remove that term.  If a license document contains
a further restriction but permits relicensing or conveying under this
License, you may add to a covered work material governed by the terms
of that license document, provided that the further restriction does
not survive such relicensing or conveying.

     <p>If you add terms to a covered work in accord with this section, you
must place, in the relevant source files, a statement of the
additional terms that apply to those files, or a notice indicating
where to find the applicable terms.

     <p>Additional terms, permissive or non-permissive, may be stated in the
form of a separately written license, or stated as exceptions; the
above requirements apply either way.

     <li>Termination.

     <p>You may not propagate or modify a covered work except as expressly
provided under this License.  Any attempt otherwise to propagate or
modify it is void, and will automatically terminate your rights under
this License (including any patent licenses granted under the third
paragraph of section 11).

     <p>However, if you cease all violation of this License, then your license
from a particular copyright holder is reinstated (a) provisionally,
unless and until the copyright holder explicitly and finally
terminates your license, and (b) permanently, if the copyright holder
fails to notify you of the violation by some reasonable means prior to
60 days after the cessation.

     <p>Moreover, your license from a particular copyright holder is
reinstated permanently if the copyright holder notifies you of the
violation by some reasonable means, this is the first time you have
received notice of violation of this License (for any work) from that
copyright holder, and you cure the violation prior to 30 days after
your receipt of the notice.

     <p>Termination of your rights under this section does not terminate the
licenses of parties who have received copies or rights from you under
this License.  If your rights have been terminated and not permanently
reinstated, you do not qualify to receive new licenses for the same
material under section 10.

     <li>Acceptance Not Required for Having Copies.

     <p>You are not required to accept this License in order to receive or run
a copy of the Program.  Ancillary propagation of a covered work
occurring solely as a consequence of using peer-to-peer transmission
to receive a copy likewise does not require acceptance.  However,
nothing other than this License grants you permission to propagate or
modify any covered work.  These actions infringe copyright if you do
not accept this License.  Therefore, by modifying or propagating a
covered work, you indicate your acceptance of this License to do so.

     <li>Automatic Licensing of Downstream Recipients.

     <p>Each time you convey a covered work, the recipient automatically
receives a license from the original licensors, to run, modify and
propagate that work, subject to this License.  You are not responsible
for enforcing compliance by third parties with this License.

     <p>An &ldquo;entity transaction&rdquo; is a transaction transferring control of an
organization, or substantially all assets of one, or subdividing an
organization, or merging organizations.  If propagation of a covered
work results from an entity transaction, each party to that
transaction who receives a copy of the work also receives whatever
licenses to the work the party's predecessor in interest had or could
give under the previous paragraph, plus a right to possession of the
Corresponding Source of the work from the predecessor in interest, if
the predecessor has it or can get it with reasonable efforts.

     <p>You may not impose any further restrictions on the exercise of the
rights granted or affirmed under this License.  For example, you may
not impose a license fee, royalty, or other charge for exercise of
rights granted under this License, and you may not initiate litigation
(including a cross-claim or counterclaim in a lawsuit) alleging that
any patent claim is infringed by making, using, selling, offering for
sale, or importing the Program or any portion of it.

     <li>Patents.

     <p>A &ldquo;contributor&rdquo; is a copyright holder who authorizes use under this
License of the Program or a work on which the Program is based.  The
work thus licensed is called the contributor's &ldquo;contributor version&rdquo;.

     <p>A contributor's &ldquo;essential patent claims&rdquo; are all patent claims owned
or controlled by the contributor, whether already acquired or
hereafter acquired, that would be infringed by some manner, permitted
by this License, of making, using, or selling its contributor version,
but do not include claims that would be infringed only as a
consequence of further modification of the contributor version.  For
purposes of this definition, &ldquo;control&rdquo; includes the right to grant
patent sublicenses in a manner consistent with the requirements of
this License.

     <p>Each contributor grants you a non-exclusive, worldwide, royalty-free
patent license under the contributor's essential patent claims, to
make, use, sell, offer for sale, import and otherwise run, modify and
propagate the contents of its contributor version.

     <p>In the following three paragraphs, a &ldquo;patent license&rdquo; is any express
agreement or commitment, however denominated, not to enforce a patent
(such as an express permission to practice a patent or covenant not to
sue for patent infringement).  To &ldquo;grant&rdquo; such a patent license to a
party means to make such an agreement or commitment not to enforce a
patent against the party.

     <p>If you convey a covered work, knowingly relying on a patent license,
and the Corresponding Source of the work is not available for anyone
to copy, free of charge and under the terms of this License, through a
publicly available network server or other readily accessible means,
then you must either (1) cause the Corresponding Source to be so
available, or (2) arrange to deprive yourself of the benefit of the
patent license for this particular work, or (3) arrange, in a manner
consistent with the requirements of this License, to extend the patent
license to downstream recipients.  &ldquo;Knowingly relying&rdquo; means you have
actual knowledge that, but for the patent license, your conveying the
covered work in a country, or your recipient's use of the covered work
in a country, would infringe one or more identifiable patents in that
country that you have reason to believe are valid.

     <p>If, pursuant to or in connection with a single transaction or
arrangement, you convey, or propagate by procuring conveyance of, a
covered work, and grant a patent license to some of the parties
receiving the covered work authorizing them to use, propagate, modify
or convey a specific copy of the covered work, then the patent license
you grant is automatically extended to all recipients of the covered
work and works based on it.

     <p>A patent license is &ldquo;discriminatory&rdquo; if it does not include within the
scope of its coverage, prohibits the exercise of, or is conditioned on
the non-exercise of one or more of the rights that are specifically
granted under this License.  You may not convey a covered work if you
are a party to an arrangement with a third party that is in the
business of distributing software, under which you make payment to the
third party based on the extent of your activity of conveying the
work, and under which the third party grants, to any of the parties
who would receive the covered work from you, a discriminatory patent
license (a) in connection with copies of the covered work conveyed by
you (or copies made from those copies), or (b) primarily for and in
connection with specific products or compilations that contain the
covered work, unless you entered into that arrangement, or that patent
license was granted, prior to 28 March 2007.

     <p>Nothing in this License shall be construed as excluding or limiting
any implied license or other defenses to infringement that may
otherwise be available to you under applicable patent law.

     <li>No Surrender of Others' Freedom.

     <p>If conditions are imposed on you (whether by court order, agreement or
otherwise) that contradict the conditions of this License, they do not
excuse you from the conditions of this License.  If you cannot convey
a covered work so as to satisfy simultaneously your obligations under
this License and any other pertinent obligations, then as a
consequence you may not convey it at all.  For example, if you agree
to terms that obligate you to collect a royalty for further conveying
from those to whom you convey the Program, the only way you could
satisfy both those terms and this License would be to refrain entirely
from conveying the Program.

     <li>Use with the GNU Affero General Public License.

     <p>Notwithstanding any other provision of this License, you have
permission to link or combine any covered work with a work licensed
under version 3 of the GNU Affero General Public License into a single
combined work, and to convey the resulting work.  The terms of this
License will continue to apply to the part which is the covered work,
but the special requirements of the GNU Affero General Public License,
section 13, concerning interaction through a network will apply to the
combination as such.

     <li>Revised Versions of this License.

     <p>The Free Software Foundation may publish revised and/or new versions
of the GNU General Public License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.

     <p>Each version is given a distinguishing version number.  If the Program
specifies that a certain numbered version of the GNU General Public
License &ldquo;or any later version&rdquo; applies to it, you have the option of
following the terms and conditions either of that numbered version or
of any later version published by the Free Software Foundation.  If
the Program does not specify a version number of the GNU General
Public License, you may choose any version ever published by the Free
Software Foundation.

     <p>If the Program specifies that a proxy can decide which future versions
of the GNU General Public License can be used, that proxy's public
statement of acceptance of a version permanently authorizes you to
choose that version for the Program.

     <p>Later license versions may give you additional or different
permissions.  However, no additional obligations are imposed on any
author or copyright holder as a result of your choosing to follow a
later version.

     <li>Disclaimer of Warranty.

     <p>THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY
APPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT
HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM &ldquo;AS IS&rdquo; WITHOUT
WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND
PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE PROGRAM PROVE
DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR
CORRECTION.

     <li>Limitation of Liability.

     <p>IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING
WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR
CONVEYS THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,
INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES
ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT
NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR
LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM
TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER
PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.

     <li>Interpretation of Sections 15 and 16.

     <p>If the disclaimer of warranty and limitation of liability provided
above cannot be given local legal effect according to their terms,
reviewing courts shall apply local law that most closely approximates
an absolute waiver of all civil liability in connection with the
Program, unless a warranty or assumption of liability accompanies a
copy of the Program in return for a fee.

     </ol>

<h3 class="heading">END OF TERMS AND CONDITIONS</h3>

<h3 class="heading">How to Apply These Terms to Your New Programs</h3>

<p>If you develop a new program, and you want it to be of the greatest
possible use to the public, the best way to achieve this is to make it
free software which everyone can redistribute and change under these
terms.

<p>To do so, attach the following notices to the program.  It is safest
to attach them to the start of each source file to most effectively
state the exclusion of warranty; and each file should have at least
the &ldquo;copyright&rdquo; line and a pointer to where the full notice is found.

<pre class="smallexample">     <var>one line to give the program's name and a brief idea of what it does.</var>
     Copyright (C) <var>year</var> <var>name of author</var>
     
     This program is free software: you can redistribute it and/or modify
     it under the terms of the GNU General Public License as published by
     the Free Software Foundation, either version 3 of the License, or (at
     your option) any later version.
     
     This program is distributed in the hope that it will be useful, but
     WITHOUT ANY WARRANTY; without even the implied warranty of
     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
     General Public License for more details.
     
     You should have received a copy of the GNU General Public License
     along with this program.  If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.
</pre>
<p>Also add information on how to contact you by electronic and paper mail.

<p>If the program does terminal interaction, make it output a short
notice like this when it starts in an interactive mode:

<pre class="smallexample">     <var>program</var> Copyright (C) <var>year</var> <var>name of author</var>
     This program comes with ABSOLUTELY NO WARRANTY; for details type &lsquo;<samp><span class="samp">show w</span></samp>&rsquo;.
     This is free software, and you are welcome to redistribute it
     under certain conditions; type &lsquo;<samp><span class="samp">show c</span></samp>&rsquo; for details.
</pre>
<p>The hypothetical commands &lsquo;<samp><span class="samp">show w</span></samp>&rsquo; and &lsquo;<samp><span class="samp">show c</span></samp>&rsquo; should show
the appropriate parts of the General Public License.  Of course, your
program's commands might be different; for a GUI interface, you would
use an &ldquo;about box&rdquo;.

<p>You should also get your employer (if you work as a programmer) or school,
if any, to sign a &ldquo;copyright disclaimer&rdquo; for the program, if necessary. 
For more information on this, and how to apply and follow the GNU GPL, see
<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.

<p>The GNU General Public License does not permit incorporating your
program into proprietary programs.  If your program is a subroutine
library, you may consider it more useful to permit linking proprietary
applications with the library.  If this is what you want to do, use
the GNU Lesser General Public License instead of this License.  But
first, please read <a href="http://www.gnu.org/philosophy/why-not-lgpl.html">http://www.gnu.org/philosophy/why-not-lgpl.html</a>.

<div class="node">
<a name="Bibliography"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Function-and-Data-Index">Function and Data Index</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="unnumbered">Bibliography</h2>

     <dl>
<dt><a name="CBCATT"></a>[CBCATT]<dd>Bodo Moeller, "Security of CBC Ciphersuites in SSL/TLS: Problems and
Countermeasures", 2002, available from
<a href="http://www.openssl.org/~bodo/tls-cbc.txt">http://www.openssl.org/~bodo/tls-cbc.txt</a>.

     <br><dt><a name="GPGH"></a>[GPGH]<dd>Mike Ashley, "The GNU Privacy Handbook", 2002, available from
<a href="http://www.gnupg.org/gph/en/manual.pdf">http://www.gnupg.org/gph/en/manual.pdf</a>.

     <br><dt><a name="GUTPKI"></a>[GUTPKI]<dd>Peter Gutmann, "Everything you never wanted to know about PKI but were
forced to find out", Available from
<a href="http://www.cs.auckland.ac.nz/~pgut001/">http://www.cs.auckland.ac.nz/~pgut001/</a>.

     <br><dt><a name="NISTSP80057"></a>[NISTSP80057]<dd>NIST Special Publication 800-57, "Recommendation for Key Management -
Part 1: General (Revised)", March 2007, available from
<a href="http://csrc.nist.gov/publications/nistpubs/800-57/sp800-57-Part1-revised2_Mar08-2007.pdf">http://csrc.nist.gov/publications/nistpubs/800-57/sp800-57-Part1-revised2_Mar08-2007.pdf</a>.

     <br><dt><a name="RFC2246"></a>[RFC2246]<dd>Tim Dierks and Christopher Allen, "The TLS Protocol Version 1.0",
January 1999, Available from
<a href="http://www.ietf.org/rfc/rfc2246.txt">http://www.ietf.org/rfc/rfc2246.txt</a>.

     <br><dt><a name="RFC4346"></a>[RFC4346]<dd>Tim Dierks and Eric Rescorla, "The TLS Protocol Version 1.1", Match
2006, Available from <a href="http://www.ietf.org/rfc/rfc4346.txt">http://www.ietf.org/rfc/rfc4346.txt</a>.

     <br><dt><a name="RFC2440"></a>[RFC2440]<dd>Jon Callas, Lutz Donnerhacke, Hal Finney and Rodney Thayer, "OpenPGP
Message Format", November 1998, Available from
<a href="http://www.ietf.org/rfc/rfc2440.txt">http://www.ietf.org/rfc/rfc2440.txt</a>.

     <br><dt><a name="RFC4880"></a>[RFC4880]<dd>Jon Callas, Lutz Donnerhacke, Hal Finney, David Shaw and Rodney
Thayer, "OpenPGP Message Format", November 2007, Available from
<a href="http://www.ietf.org/rfc/rfc4880.txt">http://www.ietf.org/rfc/rfc4880.txt</a>.

     <br><dt><a name="RFC4211"></a>[RFC4211]<dd>J. Schaad, "Internet X.509 Public Key Infrastructure Certificate
Request Message Format (CRMF)", September 2005, Available from
<a href="http://www.ietf.org/rfc/rfc4211.txt">http://www.ietf.org/rfc/rfc4211.txt</a>.

     <br><dt><a name="RFC2817"></a>[RFC2817]<dd>Rohit Khare and Scott Lawrence, "Upgrading to TLS Within HTTP/1.1",
May 2000, Available from <a href="http://www.ietf.org/rfc/rfc2817.txt">http://www.ietf.org/rfc/rfc2817.txt</a>

     <br><dt><a name="RFC2818"></a>[RFC2818]<dd>Eric Rescorla, "HTTP Over TLS", May 2000, Available from
<a href="http://www.ietf/rfc/rfc2818.txt">http://www.ietf/rfc/rfc2818.txt</a>.

     <br><dt><a name="RFC2945"></a>[RFC2945]<dd>Tom Wu, "The SRP Authentication and Key Exchange System", September
2000, Available from <a href="http://www.ietf.org/rfc/rfc2945.txt">http://www.ietf.org/rfc/rfc2945.txt</a>.

     <br><dt><a name="RFC2986"></a>[RFC2986]<dd>Magnus Nystrom and Burt Kaliski, "PKCS 10 v1.7: Certification Request
Syntax Specification", November 2000, Available from
<a href="http://www.ietf.org/rfc/rfc2986.txt">http://www.ietf.org/rfc/rfc2986.txt</a>.

     <br><dt><a name="RFC3280"></a>[RFC3280]<dd>Russell Housley, Tim Polk, Warwick Ford and David Solo, "Internet
X.509 Public Key Infrastructure Certificate and Certificate Revocation
List (CRL) Profile", April 2002, Available from
<a href="http://www.ietf.org/rfc/rfc3280.txt">http://www.ietf.org/rfc/rfc3280.txt</a>.

     <br><dt><a name="RFC3749"></a>[RFC3749]<dd>Scott Hollenbeck, "Transport Layer Security Protocol Compression
Methods", May 2004, Available from
<a href="http://www.ietf.org/rfc/rfc3749.txt">http://www.ietf.org/rfc/rfc3749.txt</a>.

     <br><dt><a name="RFC3820"></a>[RFC3820]<dd>Steven Tuecke, Von Welch, Doug Engert, Laura Pearlman, and Mary
Thompson, "Internet X.509 Public Key Infrastructure (PKI) Proxy
Certificate Profile", June 2004, available from
<a href="http://www.ietf.org/rfc3820">http://www.ietf.org/rfc3820</a>.

     <br><dt><a name="PKCS12"></a>[PKCS12]<dd>RSA Laboratories, "PKCS 12 v1.0: Personal Information Exchange
Syntax", June 1999, Available from <a href="http://www.rsa.com">http://www.rsa.com</a>.

     <br><dt><a name="RESCORLA"></a>[RESCORLA]<dd>Eric Rescorla, "SSL and TLS: Designing and Building Secure Systems",
2001

     <br><dt><a name="SELKEY"></a>[SELKEY]<dd>Arjen Lenstra and Eric Verheul, "Selecting Cryptographic Key Sizes",
2003, available from <a href="http://www.win.tue.nl/~klenstra/key.pdf">http://www.win.tue.nl/~klenstra/key.pdf</a>.

     <br><dt><a name="SSL3"></a>[SSL3]<dd>Alan Freier, Philip Karlton and Paul Kocher, "The SSL Protocol Version
3.0", November 1996, Available from
<a href="http://wp.netscape.com/eng/ssl3/draft302.txt">http://wp.netscape.com/eng/ssl3/draft302.txt</a>.

     <br><dt><a name="STEVENS"></a>[STEVENS]<dd>Richard Stevens, "UNIX Network Programming, Volume 1", Prentice Hall
PTR, January 1998

     <br><dt><a name="TLSEXT"></a>[TLSEXT]<dd>Simon Blake-Wilson, Magnus Nystrom, David Hopwood, Jan Mikkelsen and
Tim Wright, "Transport Layer Security (TLS) Extensions", June 2003,
Available from <a href="http://www.ietf.org/rfc/rfc3546.txt">http://www.ietf.org/rfc/rfc3546.txt</a>.

     <br><dt><a name="TLSPGP"></a>[TLSPGP]<dd>Nikos Mavrogiannopoulos, "Using OpenPGP keys for TLS authentication",
April 2004, November 2007. Available from
<a href="http://www.ietf.org/rfc/rfc5081.txt">http://www.ietf.org/rfc/rfc5081.txt</a>.

     <br><dt><a name="TLSSRP"></a>[TLSSRP]<dd>David Taylor, Trevor Perrin, Tom Wu and Nikos Mavrogiannopoulos,
"Using SRP for TLS Authentication", November 2007. Available from
<a href="http://www.ietf.org/rfc/rfc5054.txt">http://www.ietf.org/rfc/rfc5054.txt</a>.

     <br><dt><a name="TLSPSK"></a>[TLSPSK]<dd>Pasi Eronen and Hannes Tschofenig, "Pre-shared key Ciphersuites for
TLS", December 2005, Available from
<a href="http://www.ietf.org/rfc/rfc4279.txt">http://www.ietf.org/rfc/rfc4279.txt</a>.

     <br><dt><a name="TOMSRP"></a>[TOMSRP]<dd>Tom Wu, "The Stanford SRP Authentication Project", Available at
<a href="http://srp.stanford.edu/">http://srp.stanford.edu/</a>.

     <br><dt><a name="WEGER"></a>[WEGER]<dd>Arjen Lenstra and Xiaoyun Wang and Benne de Weger, "Colliding X.509
Certificates", Cryptology ePrint Archive, Report 2005/067, Available
at <a href="http://eprint.iacr.org/">http://eprint.iacr.org/</a>.

</dl>

<div class="node">
<a name="Function-and-Data-Index"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Bibliography">Bibliography</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Concept-Index">Concept Index</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="unnumbered">Function and Data Index</h2>

<ul class="index-fn" compact>
<li><a href="#index-alert_002ddescription_002d_003estring-702"><code>alert-description-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-alert_002dget-670"><code>alert-get</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-alert_002dlevel_002d_003estring-703"><code>alert-level-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-alert_002dsend-669"><code>alert-send</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-anonymous_002dclient_002dcredentials_003f-686"><code>anonymous-client-credentials?</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-anonymous_002dserver_002dcredentials_003f-685"><code>anonymous-server-credentials?</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-bye-673"><code>bye</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-certificate_002dcredentials_003f-682"><code>certificate-credentials?</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-certificate_002drequest_002d_003estring-699"><code>certificate-request-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-certificate_002dstatus_002d_003estring-700"><code>certificate-status-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-certificate_002dtype_002d_003estring-696"><code>certificate-type-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-certificate_002dverify_002d_003estring-689"><code>certificate-verify-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-cipher_002d_003estring-711"><code>cipher-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-cipher_002dsuite_002d_003estring-648"><code>cipher-suite-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-close_002drequest_002d_003estring-698"><code>close-request-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-compression_002dmethod_002d_003estring-705"><code>compression-method-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-connection_002dend_002d_003estring-704"><code>connection-end-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-credentials_002d_003estring-708"><code>credentials-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-dh_002dparameters_003f-684"><code>dh-parameters?</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-digest_002d_003estring-706"><code>digest-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-error_002d_003estring-688"><code>error-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-error_002d_003estring-588"><code>error-&gt;string</code></a>: <a href="#Exception-Handling">Exception Handling</a></li>
<li><a href="#index-gnutls_002dversion-675"><code>gnutls-version</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-gnutls_005falert_005fget-57"><code>gnutls_alert_get</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005falert_005fget_005fname-56"><code>gnutls_alert_get_name</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005falert_005fsend-59"><code>gnutls_alert_send</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005falert_005fsend_005fappropriate-58"><code>gnutls_alert_send_appropriate</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fanon_005fallocate_005fclient_005fcredentials-60"><code>gnutls_anon_allocate_client_credentials</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fanon_005fallocate_005fserver_005fcredentials-61"><code>gnutls_anon_allocate_server_credentials</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fanon_005ffree_005fclient_005fcredentials-62"><code>gnutls_anon_free_client_credentials</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fanon_005ffree_005fserver_005fcredentials-63"><code>gnutls_anon_free_server_credentials</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fanon_005fset_005fparams_005ffunction-64"><code>gnutls_anon_set_params_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fanon_005fset_005fserver_005fdh_005fparams-65"><code>gnutls_anon_set_server_dh_params</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fanon_005fset_005fserver_005fparams_005ffunction-66"><code>gnutls_anon_set_server_params_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fauth_005fclient_005fget_005ftype-67"><code>gnutls_auth_client_get_type</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fauth_005fget_005ftype-68"><code>gnutls_auth_get_type</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fauth_005fserver_005fget_005ftype-69"><code>gnutls_auth_server_get_type</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fbye-70"><code>gnutls_bye</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005factivation_005ftime_005fpeers-71"><code>gnutls_certificate_activation_time_peers</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fallocate_005fcredentials-72"><code>gnutls_certificate_allocate_credentials</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fclient_005fget_005frequest_005fstatus-73"><code>gnutls_certificate_client_get_request_status</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fclient_005fset_005fretrieve_005ffunction-74"><code>gnutls_certificate_client_set_retrieve_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fexpiration_005ftime_005fpeers-75"><code>gnutls_certificate_expiration_time_peers</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005ffree_005fca_005fnames-76"><code>gnutls_certificate_free_ca_names</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005ffree_005fcas-77"><code>gnutls_certificate_free_cas</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005ffree_005fcredentials-78"><code>gnutls_certificate_free_credentials</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005ffree_005fcrls-79"><code>gnutls_certificate_free_crls</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005ffree_005fkeys-80"><code>gnutls_certificate_free_keys</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fget_005fopenpgp_005fkeyring-81"><code>gnutls_certificate_get_openpgp_keyring</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fget_005fours-82"><code>gnutls_certificate_get_ours</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fget_005fpeers-83"><code>gnutls_certificate_get_peers</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fget_005fx509_005fcas-84"><code>gnutls_certificate_get_x509_cas</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fget_005fx509_005fcrls-85"><code>gnutls_certificate_get_x509_crls</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fsend_005fx509_005frdn_005fsequence-86"><code>gnutls_certificate_send_x509_rdn_sequence</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fserver_005fset_005frequest-87"><code>gnutls_certificate_server_set_request</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fserver_005fset_005fretrieve_005ffunction-88"><code>gnutls_certificate_server_set_retrieve_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fdh_005fparams-89"><code>gnutls_certificate_set_dh_params</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fopenpgp_005fkey-484"><code>gnutls_certificate_set_openpgp_key</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005ffile-479"><code>gnutls_certificate_set_openpgp_key_file</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005ffile2-478"><code>gnutls_certificate_set_openpgp_key_file2</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005fmem-481"><code>gnutls_certificate_set_openpgp_key_mem</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fopenpgp_005fkey_005fmem2-480"><code>gnutls_certificate_set_openpgp_key_mem2</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fopenpgp_005fkeyring_005ffile-482"><code>gnutls_certificate_set_openpgp_keyring_file</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fopenpgp_005fkeyring_005fmem-483"><code>gnutls_certificate_set_openpgp_keyring_mem</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fparams_005ffunction-90"><code>gnutls_certificate_set_params_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005frsa_005fexport_005fparams-91"><code>gnutls_certificate_set_rsa_export_params</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fverify_005fflags-92"><code>gnutls_certificate_set_verify_flags</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fverify_005flimits-93"><code>gnutls_certificate_set_verify_limits</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fx509_005fcrl-96"><code>gnutls_certificate_set_x509_crl</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fx509_005fcrl_005ffile-94"><code>gnutls_certificate_set_x509_crl_file</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fx509_005fcrl_005fmem-95"><code>gnutls_certificate_set_x509_crl_mem</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fx509_005fkey-99"><code>gnutls_certificate_set_x509_key</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fx509_005fkey_005ffile-97"><code>gnutls_certificate_set_x509_key_file</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fx509_005fkey_005fmem-98"><code>gnutls_certificate_set_x509_key_mem</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fx509_005fsimple_005fpkcs12_005ffile-100"><code>gnutls_certificate_set_x509_simple_pkcs12_file</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fx509_005ftrust-103"><code>gnutls_certificate_set_x509_trust</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fx509_005ftrust_005ffile-101"><code>gnutls_certificate_set_x509_trust_file</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fset_005fx509_005ftrust_005fmem-102"><code>gnutls_certificate_set_x509_trust_mem</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005ftype_005fget-106"><code>gnutls_certificate_type_get</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005ftype_005fget_005fid-104"><code>gnutls_certificate_type_get_id</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005ftype_005fget_005fname-105"><code>gnutls_certificate_type_get_name</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005ftype_005flist-107"><code>gnutls_certificate_type_list</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005ftype_005fset_005fpriority-108"><code>gnutls_certificate_type_set_priority</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fverify_005fflags-34"><code>gnutls_certificate_verify_flags</code></a>: <a href="#Verifying-X_002e509-certificate-paths">Verifying X.509 certificate paths</a></li>
<li><a href="#index-gnutls_005fcertificate_005fverify_005fpeers-110"><code>gnutls_certificate_verify_peers</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcertificate_005fverify_005fpeers2-109"><code>gnutls_certificate_verify_peers2</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcheck_005fversion-111"><code>gnutls_check_version</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcipher_005fget-115"><code>gnutls_cipher_get</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcipher_005fget_005fid-112"><code>gnutls_cipher_get_id</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcipher_005fget_005fkey_005fsize-113"><code>gnutls_cipher_get_key_size</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcipher_005fget_005fname-114"><code>gnutls_cipher_get_name</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcipher_005flist-116"><code>gnutls_cipher_list</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcipher_005fset_005fpriority-117"><code>gnutls_cipher_set_priority</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcipher_005fsuite_005fget_005fname-118"><code>gnutls_cipher_suite_get_name</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcipher_005fsuite_005finfo-119"><code>gnutls_cipher_suite_info</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcompression_005fget-122"><code>gnutls_compression_get</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcompression_005fget_005fid-120"><code>gnutls_compression_get_id</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcompression_005fget_005fname-121"><code>gnutls_compression_get_name</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcompression_005flist-123"><code>gnutls_compression_list</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcompression_005fset_005fpriority-124"><code>gnutls_compression_set_priority</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcredentials_005fclear-125"><code>gnutls_credentials_clear</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcredentials_005fset-126"><code>gnutls_credentials_set</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcrypto_005fbigint_005fregister2-127"><code>gnutls_crypto_bigint_register2</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcrypto_005fcipher_005fregister2-128"><code>gnutls_crypto_cipher_register2</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcrypto_005fdigest_005fregister2-129"><code>gnutls_crypto_digest_register2</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcrypto_005fmac_005fregister2-130"><code>gnutls_crypto_mac_register2</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcrypto_005fpk_005fregister2-131"><code>gnutls_crypto_pk_register2</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcrypto_005frnd_005fregister2-132"><code>gnutls_crypto_rnd_register2</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcrypto_005fsingle_005fcipher_005fregister2-133"><code>gnutls_crypto_single_cipher_register2</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcrypto_005fsingle_005fdigest_005fregister2-134"><code>gnutls_crypto_single_digest_register2</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fcrypto_005fsingle_005fmac_005fregister2-135"><code>gnutls_crypto_single_mac_register2</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdb_005fcheck_005fentry-136"><code>gnutls_db_check_entry</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdb_005fget_005fptr-137"><code>gnutls_db_get_ptr</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdb_005fremove_005fsession-138"><code>gnutls_db_remove_session</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdb_005fset_005fcache_005fexpiration-139"><code>gnutls_db_set_cache_expiration</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdb_005fset_005fptr-140"><code>gnutls_db_set_ptr</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdb_005fset_005fremove_005ffunction-141"><code>gnutls_db_set_remove_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdb_005fset_005fretrieve_005ffunction-142"><code>gnutls_db_set_retrieve_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdb_005fset_005fstore_005ffunction-143"><code>gnutls_db_set_store_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdeinit-144"><code>gnutls_deinit</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdh_005fget_005fgroup-145"><code>gnutls_dh_get_group</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdh_005fget_005fpeers_005fpublic_005fbits-146"><code>gnutls_dh_get_peers_public_bits</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdh_005fget_005fprime_005fbits-147"><code>gnutls_dh_get_prime_bits</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdh_005fget_005fpubkey-148"><code>gnutls_dh_get_pubkey</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdh_005fget_005fsecret_005fbits-149"><code>gnutls_dh_get_secret_bits</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdh_005fparams_005fcpy-150"><code>gnutls_dh_params_cpy</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdh_005fparams_005fdeinit-151"><code>gnutls_dh_params_deinit</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdh_005fparams_005fexport_005fpkcs3-152"><code>gnutls_dh_params_export_pkcs3</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdh_005fparams_005fexport_005fraw-153"><code>gnutls_dh_params_export_raw</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdh_005fparams_005fgenerate2-154"><code>gnutls_dh_params_generate2</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdh_005fparams_005fimport_005fpkcs3-155"><code>gnutls_dh_params_import_pkcs3</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdh_005fparams_005fimport_005fraw-156"><code>gnutls_dh_params_import_raw</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdh_005fparams_005finit-157"><code>gnutls_dh_params_init</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fdh_005fset_005fprime_005fbits-158"><code>gnutls_dh_set_prime_bits</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005ferror_005fis_005ffatal-159"><code>gnutls_error_is_fatal</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005ferror_005fto_005falert-160"><code>gnutls_error_to_alert</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fext_005fregister-161"><code>gnutls_ext_register</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fextra_005fcheck_005fversion-475"><code>gnutls_extra_check_version</code></a>: <a href="#GnuTLS_002dextra-functions">GnuTLS-extra functions</a></li>
<li><a href="#index-gnutls_005ffingerprint-162"><code>gnutls_fingerprint</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005ffree-163"><code>gnutls_free</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fglobal_005fdeinit-164"><code>gnutls_global_deinit</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fglobal_005finit-165"><code>gnutls_global_init</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fglobal_005finit_005fextra-476"><code>gnutls_global_init_extra</code></a>: <a href="#GnuTLS_002dextra-functions">GnuTLS-extra functions</a></li>
<li><a href="#index-gnutls_005fglobal_005fset_005flog_005ffunction-166"><code>gnutls_global_set_log_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fglobal_005fset_005flog_005flevel-167"><code>gnutls_global_set_log_level</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fglobal_005fset_005fmem_005ffunctions-168"><code>gnutls_global_set_mem_functions</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fhandshake-174"><code>gnutls_handshake</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fhandshake_005fget_005flast_005fin-169"><code>gnutls_handshake_get_last_in</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fhandshake_005fget_005flast_005fout-170"><code>gnutls_handshake_get_last_out</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fhandshake_005fset_005fmax_005fpacket_005flength-171"><code>gnutls_handshake_set_max_packet_length</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fhandshake_005fset_005fpost_005fclient_005fhello_005ffunction-172"><code>gnutls_handshake_set_post_client_hello_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fhandshake_005fset_005fprivate_005fextensions-173"><code>gnutls_handshake_set_private_extensions</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fhex2bin-175"><code>gnutls_hex2bin</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fhex_005fdecode-176"><code>gnutls_hex_decode</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fhex_005fencode-177"><code>gnutls_hex_encode</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fia_005fallocate_005fclient_005fcredentials-550"><code>gnutls_ia_allocate_client_credentials</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005fallocate_005fserver_005fcredentials-551"><code>gnutls_ia_allocate_server_credentials</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005fenable-552"><code>gnutls_ia_enable</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005fendphase_005fsend-553"><code>gnutls_ia_endphase_send</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005fextract_005finner_005fsecret-554"><code>gnutls_ia_extract_inner_secret</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005ffree_005fclient_005fcredentials-555"><code>gnutls_ia_free_client_credentials</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005ffree_005fserver_005fcredentials-556"><code>gnutls_ia_free_server_credentials</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005fgenerate_005fchallenge-557"><code>gnutls_ia_generate_challenge</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005fget_005fclient_005favp_005fptr-558"><code>gnutls_ia_get_client_avp_ptr</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005fget_005fserver_005favp_005fptr-559"><code>gnutls_ia_get_server_avp_ptr</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005fhandshake-561"><code>gnutls_ia_handshake</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005fhandshake_005fp-560"><code>gnutls_ia_handshake_p</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005fpermute_005finner_005fsecret-562"><code>gnutls_ia_permute_inner_secret</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005frecv-563"><code>gnutls_ia_recv</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005fsend-564"><code>gnutls_ia_send</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005fset_005fclient_005favp_005ffunction-565"><code>gnutls_ia_set_client_avp_function</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005fset_005fclient_005favp_005fptr-566"><code>gnutls_ia_set_client_avp_ptr</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005fset_005fserver_005favp_005ffunction-567"><code>gnutls_ia_set_server_avp_function</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005fset_005fserver_005favp_005fptr-568"><code>gnutls_ia_set_server_avp_ptr</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005fia_005fverify_005fendphase-569"><code>gnutls_ia_verify_endphase</code></a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-gnutls_005finit-178"><code>gnutls_init</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fkx_005fget-181"><code>gnutls_kx_get</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fkx_005fget_005fid-179"><code>gnutls_kx_get_id</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fkx_005fget_005fname-180"><code>gnutls_kx_get_name</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fkx_005flist-182"><code>gnutls_kx_list</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fkx_005fset_005fpriority-183"><code>gnutls_kx_set_priority</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fmac_005fget-187"><code>gnutls_mac_get</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fmac_005fget_005fid-184"><code>gnutls_mac_get_id</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fmac_005fget_005fkey_005fsize-185"><code>gnutls_mac_get_key_size</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fmac_005fget_005fname-186"><code>gnutls_mac_get_name</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fmac_005flist-188"><code>gnutls_mac_list</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fmac_005fset_005fpriority-189"><code>gnutls_mac_set_priority</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fmalloc-190"><code>gnutls_malloc</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fcheck_005fhostname-485"><code>gnutls_openpgp_crt_check_hostname</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fdeinit-486"><code>gnutls_openpgp_crt_deinit</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fexport-487"><code>gnutls_openpgp_crt_export</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fauth_005fsubkey-488"><code>gnutls_openpgp_crt_get_auth_subkey</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fcreation_005ftime-489"><code>gnutls_openpgp_crt_get_creation_time</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fexpiration_005ftime-490"><code>gnutls_openpgp_crt_get_expiration_time</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005ffingerprint-491"><code>gnutls_openpgp_crt_get_fingerprint</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fkey_005fid-492"><code>gnutls_openpgp_crt_get_key_id</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fkey_005fusage-493"><code>gnutls_openpgp_crt_get_key_usage</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fname-494"><code>gnutls_openpgp_crt_get_name</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fpk_005falgorithm-495"><code>gnutls_openpgp_crt_get_pk_algorithm</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fpk_005fdsa_005fraw-496"><code>gnutls_openpgp_crt_get_pk_dsa_raw</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fpk_005frsa_005fraw-497"><code>gnutls_openpgp_crt_get_pk_rsa_raw</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fpreferred_005fkey_005fid-498"><code>gnutls_openpgp_crt_get_preferred_key_id</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005frevoked_005fstatus-499"><code>gnutls_openpgp_crt_get_revoked_status</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fcount-500"><code>gnutls_openpgp_crt_get_subkey_count</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fcreation_005ftime-501"><code>gnutls_openpgp_crt_get_subkey_creation_time</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fexpiration_005ftime-502"><code>gnutls_openpgp_crt_get_subkey_expiration_time</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005ffingerprint-503"><code>gnutls_openpgp_crt_get_subkey_fingerprint</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fid-505"><code>gnutls_openpgp_crt_get_subkey_id</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fidx-504"><code>gnutls_openpgp_crt_get_subkey_idx</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005falgorithm-506"><code>gnutls_openpgp_crt_get_subkey_pk_algorithm</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005fdsa_005fraw-507"><code>gnutls_openpgp_crt_get_subkey_pk_dsa_raw</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fpk_005frsa_005fraw-508"><code>gnutls_openpgp_crt_get_subkey_pk_rsa_raw</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005frevoked_005fstatus-509"><code>gnutls_openpgp_crt_get_subkey_revoked_status</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fsubkey_005fusage-510"><code>gnutls_openpgp_crt_get_subkey_usage</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fget_005fversion-511"><code>gnutls_openpgp_crt_get_version</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fimport-512"><code>gnutls_openpgp_crt_import</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005finit-513"><code>gnutls_openpgp_crt_init</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fprint-514"><code>gnutls_openpgp_crt_print</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fset_005fpreferred_005fkey_005fid-515"><code>gnutls_openpgp_crt_set_preferred_key_id</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fverify_005fring-516"><code>gnutls_openpgp_crt_verify_ring</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fcrt_005fverify_005fself-517"><code>gnutls_openpgp_crt_verify_self</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fkeyring_005fcheck_005fid-518"><code>gnutls_openpgp_keyring_check_id</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fkeyring_005fdeinit-519"><code>gnutls_openpgp_keyring_deinit</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fkeyring_005fget_005fcrt-521"><code>gnutls_openpgp_keyring_get_crt</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fkeyring_005fget_005fcrt_005fcount-520"><code>gnutls_openpgp_keyring_get_crt_count</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fkeyring_005fimport-522"><code>gnutls_openpgp_keyring_import</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fkeyring_005finit-523"><code>gnutls_openpgp_keyring_init</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fdeinit-524"><code>gnutls_openpgp_privkey_deinit</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fexport-529"><code>gnutls_openpgp_privkey_export</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fexport_005fdsa_005fraw-525"><code>gnutls_openpgp_privkey_export_dsa_raw</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fexport_005frsa_005fraw-526"><code>gnutls_openpgp_privkey_export_rsa_raw</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fexport_005fsubkey_005fdsa_005fraw-527"><code>gnutls_openpgp_privkey_export_subkey_dsa_raw</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fexport_005fsubkey_005frsa_005fraw-528"><code>gnutls_openpgp_privkey_export_subkey_rsa_raw</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fget_005ffingerprint-530"><code>gnutls_openpgp_privkey_get_fingerprint</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fget_005fkey_005fid-531"><code>gnutls_openpgp_privkey_get_key_id</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fget_005fpk_005falgorithm-532"><code>gnutls_openpgp_privkey_get_pk_algorithm</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fget_005fpreferred_005fkey_005fid-533"><code>gnutls_openpgp_privkey_get_preferred_key_id</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fget_005frevoked_005fstatus-534"><code>gnutls_openpgp_privkey_get_revoked_status</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fcount-535"><code>gnutls_openpgp_privkey_get_subkey_count</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fcreation_005ftime-536"><code>gnutls_openpgp_privkey_get_subkey_creation_time</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fexpiration_005ftime-537"><code>gnutls_openpgp_privkey_get_subkey_expiration_time</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005ffingerprint-538"><code>gnutls_openpgp_privkey_get_subkey_fingerprint</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fid-540"><code>gnutls_openpgp_privkey_get_subkey_id</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fidx-539"><code>gnutls_openpgp_privkey_get_subkey_idx</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005fpk_005falgorithm-541"><code>gnutls_openpgp_privkey_get_subkey_pk_algorithm</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fget_005fsubkey_005frevoked_005fstatus-542"><code>gnutls_openpgp_privkey_get_subkey_revoked_status</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fimport-543"><code>gnutls_openpgp_privkey_import</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005finit-544"><code>gnutls_openpgp_privkey_init</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fset_005fpreferred_005fkey_005fid-545"><code>gnutls_openpgp_privkey_set_preferred_key_id</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fprivkey_005fsign_005fhash-546"><code>gnutls_openpgp_privkey_sign_hash</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fsend_005fcert-191"><code>gnutls_openpgp_send_cert</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fopenpgp_005fset_005frecv_005fkey_005ffunction-547"><code>gnutls_openpgp_set_recv_key_function</code></a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-gnutls_005foprfi_005fenable_005fclient-192"><code>gnutls_oprfi_enable_client</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005foprfi_005fenable_005fserver-193"><code>gnutls_oprfi_enable_server</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpem_005fbase64_005fdecode-195"><code>gnutls_pem_base64_decode</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpem_005fbase64_005fdecode_005falloc-194"><code>gnutls_pem_base64_decode_alloc</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpem_005fbase64_005fencode-197"><code>gnutls_pem_base64_encode</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpem_005fbase64_005fencode_005falloc-196"><code>gnutls_pem_base64_encode_alloc</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fperror-198"><code>gnutls_perror</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpk_005falgorithm_005fget_005fname-199"><code>gnutls_pk_algorithm_get_name</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpk_005fget_005fid-200"><code>gnutls_pk_get_id</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpk_005fget_005fname-201"><code>gnutls_pk_get_name</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpk_005flist-202"><code>gnutls_pk_list</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fbag_005fdecrypt-296"><code>gnutls_pkcs12_bag_decrypt</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fbag_005fdeinit-297"><code>gnutls_pkcs12_bag_deinit</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fbag_005fencrypt-298"><code>gnutls_pkcs12_bag_encrypt</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fbag_005fget_005fcount-299"><code>gnutls_pkcs12_bag_get_count</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fbag_005fget_005fdata-300"><code>gnutls_pkcs12_bag_get_data</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fbag_005fget_005ffriendly_005fname-301"><code>gnutls_pkcs12_bag_get_friendly_name</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fbag_005fget_005fkey_005fid-302"><code>gnutls_pkcs12_bag_get_key_id</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fbag_005fget_005ftype-303"><code>gnutls_pkcs12_bag_get_type</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fbag_005finit-304"><code>gnutls_pkcs12_bag_init</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fbag_005fset_005fcrl-305"><code>gnutls_pkcs12_bag_set_crl</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fbag_005fset_005fcrt-306"><code>gnutls_pkcs12_bag_set_crt</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fbag_005fset_005fdata-307"><code>gnutls_pkcs12_bag_set_data</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fbag_005fset_005ffriendly_005fname-308"><code>gnutls_pkcs12_bag_set_friendly_name</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fbag_005fset_005fkey_005fid-309"><code>gnutls_pkcs12_bag_set_key_id</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fdeinit-310"><code>gnutls_pkcs12_deinit</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fexport-311"><code>gnutls_pkcs12_export</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fgenerate_005fmac-312"><code>gnutls_pkcs12_generate_mac</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fget_005fbag-313"><code>gnutls_pkcs12_get_bag</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fimport-314"><code>gnutls_pkcs12_import</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005finit-315"><code>gnutls_pkcs12_init</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fset_005fbag-316"><code>gnutls_pkcs12_set_bag</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs12_005fverify_005fmac-317"><code>gnutls_pkcs12_verify_mac</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs7_005fdeinit-318"><code>gnutls_pkcs7_deinit</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs7_005fdelete_005fcrl-319"><code>gnutls_pkcs7_delete_crl</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs7_005fdelete_005fcrt-320"><code>gnutls_pkcs7_delete_crt</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs7_005fexport-321"><code>gnutls_pkcs7_export</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs7_005fget_005fcrl_005fcount-322"><code>gnutls_pkcs7_get_crl_count</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs7_005fget_005fcrl_005fraw-323"><code>gnutls_pkcs7_get_crl_raw</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs7_005fget_005fcrt_005fcount-324"><code>gnutls_pkcs7_get_crt_count</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs7_005fget_005fcrt_005fraw-325"><code>gnutls_pkcs7_get_crt_raw</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs7_005fimport-326"><code>gnutls_pkcs7_import</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs7_005finit-327"><code>gnutls_pkcs7_init</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs7_005fset_005fcrl-329"><code>gnutls_pkcs7_set_crl</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs7_005fset_005fcrl_005fraw-328"><code>gnutls_pkcs7_set_crl_raw</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs7_005fset_005fcrt-331"><code>gnutls_pkcs7_set_crt</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fpkcs7_005fset_005fcrt_005fraw-330"><code>gnutls_pkcs7_set_crt_raw</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fprf-204"><code>gnutls_prf</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fprf_005fraw-203"><code>gnutls_prf_raw</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpriority_005fdeinit-205"><code>gnutls_priority_deinit</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpriority_005finit-206"><code>gnutls_priority_init</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpriority_005fset-208"><code>gnutls_priority_set</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpriority_005fset_005fdirect-207"><code>gnutls_priority_set_direct</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fprotocol_005fget_005fid-209"><code>gnutls_protocol_get_id</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fprotocol_005fget_005fname-210"><code>gnutls_protocol_get_name</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fprotocol_005fget_005fversion-211"><code>gnutls_protocol_get_version</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fprotocol_005flist-212"><code>gnutls_protocol_list</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fprotocol_005fset_005fpriority-213"><code>gnutls_protocol_set_priority</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpsk_005fallocate_005fclient_005fcredentials-214"><code>gnutls_psk_allocate_client_credentials</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpsk_005fallocate_005fserver_005fcredentials-215"><code>gnutls_psk_allocate_server_credentials</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpsk_005fclient_005fget_005fhint-216"><code>gnutls_psk_client_get_hint</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpsk_005ffree_005fclient_005fcredentials-217"><code>gnutls_psk_free_client_credentials</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpsk_005ffree_005fserver_005fcredentials-218"><code>gnutls_psk_free_server_credentials</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpsk_005fnetconf_005fderive_005fkey-219"><code>gnutls_psk_netconf_derive_key</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpsk_005fserver_005fget_005fusername-220"><code>gnutls_psk_server_get_username</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpsk_005fset_005fclient_005fcredentials-222"><code>gnutls_psk_set_client_credentials</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpsk_005fset_005fclient_005fcredentials_005ffunction-221"><code>gnutls_psk_set_client_credentials_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpsk_005fset_005fparams_005ffunction-223"><code>gnutls_psk_set_params_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpsk_005fset_005fserver_005fcredentials_005ffile-224"><code>gnutls_psk_set_server_credentials_file</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpsk_005fset_005fserver_005fcredentials_005ffunction-225"><code>gnutls_psk_set_server_credentials_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpsk_005fset_005fserver_005fcredentials_005fhint-226"><code>gnutls_psk_set_server_credentials_hint</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpsk_005fset_005fserver_005fdh_005fparams-227"><code>gnutls_psk_set_server_dh_params</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fpsk_005fset_005fserver_005fparams_005ffunction-228"><code>gnutls_psk_set_server_params_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frecord_005fcheck_005fpending-229"><code>gnutls_record_check_pending</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frecord_005fdisable_005fpadding-230"><code>gnutls_record_disable_padding</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frecord_005fget_005fdirection-231"><code>gnutls_record_get_direction</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frecord_005fget_005fmax_005fsize-232"><code>gnutls_record_get_max_size</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frecord_005frecv-233"><code>gnutls_record_recv</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frecord_005fsend-234"><code>gnutls_record_send</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frecord_005fset_005fmax_005fsize-235"><code>gnutls_record_set_max_size</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frehandshake-236"><code>gnutls_rehandshake</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frsa_005fexport_005fget_005fmodulus_005fbits-237"><code>gnutls_rsa_export_get_modulus_bits</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frsa_005fexport_005fget_005fpubkey-238"><code>gnutls_rsa_export_get_pubkey</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frsa_005fparams_005fcpy-239"><code>gnutls_rsa_params_cpy</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frsa_005fparams_005fdeinit-240"><code>gnutls_rsa_params_deinit</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frsa_005fparams_005fexport_005fpkcs1-241"><code>gnutls_rsa_params_export_pkcs1</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frsa_005fparams_005fexport_005fraw-242"><code>gnutls_rsa_params_export_raw</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frsa_005fparams_005fgenerate2-243"><code>gnutls_rsa_params_generate2</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frsa_005fparams_005fimport_005fpkcs1-244"><code>gnutls_rsa_params_import_pkcs1</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frsa_005fparams_005fimport_005fraw-245"><code>gnutls_rsa_params_import_raw</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005frsa_005fparams_005finit-246"><code>gnutls_rsa_params_init</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fserver_005fname_005fget-247"><code>gnutls_server_name_get</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fserver_005fname_005fset-248"><code>gnutls_server_name_set</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsession_005fenable_005fcompatibility_005fmode-249"><code>gnutls_session_enable_compatibility_mode</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsession_005fget_005fclient_005frandom-250"><code>gnutls_session_get_client_random</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsession_005fget_005fdata-252"><code>gnutls_session_get_data</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsession_005fget_005fdata2-251"><code>gnutls_session_get_data2</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsession_005fget_005fid-253"><code>gnutls_session_get_id</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsession_005fget_005fmaster_005fsecret-254"><code>gnutls_session_get_master_secret</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsession_005fget_005fptr-255"><code>gnutls_session_get_ptr</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsession_005fget_005fserver_005frandom-256"><code>gnutls_session_get_server_random</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsession_005fis_005fresumed-257"><code>gnutls_session_is_resumed</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsession_005fset_005fdata-258"><code>gnutls_session_set_data</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsession_005fset_005ffinished_005ffunction-259"><code>gnutls_session_set_finished_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsession_005fset_005fptr-260"><code>gnutls_session_set_ptr</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fset_005fdefault_005fexport_005fpriority-261"><code>gnutls_set_default_export_priority</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fset_005fdefault_005fpriority-262"><code>gnutls_set_default_priority</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsign_005falgorithm_005fget_005fname-263"><code>gnutls_sign_algorithm_get_name</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsign_005fcallback_005fget-264"><code>gnutls_sign_callback_get</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsign_005fcallback_005fset-265"><code>gnutls_sign_callback_set</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsign_005fget_005fid-266"><code>gnutls_sign_get_id</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsign_005fget_005fname-267"><code>gnutls_sign_get_name</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsign_005flist-268"><code>gnutls_sign_list</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsrp_005fallocate_005fclient_005fcredentials-269"><code>gnutls_srp_allocate_client_credentials</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsrp_005fallocate_005fserver_005fcredentials-270"><code>gnutls_srp_allocate_server_credentials</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsrp_005fbase64_005fdecode-272"><code>gnutls_srp_base64_decode</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsrp_005fbase64_005fdecode_005falloc-271"><code>gnutls_srp_base64_decode_alloc</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsrp_005fbase64_005fencode-274"><code>gnutls_srp_base64_encode</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsrp_005fbase64_005fencode_005falloc-273"><code>gnutls_srp_base64_encode_alloc</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsrp_005ffree_005fclient_005fcredentials-275"><code>gnutls_srp_free_client_credentials</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsrp_005ffree_005fserver_005fcredentials-276"><code>gnutls_srp_free_server_credentials</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsrp_005fserver_005fget_005fusername-277"><code>gnutls_srp_server_get_username</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsrp_005fset_005fclient_005fcredentials-279"><code>gnutls_srp_set_client_credentials</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsrp_005fset_005fclient_005fcredentials_005ffunction-278"><code>gnutls_srp_set_client_credentials_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsrp_005fset_005fprime_005fbits-280"><code>gnutls_srp_set_prime_bits</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsrp_005fset_005fserver_005fcredentials_005ffile-281"><code>gnutls_srp_set_server_credentials_file</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsrp_005fset_005fserver_005fcredentials_005ffunction-282"><code>gnutls_srp_set_server_credentials_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fsrp_005fverifier-283"><code>gnutls_srp_verifier</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fstrerror-285"><code>gnutls_strerror</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fstrerror_005fname-284"><code>gnutls_strerror_name</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005ftransport_005fget_005fptr-287"><code>gnutls_transport_get_ptr</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005ftransport_005fget_005fptr2-286"><code>gnutls_transport_get_ptr2</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005ftransport_005fset_005ferrno-288"><code>gnutls_transport_set_errno</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005ftransport_005fset_005fglobal_005ferrno-289"><code>gnutls_transport_set_global_errno</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005ftransport_005fset_005flowat-290"><code>gnutls_transport_set_lowat</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005ftransport_005fset_005fptr-292"><code>gnutls_transport_set_ptr</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005ftransport_005fset_005fptr2-291"><code>gnutls_transport_set_ptr2</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005ftransport_005fset_005fpull_005ffunction-293"><code>gnutls_transport_set_pull_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005ftransport_005fset_005fpush_005ffunction-294"><code>gnutls_transport_set_push_function</code></a>: <a href="#Core-functions">Core functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fcheck_005fissuer-332"><code>gnutls_x509_crl_check_issuer</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fdeinit-333"><code>gnutls_x509_crl_deinit</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fexport-334"><code>gnutls_x509_crl_export</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fget_005fcrt_005fcount-335"><code>gnutls_x509_crl_get_crt_count</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fget_005fcrt_005fserial-336"><code>gnutls_x509_crl_get_crt_serial</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fget_005fdn_005foid-337"><code>gnutls_x509_crl_get_dn_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fget_005fissuer_005fdn-339"><code>gnutls_x509_crl_get_issuer_dn</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fget_005fissuer_005fdn_005fby_005foid-338"><code>gnutls_x509_crl_get_issuer_dn_by_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fget_005fnext_005fupdate-340"><code>gnutls_x509_crl_get_next_update</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fget_005fsignature-342"><code>gnutls_x509_crl_get_signature</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fget_005fsignature_005falgorithm-341"><code>gnutls_x509_crl_get_signature_algorithm</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fget_005fthis_005fupdate-343"><code>gnutls_x509_crl_get_this_update</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fget_005fversion-344"><code>gnutls_x509_crl_get_version</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fimport-345"><code>gnutls_x509_crl_import</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005finit-346"><code>gnutls_x509_crl_init</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fprint-347"><code>gnutls_x509_crl_print</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fset_005fcrt-349"><code>gnutls_x509_crl_set_crt</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fset_005fcrt_005fserial-348"><code>gnutls_x509_crl_set_crt_serial</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fset_005fnext_005fupdate-350"><code>gnutls_x509_crl_set_next_update</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fset_005fthis_005fupdate-351"><code>gnutls_x509_crl_set_this_update</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fset_005fversion-352"><code>gnutls_x509_crl_set_version</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fsign-354"><code>gnutls_x509_crl_sign</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fsign2-353"><code>gnutls_x509_crl_sign2</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrl_005fverify-355"><code>gnutls_x509_crl_verify</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fdeinit-356"><code>gnutls_x509_crq_deinit</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fexport-357"><code>gnutls_x509_crq_export</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fget_005fattribute_005fby_005foid-358"><code>gnutls_x509_crq_get_attribute_by_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fget_005fchallenge_005fpassword-359"><code>gnutls_x509_crq_get_challenge_password</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fget_005fdn-362"><code>gnutls_x509_crq_get_dn</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fget_005fdn_005fby_005foid-360"><code>gnutls_x509_crq_get_dn_by_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fget_005fdn_005foid-361"><code>gnutls_x509_crq_get_dn_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fget_005fpk_005falgorithm-363"><code>gnutls_x509_crq_get_pk_algorithm</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fget_005fversion-364"><code>gnutls_x509_crq_get_version</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fimport-365"><code>gnutls_x509_crq_import</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005finit-366"><code>gnutls_x509_crq_init</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fset_005fattribute_005fby_005foid-367"><code>gnutls_x509_crq_set_attribute_by_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fset_005fchallenge_005fpassword-368"><code>gnutls_x509_crq_set_challenge_password</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fset_005fdn_005fby_005foid-369"><code>gnutls_x509_crq_set_dn_by_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fset_005fkey-371"><code>gnutls_x509_crq_set_key</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fset_005fkey_005frsa_005fraw-370"><code>gnutls_x509_crq_set_key_rsa_raw</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fset_005fversion-372"><code>gnutls_x509_crq_set_version</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fsign-374"><code>gnutls_x509_crq_sign</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrq_005fsign2-373"><code>gnutls_x509_crq_sign2</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fcheck_005fhostname-375"><code>gnutls_x509_crt_check_hostname</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fcheck_005fissuer-376"><code>gnutls_x509_crt_check_issuer</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fcheck_005frevocation-377"><code>gnutls_x509_crt_check_revocation</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fcpy_005fcrl_005fdist_005fpoints-378"><code>gnutls_x509_crt_cpy_crl_dist_points</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fdeinit-379"><code>gnutls_x509_crt_deinit</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fexport-380"><code>gnutls_x509_crt_export</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005factivation_005ftime-381"><code>gnutls_x509_crt_get_activation_time</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fauthority_005fkey_005fid-382"><code>gnutls_x509_crt_get_authority_key_id</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fbasic_005fconstraints-383"><code>gnutls_x509_crt_get_basic_constraints</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fca_005fstatus-384"><code>gnutls_x509_crt_get_ca_status</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fcrl_005fdist_005fpoints-385"><code>gnutls_x509_crt_get_crl_dist_points</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fdn-388"><code>gnutls_x509_crt_get_dn</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fdn_005fby_005foid-386"><code>gnutls_x509_crt_get_dn_by_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fdn_005foid-387"><code>gnutls_x509_crt_get_dn_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fexpiration_005ftime-389"><code>gnutls_x509_crt_get_expiration_time</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fextension_005fby_005foid-390"><code>gnutls_x509_crt_get_extension_by_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fextension_005fdata-391"><code>gnutls_x509_crt_get_extension_data</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fextension_005finfo-392"><code>gnutls_x509_crt_get_extension_info</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fextension_005foid-393"><code>gnutls_x509_crt_get_extension_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005ffingerprint-394"><code>gnutls_x509_crt_get_fingerprint</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fissuer-398"><code>gnutls_x509_crt_get_issuer</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fissuer_005fdn-397"><code>gnutls_x509_crt_get_issuer_dn</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fissuer_005fdn_005fby_005foid-395"><code>gnutls_x509_crt_get_issuer_dn_by_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fissuer_005fdn_005foid-396"><code>gnutls_x509_crt_get_issuer_dn_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fkey_005fid-399"><code>gnutls_x509_crt_get_key_id</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fkey_005fpurpose_005foid-400"><code>gnutls_x509_crt_get_key_purpose_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fkey_005fusage-401"><code>gnutls_x509_crt_get_key_usage</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fpk_005falgorithm-402"><code>gnutls_x509_crt_get_pk_algorithm</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fpk_005fdsa_005fraw-403"><code>gnutls_x509_crt_get_pk_dsa_raw</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fpk_005frsa_005fraw-404"><code>gnutls_x509_crt_get_pk_rsa_raw</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fproxy-405"><code>gnutls_x509_crt_get_proxy</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fraw_005fdn-406"><code>gnutls_x509_crt_get_raw_dn</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fraw_005fissuer_005fdn-407"><code>gnutls_x509_crt_get_raw_issuer_dn</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fserial-408"><code>gnutls_x509_crt_get_serial</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fsignature-410"><code>gnutls_x509_crt_get_signature</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fsignature_005falgorithm-409"><code>gnutls_x509_crt_get_signature_algorithm</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fsubject-415"><code>gnutls_x509_crt_get_subject</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fsubject_005falt_005fname-412"><code>gnutls_x509_crt_get_subject_alt_name</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fsubject_005falt_005fname2-411"><code>gnutls_x509_crt_get_subject_alt_name2</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fsubject_005falt_005fothername_005foid-413"><code>gnutls_x509_crt_get_subject_alt_othername_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fsubject_005fkey_005fid-414"><code>gnutls_x509_crt_get_subject_key_id</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fget_005fversion-416"><code>gnutls_x509_crt_get_version</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fimport-417"><code>gnutls_x509_crt_import</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005finit-418"><code>gnutls_x509_crt_init</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005flist_005fimport-419"><code>gnutls_x509_crt_list_import</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005flist_005fverify-420"><code>gnutls_x509_crt_list_verify</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fprint-421"><code>gnutls_x509_crt_print</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005factivation_005ftime-422"><code>gnutls_x509_crt_set_activation_time</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fauthority_005fkey_005fid-423"><code>gnutls_x509_crt_set_authority_key_id</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fbasic_005fconstraints-424"><code>gnutls_x509_crt_set_basic_constraints</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fca_005fstatus-425"><code>gnutls_x509_crt_set_ca_status</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fcrl_005fdist_005fpoints-427"><code>gnutls_x509_crt_set_crl_dist_points</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fcrl_005fdist_005fpoints2-426"><code>gnutls_x509_crt_set_crl_dist_points2</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fcrq-428"><code>gnutls_x509_crt_set_crq</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fdn_005fby_005foid-429"><code>gnutls_x509_crt_set_dn_by_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fexpiration_005ftime-430"><code>gnutls_x509_crt_set_expiration_time</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fextension_005fby_005foid-431"><code>gnutls_x509_crt_set_extension_by_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fissuer_005fdn_005fby_005foid-432"><code>gnutls_x509_crt_set_issuer_dn_by_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fkey-435"><code>gnutls_x509_crt_set_key</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fkey_005fpurpose_005foid-433"><code>gnutls_x509_crt_set_key_purpose_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fkey_005fusage-434"><code>gnutls_x509_crt_set_key_usage</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fproxy-437"><code>gnutls_x509_crt_set_proxy</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fproxy_005fdn-436"><code>gnutls_x509_crt_set_proxy_dn</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fserial-438"><code>gnutls_x509_crt_set_serial</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fsubject_005falt_005fname-439"><code>gnutls_x509_crt_set_subject_alt_name</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fsubject_005falternative_005fname-440"><code>gnutls_x509_crt_set_subject_alternative_name</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fsubject_005fkey_005fid-441"><code>gnutls_x509_crt_set_subject_key_id</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fset_005fversion-442"><code>gnutls_x509_crt_set_version</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fsign-444"><code>gnutls_x509_crt_sign</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fsign2-443"><code>gnutls_x509_crt_sign2</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fverify-446"><code>gnutls_x509_crt_verify</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fcrt_005fverify_005fdata-445"><code>gnutls_x509_crt_verify_data</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fdn_005fdeinit-447"><code>gnutls_x509_dn_deinit</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fdn_005fexport-448"><code>gnutls_x509_dn_export</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fdn_005fget_005frdn_005fava-449"><code>gnutls_x509_dn_get_rdn_ava</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fdn_005fimport-450"><code>gnutls_x509_dn_import</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fdn_005finit-451"><code>gnutls_x509_dn_init</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fdn_005foid_005fknown-452"><code>gnutls_x509_dn_oid_known</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005fcpy-453"><code>gnutls_x509_privkey_cpy</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005fdeinit-454"><code>gnutls_x509_privkey_deinit</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005fexport-458"><code>gnutls_x509_privkey_export</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005fexport_005fdsa_005fraw-455"><code>gnutls_x509_privkey_export_dsa_raw</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005fexport_005fpkcs8-456"><code>gnutls_x509_privkey_export_pkcs8</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005fexport_005frsa_005fraw-457"><code>gnutls_x509_privkey_export_rsa_raw</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005ffix-459"><code>gnutls_x509_privkey_fix</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005fgenerate-460"><code>gnutls_x509_privkey_generate</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005fget_005fkey_005fid-461"><code>gnutls_x509_privkey_get_key_id</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005fget_005fpk_005falgorithm-462"><code>gnutls_x509_privkey_get_pk_algorithm</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005fimport-466"><code>gnutls_x509_privkey_import</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005fimport_005fdsa_005fraw-463"><code>gnutls_x509_privkey_import_dsa_raw</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005fimport_005fpkcs8-464"><code>gnutls_x509_privkey_import_pkcs8</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005fimport_005frsa_005fraw-465"><code>gnutls_x509_privkey_import_rsa_raw</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005finit-467"><code>gnutls_x509_privkey_init</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005fsign_005fdata-468"><code>gnutls_x509_privkey_sign_data</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005fsign_005fhash-469"><code>gnutls_x509_privkey_sign_hash</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005fprivkey_005fverify_005fdata-470"><code>gnutls_x509_privkey_verify_data</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005frdn_005fget-473"><code>gnutls_x509_rdn_get</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005frdn_005fget_005fby_005foid-471"><code>gnutls_x509_rdn_get_by_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-gnutls_005fx509_005frdn_005fget_005foid-472"><code>gnutls_x509_rdn_get_oid</code></a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
<li><a href="#index-handshake-672"><code>handshake</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-handshake_002ddescription_002d_003estring-701"><code>handshake-description-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-import_002dopenpgp_002dcertificate-725"><code>import-openpgp-certificate</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-import_002dopenpgp_002dkeyring-714"><code>import-openpgp-keyring</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-import_002dopenpgp_002dprivate_002dkey-724"><code>import-openpgp-private-key</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-import_002dx509_002dcertificate-613"><code>import-x509-certificate</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-import_002dx509_002dprivate_002dkey-612"><code>import-x509-private-key</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-key_002dusage_002d_003estring-690"><code>key-usage-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-kx_002d_003estring-710"><code>kx-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-mac_002d_003estring-707"><code>mac-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-make_002danonymous_002dclient_002dcredentials-636"><code>make-anonymous-client-credentials</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-make_002danonymous_002dserver_002dcredentials-637"><code>make-anonymous-server-credentials</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-make_002dcertificate_002dcredentials-631"><code>make-certificate-credentials</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-make_002ddh_002dparameters-641"><code>make-dh-parameters</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-make_002dpsk_002dclient_002dcredentials-616"><code>make-psk-client-credentials</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-make_002dpsk_002dserver_002dcredentials-618"><code>make-psk-server-credentials</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-make_002drsa_002dparameters-634"><code>make-rsa-parameters</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-make_002drsa_002dparameters-577"><code>make-rsa-parameters</code></a>: <a href="#Representation-of-Binary-Data">Representation of Binary Data</a></li>
<li><a href="#index-make_002dsession-674"><code>make-session</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-openpgp_002dcertificate_002dalgorithm-717"><code>openpgp-certificate-algorithm</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-openpgp_002dcertificate_002dfingerprint-720"><code>openpgp-certificate-fingerprint</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-openpgp_002dcertificate_002dfingerprint_0021-721"><code>openpgp-certificate-fingerprint!</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-openpgp_002dcertificate_002dformat_002d_003estring-726"><code>openpgp-certificate-format-&gt;string</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-openpgp_002dcertificate_002did-723"><code>openpgp-certificate-id</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-openpgp_002dcertificate_002did_0021-722"><code>openpgp-certificate-id!</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-openpgp_002dcertificate_002dname-719"><code>openpgp-certificate-name</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-openpgp_002dcertificate_002dnames-718"><code>openpgp-certificate-names</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-openpgp_002dcertificate_002dusage-715"><code>openpgp-certificate-usage</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-openpgp_002dcertificate_002dversion-716"><code>openpgp-certificate-version</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-openpgp_002dcertificate_003f-729"><code>openpgp-certificate?</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-openpgp_002dkeyring_002dcontains_002dkey_002did_003f-713"><code>openpgp-keyring-contains-key-id?</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-openpgp_002dkeyring_003f-727"><code>openpgp-keyring?</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-openpgp_002dprivate_002dkey_003f-728"><code>openpgp-private-key?</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-params_002d_003estring-709"><code>params-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-peer_002dcertificate_002dstatus-619"><code>peer-certificate-status</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-pk_002dalgorithm_002d_003estring-693"><code>pk-algorithm-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-pkcs1_002dexport_002drsa_002dparameters-632"><code>pkcs1-export-rsa-parameters</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-pkcs1_002dexport_002drsa_002dparameters-578"><code>pkcs1-export-rsa-parameters</code></a>: <a href="#Representation-of-Binary-Data">Representation of Binary Data</a></li>
<li><a href="#index-pkcs1_002dimport_002drsa_002dparameters-633"><code>pkcs1-import-rsa-parameters</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-pkcs3_002dexport_002ddh_002dparameters-639"><code>pkcs3-export-dh-parameters</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-pkcs3_002dimport_002ddh_002dparameters-640"><code>pkcs3-import-dh-parameters</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-pkcs8_002dimport_002dx509_002dprivate_002dkey-611"><code>pkcs8-import-x509-private-key</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-protocol_002d_003estring-697"><code>protocol-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-psk_002dclient_002dcredentials_003f-678"><code>psk-client-credentials?</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-psk_002dkey_002dformat_002d_003estring-691"><code>psk-key-format-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-psk_002dserver_002dcredentials_003f-679"><code>psk-server-credentials?</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-record_002dreceive_0021-645"><code>record-receive!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-record_002dreceive_0021-584"><code>record-receive!</code></a>: <a href="#Input-and-Output">Input and Output</a></li>
<li><a href="#index-record_002dsend-646"><code>record-send</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-record_002dsend-583"><code>record-send</code></a>: <a href="#Input-and-Output">Input and Output</a></li>
<li><a href="#index-rehandshake-671"><code>rehandshake</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-rsa_002dparameters_003f-683"><code>rsa-parameters?</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-server_002dsession_002dpsk_002dusername-614"><code>server-session-psk-username</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-session_002dauthentication_002dtype-662"><code>session-authentication-type</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-session_002dcertificate_002dtype-664"><code>session-certificate-type</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-session_002dcipher-668"><code>session-cipher</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-session_002dcipher-574"><code>session-cipher</code></a>: <a href="#Enumerates-and-Constants">Enumerates and Constants</a></li>
<li><a href="#index-session_002dclient_002dauthentication_002dtype-660"><code>session-client-authentication-type</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-session_002dcompression_002dmethod-665"><code>session-compression-method</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-session_002dkx-667"><code>session-kx</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-session_002dmac-666"><code>session-mac</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-session_002dour_002dcertificate_002dchain-658"><code>session-our-certificate-chain</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-session_002dpeer_002dcertificate_002dchain-659"><code>session-peer-certificate-chain</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-session_002dprotocol-663"><code>session-protocol</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-session_002drecord_002dport-644"><code>session-record-port</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-session_002drecord_002dport-582"><code>session-record-port</code></a>: <a href="#Input-and-Output">Input and Output</a></li>
<li><a href="#index-session_002dserver_002dauthentication_002dtype-661"><code>session-server-authentication-type</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-session_003f-687"><code>session?</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002danonymous_002dserver_002ddh_002dparameters_0021-635"><code>set-anonymous-server-dh-parameters!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dcertificate_002dcredentials_002ddh_002dparameters_0021-630"><code>set-certificate-credentials-dh-parameters!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dcertificate_002dcredentials_002dopenpgp_002dkeys_0021-712"><code>set-certificate-credentials-openpgp-keys!</code></a>: <a href="#Extra-Interface">Extra Interface</a></li>
<li><a href="#index-set_002dcertificate_002dcredentials_002drsa_002dexport_002dparameters_0021-629"><code>set-certificate-credentials-rsa-export-parameters!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dcertificate_002dcredentials_002dverify_002dflags_0021-620"><code>set-certificate-credentials-verify-flags!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dcertificate_002dcredentials_002dverify_002dlimits_0021-621"><code>set-certificate-credentials-verify-limits!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dcertificate_002dcredentials_002dx509_002dcrl_002ddata_0021-624"><code>set-certificate-credentials-x509-crl-data!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dcertificate_002dcredentials_002dx509_002dcrl_002dfile_0021-626"><code>set-certificate-credentials-x509-crl-file!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dcertificate_002dcredentials_002dx509_002dkey_002ddata_0021-623"><code>set-certificate-credentials-x509-key-data!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dcertificate_002dcredentials_002dx509_002dkey_002dfiles_0021-628"><code>set-certificate-credentials-x509-key-files!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dcertificate_002dcredentials_002dx509_002dkeys_0021-622"><code>set-certificate-credentials-x509-keys!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dcertificate_002dcredentials_002dx509_002dtrust_002ddata_0021-625"><code>set-certificate-credentials-x509-trust-data!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dcertificate_002dcredentials_002dx509_002dtrust_002dfile_0021-627"><code>set-certificate-credentials-x509-trust-file!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dlog_002dlevel_0021-596"><code>set-log-level!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dlog_002dprocedure_0021-597"><code>set-log-procedure!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dpsk_002dclient_002dcredentials_0021-615"><code>set-psk-client-credentials!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dpsk_002dserver_002dcredentials_002dfile_0021-617"><code>set-psk-server-credentials-file!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dserver_002dsession_002dcertificate_002drequest_0021-657"><code>set-server-session-certificate-request!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dsession_002dcertificate_002dtype_002dpriority_0021-651"><code>set-session-certificate-type-priority!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dsession_002dcipher_002dpriority_0021-656"><code>set-session-cipher-priority!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dsession_002dcompression_002dmethod_002dpriority_0021-654"><code>set-session-compression-method-priority!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dsession_002dcredentials_0021-647"><code>set-session-credentials!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dsession_002ddefault_002dexport_002dpriority_0021-649"><code>set-session-default-export-priority!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dsession_002ddefault_002dpriority_0021-650"><code>set-session-default-priority!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dsession_002ddh_002dprime_002dbits_0021-638"><code>set-session-dh-prime-bits!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dsession_002dkx_002dpriority_0021-653"><code>set-session-kx-priority!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dsession_002dmac_002dpriority_0021-655"><code>set-session-mac-priority!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dsession_002dprotocol_002dpriority_0021-652"><code>set-session-protocol-priority!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dsession_002dtransport_002dfd_0021-643"><code>set-session-transport-fd!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dsession_002dtransport_002dfd_0021-581"><code>set-session-transport-fd!</code></a>: <a href="#Input-and-Output">Input and Output</a></li>
<li><a href="#index-set_002dsession_002dtransport_002dport_0021-642"><code>set-session-transport-port!</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-set_002dsession_002dtransport_002dport_0021-580"><code>set-session-transport-port!</code></a>: <a href="#Input-and-Output">Input and Output</a></li>
<li><a href="#index-sign_002dalgorithm_002d_003estring-692"><code>sign-algorithm-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-srp_002dclient_002dcredentials_003f-680"><code>srp-client-credentials?</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-srp_002dserver_002dcredentials_003f-681"><code>srp-server-credentials?</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-x509_002dcertificate_002dauthority_002dkey_002did-600"><code>x509-certificate-authority-key-id</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-x509_002dcertificate_002ddn-610"><code>x509-certificate-dn</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-x509_002dcertificate_002ddn_002doid-608"><code>x509-certificate-dn-oid</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-x509_002dcertificate_002dformat_002d_003estring-695"><code>x509-certificate-format-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-x509_002dcertificate_002dissuer_002ddn-609"><code>x509-certificate-issuer-dn</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-x509_002dcertificate_002dissuer_002ddn_002doid-607"><code>x509-certificate-issuer-dn-oid</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-x509_002dcertificate_002dkey_002did-601"><code>x509-certificate-key-id</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-x509_002dcertificate_002dkey_002dusage-603"><code>x509-certificate-key-usage</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-x509_002dcertificate_002dmatches_002dhostname_003f-606"><code>x509-certificate-matches-hostname?</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-x509_002dcertificate_002dpublic_002dkey_002dalgorithm-604"><code>x509-certificate-public-key-algorithm</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-x509_002dcertificate_002dsignature_002dalgorithm-605"><code>x509-certificate-signature-algorithm</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-x509_002dcertificate_002dsubject_002dalternative_002dname-598"><code>x509-certificate-subject-alternative-name</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-x509_002dcertificate_002dsubject_002dkey_002did-599"><code>x509-certificate-subject-key-id</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-x509_002dcertificate_002dversion-602"><code>x509-certificate-version</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-x509_002dcertificate_003f-677"><code>x509-certificate?</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-x509_002dprivate_002dkey_003f-676"><code>x509-private-key?</code></a>: <a href="#Core-Interface">Core Interface</a></li>
<li><a href="#index-x509_002dsubject_002dalternative_002dname_002d_003estring-694"><code>x509-subject-alternative-name-&gt;string</code></a>: <a href="#Core-Interface">Core Interface</a></li>
</ul><div class="node">
<a name="Concept-Index"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Function-and-Data-Index">Function and Data Index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Copying-Information">Copying Information</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="unnumbered">Concept Index</h2>



<ul class="index-cp" compact>
<li><a href="#index-Alert-protocol-12">Alert protocol</a>: <a href="#The-TLS-Alert-Protocol">The TLS Alert Protocol</a></li>
<li><a href="#index-Anonymous-authentication-28">Anonymous authentication</a>: <a href="#Anonymous-authentication">Anonymous authentication</a></li>
<li><a href="#index-Bad-record-MAC-25">Bad record MAC</a>: <a href="#On-Record-Padding">On Record Padding</a></li>
<li><a href="#index-Callback-functions-6">Callback functions</a>: <a href="#Callback-functions">Callback functions</a></li>
<li><a href="#index-Certificate-authentication-31">Certificate authentication</a>: <a href="#More-on-certificate-authentication">More on certificate authentication</a></li>
<li><a href="#index-Certificate-requests-35">Certificate requests</a>: <a href="#PKCS-_002310-certificate-requests">PKCS #10 certificate requests</a></li>
<li><a href="#index-certtool-44">certtool</a>: <a href="#Invoking-certtool">Invoking certtool</a></li>
<li><a href="#index-Ciphersuites-571">Ciphersuites</a>: <a href="#All-the-supported-ciphersuites-in-GnuTLS">All the supported ciphersuites in GnuTLS</a></li>
<li><a href="#index-Client-Certificate-authentication-14">Client Certificate authentication</a>: <a href="#The-TLS-Handshake-Protocol">The TLS Handshake Protocol</a></li>
<li><a href="#index-Compression-algorithms-11">Compression algorithms</a>: <a href="#Compression-algorithms-used-in-the-record-layer">Compression algorithms used in the record layer</a></li>
<li><a href="#index-constant-573">constant</a>: <a href="#Enumerates-and-Constants">Enumerates and Constants</a></li>
<li><a href="#index-Contributing-4">Contributing</a>: <a href="#Contributing">Contributing</a></li>
<li><a href="#index-debug-server-51">debug server</a>: <a href="#Invoking-gnutls_002dserv">Invoking gnutls-serv</a></li>
<li><a href="#index-Digital-signatures-39">Digital signatures</a>: <a href="#Digital-signatures">Digital signatures</a></li>
<li><a href="#index-Download-2">Download</a>: <a href="#Downloading-and-Installing">Downloading and Installing</a></li>
<li><a href="#index-enumerate-572">enumerate</a>: <a href="#Enumerates-and-Constants">Enumerates and Constants</a></li>
<li><a href="#index-Error-codes-570">Error codes</a>: <a href="#Error-codes-and-descriptions">Error codes and descriptions</a></li>
<li><a href="#index-errors-586">errors</a>: <a href="#Exception-Handling">Exception Handling</a></li>
<li><a href="#index-Example-programs-40">Example programs</a>: <a href="#How-to-use-GnuTLS-in-applications">How to use GnuTLS in applications</a></li>
<li><a href="#index-exceptions-585">exceptions</a>: <a href="#Exception-Handling">Exception Handling</a></li>
<li><a href="#index-FDL_002c-GNU-Free-Documentation-License-731">FDL, GNU Free Documentation License</a>: <a href="#GNU-Free-Documentation-License">GNU Free Documentation License</a></li>
<li><a href="#index-Function-reference-55">Function reference</a>: <a href="#Function-reference">Function reference</a></li>
<li><a href="#index-gnutls_002dcli-45">gnutls-cli</a>: <a href="#Invoking-gnutls_002dcli">Invoking gnutls-cli</a></li>
<li><a href="#index-gnutls_002dcli_002ddebug-48">gnutls-cli-debug</a>: <a href="#Invoking-gnutls_002dcli_002ddebug">Invoking gnutls-cli-debug</a></li>
<li><a href="#index-g_t_0040code_007bgnutls_002derror_007d-587"><code>gnutls-error</code></a>: <a href="#Exception-Handling">Exception Handling</a></li>
<li><a href="#index-g_t_0040acronym_007bGnuTLS_002dextra_007d-functions-474"><acronym>GnuTLS-extra</acronym> functions</a>: <a href="#GnuTLS_002dextra-functions">GnuTLS-extra functions</a></li>
<li><a href="#index-gnutls_002dserv-49">gnutls-serv</a>: <a href="#Invoking-gnutls_002dserv">Invoking gnutls-serv</a></li>
<li><a href="#index-GPL_002c-GNU-General-Public-License-734">GPL, GNU General Public License</a>: <a href="#GNU-GPL">GNU GPL</a></li>
<li><a href="#index-Hacking-5">Hacking</a>: <a href="#Contributing">Contributing</a></li>
<li><a href="#index-Handshake-protocol-13">Handshake protocol</a>: <a href="#The-TLS-Handshake-Protocol">The TLS Handshake Protocol</a></li>
<li><a href="#index-homogeneous-vector-576">homogeneous vector</a>: <a href="#Representation-of-Binary-Data">Representation of Binary Data</a></li>
<li><a href="#index-HTTPS-server-50">HTTPS server</a>: <a href="#Invoking-gnutls_002dserv">Invoking gnutls-serv</a></li>
<li><a href="#index-Inner-Application-_0028_0040acronym_007bTLS_002fIA_007d_0029-functions-549">Inner Application (<acronym>TLS/IA</acronym>) functions</a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-Installation-1">Installation</a>: <a href="#Downloading-and-Installing">Downloading and Installing</a></li>
<li><a href="#index-Internal-architecture-730">Internal architecture</a>: <a href="#Internal-architecture-of-GnuTLS">Internal architecture of GnuTLS</a></li>
<li><a href="#index-key-sizes-21">key sizes</a>: <a href="#Selecting-cryptographic-key-sizes">Selecting cryptographic key sizes</a></li>
<li><a href="#index-LGPL_002c-GNU-Lesser-General-Public-License-732">LGPL, GNU Lesser General Public License</a>: <a href="#GNU-LGPL">GNU LGPL</a></li>
<li><a href="#index-License_002c-GNU-GPL-735">License, GNU GPL</a>: <a href="#GNU-GPL">GNU GPL</a></li>
<li><a href="#index-License_002c-GNU-LGPL-733">License, GNU LGPL</a>: <a href="#GNU-LGPL">GNU LGPL</a></li>
<li><a href="#index-Maximum-fragment-length-18">Maximum fragment length</a>: <a href="#TLS-Extensions">TLS Extensions</a></li>
<li><a href="#index-Netconf-47">Netconf</a>: <a href="#Example-client-PSK-connection">Example client PSK connection</a></li>
<li><a href="#index-Opaque-PRF-Input-43">Opaque PRF Input</a>: <a href="#Opaque-PRF-Input-TLS-Extension">Opaque PRF Input TLS Extension</a></li>
<li><a href="#index-g_t_0040acronym_007bOpenPGP_007d-functions-477"><acronym>OpenPGP</acronym> functions</a>: <a href="#OpenPGP-functions">OpenPGP functions</a></li>
<li><a href="#index-g_t_0040acronym_007bOpenPGP_007d-Keys-38"><acronym>OpenPGP</acronym> Keys</a>: <a href="#The-OpenPGP-trust-model">The OpenPGP trust model</a></li>
<li><a href="#index-g_t_0040acronym_007bOpenPGP_007d-Keys-27"><acronym>OpenPGP</acronym> Keys</a>: <a href="#Certificate-authentication">Certificate authentication</a></li>
<li><a href="#index-g_t_0040acronym_007bOpenPGP_007d-Server-41"><acronym>OpenPGP</acronym> Server</a>: <a href="#Echo-Server-with-OpenPGP-authentication">Echo Server with OpenPGP authentication</a></li>
<li><a href="#index-OpenSSL-42">OpenSSL</a>: <a href="#Compatibility-with-the-OpenSSL-library">Compatibility with the OpenSSL library</a></li>
<li><a href="#index-PCT-23">PCT</a>: <a href="#On-SSL-2-and-older-protocols">On SSL 2 and older protocols</a></li>
<li><a href="#index-g_t_0040acronym_007bPKCS_007d-_002310-36"><acronym>PKCS</acronym> #10</a>: <a href="#PKCS-_002310-certificate-requests">PKCS #10 certificate requests</a></li>
<li><a href="#index-g_t_0040acronym_007bPKCS_007d-_002312-37"><acronym>PKCS</acronym> #12</a>: <a href="#PKCS-_002312-structures">PKCS #12 structures</a></li>
<li><a href="#index-g_t_0040acronym_007bPSK_007d-authentication-30"><acronym>PSK</acronym> authentication</a>: <a href="#Authentication-using-PSK">Authentication using PSK</a></li>
<li><a href="#index-PSK-client-46">PSK client</a>: <a href="#Example-client-PSK-connection">Example client PSK connection</a></li>
<li><a href="#index-PSK-server-52">PSK server</a>: <a href="#Example-server-PSK-connection">Example server PSK connection</a></li>
<li><a href="#index-psktool-53">psktool</a>: <a href="#Invoking-psktool">Invoking psktool</a></li>
<li><a href="#index-Record-padding-24">Record padding</a>: <a href="#On-Record-Padding">On Record Padding</a></li>
<li><a href="#index-Record-protocol-9">Record protocol</a>: <a href="#The-TLS-record-protocol">The TLS record protocol</a></li>
<li><a href="#index-Reporting-Bugs-3">Reporting Bugs</a>: <a href="#Bug-Reports">Bug Reports</a></li>
<li><a href="#index-Resuming-sessions-15">Resuming sessions</a>: <a href="#The-TLS-Handshake-Protocol">The TLS Handshake Protocol</a></li>
<li><a href="#index-Server-name-indication-20">Server name indication</a>: <a href="#TLS-Extensions">TLS Extensions</a></li>
<li><a href="#index-SRFI_002d4-575">SRFI-4</a>: <a href="#Representation-of-Binary-Data">Representation of Binary Data</a></li>
<li><a href="#index-g_t_0040acronym_007bSRP_007d-authentication-29"><acronym>SRP</acronym> authentication</a>: <a href="#Authentication-using-SRP">Authentication using SRP</a></li>
<li><a href="#index-srptool-54">srptool</a>: <a href="#Invoking-srptool">Invoking srptool</a></li>
<li><a href="#index-SSL-2-22">SSL 2</a>: <a href="#On-SSL-2-and-older-protocols">On SSL 2 and older protocols</a></li>
<li><a href="#index-Symmetric-encryption-algorithms-10">Symmetric encryption algorithms</a>: <a href="#Encryption-algorithms-used-in-the-record-layer">Encryption algorithms used in the record layer</a></li>
<li><a href="#index-TLS-Extensions-16">TLS Extensions</a>: <a href="#TLS-Extensions">TLS Extensions</a></li>
<li><a href="#index-g_t_0040acronym_007bTLS_007d-Inner-Application-_0028_0040acronym_007bTLS_002fIA_007d_0029-functions-548"><acronym>TLS</acronym> Inner Application (<acronym>TLS/IA</acronym>) functions</a>: <a href="#TLS-Inner-Application-_0028TLS_002fIA_0029-functions">TLS Inner Application (TLS/IA) functions</a></li>
<li><a href="#index-TLS-Layers-7">TLS Layers</a>: <a href="#TLS-layers">TLS layers</a></li>
<li><a href="#index-Transport-protocol-8">Transport protocol</a>: <a href="#The-transport-layer">The transport layer</a></li>
<li><a href="#index-Verifying-certificate-paths-33">Verifying certificate paths</a>: <a href="#Verifying-X_002e509-certificate-paths">Verifying X.509 certificate paths</a></li>
<li><a href="#index-g_t_0040acronym_007bX_002e509_007d-certificates-32"><acronym>X.509</acronym> certificates</a>: <a href="#The-X_002e509-trust-model">The X.509 trust model</a></li>
<li><a href="#index-g_t_0040acronym_007bX_002e509_007d-certificates-26"><acronym>X.509</acronym> certificates</a>: <a href="#Certificate-authentication">Certificate authentication</a></li>
<li><a href="#index-g_t_0040acronym_007bX_002e509_007d-Functions-295"><acronym>X.509</acronym> Functions</a>: <a href="#X_002e509-certificate-functions">X.509 certificate functions</a></li>
</ul><div class="footnote">
<hr>
<a name="texinfo-footnotes-in-document"></a><h4>Footnotes</h4><p class="footnote"><small>[<a name="fn-1" href="#fnd-1">1</a>]</small> <a href="http://www.openssl.org/">http://www.openssl.org/</a></p>

<p class="footnote"><small>[<a name="fn-2" href="#fnd-2">2</a>]</small> <a href="ftp://ftp.gnupg.org/gcrypt/alpha/gnutls/libtasn1/">ftp://ftp.gnupg.org/gcrypt/alpha/gnutls/libtasn1/</a></p>

<p class="footnote"><small>[<a name="fn-3" href="#fnd-3">3</a>]</small> <a href="ftp://ftp.gnupg.org/gcrypt/alpha/gnutls/opencdk/">ftp://ftp.gnupg.org/gcrypt/alpha/gnutls/opencdk/</a></p>

<p class="footnote"><small>[<a name="fn-4" href="#fnd-4">4</a>]</small> <a href="ftp://ftp.gnupg.org/gcrypt/alpha/libgcrypt/">ftp://ftp.gnupg.org/gcrypt/alpha/libgcrypt/</a></p>

<p class="footnote"><small>[<a name="fn-5" href="#fnd-5">5</a>]</small> On current versions of GnuTLS it is possible
to override the default crypto backend. Check see <a href="#Cryptographic-Backend">Cryptographic Backend</a> for details</p>

<p class="footnote"><small>[<a name="fn-6" href="#fnd-6">6</a>]</small> The first message in a <acronym>TLS</acronym> handshake</p>

<p class="footnote"><small>[<a name="fn-7" href="#fnd-7">7</a>]</small> IETF, or Internet Engineering Task Force,
is a large open international community of network designers,
operators, vendors, and researchers concerned with the evolution of
the Internet architecture and the smooth operation of the Internet. 
It is open to any interested individual.</p>

<p class="footnote"><small>[<a name="fn-8" href="#fnd-8">8</a>]</small> AES,
or Advanced Encryption Standard, is actually the RIJNDAEL algorithm. 
This is the algorithm that replaced DES.</p>

<p class="footnote"><small>[<a name="fn-9" href="#fnd-9">9</a>]</small> <code>ARCFOUR_128</code> is a compatible
algorithm with RSA's RC4 algorithm, which is considered to be a trade
secret.</p>

<p class="footnote"><small>[<a name="fn-10" href="#fnd-10">10</a>]</small> You should use
<a href="#gnutls_005fhandshake_005fset_005fprivate_005fextensions">gnutls_handshake_set_private_extensions</a> to enable private
extensions.</p>

<p class="footnote"><small>[<a name="fn-11" href="#fnd-11">11</a>]</small> MAC stands for Message Authentication Code. It can be described as a keyed hash algorithm. See RFC2104.</p>

<p class="footnote"><small>[<a name="fn-12" href="#fnd-12">12</a>]</small> It really depends on the group used.  Primes with
lesser bits are always faster, but also easier to break.  Values less
than 768 should not be used today</p>

<p class="footnote"><small>[<a name="fn-13" href="#fnd-13">13</a>]</small> <acronym>SRP</acronym> is described in [RFC2945] (see <a href="#Bibliography">Bibliography</a>)</p>

<p class="footnote"><small>[<a name="fn-14" href="#fnd-14">14</a>]</small> See also the Server Name Indication extension on
<a href="#serverind">serverind</a>.</p>

<p class="footnote"><small>[<a name="fn-15" href="#fnd-15">15</a>]</small> See LDAP, IMAP etc.</p>

<p class="footnote"><small>[<a name="fn-16" href="#fnd-16">16</a>]</small> in <acronym>SRP</acronym> authentication</p>

<p class="footnote"><small>[<a name="fn-17" href="#fnd-17">17</a>]</small> such as the <code>gnutls_certificate_credentials_t</code> structures</p>

<hr></div>

</body></html>


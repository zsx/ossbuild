// This file was generated by the Gtk# code generator.
// Any changes made will be lost if regenerated.

namespace Gst {

	using System;
	using System.Collections;
	using System.Runtime.InteropServices;

#region Autogenerated code
	public partial class TagList : Gst.GLib.Opaque {

		[DllImport("libgstreamer-0.10.dll", CallingConvention = CallingConvention.Cdecl)]
		static extern void gst_tag_list_insert(IntPtr raw, IntPtr from, int mode);

		public void Insert(Gst.TagList from, Gst.TagMergeMode mode) {
			gst_tag_list_insert(Handle, from == null ? IntPtr.Zero : from.Handle, (int) mode);
		}

		[DllImport("libgstreamer-0.10.dll", CallingConvention = CallingConvention.Cdecl)]
		static extern IntPtr gst_tag_list_merge(IntPtr raw, IntPtr list2, int mode);

		public Gst.TagList Merge(Gst.TagList list2, Gst.TagMergeMode mode) {
			IntPtr raw_ret = gst_tag_list_merge(Handle, list2 == null ? IntPtr.Zero : list2.Handle, (int) mode);
			Gst.TagList ret = raw_ret == IntPtr.Zero ? null : (Gst.TagList) Gst.GLib.Opaque.GetOpaque (raw_ret, typeof (Gst.TagList), true);
			return ret;
		}

		[DllImport("libgstreamer-0.10.dll", CallingConvention = CallingConvention.Cdecl)]
		static extern void gst_tag_list_remove_tag(IntPtr raw, IntPtr tag);

		public void RemoveTag(string tag) {
			IntPtr native_tag = Gst.GLib.Marshaller.StringToPtrGStrdup (tag);
			gst_tag_list_remove_tag(Handle, native_tag);
			Gst.GLib.Marshaller.Free (native_tag);
		}

		[DllImport("libgstreamer-0.10.dll", CallingConvention = CallingConvention.Cdecl)]
		static extern IntPtr gst_tag_list_copy(IntPtr raw);

		public Gst.TagList Copy() {
			IntPtr raw_ret = gst_tag_list_copy(Handle);
			Gst.TagList ret = raw_ret == IntPtr.Zero ? null : (Gst.TagList) Gst.GLib.Opaque.GetOpaque (raw_ret, typeof (Gst.TagList), true);
			return ret;
		}

		[DllImport("libgstreamer-0.10.dll", CallingConvention = CallingConvention.Cdecl)]
		static extern IntPtr gst_tag_list_get_type();

		public static Gst.GLib.GType GType { 
			get {
				IntPtr raw_ret = gst_tag_list_get_type();
				Gst.GLib.GType ret = new Gst.GLib.GType(raw_ret);
				return ret;
			}
		}

		[DllImport("libgstreamer-0.10.dll", CallingConvention = CallingConvention.Cdecl)]
		static extern uint gst_tag_list_get_tag_size(IntPtr raw, IntPtr tag);

		public uint GetTagSize(string tag) {
			IntPtr native_tag = Gst.GLib.Marshaller.StringToPtrGStrdup (tag);
			uint raw_ret = gst_tag_list_get_tag_size(Handle, native_tag);
			uint ret = raw_ret;
			Gst.GLib.Marshaller.Free (native_tag);
			return ret;
		}

		[DllImport("libgstreamer-0.10.dll", CallingConvention = CallingConvention.Cdecl)]
		static extern void gst_tag_list_add_value(IntPtr raw, int mode, IntPtr tag, IntPtr value);

		private void AddValue(Gst.TagMergeMode mode, string tag, Gst.GLib.Value value) {
			IntPtr native_tag = Gst.GLib.Marshaller.StringToPtrGStrdup (tag);
			IntPtr native_value = Gst.GLib.Marshaller.StructureToPtrAlloc (value);
			gst_tag_list_add_value(Handle, (int) mode, native_tag, native_value);
			Gst.GLib.Marshaller.Free (native_tag);
			value = (Gst.GLib.Value) Marshal.PtrToStructure (native_value, typeof (Gst.GLib.Value));
			Marshal.FreeHGlobal (native_value);
		}

		[DllImport("libgstreamer-0.10.dll", CallingConvention = CallingConvention.Cdecl)]
		static extern bool gst_tag_list_is_empty(IntPtr raw);

		public bool IsEmpty { 
			get {
				bool raw_ret = gst_tag_list_is_empty(Handle);
				bool ret = raw_ret;
				return ret;
			}
		}

		public TagList(IntPtr raw) : base(raw) {}

		[DllImport("libgstreamer-0.10.dll", CallingConvention = CallingConvention.Cdecl)]
		static extern IntPtr gst_tag_list_new();

		public TagList () 
		{
			Raw = gst_tag_list_new();
		}

		[DllImport("libgstreamer-0.10.dll", CallingConvention = CallingConvention.Cdecl)]
		static extern void gst_tag_list_free(IntPtr raw);

		protected override void Free (IntPtr raw)
		{
			gst_tag_list_free (raw);
		}

		class FinalizerInfo {
			IntPtr handle;

			public FinalizerInfo (IntPtr handle)
			{
				this.handle = handle;
			}

			public bool Handler ()
			{
				gst_tag_list_free (handle);
				return false;
			}
		}

		~TagList ()
		{
			if (!Owned)
				return;
			FinalizerInfo info = new FinalizerInfo (Handle);
			Gst.GLib.Timeout.Add (50, new Gst.GLib.TimeoutHandler (info.Handler));
		}

#endregion
#region Customized extensions
#line 1 "TagList.custom"
[DllImport ("libgstreamer-0.10.dll") ]
static extern IntPtr gst_structure_to_string (IntPtr handle);

public override string ToString () {
  IntPtr raw_ret = gst_structure_to_string (Handle);
  string ret = Gst.GLib.Marshaller.PtrToStringGFree (raw_ret);
  return ret;
}

[DllImport ("libgstreamer-0.10.dll") ]
static extern int gst_structure_n_fields (IntPtr raw);

public int Size {
  get {
    int raw_ret = gst_structure_n_fields (Handle);
    int ret = raw_ret;
    return ret;
  }
}

[DllImport ("libgstreamer-0.10.dll") ]
static extern bool gst_tag_list_copy_value (ref Gst.GLib.Value dest, IntPtr list, IntPtr tag);
[DllImport ("libgstreamer-0.10.dll") ]
static extern IntPtr gst_tag_list_get_value_index (IntPtr raw, IntPtr tag, uint index);

public object this[string tag, uint index] {
  get {
    IntPtr raw_string = Gst.GLib.Marshaller.StringToPtrGStrdup (tag);
    IntPtr raw_ret = gst_tag_list_get_value_index (Handle, raw_string, index);
    Gst.GLib.Marshaller.Free (raw_string);

    if (raw_ret == IntPtr.Zero)
      return null;

    Gst.GLib.Value v = (Gst.GLib.Value) Marshal.PtrToStructure (raw_ret, typeof (Gst.GLib.Value));

    return (object) v.Val;
  }
}

public object this[string tag] {
  get {
    Gst.GLib.Value v = Gst.GLib.Value.Empty;
    bool success;

    IntPtr raw_string = Gst.GLib.Marshaller.StringToPtrGStrdup (tag);
    success = gst_tag_list_copy_value (ref v, Handle, raw_string);
    Gst.GLib.Marshaller.Free (raw_string);

    if (!success)
      return null;

    object ret = (object) v.Val;
    v.Dispose ();

    return ret;
  }
}

public void Add (Gst.TagMergeMode mode, string tag, object value) {
  if (!Tag.Exists (tag))
    throw new ArgumentException (String.Format ("Invalid tag name '{0}'", tag));

  Gst.GLib.Value v = new Gst.GLib.Value (value);
  IntPtr raw_v = Gst.GLib.Marshaller.StructureToPtrAlloc (v);

  IntPtr raw_string = Gst.GLib.Marshaller.StringToPtrGStrdup (tag);
  gst_tag_list_add_value (Handle, (int) mode, raw_string, raw_v);
  Marshal.FreeHGlobal (raw_v);
  v.Dispose ();
  Gst.GLib.Marshaller.Free (raw_string);
}

public void Add (Gst.TagMergeMode mode, params object[] parameters) {
  if (parameters.Length % 2 != 0)
    throw new ArgumentException ();

  for (int i = 0; i < parameters.Length; i += 2) {
    if (parameters[i].GetType () != typeof (string))
      throw new ArgumentException ();

    Add (mode, parameters[i] as string, parameters[i+1]);
  }
}

[DllImport ("libgstreamer-0.10.dll") ]
static extern IntPtr gst_structure_nth_field_name (IntPtr raw, uint index);

private string NthFieldName (uint index) {
  IntPtr raw_ret = gst_structure_nth_field_name (Handle, index);
  string ret = Gst.GLib.Marshaller.Utf8PtrToString (raw_ret);
  return ret;
}

public string[] Tags {
  get {
    string[] tags = new string[Size];
    for (uint i = 0; i < Size; i++)
      tags[i] = NthFieldName (i);

    return tags;
  }
}

[DllImport ("libgstreamer-0.10.dll") ]
static extern IntPtr gst_structure_get_value (IntPtr raw, IntPtr fieldname);

public Gst.List GetTag (string tag) {
  IntPtr raw_string = Gst.GLib.Marshaller.StringToPtrGStrdup (tag);
  IntPtr raw_ret = gst_structure_get_value (Handle, raw_string);
  Gst.GLib.Marshaller.Free (raw_string);
  Gst.GLib.Value ret = (Gst.GLib.Value) Marshal.PtrToStructure (raw_ret, typeof (Gst.GLib.Value));

  object o = ret.Val;

  if (o.GetType () == typeof (Gst.List))
    return (Gst.List) o;

  return new Gst.List (new object[] { o });
}


#endregion
	}
}
